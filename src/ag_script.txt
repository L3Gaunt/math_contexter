Algebraic Geometry
Andreas Gathmann
Notes for a class
taught at the University of Kaiserslautern 2002/2003
CONTENTS
0. Introduction 1
0.1. What is algebraic geometry? 1
0.2. Exercises 6
1. Affine varieties 8
1.1. Algebraic sets and the Zariski topology 8
1.2. Hilbert’s Nullstellensatz 11
1.3. Irreducibility and dimension 13
1.4. Exercises 16
2. Functions, morphisms, and varieties 18
2.1. Functions on affine varieties 18
2.2. Sheaves 21
2.3. Morphisms between affine varieties 23
2.4. Prevarieties 27
2.5. Varieties 31
2.6. Exercises 32
3. Projective varieties 35
3.1. Projective spaces and projective varieties 35
3.2. Cones and the projective Nullstellensatz 39
3.3. Projective varieties as ringed spaces 40
3.4. The main theorem on projective varieties 44
3.5. Exercises 47
4. Dimension 50
4.1. The dimension of projective varieties 50
4.2. The dimension of varieties 54
4.3. Blowing up 57
4.4. Smooth varieties 63
4.5. The 27 lines on a smooth cubic surface 68
4.6. Exercises 71
5. Schemes 74
5.1. Affine schemes 74
5.2. Morphisms and locally ringed spaces 78
5.3. Schemes and prevarieties 80
5.4. Fiber products 82
5.5. Projective schemes 86
5.6. Exercises 89
6. First applications of scheme theory 92
6.1. Hilbert polynomials 92
6.2. Bezout’s theorem ´ 96
6.3. Divisors on curves 101
6.4. The group structure on a plane cubic curve 104
6.5. Plane cubic curves as complex tori 108
6.6. Where to go from here 112
6.7. Exercises 117
7. More about sheaves 120
7.1. Sheaves and sheafification 120
7.2. Quasi-coherent sheaves 127
7.3. Locally free sheaves 131
7.4. Differentials 133
7.5. Line bundles on curves 137
7.6. The Riemann-Hurwitz formula 141
7.7. The Riemann-Roch theorem 143
7.8. Exercises 147
8. Cohomology of sheaves 149
8.1. Motivation and definitions 149
8.2. The long exact cohomology sequence 152
8.3. The Riemann-Roch theorem revisited 155
8.4. The cohomology of line bundles on projective spaces 159
8.5. Proof of the independence of the affine cover 162
8.6. Exercises 163
9. Intersection theory 165
9.1. Chow groups 165
9.2. Proper push-forward of cycles 171
9.3. Weil and Cartier divisors 176
9.4. Intersections with Cartier divisors 181
9.5. Exercises 185
10. Chern classes 188
10.1. Projective bundles 188
10.2. Segre and Chern classes of vector bundles 191
10.3. Properties of Chern classes 194
10.4. Statement of the Hirzebruch-Riemann-Roch theorem 200
10.5. Proof of the Hirzebruch-Riemann-Roch theorem 203
10.6. Exercises 209
References 211
0. Introduction 1
0. INTRODUCTION
In a very rough sketch we explain what algebraic geometry is about and what it can be
used for. We stress the many correlations with other fields of research, such as complex analysis, topology, differential geometry, singularity theory, computer algebra,
commutative algebra, number theory, enumerative geometry, and even theoretical
physics. The goal of this section is just motivational; you will not find definitions or
proofs here (and probably not even a mathematically precise statement).
0.1. What is algebraic geometry? To start from something that you probably know, we
can say that algebraic geometry is the combination of linear algebra and algebra:
• In linear algebra, we study systems of linear equations in several variables.
• In algebra, we study (among other things) polynomial equations in one variable.
Algebraic geometry combines these two fields of mathematics by studying systems of
polynomial equations in several variables.
Given such a system of polynomial equations, what sort of questions can we ask? Note
that we cannot expect in general to write down explicitly all the solutions: we know from
algebra that even a single complex polynomial equation of degree d > 4 in one variable
can in general not be solved exactly. So we are more interested in statements about the
geometric structure of the set of solutions. For example, in the case of a complex polynomial equation of degree d, even if we cannot compute the solutions we know that there are
exactly d of them (if we count them with the correct multiplicities). Let us now see what
sort of “geometric structure” we can find in polynomial equations in several variables.
Example 0.1.1. Probably the easiest example that is covered neither in linear algebra nor
in algebra is that of a single polynomial equation in two variables. Let us consider the
following example:
Cn = {(x, y) ∈ C
2
; y
2 = (x−1)(x−2)···(x−2n)} ⊂ C
2
,
where n ≥ 1. Note that in this case it is actually possible to write down all the solutions,
because the equation is (almost) solved for y already: we can pick x to be any complex
number, and then get two values for y — unless x ∈ {1,...,2n}, in which case we only get
one value for y (namely 0).
So it seems that the set of equations looks like two copies of the complex plane with the
two copies of each point 1,...,2n identified: the complex plane parametrizes the values
for x, and the two copies of it correspond to the two possible values for y, i. e. the two roots
of the number (x−1)···(x−2n).
This is not quite true however, because a complex non-zero number does not have a
distinguished first and second root that could correspond to the first and second copy of
the complex plane. Rather, the two roots of a complex number get exchanged if you run
around the origin once: if we consider a path
x = r eiϕ
for 0 ≤ ϕ ≤ 2π and fixed r > 0
around the complex origin, the square root of this number would have to be defined by
√
x =
√
r e
iϕ
2
which gives opposite values at ϕ = 0 and ϕ = 2π. In other words, if in Cn we run around
one of the points 1,...,2n, we go from one copy of the plane to the other. The way to draw
this topologically is to cut the two planes along the lines [1,2],...,[2n−1,2n], and to glue
the two planes along these lines as in this picture (lines marked with the same letter are to
be identified):
2 Andreas Gathmann
C
C
A
B
C
D
E
F
A
B
C
D
E
F
2
3
4
5
6
1
1
2
3
4
5
6
glue
To make the picture a little nicer, we can compactify our set by adding two points at infinity,
in the same way as we go from C to C∞ by adding a point ∞. If we do this here, we end up
with a compact surface with n−1 handles:
add points
at infinity
Such an object is called a surface of genus n − 1; the example above shows a surface of
genus 2.
Example 0.1.2. Example 0.1.1 is a little “cheated” because we said before that we want
to figure out the geometric structure of equations that we cannot solve explicitly. In the
example however, the polynomial equation was chosen so that we could solve it, and in
fact we used this solution to construct the geometric picture. Let us see now what we can
still do if we make the polynomial more complicated.
What happens if we consider
Cn = {(x, y) ∈ C
2
; y
2 = f(x)} ⊂ C
2
,
with f some polynomial in x of degree 2n? Obviously, as long as the 2n roots of f are
still distinct, the topological picture does not change. But if two of the roots approach
each other and finally coincide, this has the effect of shrinking one of the tubes connecting
the two planes until it finally reduces to a “singular point” (also called a node), as in the
following picture on the left:
=
glue
0. Introduction 3
Obviously, we can view this as a surface with one handle less, where in addition we identify
two of the points (as illustrated in the picture on the right). Note that we can still see the
“handles” when we draw the surface like this, just that one of the handles results from the
glueing of the two points.
Example 0.1.3. You have probably noticed that the polynomial equation of example 0.1.2
could be solved directly too. Let us now consider
Cd = {(x, y) ∈ C
2
; f(x, y) = 0} ⊂ C
2
,
where f is an arbitrary polynomial of degree d. This is an equation that we certainly cannot
solve directly if f is sufficiently general. Can we still deduce the geometric structure of C?
In fact, we can do this with the idea of example 0.1.2. We saw there that the genus
of the surface does not change if we perturb the polynomial equation, even if the surface
acquires singular points (provided that we know how to compute the genus of such a singular surface). So why not deform the polynomial f to something singular that is easier to
analyze? Probably the easiest thing that comes into mind is to degenerate the polynomial
f of degree d into a product of d linear equations `1,..., `d:
C
0
d = {(x, y) ∈ C
2
; `1(x, y)··· `d(x, y) = 0} ⊂ C
2
,
This surface should have the same “genus” as the original Cd.
It is easy to see what C
0
d
looks like: of course it is just a union of d lines. Any two of
them intersect in a point, and we can certainly choose the lines so that no three of them
intersect in a point. The picture below shows C
0
d
for d = 3 (note that every line is — after
compactifying — just the complex sphere C∞).
What is the genus of this surface? In the picture above it is obvious that we have one loop;
so if d = 3 we get a surface of genus 1. What is the general formula? We have d spheres,
and every two of them connect in a pair of points, so in total we have
d
2

connections. But
d − 1 of them are needed to glue the d spheres to a connected chain without loops; only
the remaining ones then add a handle each. So the genus of C
0
d
(and hence of Cd) is

d
2

−(d −1) = 
d −1
2

.
This is commonly called the degree-genus formula for plane curves.
Remark 0.1.4. One of the trivial but common sources for misunderstandings is whether we
count dimensions over C or over R. The examples considered above are real surfaces (the
dimension over R is 2), but complex curves (the dimension over C is 1). We have used the
word “surface” as this fitted best to the pictures that we have drawn. When looking at the
theory however, it is usually best to call these objects curves. In what follows, we always
mean the dimension over C unless stated otherwise.
Remark 0.1.5. What we should learn from the examples above:
• Algebraic geometry can make statements about the topological structure of objects defined by polynomial equations. It is therefore related to topology and
differential geometry (where similar statements are deduced using analytic methods)
4 Andreas Gathmann
• The geometric objects considered in algebraic geometry need not be smooth (i. e.
they need not be manifolds). Even if our primary interest is in smooth objects,
degenerations to singular objects can greatly simplify a problem (as in example
0.1.3). This is a main point that distinguishes algebraic geometry from other
“geometric” theories (e. g. differential or symplectic geometry). Of course, this
comes at a price: our theory must be strong enough to include such singular
objects and make statements how things vary when we degenerate from smooth
to singular objects. In this regard, algebraic geometry is related to singularity
theory which studies precisely these questions.
Remark 0.1.6. Maybe it looks a bit restrictive to allow only algebraic (polynomial) equations to describe our geometric objects. But in fact it is a deep theorem that for compact
objects, we would not get anything different if we allowed holomorphic equations too. In
this respect, algebraic geometry is very much related (and in certain cases identical) to
complex (analytic) geometry. The easiest example of this correspondence is that a holomorphic map from the Riemann sphere C∞ to itself must in fact be a rational map (i. e. the
quotient of two polynomials).
Example 0.1.7. Let us now turn our attention to the next more complicated objects, namely
complex surfaces in 3-space. We just want to give one example here. Let S be the cubic
surface
S = {(x, y,z) ; 1+x
3 +y
3 +z
3 −(1+x+y+z)
3 = 0} ⊂ C
3
.
As this object has real dimension 4, it is impossible to draw pictures of it that reflect its
topological properties correctly. Usually, we overcome this problem by just drawing the
real part, i. e. we look for solutions of the equation over the real numbers. This then gives
a real surface in R
3
that we can draw. We should just be careful about which statements
we can claim to “see” from this incomplete geometric picture.
The following picture shows the real part of the surface S:
In contrast to our previous examples, we have now used a linear projection to map the real
3-dimensional space onto the drawing plane.
We see that there are some lines contained in S. In fact, one can show that every smooth
cubic surface has exactly 27 lines on it (see section 4.5 for details). This is another sort of
question that one can ask about the solutions of polynomial equations, and that is not of
topological nature: do they contain curves with special properties (in this case lines), and if
so, how many? This branch of algebraic geometry is usually called enumerative geometry.
Remark 0.1.8. It is probably surprising that algebraic geometry, in particular enumerative
geometry, is very much related to theoretical physics. In fact, many results in enumerative
geometry have been found by physicists first.
Why are physicists interested e. g. in the number of lines on the cubic surface? We try
to give a short answer to this (that is necessarily vague and incomplete): There is a branch
of theoretical physics called string theory whose underlying idea is that the elementary
0. Introduction 5
particles (electrons, quarks,. . . ) might not be point-like, but rather one-dimensional objects
(the so-called strings), that are just so small that their one-dimensional structure cannot be
observed directly by any sort of physical measurement. When these particles move in time,
they sweep out a surface in space-time. For some reason this surface has a natural complex
structure coming from the underlying physical theory.
Now the same idea applies to space-time in general: string theorists believe that spacetime is not 4-dimensional as we observe it, but rather has some extra dimensions that are
again so small in size that we cannot observe them directly. (Think e. g. of a long tube
with a very small diameter — of course this is a two-dimensional object, but if you look at
this tube from very far away you cannot see the small diameter any more, and the object
looks like a one-dimensional line.) These extra dimensions are parametrized by a space
that sometimes has a complex structure too; it might for example be the complex cubic
surface that we looked at above.
So in this case we’re in fact looking at complex curves in a complex surface. A priori,
these curves can sit in the surface in any way. But there are equations of motion that tell
you how these curves will sit in the ambient space, just as in classical mechanics it follows
from the equations of motion that a particle will move on a straight line if no forces apply
to it. In our case, the equations of motion say that the curve must map holomorphically
to the ambient space. As we said in remark 0.1.6 above, this is equivalent to saying that
we must have algebraic equations that describe the curve. So we are looking at exactly the
same type of questions as we did in example 0.1.7 above.
Example 0.1.9. Let us now have a brief look at curves in 3-dimensional space. Consider
the example
C = {(x, y,z) = (t
3
,t
4
,t
5
) ; t ∈ C} ⊂ C
3
.
We have given this curve parametrically, but it is in fact easy to see that we can give it
equally well in terms of polynomial equations:
C = {(x, y,z) ; x
3 = yz, y
2 = xz, z
2 = x
2
y}.
What is striking here is that we have three equations, although we would expect that a
one-dimensional object in three-dimensional space should be given by two equations. But
in fact, if you leave out any of the above three equations, you’re changing the set that it
describes: if you leave out e. g. the last equation z
2 = x
2
y, you would get the whole z-axis
{x = y = 0} as additional points that do satisfy the first two equations, but not the last one.
So we see another important difference to linear algebra: it is not true that every object
of codimension d can be given by d equations. Even worse, if you are given d equations,
it is in general a very difficult task to figure out what dimension their solution has. There
do exist algorithms to find this out for any given set of polynomials, but they are so complicated that you will in general want to use a computer program to do that for you. This
is a simple example of an application of computer algebra to algebraic geometry.
Remark 0.1.10. Especially the previous example 0.1.9 is already very algebraic in nature:
the question that we asked there does not depend at all on the ground field being the complex numbers. In fact, this is a general philosophy: even if algebraic geometry describes
geometric objects (when viewed over the complex numbers), most methods do not rely
on this, and therefore should be established in purely algebraic terms. For example, the
genus of a curve (that we introduced topologically in example 0.1.1) can be defined in
purely algebraic terms in such a way that all the statements from complex geometry (e. g.
the degree-genus formula of example 0.1.3) extend to this more general setting. Many
geometric questions then reduce to pure commutative algebra, which is in some sense the
foundation of algebraic geometry.
6 Andreas Gathmann
Example 0.1.11. The most famous application of algebraic geometry to ground fields
other than the complex numbers is certainly Fermat’s Last Theorem: this is just the statement that the algebraic curve over the rational numbers
C = {(x, y) ∈ Q
2
; x
n +y
n = 1} ⊂ Q
2
contains only the trivial points where x = 0 or y = 0. Note that this is very different from the
case of the ground field C, where we have seen in example 0.1.3 that C is a curve of genus

n−1
2

. But a lot of the theory of algebraic geometry applies to the rational numbers (and
related fields) as well, so if you look at the proof of Fermat’s theorem (which you most
probably will not understand) you will notice that it uses e. g. the concepts of algebraic
curves and their genus all over the place, although the corresponding point set C contains
only some trivial points. So, in some sense, we can view (algebraic) number theory as a
part of algebraic geometry.
Remark 0.1.12. With this many relations to other fields of mathematics (and physics), it
is obvious that we have to restrict our attention in this class to quite a small subset of the
possible applications. Although we will develop the general theory of algebraic geometry,
our focus will mainly be on geometric questions, neglecting number-theoretic aspects most
of the time. So, for example, if we say “let k be an algebraically closed field”, feel free to
read this as “let k be the complex numbers” and think about geometry rather than algebra.
Every now and then we will quote results from or give applications to other fields of
mathematics. This applies in particular to commutative algebra, which provides some of
the basic foundations of algebraic geometry. So unless you want to take commutative
algebra as a black box that spits out a useful theorem from time to time (which is possible
but not recommended), you should get some background in commutative algebra while
learning algebraic geometry. Some knowledge about geometric objects occurring in other
fields of mathematics (manifolds, projective spaces, differential forms, vector bundles, . . . )
is helpful but not necessary. We will develop these concepts along the way as we need
them.
0.2. Exercises. Note: As we have not developed any theory yet, you are not expected
to be able to solve the following problems in a mathematically precise way. Rather, they
are just meant as some “food for thought” if you want to think a little further about the
examples considered in this section.
Exercise 0.2.1. What do we get in example 0.1.1 if we consider the equation
C
0
n = {(x, y) ∈ C
2
; y
2 = (x−1)(x−2)···(x−(2n−1))} ⊂ C
2
instead?
Exercise 0.2.2. (For those who know something about projective geometry:) In example
0.1.3, we argued that a polynomial of degree d in two complex variables gives rise to a
surface of genus
d−1
2

. In example 0.1.1 however, a polynomial of degree 2n gave us a
surface of genus n−1. Isn’t that a contradiction?
Exercise 0.2.3.
(i) Show that the space of lines in C
n has dimension 2n−2. (Hint: use that there is
a unique line through any two given points in C
n
.)
(ii) Let S ⊂ C
3 be a cubic surface, i. e. the zero locus of a polynomial of degree 3 in
the three coordinates of C
3
. Find an argument why you would expect there to be
finitely many lines in S (i. e. why you would expect the dimension of the space of
lines in S to be 0-dimensional). What would you expect if the equation of S has
degree less than or greater than 
0. Introduction 7
Exercise 0.2.4. Let S be the specific cubic surface
S = {(x, y,z) ; x
3 +y
3 +z
3 = (x+y+z)
3
} ⊂ C
3
.
(i) Show that there are exactly 3 lines contained in S.
(ii) Using the description of the space of lines of exercise 0.2.3, try to find an argument why these 3 lines should be counted with multiplicity 9 each (in the same
way as e. g. double roots of a polynomial should be counted with multiplicity 2).
We can then say that there are 27 lines on S, counted with their correct multiplicities.
(Remark: It is actually possible to prove that the number of lines on a cubic surface does
not depend on the specific equation of the surface. This then shows, together with this
exercise, that every cubic surface has 27 lines on it. You need quite a lot of theoretical
background however to make this into a rigorous proof.)
Exercise 0.2.5. Show that if you replace the three equations defining the curve C in example 0.1.9 by
(i) x
3 = y
2
, x
5 = z
2
, y
5 = z
4
, or
(ii) x
3 = y
2
, x
5 = z
2
, y
5 = z
3 +ε for small but non-zero ε,
the resulting set of solutions is in fact 0-dimensional, as you would expect it from three
equations in three-dimensional space. So we see that very small changes in the equations
can make a very big difference in the result. In other words, we usually cannot apply
numerical methods to our problems, as very small rounding errors can change the result
completely.
Exercise 0.2.6. Let X be the set of all complex 2×3 matrices of rank at most 1, viewed as
a subset of the C
6 of all 2×3 matrices. Show that X has dimension 4, but that you need 3
equations to define X in the ambient 6-dimensional space C
6
.
8 Andreas Gathmann
1. AFFINE VARIETIES
A subset of affine n-space A
n over a field k is called an algebraic set if it can be
written as the zero locus of a set of polynomials. By the Hilbert basis theorem, this
set of polynomials can be assumed to be finite. We define the Zariski topology on A
n
(and hence on any subset of A
n
) by declaring the algebraic sets to be the closed sets.
Any algebraic set X ⊂ A
n has an associated radical ideal I(X) ⊂ k[x1,..., xn] that
consists of those functions that vanish on X. Conversely, for any radical ideal I there
is an associated algebraic set Z(I) which is the common zero locus of all functions
in I. If k is algebraically closed, Hilbert’s Nullstellensatz states that this gives in
fact a one-to-one correspondence between algebraic sets in A
n
and radical ideals in
k[x1,..., xn].
An algebraic set (or more generally any topological space) is called irreducible
if it cannot be written as a union of two proper closed subsets. Irreducible algebraic
sets in A
n
are called affine varieties. Any algebraic set in A
n
can be decomposed
uniquely into a finite union of affine varieties. Under the correspondence mentioned
above, affine varieties correspond to prime ideals. The dimension of an algebraic set
(or more generally of a topological space) is defined to be the length of the longest
chain of irreducible closed subsets minus one.
1.1. Algebraic sets and the Zariski topology. We have said in the introduction that we
want to consider solutions of polynomial equations in several variables. So let us now
make the obvious definitions.
Definition 1.1.1. Let k be a field (recall that you may think of the complex numbers if you
wish). We define affine n-space over k, denoted A
n
, to be the set of all n-tuples of elements
of k:
A
n
:= {(a1,...,an) ; ai ∈ k for 1 ≤ i ≤ n}.
The elements of the polynomial ring
k[x1,..., xn] :={polynomials in the variables x1,..., xn over k}
={∑
I
aIx
I
; aI ∈ k}
(with the sum taken over all multi-indices I = (i1,...,in) with ij ≥ 0 for all 1 ≤ j ≤ n)
define functions on A
n
in the obvious way. For a given set S ⊂ k[x1,..., xn] of polynomials,
we call
Z(S) := {P ∈ A
n
; f(P) = 0 for all f ∈ S} ⊂ A
n
the zero set of S. Subsets of A
n
that are of this form for some S are called algebraic sets.
By abuse of notation, we also write Z(f1,..., fi) for Z(S) if S = { f1,..., fi}.
Example 1.1.2. Here are some simple examples of algebraic sets:
(i) Affine n-space itself is an algebraic set: A
n = Z(0).
(ii) The empty set is an algebraic set: 0/ = Z(1).
(iii) Any single point in A
n
is an algebraic set: (a1,...,an) = Z(x1 −a1,..., xn −an).
(iv) Linear subspaces of A
n
are algebraic sets.
(v) All the examples from section 0 are algebraic sets: e. g. the curves of examples
0.1.1 and 0.1.3, and the cubic surface of example 0.1.7.
Remark 1.1.3. Of course, different subsets of k[x1,..., xn] can give rise to the same algebraic set. Two trivial cases are:
(i) If two polynomials f and g are already in S, then we can also throw in f + g
without changing Z(S).
(ii) If f is in S, and g is any polynomial, then we can also throw in f · g without
changing Z(S).
1. Affine varieties 9
Recall that a subset S of a commutative ring R (in our case, R = k[x1,..., xn]) is called
an ideal if it is closed both under addition and under multiplication with arbitrary ring
elements. If S ⊂ R is any subset, the set
(S) = { f1g1 +···+ fmgm ; fi ∈ S, gi ∈ R}
is called the ideal generated by S; it is obviously an ideal. So what we have just said
amounts to stating that Z(S) = Z((S)). It is therefore sufficient to only look at the cases
where S is an ideal of k[x1,..., xn].
There is a more serious issue though that we will deal with in section 1.2: a function f
has the same zero set as any of its powers f
i
; so e. g. Z(x1) = Z(x
2
1
) (although the ideals
(x1) and (x
2
1
) are different).
We will now address the question whether any algebraic set can be defined by a finite
number of polynomials. Although this is entirely a question of commutative algebra about
the polynomial ring R = k[x1,..., xn], we will recall here the corresponding definition and
proposition.
Lemma and Definition 1.1.4. Let R be a ring. The following two conditions are equivalent:
(i) Every ideal in R can be generated by finitely many elements.
(ii) R satisfies the ascending chain condition: every (infinite) ascending chain of
ideals I1 ⊂ I2 ⊂ I3 ⊂ ··· is stationary, i. e. we must have Im = Im+1 = Im+2 = ···
for some m.
If R satisfies these conditions, it is called Noetherian.
Proof. (i) ⇒ (ii): Let I1 ⊂ I2 ⊂ ··· be an infinite ascending chain of ideals in R. Then
I := ∪iIi
is an ideal of R as well; so by assumption (i) it can be generated by finitely many
elements. These elements must already be contained in one of the Im, which means that
Im = Im+1 = ···.
(ii) ⇒ (i): Assume that there is an ideal I that cannot be generated by finitely many
elements. Then we can recursively construct elements fi
in I by picking f1 ∈ I arbitrary
and fi+1 ∈ I\(f1,..., fi). It follows that the sequence of ideals
(f1) ⊂ (f1, f2) ⊂ (f1, f2, f3) ⊂ ···
is not stationary.
Proposition 1.1.5. (Hilbert basis theorem) If R is a Noetherian ring then so is R[x]. In
particular, k[x1,..., xn] is Noetherian; so every algebraic set can be defined by finitely
many polynomials.
Proof. Assume that I ⊂ R[x] is an ideal that is not finitely generated. Then we can define
a sequence of elements fi ∈ I as follows: let f0 be a non-zero element of I of minimal
degree, and let fi+1 be an element of I of minimal degree in I\(f0,..., fi). Obviously,
deg fi ≤ deg fi+1 for all i by construction.
For all i let ai ∈ R be the leading coefficient of fi
, and let Ii = (a0,...,ai) ⊂ R. As R is
Noetherian, the chain of ideals I0 ⊂ I1 ⊂ ··· in R is stationary. Hence there is an m such
that am+1 ∈ (a0,...,am). Let r0,...,rm ∈ R such that am+1 = ∑
m
i=0
riai
, and consider the
polynomial
f = fm+1 −
m
∑
i=0
x
deg fm+1−deg firi
fi
.
We must have f ∈ I\(f0,..., fm), as otherwise the above equation would imply that fm+1 ∈
(f0,..., fm). But by construction the coefficient of f of degree deg fm+1 is zero, so deg f <
deg fm+1, contradicting the choice of fm+1. Hence R[x] is Noetherian.
10 Andreas Gathmann
In particular, as k is trivially Noetherian, it follows by induction that k[x1,..., xn] is.
We will now return to the study of algebraic sets and make them into topological spaces.
Lemma 1.1.6.
(i) If S1 ⊂ S2 ⊂ k[x1,..., xn] then Z(S2) ⊂ Z(S1) ⊂ A
n
.
(ii) If {Si} is a family of subsets of k[x1,..., xn] then T
i Z(Si) = Z(
S
i Si) ⊂ A
n
.
(iii) If S1,S2 ⊂ k[x1,..., xn] then Z(S1)∪Z(S2) = Z(S1S2) ⊂ A
n
.
In particular, arbitrary intersections and finite unions of algebraic sets are again algebraic
sets.
Proof. (i) and (ii) are obvious, so let us prove (iii). “⊂”: If P ∈ Z(S1)∪Z(S2) then P ∈
Z(S1) or P ∈ Z(S2). In particular, for any f1 ∈ S1, f2 ∈ S2, we have f1(P) = 0 or f2(P) = 0,
so f1 f2(P) = 0. “⊃”: If P ∈/ Z(S1) ∪ Z(S2) then P ∈/ Z(S1) and P ∈/ Z(S2). So there
are functions f1 ∈ S1 and f2 ∈ S2 that do not vanish at P. Hence f1 f2(P) 6= 0, so P ∈/
Z(S1S2).
Remark 1.1.7. Recall that a topology on any set X can be defined by specifying which
subsets of X are to be considered closed sets, provided that the following conditions hold:
(i) The empty set 0/ and the whole space X are closed.
(ii) Arbitrary intersections of closed sets are closed.
(iii) Finite unions of closed sets are closed.
Note that the standard definition of closed subsets of R
n
that you know from real analysis
satisfies these conditions.
A subset Y of X is then called open if its complement X\Y is closed. If X is a topological
space and Y ⊂ X any subset, Y inherits an induced subspace topology by declaring the
sets of the form Y ∩Z to be closed whenever Z is closed in X. A map f : X → Y is called
continuous if inverse images of closed subsets are closed. (For the standard topology of R
n
from real analysis and the standard definition of continuous functions, it is a theorem that
a function is continuous if and only if inverse images of closed subsets are closed.)
Definition 1.1.8. We define the Zariski topology on A
n
to be the topology whose closed
sets are the algebraic sets (lemma 1.1.6 tells us that this gives in fact a topology). Moreover,
any subset X of A
n will be equipped with the topology induced by the Zariski topology on
A
n
. This will be called the Zariski topology on X.
Remark 1.1.9. In particular, using the induced subspace topology, this defines the Zariski
topology on any algebraic set X ⊂ A
n
: the closed subsets of X are just the algebraic sets
Y ⊂ A
n
contained in X.
The Zariski topology is the standard topology in algebraic geometry. So whenever
we use topological concepts in what follows we refer to this topology (unless we specify
otherwise).
Remark 1.1.10. The Zariski topology is quite different from the usual ones. For example,
on A
n
, a closed subset that is not equal to A
n
satisfies at least one non-trivial polynomial
equation and has therefore necessarily dimension less than n. So the closed subsets in
the Zariski topology are in a sense “very small”. It follows from this that any two nonempty open subsets of A
n have a non-empty intersection, which is also unfamiliar from the
standard topology of real analysis.
Example 1.1.11. Here is another example that shows that the Zariski topology is “unusual”. The closed subsets of A
1 besides the whole space and the empty set are exactly the
finite sets. In particular, if f : A
1 → A
1
is any bijection, then f is a homeomorphism. (This
1. Affine varieties 11
last statement is essentially useless however, as we will not define morphisms between
algebraic sets as just being continuous maps with respect to the Zariski topology. In fact,
this example gives us a strong hint that we should not do so.)
1.2. Hilbert’s Nullstellensatz. We now want to establish the precise connection between
algebraic sets in A
n
and ideals in k[x1,..., xn], hence between geometry and algebra. We
have already introduced the operation Z(·) that takes an ideal (or any subset of k[x1,..., xn])
to an algebraic set. Here is an operation that does the opposite job.
Definition 1.2.1. For a subset X ⊂ A
n
, we call
I(X) := { f ∈ k[x1,..., xn] ; f(P) = 0 for all P ∈ X} ⊂ k[x1,..., xn]
the ideal of X (note that this is in fact an ideal).
Remark 1.2.2. We have thus defined a two-way correspondence

algebraic sets
in A
n
 I
−→
Z
←− 
ideals in
k[x1,..., xn]

.
We will now study to what extent these two maps are inverses of each other.
Remark 1.2.3. Let us start with the easiest case of algebraic sets and look at points in A
n
.
Points are minimal algebraic sets, so by lemma 1.1.6 (i) they should correspond to maximal
ideals. In fact, the point (a1,...,an) ∈ A
n
is the zero locus of the ideal I = (x1−a1,..., xn−
an). Recall from commutative algebra that an ideal I of a ring R is maximal if and only
if R/I is a field. So in our case I is indeed maximal, as k[x1,..., xn]/I ∼= k. However,
for general k there are also maximal ideals that are not of this form, e. g. (x
2 + 1) ⊂ R[x]
(where R[x]/(x
2 +1) ∼= C). The following proposition shows that this cannot happen if k
is algebraically closed, i. e. if every non-constant polynomial in k[x] has a zero.
Proposition 1.2.4. (Hilbert’s Nullstellensatz (“theorem of the zeros”)) Assume that k is
algebraically closed (e. g. k = C). Then the maximal ideals of k[x1,..., xn] are exactly the
ideals of the form (x1 −a1,..., xn −an) for some ai ∈ k.
Proof. Again this is entirely a statement of commutative algebra, so you can just take it on
faith if you wish (in fact, many textbooks on algebraic geometry do so). For the sake of
completeness we will give a short proof here in the case k = C that uses only some basic
algebra; but feel free to ignore it if it uses concepts that you do not know. A proof of the
general case can be found e. g. in [Ha] proposition 5.18.
So assume that k = C. From the discussion above we see that it only remains to show
that any maximal ideal m is contained in an ideal of the form (x1 −a1,..., xn −an).
As C[x1,..., xn] is Noetherian, we can write m = (f1,..., fr) for some fi ∈ C[x1,..., xn].
Let K be the subfield of C obtained by adjoining to Q all coefficients of the fi
. We will
now restrict coefficients to this subfield K, so let m0 = m ∩K[x1,..., xn]. Note that then
m = m0 ·C[x1,..., xn], as the generators fi of m lie in m0.
Note that m0 ⊂ K[x1,..., xn] is a maximal ideal too, because if we had an inclusion
m0 ( m0
0 ( K[x1,..., xn] of ideals, this would give us an inclusion m ( m0 ( C[x1,..., xn]
by taking the product with C[x1,..., xn]. (This last inclusion has to be strict as intersecting
it with K[x1,..., xn] gives the old ideals m0 ( m0
0
back again.)
So K[x1,..., xn]/m0 is a field. We claim that there is an embedding K[x1,..., xn]/m0 ,→
C. To see this, split the field extension K[x1,..., xn]/m0 : Q into a purely transcendental
part L : Q and an algebraic part K[x1,..., xn]/m0 : L. As K[x1,..., xn]/m0 and hence L is
finitely generated over Q whereas C is of infinite transcendence degree over Q, there is an
embedding L ⊂ C. Finally, as K[x1,..., xn]/m0 : L is algebraic and C algebraically closed,
this embedding can be extended to give an embedding K[x1,..., xn]/m0 ⊂ C.
12 Andreas Gathmann
Let ai be the images of the xi under this embedding. Then fi(a1,...,an) = 0 for all i by
construction, so fi ∈ (x1 −a1,..., xn −an) and hence m ⊂ (x1 −a1,..., xn −an).
Remark 1.2.5. The same method of proof can be used for any algebraically closed field k
that has infinite transcendence degree over the prime field Q or Fp.
Corollary 1.2.6. Assume that k is algebraically closed.
(i) There is a 1:1 correspondence
{points in A
n} ←→ {maximal ideals of k[x1,..., xn]}
given by (a1,...,an) ←→ (x1 −a1,..., xn −an).
(ii) Every ideal I ( k[x1,..., xn] has a zero in A
n
.
Proof. (i) is obvious from the Nullstellensatz, and (ii) follows in conjunction with lemma
1.1.6 (i) as every ideal is contained in a maximal one.
Example 1.2.7. We just found a correspondence between points of A
n
and certain ideals
of the polynomial ring. Now let us try to extend this correspondence to more complicated
algebraic sets than just points. We start with the case of a collection of points in A
1
.
(i) Let X = {a1,...,ar} ⊂ A
1 be a finite algebraic set. Obviously, I(X) is then generated by the function (x − a1)···(x − ar), and Z(I(X)) = X again. So Z is an
inverse of I.
(ii) Conversely, let I ⊂ k[x] be an ideal (not equal to (0) or (1)). As k[x] is a principal
ideal domain, we have I = (f) for some non-constant monic function f ∈ k[x].
Now for the correspondence to work at all, we have to require that k be algebraically closed: for if f had no zeros, we would have Z(I) = 0/, and I(Z(I)) = (1)
would give us back no information about I at all. But if k is algebraically closed,
we can write f = (x − a1)
m1 ···(x − ar)
mr with the ai distinct and mi > 0. Then
Z(I) = {a1,...,ar} and therefore I(Z(I)) is generated by (x−a1)···(x−ar), i. e.
all exponents are reduced to 1. Another way to express this fact is that a function
is in I(Z(I))if and only if some power of it lies in I. We write this asI(Z(I)) = √
I,
where we use the following definition.
Definition 1.2.8. For an ideal I ⊂ k[x1,..., xn], we define the radical of I to be
√
I := { f ∈ k[x1,..., xn] ; f
r ∈ I for some r > 0}.
(In fact, this is easily seen to be an ideal.) An ideal I is called radical if I =
√
I. Note that
the ideal of an algebraic set is always radical.
The following proposition says that essentially the same happens for n > 1. As it can
be guessed from the example above, the case Z(I(X)) is more or less trivial, whereas the
case I(Z(I)) is more difficult and needs the assumption that k be algebraically closed.
Proposition 1.2.9.
(i) If X1 ⊂ X2 are subsets of A
n
then I(X2) ⊂ I(X1).
(ii) For any algebraic set X ⊂ A
n we have Z(I(X)) = X.
(iii) If k is algebraically closed, then for any ideal I ⊂ k[x1,..., xn] we have I(Z(I)) =
√
I.
Proof. (i) is obvious, as well as the “⊃” parts of (ii) and (iii).
(ii) “⊂”: By definition X = Z(I) for some I. Hence, by (iii) “⊃” we have I ⊂ I(Z(I)) =
I(X). By 1.1.6 (i) it then follows that Z(I(X)) ⊂ Z(I) = X.
1. Affine varieties 13
(iii) “⊂”: (This is sometimes also called Hilbert’s Nullstellensatz, as it follows easily
from proposition 1.2.4.) Let f ∈ I(Z(I)). Consider the ideal
J = I + (ft −1) ⊂ k[x1,..., xn,t].
This has empty zero locus in A
n+1
, as f vanishes on Z(I), so if we require ft = 1 at the
same time, we get no solutions. Hence J = (1) by corollary 1.2.6 (i). In particular, there is
a relation
1 = (ft −1)g0 +∑ figi ∈ k[x1,..., xn,t]
for some gi ∈ k[x1,..., xn,t] and fi ∈ I. If t
N is the highest power of t occurring in the gi
,
then after multiplying with f
N we can write this as
f
N = (ft −1)G0(x1,..., xn, ft) +∑ fiGi(x1,..., xn, ft)
where Gi = f
Ngi
is considered to be a polynomial in x1,..., xn, ft. Modulo ft −1 we get
f
N = ∑ fiGi(x1,..., xn,1) ∈ k[x1,..., xn,t]/(ft −1).
But as the map k[x1,..., xn] → k[x1,..., xn, ft]/(ft −1) is injective, this equality holds in
fact in k[x1,..., xn], so f
N ∈ I.
Corollary 1.2.10. If k is algebraically closed, there is a one-to-one inclusion-reversing
correspondence between algebraic sets in A
n and radical ideals in k[x1,..., xn], given by
the operations Z(·) and I(·). (This is also sometimes called the Nullstellensatz.)
Proof. Immediately from proposition 1.2.9 and lemma 1.1.6 (i).
From now on up to the end of section 4, we will always assume that the ground field k
is algebraically closed.
Remark 1.2.11. Even though the radical √
I of an ideal I was easy to define, it is quite
difficult to actually compute √
I for any given ideal I. Even worse, it is already quite
difficult just to check whether I itself is radical or not. In general, you will need non-trivial
methods of computer algebra to solve problems like this.
1.3. Irreducibility and dimension. The algebraic set X = {x1x2 = 0} ⊂ A
2
can be written
as the union of the two coordinate axes X1 = {x1 = 0} and X2 = {x2 = 0}, which are
themselves algebraic sets. However, X1 and X2 cannot be decomposed further into finite
unions of smaller algebraic sets. We now want to generalize this idea. It turns out that this
can be done completely in the language of topological spaces. This has the advantage that
it applies to more general cases, i. e. open subsets of algebraic sets.
However, you will want to think only of the Zariski topology here, since the concept of
irreducibility as introduced below does not make much sense in classical topologies.
Definition 1.3.1.
(i) A topological space X is said to be reducible if it can be written as a union
X = X1 ∪X2, where X1 and X2 are (non-empty) closed subsets of X not equal to
X. It is called irreducible otherwise. An irreducible algebraic set in A
n
is called
an affine variety.
(ii) A topological space X is called disconnected if it can be written as a disjoint
union X = X1 ∪X2 of (non-empty) closed subsets of X not equal to X. It is called
connected otherwise.
Remark 1.3.2. Although we have given this definition for arbitrary topological spaces,
you will usually want to apply the notion of irreducibility only in the Zariski topology.
For example, in the usual complex topology, the affine line A
1
(i. e. the complex plane) is
reducible because it can be written e. g. as the union of closed subsets
A
1 = {z ∈ C ; |z| ≤ 1} ∪ {z ∈ C ; |z| ≥ 1}.
14 Andreas Gathmann
In the Zariski topology however, A
1
is irreducible (as it should be).
In contrast, the notion of connectedness can be used in the “usual” topology too and
does mean there what you think it should mean.
Remark 1.3.3. Note that there is a slight inconsistency in the existing literature: some
authors call a variety what we call an algebraic set, and consequently an irreducible variety
what we call an affine variety.
The algebraic characterization of affine varieties is the following.
Lemma 1.3.4. An algebraic set X ⊂ A
n
is an affine variety if and only if its ideal I(X) ⊂
k[x1,..., xn] is a prime ideal.
Proof. “⇐”: Let I(X) be a prime ideal, and suppose that X = X1 ∪ X2. Then I(X) =
I(X1) ∩ I(X2) by exercise 1.4.1 (i). As I(X) is prime, we may assume I(X) = I(X1), so
X = X1 by proposition 1.2.9 (ii).
“⇒”: Let X be irreducible, and let f g ∈ I(X). Then X ⊂ Z(f g) = Z(f)∪Z(g), hence
X = (Z(f)∩X)∪(Z(g)∩X) is a union of two algebraic sets. As X is irreducible, we may
assume that X = Z(f)∩X, so f ∈ I(X).
Example 1.3.5.
(i) A
n
is an affine variety, as I(A
n
) = (0) is prime. If f ∈ k[x1,..., xn] is an irreducible
polynomial, then Z(f) is an affine variety. A collection of m points in A
n
is
irreducible if and only if m = 1.
(ii) Every affine variety is connected. The union of the n coordinate axes in A
n
is
always connected, although it is reducible for n > 1. A collection of m points in
A
n
is connected if and only if m = 1.
As it can be expected, any topological space that satisfies a reasonable finiteness condition can be decomposed uniquely into finitely many irreducible spaces. This is what we
want to show next.
Definition 1.3.6. A topological space X is called Noetherian if every descending chain
X ⊃ X1 ⊃ X2 ⊃ ··· of closed subsets of X is stationary.
Remark 1.3.7. By corollary 1.2.10 the fact that k[x1,..., xn] is a Noetherian ring (see proposition 1.1.5) translates into the statement that any algebraic set is a Noetherian topological
space.
Proposition 1.3.8. Every Noetherian topological space X can be written as a finite union
X = X1 ∪ ··· ∪Xr of irreducible closed subsets. If one assumes that Xi 6⊂ Xj
for all i 6= j,
then the Xi are unique (up to permutation). They are called the irreducible components of
X.
In particular, any algebraic set is a finite union of affine varieties in a unique way.
Proof. To prove existence, assume that there is a topological space X for which the statement is false. In particular, X is reducible, hence X = X1 ∪X
0
1
. Moreover, the statement of
the proposition must be false for at least one of these two subsets, say X1. Continuing this
construction, one arrives at an infinite chain X ) X1 ) X2 ) ··· of closed subsets, which is
a contradiction as X is Noetherian.
To show uniqueness, assume that we have two decompositions X = X1 ∪ ··· ∪ Xr =
X
0
1 ∪ ··· ∪ X
0
s
. Then X1 ⊂
S
i X
0
i
, so X1 =
S
(X1 ∩ X
0
i
). But X1 is irreducible, so we can
assume X1 = X1 ∩X
0
1
, i. e. X1 ⊂ X
0
1
. For the same reason, we must have X
0
1 ⊂ Xi for some
i. So X1 ⊂ X
0
1 ⊂ Xi
, which means by assumption that i = 1. Hence X1 = X
0
1
is contained
in both decompositions. Now let Y = X\X1. Then Y = X2 ∪ ··· ∪ Xr = X
0
2 ∪ ··· ∪ X
0
s
; so
proceeding by induction on r we obtain the uniqueness of the decomposition. 
1. Affine varieties 15
Remark 1.3.9. It is probably time again for a warning: given an ideal I of the polynomial
ring, it is in general not easy to find the irreducible components of Z(I), or even to determine whether Z(I) is irreducible or not. There are algorithms to figure this out, but they are
computationally quite involved, so you will in most cases want to use a computer program
for the actual calculation.
Remark 1.3.10. In the same way one can show that every algebraic set X is a (disjoint)
finite union of connected algebraic sets, called the connected components of X.
Remark 1.3.11. We have now seen a few examples of the correspondence between geometry and algebra that forms the base of algebraic geometry: points in affine space correspond
to maximal ideals in a polynomial ring, affine varieties to prime ideals, algebraic sets to
radical ideals. Most concepts in algebraic geometry can be formulated and most proofs
can be given both in geometric and in algebraic language. For example, the geometric
statement that we have just shown that any algebraic set can be written as a finite union
of irreducible components has the equivalent algebraic formulation that every radical ideal
can be written uniquely as a finite intersection of prime ideals.
Remark 1.3.12. An application of the notion of irreducibility is the definition of the dimension of an affine variety (or more generally of a topological space; but as in the case
of irreducibility above you will only want to apply it to the Zariski topology). Of course,
in the case of complex varieties we have a geometric idea what the dimension of an affine
variety should be: it is the number of complex coordinates that you need to describe X locally around any point. Although there are algebraic definitions of dimension that mimics
this intuitive one, we will give a different definition here that uses only the language of
topological spaces. Finally, all these definitions are of course equivalent and describe the
intuitive notion of dimension (at least over C), but it is actually quite hard to prove this
rigorously.
The idea to define the dimension in algebraic geometry using the Zariski topology is the
following: if X is an irreducible topological space, then any closed subset of X not equal
to X must have dimension (at least) one smaller. (This is of course an idea that is not valid
in the usual topology that you know from real analysis.)
Definition 1.3.13. Let X be a (non-empty) irreducible topological space. The dimension
of X is the biggest integer n such that there is a chain 0/ 6= X0 ( X1 ( ··· ( Xn = X of
irreducible closed subsets of X. If X is any Noetherian topological space, the dimension of
X is defined to be the supremum of the dimensions of its irreducible components. A space
of dimension 1 is called a curve, a space of dimension 2 a surface.
Remark 1.3.14. In this definition you should think of Xi as having dimension i. The content
of the definition is just that there is “nothing between” varieties of dimension i and i+1.
Example 1.3.15. The dimension of A
1
is 1, as single points are the only irreducible closed
subsets of A
1 not equal to A
1
. We will see in exercise 1.4.9 that the dimension of A
2
is
2. Of course, the dimension of A
n
is always n, but this is a fact from commutative algebra
that we cannot prove at the moment. But we can at least see that the dimension of A
n
is
not less than n, because there are sequences of inclusions
A
0 ( A1 ( ··· ( An
of linear subspaces of increasing dimension.
Remark 1.3.16. This definition of dimension has the advantage of being short and intuitive,
but it has the disadvantage that it is very difficult to apply in actual computations. So for
the moment we will continue to use the concept of dimension only in the informal way as
we have used it so far. We will study the dimension of varieties rigorously in section 4,
after we have developed more powerful techniques in algebraic geometry.
16 Andreas Gathmann
Remark 1.3.17. Here is another application of the notion of irreducibility (that is in fact
not much more than a reformulation of the definition). Let X be an irreducible topological
space (e. g. an affine variety). Let U ⊂ X be a non-empty open subset, and let Y ( X be
a closed subset. The fact that X cannot be the union (X\U)∪Y can be reformulated by
saying that U cannot be a subset of Y. In other words, the closure closure closure of U (i. e. the smallest
closed subset of X that contains U) is equal to X itself. Recall that an open subset of a
topological space X is called dense if its closure is equal to the whole space X. With this
wording, we have just shown that in an irreducible topological space every non-empty open
subset is dense. Note that this is not true for reducible spaces: let X = {x1x2 = 0} ⊂ A
2
be the union of the two coordinate axes, and let U = {x1 6= 0} ∩X be the open subset of X
consisting of the x1-axis minus the origin. Then the closure of U in X is just the x1-axis,
and not all of X.
1.4. Exercises. In all exercises, the ground field k is assumed to be algebraically closed
unless stated otherwise.
Exercise 1.4.1. Let X1,X2 ⊂ A
n be algebraic sets. Show that
(i) I(X1 ∪X2) = I(X1)∩I(X2),
(ii) I(X1 ∩X2) = p
I(X1) +I(X2).
Show by example that taking the radical in (ii) is in general necessary, i. e. find algebraic
sets X1,X2 such that I(X1 ∩X2) 6= I(X1) +I(X2). Can you see geometrically what it means
if we have inequality here?
Exercise 1.4.2. Let X ⊂ A
3 be the union of the three coordinate axes. Determine generators for the ideal I(X). Show that I(X) cannot be generated by fewer than 3 elements,
although X has codimension 2 in A
3
.
Exercise 1.4.3. In affine 4-dimensional space A
4 with coordinates x, y,z,t let X be the
union of the two planes
X
0 = {x = y = 0} and X
00 = {z = x−t = 0}.
Compute the ideal I = I(X) ⊂ k[x, y,z,t]. For any a ∈ k let Ia ⊂ k[x, y,z] be the ideal obtained
by substituting t = a in I, and let Xa = Z(Ia) ⊂ A
3
.
Show that the family of algebraic sets Xa with a ∈ k describes two skew lines in A
3
approaching each other, until they finally intersect transversely for a = 0.
Moreover, show that the ideals Ia are radical for a 6= 0, but that I0 is not. Find the
elements in √
I0\I0 and interpret them geometrically.
Exercise 1.4.4. Let X ⊂ A
3 be the algebraic set given by the equations x
2
1 −x2x3 = x1x3 −
x1 = 0. Find the irreducible components of X. What are their prime ideals? (Don’t let the
simplicity of this exercise fool you. As mentioned in remark 1.3.9, it is in general very
difficult to compute the irreducible components of the zero locus of given equations, or
even to determine if it is irreducible or not.)
Exercise 1.4.5. Let A
3 be the 3-dimensional affine space over a field k with coordinates
x, y,z. Find ideals describing the following algebraic sets and determine the minimal number of generators for these ideals.
(i) The union of the (x, y)-plane with the z-axis.
(ii) The union of the 3 coordinate axes.
(iii) The image of the map A
1 → A
3 given by t 7→ (t
3
,t
4
,t
5
).
Exercise 1.4.6. Let Y be a subspace of a topological space X. Show that Y is irreducible
if and only if the closure of Y in X is irreducible.
1. Affine varieties 17
Exercise 1.4.7. (For those of you who like pathological examples. You will need some
knowledge on general topological spaces.) Find a Noetherian topological space with infinite dimension. Can you find an affine variety with infinite dimension?
Exercise 1.4.8. Let X = {(t,t
3
,t
5
) ; t ∈ k} ⊂ A
3
. Show that X is an affine variety of
dimension 1 and compute I(X).
Exercise 1.4.9. Let X ⊂ A
2 be an irreducible algebraic set. Show that either
• X = Z(0), i. e. X is the whole space A
2
, or
• X = Z(f) for some irreducible polynomial f ∈ k[x, y], or
• X = Z(x−a, y−b) for some a,b ∈ k, i. e. X is a single point.
Deduce that dim(A
2
) = 2. (Hint: Show that the common zero locus of two polynomials
f,g ∈ k[x, y] without common factor is finite.)
18 Andreas Gathmann
2. FUNCTIONS, MORPHISMS, AND VARIETIES
If X ⊂ A
n
is an affine variety, we define the function field K(X) of X to be the quotient
field of the coordinate ring A(X) = k[x1,..., xn]/I(X); this can be thought of as the
field of rational functions on X. For a point P ∈ X the local ring OX,P is the subring
of K(X) of all functions that are regular (i. e. well-defined) at P, and for U ⊂ X an
open subset we let OX (U) be the subring of K(X) of all functions that are regular at
every P ∈ U. The ring of functions that are regular on all of X is precisely A(X).
Given two ringed spaces (X,OX ), (Y,OY ) with the property that their structure
sheaves are sheaves of k-valued functions, a set-theoretic map f : X →Y determines a
pull-back map f
∗
from k-valued functions on Y to k-valued functions on X by composition. We say that f is a morphism if f is continuous and f
∗OY (U) ⊂ OX (f
−1
(U))
for all open sets U in Y. In particular, this defines morphisms between affine varieties and their open subsets. Morphisms X → Y between affine varieties correspond
exactly to k-algebra homomorphisms A(Y) → A(X).
In complete analogy to the theory of manifolds, we then define a prevariety to
be a ringed space (whose structure sheaf is a sheaf of k-valued functions and) that
is locally isomorphic to an affine variety. Correspondingly, there is a general way to
construct prevarieties and morphisms between them by taking affine varieties (resp.
morphisms between them) and patching them together. Affine varieties and their
open subsets are simple examples of prevarieties, but we also get more complicated
spaces as e. g. P
1
and the affine line with a doubled origin. A prevariety X is called
a variety if the diagonal ∆(X) ⊂ X ×X is closed, i. e. if X does not contain “doubled
points”.
2.1. Functions on affine varieties. After having defined affine varieties, our next goal
must of course be to say what the maps between them should be. Let us first look at the
easiest case: “regular functions”, i. e. maps to the ground field k = A
1
. They should be
thought of as the analogue of continuous functions in topology, or differentiable functions
in real analysis, or holomorphic functions in complex analysis. Of course, in the case of
algebraic geometry we want to have algebraic functions, i. e. (quotients of) polynomial
functions.
Definition 2.1.1. Let X ⊂ A
n be an affine variety. We call
A(X) := k[x1,..., xn]/I(X)
the coordinate ring of X.
Remark 2.1.2. The coordinate ring of X should be thought of as the ring of polynomial
functions on X. In fact, for any P ∈ X an element f ∈ A(X) determines a polynomial map
X → k (usually also denoted by f) given by f 7→ f(P):
• this is well-defined, because all functions in I(X) vanish on X by definition,
• if the function f : X → k is identically zero then f ∈ I(X) by definition, so f = 0
in A(X).
Note that I(X) is a prime ideal by lemma 1.3.4, so A(X) is an integral domain. Hence we
can make the following definition:
Definition 2.1.3. Let X ⊂ A
n be an affine variety. The quotient field K(X) of A(X) is
called the field of rational functions on X.
Remark 2.1.4. Recall that the quotient field K of an integral domain R is defined to be the
set of pairs (f,g) with f,g ∈ R, g 6= 0, modulo the equivalence relation
(f,g) ∼ (f
0
,g
0
) ⇐⇒ f g0 −g f 0 = 0.
2. Functions, morphisms, and varieties 19
An element (f,g) of K is usually written as f
g
, and we think of it as the formal quotient
of two ring elements. Addition of two such formal quotients is defined in the same way as
you would expect to add fractions, namely
f
g
+
f
0
g
0
:=
f g0 +g f 0
gg0
,
and similarly for subtraction, multiplication, and division. This makes K(X) into a field.
In the case where R = A(X) is the coordinate ring of an affine variety, we can therefore
think of elements of K(X) as being quotients of polynomial functions. We have to be very
careful with this interpretation though, see example 2.1.7 and lemma 2.1.8.
Now let us define what we want to mean by a regular function on an open subset U of
an affine variety X. This is more or less obvious: a regular function should be a rational
function that is well-defined at all points of U:
Definition 2.1.5. Let X ⊂ A
n be an affine variety and let P ∈ X be a point. We call
OX,P :=

f
g
; f,g ∈ A(X) and g(P) 6= 0

⊂ K(X)
the local ring of X at the point P. Obviously, this should be thought of as the rational
functions that are regular at P. If U ⊂ X is a non-empty open subset, we set
OX (U) :=
\
P∈U
OX,P.
This is a subring of K(X). We call this the ring of regular functions on U.
Remark 2.1.6. The set mX,P := { f ∈ A(X) ; f(P) = 0} of all functions that vanish at P
is an ideal in A(X). This is a maximal ideal, as A(X)/mX,P
∼= k, the isomorphism being
evaluation of the polynomial at the point P. With this definition, OX,P is just the localization
of the ring A(X) at the maximal ideal mX,P. We will explain in lemma 2.2.10 where the
name “local” (resp. “localization”) comes from.
Example 2.1.7. We have just defined regular functions on an open subset of an affine
variety X ⊂ A
n
to be rational functions, i. e. elements in the quotient field K(X), with
certain properties. This means that every such function can be written as the “quotient”
of two elements in A(X). It does not mean however that we can always write a regular
function as the quotient of two polynomials in k[x1,...,nn]. Here is an example showing
this. Let X ⊂ A
4 be the variety defined by the equation x1x4 = x2x3, and let U ⊂ X be the
open subset of all points in X where x2 6= 0 or x4 6= 0. The function x1
x2
is defined at all
points of X where x2 6= 0, and the function x3
x4
is defined at points of X where x4 6= 0. By
the equation of X, these two functions coincide where they are both defined; in other words
x1
x2
=
x3
x4
∈ K(X)
by remark 2.1.4. So this gives rise to a regular function on U. But there is no representation
of this function as a quotient of two polynomials in k[x1, x2, x3, x4] that works on all of U
— we have to use different representations at different points.
As we will usually want to write down regular functions as quotients of polynomials,
we should prove a precise statement how regular functions can be patched together from
different polynomial representations:
Lemma 2.1.8. The following definition of regular functions is equivalent to the one of
definition 2.1.5:
Let U be an open subset of an affine variety X ⊂ A
n
. A set-theoretic map ϕ : U → k is
called regular at the point P ∈ U if there is a neighborhood V of P in U such that there are
20 Andreas Gathmann
polynomials f,g ∈ k[x1,..., xn] with g(Q) 6= 0 and ϕ(Q) = f(Q)
g(Q)
for all Q ∈ V . It is called
regular on U if it is regular at every point in U.
Proof. It is obvious that an element of the ring of regular functions on U determines a
regular function in the sense of the lemma.
Conversely, let ϕ : U → A
1 be a regular function in the sense of the lemma. Let P ∈ U
be any point, then there are polynomials f,g such that g(Q) 6= 0 and ϕ(Q) = f(Q)
g(Q)
for all
points Q in some neighborhood V of P. We claim that f
g
∈ K(X) is the element in the ring
of regular functions that we seek.
In fact, all we have to show is that this element does not depend on the choices that
we made. So let P
0 ∈ U be another point (not necessarily distinct from P), and suppose
that there are polynomials f
0
,g
0
such that f
g =
f
0
g
0 on some neighborhood V
0 of P
0
. Then
f g0 = g f 0 on V ∩V
0
and hence on X as V ∩V
0
is dense in X by remark 1.3.17. In other
words, f g0 −g f 0 ∈ I(X), so it is zero in A(X), i. e. f
g =
f
0
g
0 ∈ K(X).
Remark 2.1.9. An almost trivial but remarkable consequence of our definition of regular
functions is the following: let U ⊂ V be non-empty open subsets of an affine variety X. If
ϕ1,ϕ2 : V → k are two regular functions on V that agree on U, then they agree on all of V.
This is obvious because the ring of regular functions (on any non-empty open subset) is a
subring of the function field K(X), so if two such regular functions agree this just means
that they are the same element of K(X). Of course, this is not surprising as open subsets
are always dense, so if we know a regular function on an open subset it is intuitively clear
that we know it almost everywhere anyway.
The interesting remark here is that the very same statement holds in complex analysis for
holomorphic functions as well (or more generally, in real analysis for analytic functions):
two holomorphic functions on a (connected) open subset U ⊂ C
n must be the same if
they agree on any smaller open subset V ⊂ U. This is called the identity theorem for
holomorphic functions — in complex analysis this is a real theorem because there the
open subset V can be “very small”, so the statement that the extension to U is unique is
a lot more surprising than it is here in algebraic geometry. Still this is an example of a
theorem that is true in literally the same way in both algebraic and complex geometry,
although these two theories are quite different a priori.
Let us compute the rings OX (U) explicitly in the cases where U is the complement of
the zero locus of just a single polynomial.
Proposition 2.1.10. Let X ⊂ A
n be an affine variety. Let f ∈ A(X) and Xf = {P ∈
X ; f(P) 6= 0}. (Open subsets of this form are called distinguished open subsets.) Then
OX (Xf) = A(X)f
:=

g
f
r
; g ∈ A(X) and r ≥ 0

.
In particular, OX (X) = A(X), i. e. any regular function on X is polynomial (take f = 1).
Proof. It is obvious that A(X)f ⊂ OX (Xf), so let us prove the converse. Let ϕ ∈ OX (Xf) ⊂
K(X). Let J = {g ∈ A(X) ; gϕ ∈ A(X)}. This is an ideal in A(X); we want to show that
f
r ∈ J for some r.
For any P ∈ Xf we know that ϕ ∈ OX,P, so ϕ =
h
g
with g 6= 0 in a neighborhood of P.
In particular g ∈ J, so J contains an element not vanishing at P. This means that the zero
locus of the ideal I(X) + J ⊂ k[x1,..., xn] is contained in the set {P ∈ X ; f(P) = 0}, or
in other words that Z(I(X) +J) ⊂ Z(f). By proposition 1.2.9 (i) it follows that I(Z(f)) ⊂
I(Z(I(X) + J)). So f
0 ∈ I(Z(I(X) + J)), where f
0 ∈ k[x1,..., xn] is a representative of f .
Therefore f
0r ∈ I(X) +J for some r by the Nullstellensatz 1.2.9 (iii), and so f
r ∈ J. 
2. Functions, morphisms, and varieties 21
Remark 2.1.11. In the proof of proposition 2.1.10 we had to use the Nullstellensatz again.
In fact, the statement is false if the ground field is not algebraically closed, as you can see
from the example of the function 1
x
2+1
that is regular on all of A
1
(R), but not polynomial.
Example 2.1.12. Probably the easiest case of an open subset of an affine variety X that is
not of the form Xf as in proposition 2.1.10 is the complement U = C
2\{0} of the origin in
the affine plane. Let us compute OC2 (U). By definition 2.1.5 any element ϕ ∈ OC2 (U) ⊂
C(x, y) is globally the quotient ϕ =
f
g
of two polynomials f,g ∈ C[x, y]. The condition that
we have to satisfy is that g(x, y) 6= 0 for all (x, y) 6= (0,0). We claim that this implies that
g is constant. (In fact, this follows intuitively from the fact that a single equation can cut
down the dimension of a space by only 1, so the zero locus of the polynomial g cannot
only be the origin in C
2
. But we have not proved this rigorously yet.)
We know already by the Nullstellensatz that there is no non-constant polynomial that
has empty zero locus in C
2
, so we can assume that g vanishes on (0,0). If we write g as
g(x, y) = f0(x) + f1(x)· y+ f2(x)· y
2 +···+ fn(x)· y
n
,
this means that f0(0) = 0. We claim that f0(x) must be of the form x
m for some m. In fact:
• if f0 is the zero polynomial, then g(x, y) contains y as a factor and hence the whole
x-axis in its zero locus,
• if f0 contains more than one monomial, f0 has a zero x0 6= 0, and hence g(x0,0) =
0.
So g(x, y) is of the form
g(x, y) = x
m + f1(x)· y+ f2(x)· y
2 +···+ fn(x)· y
n
.
Now set y = ε for some small ε. As g(x,0) = x
m and all fi are continuous, the restriction
g(x, ε) cannot be the zero or a constant polynomial. Hence g(x, ε) vanishes for some x,
which is a contradiction.
So we see that we cannot have any denominators, i. e. OC2 (U) = C[x, y]. In other words,
a regular function on C
2\{0} is always regular on all of C
2
. This is another example of
a statement that is known from complex analysis for holomorphic functions, known as the
removable singularity theorem.
2.2. Sheaves. We have seen in lemma 2.1.8 that regular functions on affine varieties are
defined in terms of local properties: they are set-theoretic functions that can locally be written as quotients of polynomials. Local constructions of function-like objects occur in many
places in algebraic geometry (and also in many other “topological” fields of mathematics),
so we should formalize the idea of such objects. This will also give us an “automatic”
definition of morphisms between affine varieties in section 2.3.
Definition 2.2.1. A presheaf F of rings on a topological space X consists of the data:
• for every open set U ⊂ X a ring F (U) (think of this as the ring of functions on
U),
• for every inclusion U ⊂V of open sets in X a ring homomorphism ρV,U : F (V) →
F (U) called the restriction map (think of this as the usual restriction of functions
to a subset),
such that
• F (0/) = 0,
• ρU,U is the identity map for all U,
• for any inclusion U ⊂ V ⊂ W of open sets in X we have ρV,U ◦ ρW,V = ρW,U .
The elements of F (U) are usually called the sections of F over U, and the restriction
maps ρV,U are written as f 7→ f |U .
22 Andreas Gathmann
A presheaf F of rings is called a sheaf of rings if it satisfies the following glueing
property: if U ⊂ X is an open set, {Ui} an open cover of U and fi ∈ F (Ui) sections for all i
such that fi
|Ui∩Uj = fj
|Ui∩Uj
for all i, j, then there is a unique f ∈ F (U) such that f |Ui = fi
for all i.
Remark 2.2.2. In the same way one can define (pre-)sheaves of Abelian groups / k-algebras
etc., by requiring that all F (U) are objects and all ρV,U are morphisms in the corresponding
category.
Example 2.2.3. If X ⊂ A
n
is an affine variety, then the rings OX (U) of regular functions
on open subsets of X (with the obvious restriction maps OX (V) → OX (U) for U ⊂V) form
a sheaf of rings OX , the sheaf of regular functions or structure sheaf on X. In fact, all
defining properties of presheaves are obvious, and the glueing property of sheaves is easily
seen from the description of regular functions in lemma 2.1.8.
Example 2.2.4. Here are some examples from other fields of mathematics: Let X = R
n
,
and for any open subset U ⊂ X let F (U) be the ring of continuous functions on U. Together
with the obvious restriction maps, these rings F (U) form a sheaf, the sheaf of continuous
functions. In the same way we can define the sheaf of k times differentiable functions,
analytic functions, holomorphic functions on C
n
, and so on. The same definitions can be
applied if X is a real or complex manifold instead of just R
n or C
n
.
In all these examples, the sheaves just defined “are” precisely the functions that are considered to be morphisms in the corresponding category (for example, in complex analysis
the morphisms are just the holomorphic maps). This is usually expressed in the following way: a pair (X,F ) where X is a topological space and F is a sheaf of rings on X is
called a ringed space. The sheaf F is then called the structure sheaf of this ringed space
and usually written OX . Hence we have just given affine varieties the structure of a ringed
space. (Although being general, this terminology will usually only be applied if F actually
has an interpretation as the space of functions that are considered to be morphisms in the
corresponding category.)
Remark 2.2.5. Intuitively speaking, any “function-like” object forms a presheaf; it is a
sheaf if the conditions imposed on the “functions” are local. Here is an example illustrating
this fact. Let X = R be the real line. For U ⊂ X open and non-empty let F (U) be the ring
of constant (real-valued) functions on U, i. e. F (U) ∼= R for all U. Let ρV,U for U ⊂ V
be the obvious restriction maps. Then F is obviously a presheaf, but not a sheaf. This is
because being constant is not a local property; it means that f(P) = f(Q) for all P and
Q that are possibly quite far away. For example, let U = (0,1) ∪ (2,3). Then U has an
open cover U = U1 ∪U2 with U1 = (0,1) and U2 = (2,3). Let f1 : U1 → R be the constant
function 0, and let f2 : U2 → R be the constant function 1. Then f1 and f2 trivially agree
on the overlap U1 ∩U2 = 0/, but there is no constant function on U that restricts to both f1
and f2 on U1 and U2, respectively. There is however a uniquely defined locally constant
function on U with that property. In fact, it is easy to see that the locally constant functions
on X do form a sheaf.
Remark 2.2.6. If F is a sheaf on X and U ⊂ X is an open subset, then one defines the
restriction of F to U, denoted F |U , by (F |U )(V) = F (V) for all open subsets V ⊂ U.
Obviously, this is again a sheaf.
Finally, let us see how the local rings of an affine variety appear in the language of
sheaves.
Definition 2.2.7. Let X be a topological space, P ∈ X, and F a (pre-)sheaf on X. Consider
pairs (U,ϕ) where U is an open neighborhood of P and ϕ ∈ F (U) a section of F over U.
We call two such pairs (U,ϕ) and (U
0
,ϕ
0
) equivalent if there is an open neighborhood V of
2. Functions, morphisms, and varieties 23
P with V ⊂ U ∩U
0
such that ϕ|V = ϕ
0
|V . (Note that this is in fact an equivalence relation.)
The set of all such pairs modulo this equivalence relation is called the stalk FP of F at P,
its elements are called germs of F .
Remark 2.2.8. If F is a (pre-)sheaf of rings (or k-algebras, Abelian groups, etc.) then the
stalks of F are rings (or k-algebras, Abelian groups, etc.).
Remark 2.2.9. The interpretation of the stalk of a sheaf is obviously that its elements are
sections of F that are defined in an (arbitrarily small) neighborhood around P. Hence e. g.
on the real line the germ of a differentiable function at a point P allows you to compute the
derivative of this function at P, but none of the actual values of the function at any point
besides P. On the other hand, we have seen in remark 2.1.9 that holomorphic functions
on a (connected) complex manifold are already determined by their values on any open
set, so germs of holomorphic functions carry “much more information” than germs of
differentiable functions. In algebraic geometry, this is similar: it is already quite obvious
that germs of regular functions must carry much information, as the open subsets in the
Zariski topology are so big. We will now show that the stalk of OX at a point P is exactly
the local ring OX,P, which finally gives a good motivation for the name “local ring”.
Lemma 2.2.10. Let X be an affine variety and P ∈ X. The stalk of OX at P is OX,P.
Proof. Recall that OX (U) ⊂ OX,P ⊂ K(X) for all P ∈ U by definition.
Therefore, if we are given a pair (U,ϕ) with P ∈U and ϕ ∈ OX (U), we see that ϕ ∈ OX,P
determines an element in the local ring. If we have another equivalent pair (U
0
,ϕ
0
), then
ϕ and ϕ
0
agree on some V with P ∈ V ⊂ U ∩U
0 by definition, so they determine the same
element in OX (V) and hence in OX,P.
Conversely, if ϕ ∈ OX,P is an element in the local ring, we can write it as ϕ =
f
g
with
polynomials f,g such that g(P) 6= 0. Then there must be a neighborhood U of P on which
g is non-zero, and therefore the (U,ϕ) defines an element in the stalk of OX at P.
2.3. Morphisms between affine varieties. Having given the structure of ringed spaces to
affine varieties, there is a natural way to define morphisms between them. In this section we
will allow ourselves to view morphisms as set-theoretic maps on the underlying topological
spaces with additional properties (see lemma 2.1.8).
Definition 2.3.1. Let (X,OX ) and (Y,OY ) be ringed spaces whose structure sheaves OX and
OY are sheaves of k-valued functions (in the case we are considering right now X and Y
will be affine varieties or open subsets of affine varieties). Let f : X →Y be a set-theoretic
map.
(i) If ϕ : U → k is a k-valued (set-theoretic) function on an open subset U of Y, the
composition ϕ◦ f : f
−1
(U) → k is again a set-theoretic function. It is denoted by
f
∗ϕ and is called the pull-back of ϕ.
(ii) The map f is called a morphism if it is continuous, and if it pulls back regular
functions to regular functions, i. e. if f
∗OY (U) ⊂ OX (f
−1
(U)) for all open U ⊂Y.
Remark 2.3.2. Recall that a function f : X → Y between topological spaces is called continuous if inverse images of open subsets are always open. In the above definition (ii), the
requirement that f be continuous is therefore necessary to formulate the second condition,
as it ensures that f
−1
(U) is open, so that OX (f
−1
(U)) is well-defined.
Remark 2.3.3. In our context of algebraic geometry OX and OY will always be the sheaves
of regular maps constructed in definition 2.1.5. But in fact, this definition of morphisms is
used in many other categories as well, e. g. one can say that a set-theoretic map between
complex manifolds is holomorphic if it pulls back holomorphic functions to holomorphic
functions. In fact, it is almost the general definition of morphisms between ringed spaces —
24 Andreas Gathmann
the only additional twist in the general case is that if f : X →Y is a continuous map between
arbitrary ringed spaces (X,OX ) and (Y,OY ), there is no a priori definition of the pull-back
map OY (U) → OX (f
−1
(U)). In the case above we solved this problem by applying the settheoretic viewpoint that gave us a notion of pull-back in our special case. In more general
cases (e. g. for schemes that we will discuss later in section 5) one will have to include
these pull-back maps in the data needed to define a morphism.
We now want to show that for affine varieties the situation is a lot easier: we actually do
not have to deal with open subsets, but it suffices to check the pull-back property on global
functions only:
Lemma 2.3.4. Let f : X → Y be a continuous map between affine varieties. Then the
following are equivalent:
(i) f is a morphism (i. e. f pulls back regular functions on open subsets to regular
functions on open subsets).
(ii) For every ϕ ∈ OY (Y) we have f ∗ϕ ∈ OX (X), i. e. f pulls back global regular
functions to global regular functions.
(iii) For every P ∈ X and every ϕ ∈ OY, f(P) we have f ∗ϕ ∈ OX,P, i. e. f pulls back
germs of regular functions to germs of regular functions.
Proof. (i) ⇒ (ii) is trivial, and (iii) ⇒ (i) follows immediately from the definition of OY (U)
and OX (f
−1
(U)) as intersections of local rings. To prove (ii) ⇒ (iii) let ϕ ∈ OY, f(P) be
the germ of a regular function on Y. We write ϕ =
g
h with g,h ∈ A(Y) = OY (Y) and
h(f(P)) 6= 0. By (ii), f
∗g and f
∗h are global regular functions in A(X) = OX (X), hence
f
∗ϕ =
f
∗g
f
∗h
∈ OX,P, since we have h(f(P)) 6= 0.
Example 2.3.5. Let X = A
1 be the affine line with coordinate x, and let Y = A
1 be the
affine line with coordinate y. Consider the set-theoretic map
f : X → Y, x 7→ y = x
2
.
We claim that this is a morphism. In fact, by lemma 2.3.4 (ii) we just have to show that f
pulls back polynomials in k[y] to polynomials in k[x]. But this is obvious, as the pull-back
of a polynomial ϕ(y) ∈ k[y] is just ϕ(x
2
) (i. e. we substitute x
2
for y in ϕ). This is still a
polynomial, so it is in k[x].
Example 2.3.6. For the very same reason, every polynomial map is a morphism. More
precisely, let X ⊂ A
m and Y ⊂ A
n be affine varieties, and let f : X → Y be a polynomial
map, i. e. a map that can be written as f(P) = (f1(P),..., fn(P)) with fi ∈ k[x1,..., xm]. As
f then pulls back polynomials to polynomials, we conclude first of all that f is continuous.
Moreover, it then follows from lemma 2.3.4 (ii) that f is a morphism. In fact, we will show
now that all morphisms between affine varieties are of this form.
Lemma 2.3.7. Let X ⊂ A
n and Y ⊂ A
m be affine varieties. There is a one-to-one correspondence between morphisms f : X → Y and k-algebra homomorphisms f ∗
: A(Y) →
A(X).
Proof. Any morphism f : X → Y determines a k-algebra homomorphism f
∗
: OY (Y) =
A(Y) → OX (X) = A(X) by definition. Conversely, if
g : k[y1,..., ym]/I(Y) → k[x1,..., xn]/I(X)
is any k-algebra homomorphism then it determines a polynomial map f = (f1,..., fm) :
X → Y as in example 2.3.6 by fi = g(yi), and hence a morphism. 
2. Functions, morphisms, and varieties 25
Example 2.3.8. Of course, an isomorphism is defined to be a morphism f : X → Y that
has an inverse (i. e. a morphism such that there is a morphism g : Y → X with g ◦ f = idX
and f ◦ g = idY ). A warning is in place here that an isomorphism of affine varieties is
not the same as a bijective morphism (in contrast e. g. to the case of vector spaces). For
example, let X ⊂ A
2 be the curve given by the equation x
2 = y
3
, and consider the map
f : A
1 → X, t 7→ (x = t
3
, y = t
2
).
x
2 = y 3
A1 f
This is a morphism as it is given by polynomials, and it is bijective as the inverse is given
by
f
−1
: X → A
1
, (x, y) 7→
(x
y
if (x, y) 6= (0,0),
0 if (x, y) = (0,0).
But if f was an isomorphism, the corresponding k-algebra homomorphism
k[x, y]/(x
2 −y
3
) → k[t], x 7→ t
3
and y 7→ t
2
would have to be an isomorphism by lemma 2.3.7. This is obviously not the case, as the
image of this algebra homomorphism contains no linear polynomials.
Example 2.3.9. As an application of morphisms, let us consider products of affine varieties. Let X ⊂ A
n
and Y ⊂ A
m be affine varieties with ideals I(X) ⊂ k[x1,..., xn] and
I(Y) ⊂ k[y1,..., ym]. As usual, we define the product X ×Y of X and Y to be the set
X ×Y = {(P,Q) ∈ A
n ×A
m
; P ∈ X and Q ∈ Y} ⊂ A
n ×A
m = A
n+m
.
Obviously, this is an algebraic set in A
n+m with ideal
I(X ×Y) = I(X) +I(Y) ⊂ k[x1,..., xn, y1,..., ym]
where we consider k[x1,..., xn] and k[y1,..., ym] as subalgebras of k[x1,..., xn, y1,..., ym]
in the obvious way. Let us show that it is in fact a variety, i. e. irreducible:
Proposition 2.3.10. If X and Y are affine varieties, then so is X ×Y .
Proof. For simplicity, let us just write x for the collection of the xi
, and y for the collection
of the yi
. By the above discussion it only remains to show that I(X ×Y) is prime. So let
f,g ∈ k[x, y] be polynomial functions such that f g ∈ I(X ×Y); we have to show that either
f or g vanishes on all of X ×Y, i. e. that X ×Y ⊂ Z(f) or X ×Y ⊂ Z(g).
So let us assume that X ×Y 6⊂ Z(f), i. e. there is a point (P,Q) ∈ X ×Y\Z(f) (where
P ∈ X and Q ∈ Y). Denote by f(·,Q) ∈ k[x] the polynomial obtained from f ∈ k[x, y] by
plugging in the coordinates of Q for y. For all P
0 ∈ X\Z(f(·,Q)) (e. g. for P
0 = P) we must
have
Y ⊂ Z(f(P
0
,·)· g(P
0
,·)) = Z(f(P
0
,·))∪Z(g(P
0
,·)).
As Y is irreducible and Y 6⊂ Z(f(P
0
,·)) by the choice of P
0
, it follows that Y ⊂ Z(g(P
0
,·)).
This is true for all P
0 ∈ X\Z(f(·,Q)), so we conclude that (X\Z(f(·,Q)) ×Y ⊂ Z(g).
But as Z(g) is closed, it must in fact contain the closure of (X\Z(f(·,Q)) ×Y as well,
which is just X ×Y as X is irreducible and X\Z(f(·,Q)) a non-empty open subset of X
(see remark 1.3.17).
The obvious projection maps
πX : X ×Y → X, (P,Q) 7→ P and πY : X ×Y → Y, (P,Q) 7→ Q
are given by (trivial) polynomial maps and are therefore morphisms. The important main
property of the product X ×Y is the following:
26 Andreas Gathmann
Lemma 2.3.11. Let X and Y be affine varieties. Then the product X ×Y satisfies the
following universal property: for every affine variety Z and morphisms f : Z → X and
g : Z → Y , there is a unique morphism h : Z → X ×Y such that f = πX ◦ h and g = πY ◦ h,
i. e. such that the following diagram commutes:
Z
g
%
h
"
f

X ×Y πY
/
πX

Y
X
In other words, giving a morphism Z → X ×Y “is the same” as giving two morphisms
Z → X and Z → Y .
Proof. Let A be the coordinate ring of Z. Then by lemma 2.3.7 the morphism f : Z → X is
given by a k-algebra homomorphism ˜f : k[x1,..., xn]/I(X) → A. This in turn is determined
by giving the images ˜fi
:= ˜f(xi) ∈ A of the generators xi
, satisfying the relations of I (i. e.
F(
˜f1,...,
˜fn) = 0 for all F(x1,..., xn) ∈ I(X)). The same is true for g, which is determined
by the images ˜gi
:= g˜(yi) ∈ A.
Now it is obvious that the elements ˜fi and ˜gi determine a k-algebra homomorphism
k[x1,..., xn, y1,..., ym]/(I(X) +I(Y)) → A,
which determines a morphism h : Z → X ×Y by lemma 2.3.7.
To show uniqueness, just note that the relations f = πX ◦ h and g = πY ◦ h imply immediately that h must be given set-theoretically by h(P) = (f(P),g(P)) for all P ∈ Z.
Remark 2.3.12. It is easy to see that the property of lemma 2.3.11 determines the product
X ×Y uniquely up to isomorphism. It is therefore often taken to be the defining property
for products.
Remark 2.3.13. If you have heard about tensor products before, you will have noticed that
the coordinate ring of X ×Y is just the tensor product A(X)⊗A(Y) of the coordinate rings
of the factors (where the tensor product is taken as k-algebras). See also section 5.4 for
more details.
Remark 2.3.14. Lemma 2.3.7 allows us to associate an affine variety up to isomorphism
to any finitely generated k-algebra that is a domain: if A is such an algebra, let x1,..., xn
be generators of A, so that A = k[x1,..., xn]/I for some ideal I. Let X be the affine variety
in A
n defined by the ideal I; by the lemma it is defined up to isomorphism. Therefore we
should make a (very minor) redefinition of the term “affine variety” to allow for objects that
are isomorphic to an affine variety in the old sense, but that do not come with an intrinsic
description as the zero locus of some polynomials in affine space:
Definition 2.3.15. A ringed space (X,OX ) is called an affine variety over k if
(i) X is irreducible,
(ii) OX is a sheaf of k-valued functions,
(iii) X is isomorphic to an affine variety in the sense of definition 1.3.1.
Here is an example of an affine variety in this new sense although it is not a priori given
as the zero locus of some polynomials in affine space:
Lemma 2.3.16. Let X be an affine variety and f ∈ A(X), and let Xf = X\Z(f) be a
distinguished open subset as in proposition 2.1.10. Then the ringed space (Xf
,OX |Xf
) is
isomorphic to an affine variety with coordinate ring A(X)f
.
2. Functions, morphisms, and varieties 27
Proof. Let X ⊂ A
n be an affine variety, and let f
0 ∈ k[x1,..., xn] be a representative of f .
Let J ⊂ k[x1,..., xn,t] be the ideal generated by I(X) and the function 1 −t f 0
. We claim
that the ringed space (Xf
,OX |Xf
) is isomorphic to the affine variety
Z(J) = {(P,λ) ; P ∈ X and λ =
1
f
0(P)
} ⊂ A
n+1
.
Consider the projection map π : Z(J) → X given by π(P,λ) = P. This is a morphism with
image Xf and inverse morphism π
−1
(P) = (P,
1
f
0(P)
), hence π is an isomorphism. It is
obvious that A(Z(J)) = A(X)f
.
Remark 2.3.17. So we have just shown that even open subsets of affine varieties are themselves affine varieties, provided that the open subset is the complement of the zero locus of
a single polynomial equation.
Example 2.1.12 shows however that not all open subsets of affine varieties are themselves isomorphic to affine varieties: if U ⊂ C
2\{0} we have seen that OU (U) = k[x, y]. So
if U was an affine variety, its coordinate ring must be k[x, y], which is the same as the coordinate ring of C
2
. By lemma 2.3.7 this means that U and C
2 would have to be isomorphic,
with the isomorphism given by the identity map. Obviously, this is not true. Hence U is
not an affine variety. It can however be covered by two open subsets {x 6= 0} and {y 6= 0}
which are both affine by lemma 2.3.16. This leads us to the idea of patching affine varieties
together, which we will do in the next section.
2.4. Prevarieties. Now we want to extend our category of objects to more general things
than just affine varieties. Remark 2.3.17 showed us that not all open subsets of affine varieties are themselves isomorphic to affine varieties. But note that every open subset of
an affine variety can be written as a finite union of distinguished open subsets (as this is
equivalent to the statement that every closed subset of an affine variety is the zero locus
of finitely many polynomials). Hence any such open subset can be covered by affine varieties. This leads us to the idea that we should study objects that are not affine varieties
themselves, but rather can be covered by (finitely many) affine varieties. Note that the
following definition is completely parallel to the definition 2.3.15 of affine varieties (in the
new sense).
Definition 2.4.1. A prevariety is a ringed space (X,OX ) such that
(i) X is irreducible,
(ii) OX is a sheaf of k-valued functions,
(iii) there is a finite open cover {Ui} of X such that (Ui
,OX |Ui
) is an affine variety for
all i.
As before, a morphism of prevarieties is just a morphism as ringed spaces (see definition
2.3.1).
An open subset U ⊂ X of a prevariety such that (U,OX |U ) is isomorphic to an affine
variety is called an affine open set.
Example 2.4.2. Affine varieties and open subsets of affine varieties are prevarieties (the
irreducibility of open subsets follows from exercise 1.4.6).
Remark 2.4.3. The above definition is completely analogous to the definition of manifolds.
Recall how manifolds are defined: first you look at open subsets of R
n
that are supposed to
form the patches of your space, and then you define a manifold to be a topological space
that looks locally like these patches. In the algebraic case now we can say that the affine
varieties form the basic patches of the spaces that we want to consider, and that e. g. open
subsets of affine varieties are spaces that look locally like affine varieties.
28 Andreas Gathmann
As we defined a prevariety to be a space that can be covered by affine opens, the most
general way to construct prevarieties is of course to take some affine varieties (or prevarieties that we have already constructed) and patch them together:
Example 2.4.4. Let X1,X2 be prevarieties, let U1 ⊂ X1 and U2 ⊂ X2 be non-empty open
subsets, and let f : (U1,OX1
|U1
) → (U2,OX2
|U2
) be an isomorphism. Then we can define a
prevariety X, obtained by glueing X1 and X2 along U1 and U2 via the isomorphism f :
• As a set, the space X is just the disjoint union X1 ∪ X2 modulo the equivalence
relation P ∼ f(P) for all P ∈ U1.
• As a topological space, we endow X with the so-called quotient topology induced
by the above equivalence relation, i. e. we say that a subset U ⊂ X is open if
and only if i
−1
1
(U) ⊂ X1 and i
−1
2
(U) ⊂ X2 are both open, with i1 : X1 → X and
i2 : X2 → X being the obvious inclusion maps.
• As a ringed space, we define the structure sheaf OX by
OX (U) = {(ϕ1,ϕ2) ; ϕ1 ∈ OX1
(i
−1
1
(U)),ϕ2 ∈ OX2
(i
−1
2
(U)),
ϕ1 = ϕ2 on the overlap (i. e. f
∗
(ϕ2|
i
−1
2
(U)∩U2
) = ϕ1|
i
−1
1
(U)∩U1
)}.
It is easy to check that this defines a sheaf of k-valued functions on X and that X is irreducible. Of course, every point of X has an affine neighborhood, so X is in fact a prevariety.
Example 2.4.5. As an example of the above glueing construction, let X1 = X2 = A
1
, U1 =
U2 = A
1\{0}.
• Let f : U1 → U2 be the isomorphism x 7→ 1
x
. The space X can be thought of as
A
1 ∪ {∞}: of course the affine line X1 = A
1 ⊂ X sits in X. The complement
X\X1 is a single point that corresponds to the zero point in X2
∼= A
1
and hence
to “∞ =
1
0
” in the coordinate of X1. In the case k = C, the space X is just the
Riemann sphere C∞.
1
X2
f
glue
X
X
0
8
8 0
We denote this space by P
1
. (This is a special case of a projective space; see
section 3.1 and remark 3.3.7 for more details.)
• Let f : U1 →U2 be the identity map. Then the space X obtained by glueing along
f is “the affine line with the zero point doubled”:
glue
f
X1
X2
X
Obviously this is a somewhat weird space. Speaking in classical terms (and thinking of the complex numbers), if we have a sequence of points tending to the zero,
this sequence would have two possible limits, namely the two zero points. Usually we want to exclude such spaces from the objects we consider. In the theory
of manifolds, this is simply done by requiring that a manifold satisfies the socalled Hausdorff property, i. e. that every two distinct points have disjoint open
neighborhoods. This is obviously not satisfied for our space X. But the analogous
definition does not make sense in the Zariski topology, as non-empty open subsets
2. Functions, morphisms, and varieties 29
are never disjoint. Hence we need a different characterization of the geometric
concept of “doubled points”. We will do this in section 2.5.
Example 2.4.6. Let X be the complex affine curve
X = {(x, y) ∈ C
2
; y
2 = (x−1)(x−2)···(x−2n)}.
We have already seen in example 0.1.1 that X can (and should) be “compactified” by adding
two points at infinity, corresponding to the limit x → ∞ and the two possible values for y.
Let us now construct this compactified space rigorously as a prevariety.
To be able to add a limit point “x = ∞” to our space, let us make a coordinate change
x˜ =
1
x
, so that the equation of the curve becomes
y
2
x˜
2n = (1−x˜)(1−2 ˜x)···(1−2nx˜).
If we make an additional coordinate change ˜y =
y
x
n , this becomes
y˜
2 = (1−x˜)(1−2 ˜x)···(1−2nx˜).
In these coordinates we can add our two points at infinity, as they now correspond to ˜x = 0
(and therefore ˜y = ±1).
Summarizing, our “compactified curve” of example 0.1.1 is just the prevariety obtained
by glueing the two affine varieties
X = {(x, y) ∈ C
2
; y
2 = (x−1)(x−2)···(x−2n)}
and X˜ = {(x˜, y˜) ∈ C
2
; ˜y
2 = (1−x˜)(1−2 ˜x)···(1−2nx˜)}
along the isomorphism
f :U → U˜, (x, y) 7→ (x˜, y˜) = 
1
x
,
y
x
n

,
f
−1
:U˜ → U, (x˜, y˜) 7→ (x, y) = 
1
x˜
,
y˜
x˜
n

,
where U = {x 6= 0} ⊂ X and U˜ = {x˜ 6= 0} ⊂ X˜.
Of course one can also glue together more than two prevarieties. As the construction
is the same as in the case above, we will just give the statement and leave its proof as an
exercise:
Lemma 2.4.7. Let X1,...,Xr be prevarieties, and let Ui, j ⊂ Xi be non-empty open subsets
for i, j = 1,...,r. Let fi, j
: Ui, j → Uj,i be isomorphisms such that
(i) fi, j = f
−1
j,i
,
(ii) fi,k = fj,k ◦ fi, j where defined.
Then there is a prevariety X, obtained by glueing the Xi along the morphisms fi, j as in
example 2.4.4 (see below).
Remark 2.4.8. The prevariety X in the lemma 2.4.7 can be described as follows:
• As a set, X is the disjoint union of the Xi
, modulo the equivalence relation P ∼
fi, j(P) for all P ∈ Ui, j
.
• To define X as a topological space, we say that a subset Y ⊂ X is closed if and
only if all restrictions Y ∩Xi are closed.
• A regular function on an open set U ⊂ X is a collection of regular functions
ϕi ∈ OXi
(Xi ∩U) that agree on the overlaps.
30 Andreas Gathmann
Condition (ii) of the lemma gives a compatibility condition for triple overlaps: consider
three patches Xi
, Xj
, Xk that have a common intersection. Then we want to identify every
point P ∈ Ui, j with fi, j(P) ∈ Uj,k, and the point fi, j(P) with fj,k(fi, j(P)) (if it lies in Uj,k).
So the glueing map fi,k must map P to the same point fj,k(fi, j(P)) to get a consistent
glueing. This is illustrated in the following picture:
X
P
P
X
Ui,j
Ui,k
Uk,i
Uk,j
Uj,k
Uj,i
X
Xk
i
j
glue
f
f
f j,k
i,j
i,k
Let us now consider some examples of morphisms between prevarieties.
Example 2.4.9. Let f : P
1 → A
1 be a morphism. We claim that f must be constant.
In fact, consider the restriction f |A1 of f to the open affine subset A
1 ⊂ P
1
. By definition
the restriction of a morphism is again a morphism, so f |A1 must be of the form x 7→ y = p(x)
for some polynomial p ∈ k[x]. Now consider the second patch of P
1 with coordinate ˜x =
1
x
.
Applying this coordinate change, we see that f |P1\{0}
is given by ˜x 7→ p(
1
x˜
). But this must
be a morphism too, i. e. p(
1
x˜
) must be a polynomial in ˜x. This is only true if p is a constant.
In the same way as prevarieties can be glued, we can patch together morphisms too. Of
course, the statement is essentially that we can check the property of being a morphism on
affine open covers:
Lemma 2.4.10. Let X,Y be prevarieties and let f : X → Y be a set-theoretic map. Let
{U1,...,Ur} be an open cover of X and {V1,...,Vr} an affine open cover of Y such that
f(Ui) ⊂ Vi and (f |Ui
)
∗OY (Vi) ⊂ OX (Ui). Then f is a morphism.
Proof. We may assume that the Ui are affine, as otherwise we can replace the Ui by a set
of affines that cover Ui
. Consider the restrictions fi
: Ui → Vi
. The homomorphism f
∗
i
:
OY (Vi) = A(Vi) → OX (Ui) = A(Ui) is induced by some morphism Ui → Vi by lemma 2.3.7
which is easily seen to coincide with fi
. In particular, the fi are continuous, and therefore
so is f . It remains to show that f
∗
takes sections of OY to sections of OX . But if V ⊂ Y is
open and ϕ ∈ OY (V), then f
∗ϕ is at least a section of OX on the sets f
−1
(V)∩Ui
. Since
OX is a sheaf and the Ui cover X, these sections glue to give a section in OX (f
−1
(V)).
Example 2.4.11. Let f : A
1 → A
1
, x 7→ y = f(x) be a morphism given by a polynomial f ∈
k[x]. We claim that there is a unique extension morphism ˜f : P
1 → P
1
such that ˜f |A1 = f .
We can assume that f = ∑
n
i=1
aix
i
is not constant, as otherwise the result is trivial. It is then
obvious that the extension should be given by ˜f(∞) = ∞. Let us check that this defines in
fact a morphism.
We want to apply lemma 2.4.10. Consider the standard open affine cover of the domain
P
1 by the two affine lines V1 = P
1\{∞} and V2 = P
1\{0}. Then U1 := ˜f
−1
(V1) = A
1
,
and ˜f |A1 = f is a morphism. On the other hand, let U2 := ˜f
−1
(V2)\{0}. Consider the
coordinates ˜x =
1
x
and ˜y =
1
y
on U2 and V2, respectively. In these coordinates, the map ˜f is
given by
y˜ =
x˜
n
∑
n
i=1
aix˜
n−i
;
2. Functions, morphisms, and varieties 31
in particular ˜x = 0 maps to ˜y = 0. So by defining ˜f(∞) = ∞, we get a morphism ˜f : P
1 → P
1
that extends f by lemma 2.4.10.
2.5. Varieties. Recall example 2.4.5 (ii) where we constructed a prevariety that was “not
Hausdorff” in the classical sense: take two copies of the affine line A
1
and glue them
together on the open set A
1\{0} along the identity map. The prevariety X thus obtained is
the “affine line with the origin doubled”; its strange property is that even in the classical
topology (for k = C) the two origins do not have disjoint neighborhoods. We will now
define an algebro-geometric analogue of the Hausdorff property and say that a prevariety
is a variety if it has this property.
Definition 2.5.1. Let X be a prevariety. We say that X is a variety if for every prevariety
Y and every two morphisms f1, f2 : Y → X, the set {P ∈Y ; f1(P) = f2(P)} is closed in Y.
Remark 2.5.2. Let X be the affine line with the origin doubled. Then X is not a variety —
if we take Y = A
1
and let f1, f2 : Y → X be the two obvious inclusions that map the origin
in Y to the two different origins in X, then f1 and f2 agree on A
1\{0}, which is not closed
in A
1
.
On the other hand, if X has the Hausdorff property that we want to characterize, then
two morphisms Y → X that agree on an open subset of Y should also agree on Y.
One can make this definition somewhat easier and eliminate the need for an arbitrary
second prevariety Y. To do so note that we can define products of prevarieties in the same
way as we have defined products of affine varieties (see example 2.3.9 and exercise 2.6.13).
For any prevariety X, consider the diagonal morphism
∆ : X → X ×X, P 7→ (P,P).
The image ∆(X) ⊂ X ×X is called the diagonal of X. Of course, the morphism ∆ : X →
∆(X) is an isomorphism onto its image (with inverse morphism being given by (P,Q)7→ P).
So the space ∆(X) is not really interesting as a new prevariety; instead the main question
is how ∆(X) is embedded in X ×X:
Lemma 2.5.3. A prevariety X is a variety if and only if the diagonal ∆(X) is closed in
X ×X.
Proof. It is obvious that a variety has this property (take Y = X × X and f1, f2 the two
projections to X). Conversely, if the diagonal ∆(X) is closed and f1, f2 : Y → X are two
morphisms, then they induce a morphism (f1, f2) : Y → X ×X by the universal property of
exercise 2.6.13, and
{P ∈ Y | f1(P) = f2(P)} = (f1, f2)
−1
(∆(X))
is closed.
Lemma 2.5.4. Every affine variety is a variety. Any open or closed subprevariety of a
variety is a variety.
Proof. If X ⊂ A
n
is an affine variety with ideal I(X) = (f1,..., fr), the diagonal ∆(X) ⊂
A
2n
is an affine variety given by the equations fi(x1,..., xn) = 0 for i = 1,...,r and xi = yi
for i = 1,...,n, where x1,..., xn, y1,..., yn are the coordinates on A
2n
. This is obviously
closed, so X is a variety by lemma 2.5.3.
If Y ⊂ X is open or closed, then ∆(Y) = ∆(X)∩(Y ×Y); i. e. if ∆(X) is closed in X ×X
then so is ∆(Y) in Y ×Y.
Example 2.5.5. Let us illustrate lemma 2.5.3 in the case of the affine line with a doubled
origin. So let X1 = X2 = A
1
, and let X be the prevariety obtained by glueing X1 to X2 along
the identity on A\{0}. Then X ×X is covered by the four affine varieties X1 ×X1, X1 ×X2,
32 Andreas Gathmann
X2 ×X1, and X2 ×X2 by exercise 2.6.13. As we glue along A
1\{0} to obtain X, it follows
that the space X ×X contains the point (P,Q) ∈ A
1 ×A
1
• once if P 6= 0 and Q 6= 0,
• twice if P = 0 and Q 6= 0, or if P 6= 0 and Q = 0,
• four times if P = 0 and Q = 0.
XxX
∆(X)
In particular, X ×X contains four origins now. But the diagonal ∆(X) contains only two of
them (by definition of the diagonal we have to take the same origin in both factors). So on
the patch X1 ×X2, the diagonal is given by {(P,P) ; P 6= 0} ⊂ X1 ×X2 = A
1 ×A
1
, which
is not closed. So we see again that X is not a variety.
2.6. Exercises.
Exercise 2.6.1. An algebraic set X ⊂ A
2 defined by a polynomial of degree 2 is called a
conic. Show that any irreducible conic is isomorphic either to Z(y−x
2
) or to Z(xy−1).
Exercise 2.6.2. Let X,Y ⊂ A
2 be irreducible conics as in exercise 2.6.1, and assume that
X 6= Y. Show that X and Y intersect in at most 4 points. For all n ∈ {0,1,2,3,4}, find an
example of two conics that intersect in exactly n points. (For a generalization see theorem
6.2.1.)
Exercise 2.6.3. Which of the following algebraic sets are isomorphic over the complex
numbers?
(a) A
1
(b) Z(xy) ⊂ A
2
(c) Z(x
2 +y
2
) ⊂ A
2
(d) Z(y
2 −x
3 −x
2
) ⊂ A
2
(e) Z(x
2 −y
3
) ⊂ A
2
(f) Z(y−x
2
,z−x
3
) ⊂ A
3
Exercise 2.6.4. Let X be an affine variety, and let G be a finite group. Assume that G acts
on X, i. e. that for every g ∈ G we are given a morphism g : X → X (denoted by the same
letter for simplicity of notation), such that (g ◦ h)(P) = g(h(P)) for all g,h ∈ G and P ∈ X.
(i) Let A(X)
G be the subalgebra of A(X) consisting of all G-invariant functions on
X, i. e. of all f : X → k such that f(g(P)) = f(P) for all P ∈ X. Show that A(X)
G
is a finitely generated k-algebra.
(ii) By (i), there is an affine variety Y with coordinate ring A(X)
G, together with a
morphism π : X → Y determined by the inclusion A(X)
G ⊂ A(X). Show that Y
can be considered as the quotient of X by G, denoted X/G, in the following
sense:
(a) π is surjective.
(b) If P,Q ∈ X then π(P) = π(Q) if and only if there is a g ∈ G such that g(P) =
Q.
(iii) For a given group action, is an affine variety with the properties (ii)(a) and (ii)(b)
uniquely determined?
(iv) Let Zn = {exp(
2πik
n
) ; k ∈ Z} ⊂ C be the group of n-th roots of unity. Let Zn act
on C
m by multiplication in each coordinate. Show that C/Zn is isomorphic to C
for all n, but that C
2/Zn is not isomorphic to C
2
for n ≥ 2.
Exercise 2.6.5. Are the following statements true or false: if f : A
n → A
m is a polynomial
map (i. e. f(P) = (f1(P),..., fm(P)) with fi ∈ k[x1,..., xn]), and. . .
2. Functions, morphisms, and varieties 33
(i) X ⊂ A
n
is an algebraic set, then the image f(X) ⊂ A
m is an algebraic set.
(ii) X ⊂ A
m is an algebraic set, then the inverse image f
−1
(X) ⊂ A
n
is an algebraic
set.
(iii) X ⊂ A
n
is an algebraic set, then the graph Γ = {(x, f(x))| x ∈ X} ⊂ A
n+m is an
algebraic set.
Exercise 2.6.6. Let f : X →Y be a morphism between affine varieties, and let f
∗
: A(Y) →
A(X) be the corresponding map of k-algebras. Which of the following statements are true?
(i) If P ∈ X and Q ∈ Y, then f(P) = Q if and only if (f
∗
)
−1
(I(P)) = I(Q).
(ii) f
∗
is injective if and only if f is surjective.
(iii) f
∗
is surjective if and only if f is injective.
(iv) f is an isomorphism if and only if f
∗
is an isomorphism.
If a statement is false, is there maybe a weaker form of it which is true?
Exercise 2.6.7. Let X be a prevariety. Show that:
(i) X is a Noetherian topological space,
(ii) any open subset of X is a prevariety.
Exercise 2.6.8. Let (X,OX ) be a prevariety, and let Y ⊂ X be an irreducible closed subset.
For every open subset U ⊂ Y define OY (U) to be the ring of k-valued functions f on U
with the following property: for every point P ∈Y there is a neighborhood V of P in X and
a section F ∈ OX (V) such that f coincides with F on U.
(i) Show that the rings OY (U) together with the obvious restriction maps define a
sheaf OY on Y.
(ii) Show that (Y,OY ) is a prevariety.
Exercise 2.6.9. Let X be a prevariety. Consider pairs (U, f) where U is an open subset
of X and f ∈ OX (U) a regular function on U. We call two such pairs (U, f) and (U
0
, f
0
)
equivalent if there is an open subset V in X with V ⊂ U ∩U
0
such that f |U = f |U0 .
(i) Show that this defines an equivalence relation.
(ii) Show that the set of all such pairs modulo this equivalence relation is a field. It is
called the field of rational functions on X and denoted K(X).
(iii) If X is an affine variety, show that K(X) is just the field of rational functions as
defined in definition 2.1.3.
(iv) If U ⊂ X is any non-empty open subset, show that K(U) = K(X).
Exercise 2.6.10. If U is an open subset of a prevariety X and f : U → P
1
a morphism, is it
always true that f can be extended to a morphism ˜f : X → P
1
?
Exercise 2.6.11. Show that the prevariety P
1
is a variety.
Exercise 2.6.12.
(i) Show that every isomorphism f : A
1 → A
1
is of the form f(x) = ax+b for some
a,b ∈ k, where x is the coordinate on A
1
.
(ii) Show that every isomorphism f : P
1 → P
1
is of the form f(x) = ax+b
cx+d
for some
a,b, c,d ∈ k, where x is an affine coordinate on A
1 ⊂ P
1
. (For a generalization
see corollary 6.2.10.)
(iii) Given three distinct points P1,P2,P3 ∈ P
1
and three distinct points Q1,Q2,Q3 ∈
P
1
, show that there is a unique isomorphism f : P
1 → P
1
such that f(Pi) = Qi for
i = 1,2,3.
(Remark: If the ground field is C, the very same statements are true in the complex analytic
category as well, i. e. if “morphisms” are understood as “holomorphic maps” (and P
1
is
the Riemann sphere C∞). If you know some complex analysis and have some time to kill,
you may try to prove this too.)
34 Andreas Gathmann
Exercise 2.6.13. Let X and Y be prevarieties with affine open covers {Ui} and {Vj}, respectively. Construct the product prevariety X ×Y by glueing the affine varieties Ui ×Vj
together. Moreover, show that there are projection morphisms πX : X ×Y → X and πY : X ×
Y → Y satisfying the “usual” universal property for products: given morphisms f : Z → X
and g : Z → Y from any prevariety Z, there is a unique morphism h : Z → X ×Y such that
f = πX ◦ h and g = πY ◦ h.
3. Projective varieties 35
3. PROJECTIVE VARIETIES
Similarly to the affine case, a subset of projective n-space P
n over k is called a projective algebraic set if it can be written as the zero locus of a (finite) set of homogeneous
polynomials. The Zariski topology on P
n
is the topology whose closed sets are the
projective algebraic sets. The concepts of irreducibility and dimension are purely
topological and extend therefore immediately to subsets of projective space. We
prove a projective version of the Nullstellensatz and make projective varieties into
ringed spaces that are varieties.
The main property of projective varieties distinguishing them from affine varieties
is that (over C in the classical topology) they are compact. In terms of algebraic
geometry this translates into the statement that if f : X → Y is a morphism between
projective varieties then f(X) is closed in Y.
3.1. Projective spaces and projective varieties. In the last section we have studied varieties, i. e. topological spaces that are locally isomorphic to affine varieties. In particular,
the ability to glue affine varieties together allowed us to construct compact spaces (over the
ground field C) like e. g. P
1
, whereas affine varieties themselves are never compact unless
they are a single point (see exercise 3.5.6). Unfortunately, the description of a variety in
terms of its affine patches is often quite inconvenient in practice, as we have seen already
in the calculations in the last section. It would be desirable to have a global description of
the spaces that does not refer to glueing methods.
Projective varieties form a large class of “compact” varieties that do admit such a unified
global description. In fact, the class of projective varieties is so large that it is not easy to
construct a variety that is not (an open subset of) a projective variety.
To construct projective varieties, we need to define projective spaces first. Projective
spaces are “compactifications” of affine spaces. We have seen P
1
already as a compactification of A
1
; general projective spaces are an extension of this construction to higher
dimensions.
Definition 3.1.1. We define projective n-space over k, denoted P
n
, to be the set of all
one-dimensional linear subspaces of the vector space k
n+1
.
Remark 3.1.2. Obviously, a one-dimensional linear subspace of k
n+1
is uniquely determined by a non-zero vector in k
n+1
. Conversely, two such vectors a = (a0,...,an) and
b = (b0,...,bn) in k
n+1
span the same linear subspace if and only if they differ only by a
common scalar, i. e. if b = λa for some non-zero λ ∈ k. In other words,
P
n = {(a0,...,an) ; ai ∈ k, not all ai = 0}/ ∼
with the equivalence relation
(a0,...,an) ∼ (b0,...,bn) if ai = λbi for some λ ∈ k\{0} and all i.
This is often written as
P
n = (k
n+1
\{0})/(k\{0}),
and the point P in P
n determined by (a0,...,an) is written as P = (a0 : ··· : an) (the notation
[a0,...,an] is also common in the literature). So the notation (a0 : ··· : an) means that the
ai are not all zero, and that they are defined only up to a common scalar multiple. The ai
are called the homogeneous coordinates of the point P (the motivation for this name will
become obvious in the course of this section).
Example 3.1.3. Consider the one-dimensional projective space P
1
. Let (a0 : a1) ∈ P
1 be
a point. Then we have one of the following cases:
36 Andreas Gathmann
(i) a0 6= 0. Then P can be written as P = (1 : a) with a =
a1
a0
∈ k. Obviously (1 : a) =
(1 : b) if and only if a = b, i. e. the ambiguity in the homogeneous coordinates is
gone if we fix one of them to be 1. So the set of these points is just A
1
. We call
a =
a1
a0
the affine coordinate of the point P; it is uniquely determined by P (and
not just up to a multiple as for the homogeneous coordinates).
(ii) a0 = 0, and therefore a1 6= 0. There is just one such point that we can write as
(0 : 1).
So P
1
is just A
1 with one point added. This additional point (0 : 1) can be thought of as a
“point at infinity”, as you can see from the fact that its affine coordinate is formally 1
0
. So
we arrive at the same description of P
1
as in example 2.4.5 (i).
Remark 3.1.4. There is a completely analogous description of P
n
as A
n with some points
added “at infinity”: let P = (a0 : ··· : an) ∈ P
n be a point. Then we have one of the following
cases:
(i) a0 6= 0. Then P = (1 : α1 : ··· : αn) with αi =
ai
a0
for all i. The αi are the affine
coordinates of P; they are uniquely determined by P and are obtained by setting
a0 = 1. So the set of all P with a0 6= 0 is just A
n
.
(ii) a0 = 0, i. e. P = (0 : a1 : ··· : an), with the ai still defined only up to a common
scalar. Obviously, the set of such points is P
n−1
; the set of all one-dimensional
linear subspaces of A
n
. We think of these points as points at infinity; the new twist
compared to P
1
is just that we have a point at infinity for every one-dimensional
linear subspace of A
n
, i. e. for every “direction” in A
n
. So, for example, two
lines in A
n will meet at infinity (when compactified in P
n
) if and only if they
are parallel, i. e. point in the same direction. (This is good as it implies that two
distinct lines always intersect in exactly one point.)
Usually, it is more helpful to think of the projective space P
n
as the affine space A
n
compactified by adding some points (parametrized by P
n−1
) at infinity, rather than as the set of
lines in A
n+1
.
Remark 3.1.5. In the case k = C, we claim that P
n
is a compact space (in the classical
topology). In fact, let
S
2n+1 = {(a0,...,an) ∈ C
n+1
; |a0|
2 +···+|an|
2 = 1}
be the unit sphere in C
n+1 = R
2n+2
. This is a compact space as it is closed and bounded,
and there is an obvious surjective map
S
2n+1 → P
n
, (a0,··· ,an) 7→ (a0 : ··· : an).
As images of compact sets under continuous maps are compact, it follows that P
n
is also
compact.
Remark 3.1.6. In complete analogy to affine algebraic sets, we now want to define projective algebraic sets to be subsets of P
n
that can be described as the zero locus of some
polynomials in the homogeneous coordinates. Note however that if f ∈ k[x0,..., xn] is an
arbitrary polynomial, it does not make sense to write down a definition like
Z(f) = {(a0 : ··· : an) ; f(a0,...,an) = 0},
because the ai are only defined up to a common scalar. For example, if f(x0, x1) = x
2
1 −x0
then f(1,1) = 0 but f(−1,−1) 6= 0, although (1 : 1) and (−1 : −1) are the same point in
P
1
. To get rid of this problem we have to require that f be homogeneous, i. e. that all of
its monomials have the same (total) degree d. This is equivalent to the requirement
f(λx0,...,λxn) = λ
d
f(x0,..., xn) for all λ,
3. Projective varieties 37
so in particular we see that
f(λx0,...,λxn) = 0 ⇐⇒ f(x0,..., xn) = 0,
i. e. the condition that a homogeneous polynomial in the homogeneous coordinates vanishes is indeed well-defined.
Definition 3.1.7. For every f ∈ k[x0,..., xn] let f
(d) denote the degree-d part of f , i. e.
f = ∑ f
(d) with f
(d) homogeneous of degree d for all d.
Lemma 3.1.8. Let I ⊂ k[x0,..., xn] be an ideal. The following are equivalent:
(i) I can be generated by homogeneous polynomials.
(ii) For every f ∈ I we have f (d) ∈ I for all d.
An ideal that satisfies these conditions is called homogeneous.
Proof. (i) ⇒ (ii): Let I = (f1,..., fm) with all fi homogeneous. Then every f ∈ I can
be written as f = ∑i ai
fi for some ai ∈ k[x0,..., xn] (which need not be homogeneous).
Restricting this equation to the degree-d part, we get f
(d) = ∑i
(ai)
(d−deg fi)
fi ∈ I.
(ii) ⇒ (i): Any ideal can be written as I = (f1,..., fm) with the fi possibly not being
homogeneous. But by (ii) we know that all f
(d)
i
are in I too, so it follows that I is generated
by the homogeneous polynomials f
(d)
i
.
Remark 3.1.9. Note that it is not true that every element of a homogeneous ideal I is a
homogeneous polynomial: we can always add two polynomials of I to get another element
of I, even if they do not have the same degree.
With the exception of the homogeneity requirement, the following constructions are
now completely analogous to the affine case:
Definition 3.1.10. Let I ⊂ k[x0,..., xn] be a homogeneous ideal (or a set of homogeneous
polynomials). The set
Z(I) := {(a0 : ··· : an) ∈ P
n
; f(a0,...,an) = 0 for all f ∈ I}
is called the zero locus of I; this is well-defined by remark 3.1.6. Subsets of P
n
that are of
the form Z(I) are called algebraic sets. If X ⊂ P
n
is any subset, we call
I(X) :=the ideal generated by
{ f ∈ k[x0,..., xn] homogeneous ; f(a0,...,an) = 0 for all (a0 : ··· : an) ∈ X}
⊂ k[x0,..., xn]
the ideal of X; by definition this is a homogeneous ideal.
If we want to distinguish between the affine zero locus Z(I) ⊂ A
n+1
and the projective
zero locus Z(I) ⊂ P
n of the same (homogeneous) ideal, we denote the former by Za(I) and
the latter by Zp(I).
Remark 3.1.11. A remark that is sometimes useful is that every projective algebraic set
can be written as the zero locus of finitely many homogeneous polynomials of the same
degree. This follows easily from the fact that Z(f) = Z(x
d
0
f,..., x
d
n
f) for all homogeneous
polynomials f and every d ≥ 0.
Example 3.1.12. Let L ⊂ A
n+1 be a linear subspace of dimension k + 1; it can be given
by n − k linear equations in the coordinates of A
n+1
. The image of L under the quotient
map (A
n+1\{0})/(k\{0}) = P
n
, i. e. the subspace of P
n given by the same n−k equations
(now considered as equations in the homogeneous coordinates on P
n
) is called a linear
subspace of P
n of dimension k. Once we have given projective varieties the structure of
varieties, we will see that a linear subspace of P
n of dimension k is isomorphic to P
k
. For
38 Andreas Gathmann
example, a line in P
3
(with homogeneous coordinates x0, x1, x2, x3) is given by two linearly
independent equations in the xi
. One example is the line
{x2 = x3 = 0} = {(a0 : a1 : 0 : 0) ; a0,a1 ∈ k} ⊂ P
3
,
which is “obviously isomorphic” to P
1
.
Example 3.1.13. Consider the conics in A
2
X1 = {x2 = x
2
1} and X2 = {x1x2 = 1}
of exercise 2.6.1. We want to “compactify” these conics to projective algebraic sets X˜
1,
X˜
2 in P
2
. Note that for a projective algebraic set we need the defining polynomials to be
homogeneous, which is not yet the case here. On the other hand, we have an additional
coordinate x0 that you can think of as being 1 on the affine space A
2 ⊂ P
2
. So it is obvious
that we should make the defining equations homogeneous by adding suitable powers of x0:
consider
X˜
1 = {x0x2 = x
2
1} and X˜
2 = {x1x2 = x
2
0}
in P
2
. Then the restriction of X˜
i
to the affine space A
2 ⊂ P
2
is just given by Xi for i = 1,2.
We call X˜
i
the projective completion of Xi
; it can be done in the same way for all affine
varieties (see exercise 3.5.3).
Let us consider X˜
1 first. The points that we add at infinity correspond to those where
x0 = 0. It follows from the defining equation that x1 = 0 as well; and then we must necessarily have x2 6= 0 as the coordinates cannot be simultaneously zero. So there is only
one point added at infinity, namely (0 : 0 : 1). It corresponds to the “vertical direction” in
A
2
, which is the direction in which the parabola x2 = x
2
1
goes off to infinity (at both ends
actually).
For X˜
2, the added points have again x0 = 0. This means that x1x2 = 0, which yields the
two points (0 : 1 : 0) and (0 : 0 : 1) in P
2
: we added two points at infinity, one corresponding
to the “horizontal” and one to the “vertical” direction in A
2
. This is clear from the picture
below as the hyperbola x1x2 = 1 extends to infinity both along the x1 and the x2 axis.
x 1
x 2 X1
x 1
x 2
X2
Note that the equations of X˜
1 and X˜
2 are exactly the same, up to a permutation of the
coordinates. Even if we have not given projective varieties the structure of varieties yet,
it should be obvious that X˜
1 and X˜
2 will be isomorphic varieties, with the isomorphism
being given by exchanging x0 and x1. Hence we see that the two distinct types of conics
in A
2 become the same in projective space: there is only one projective conic in P
2 up to
isomorphism. The difference in the affine case comes from the fact that some conics “meet
infinity” in one point (like X1), and some in two (like X2).
Proposition 3.1.14.
(i) If I1 ⊂ I2 are homogeneous ideals in k[x0,..., xn] then Z(I2) ⊂ Z(I1).
(ii) If {Ii} is a family of homogeneous ideals in k[x0,..., xn] then T
i Z(Ii) = Z(
S
i
Ii) ⊂
P
n
.
(iii) If I1,I2 ⊂ k[x0,..., xn] are homogeneous ideals then Z(I1)∪Z(I2) = Z(I1I2) ⊂ P
n
.
3. Projective varieties 39
In particular, arbitrary intersections and finite unions of algebraic sets are again algebraic
sets.
Proof. The proof is the same as in the affine case (proposition 1.1.6).
Definition 3.1.15. We define the Zariski topology on P
n
to be the topology whose closed
sets are the algebraic sets (proposition 3.1.14 tells us that this gives in fact a topology).
Moreover, any subset X of P
n
(in particular any algebraic set) will be equipped with the
topology induced by the Zariski topology on P
n
. This will be called the Zariski topology
on X.
Remark 3.1.16. The concepts of irreducibility and dimension introduced in section 1.3 are
purely topological ones, so they apply to projective algebraic sets (or more generally to
any subset of P
n
) as well. They have the same geometric interpretation as in the affine
case. Irreducible algebraic sets in P
n
are called projective varieties. As in the affine case
(see lemma 1.3.4) a projective algebraic set X is irreducible if and only if its ideal I(X) is
a prime ideal. In particular, P
n
itself is irreducible.
3.2. Cones and the projective Nullstellensatz. We will now establish a correspondence
between algebraic sets in P
n
and homogeneous radical ideals in k[x0,..., xn], similar to
the affine case. This is quite straightforward; the only twist is that there is no zero point
(0 : ··· : 0) in P
n
, and so the zero locus of the radical homogeneous ideal (x0,..., xn) is
empty although the ideal is not equal to (1). So we will have to exclude this ideal from our
correspondence, which is why it is sometimes called the irrelevant ideal.
As we want to use the results of the affine case for the proof of this statement, let us first
establish a connection between projective algebraic sets in P
n
and certain affine algebraic
sets in A
n+1
.
Definition 3.2.1. An affine algebraic set X ⊂ A
n+1
is called a cone if it is not empty, and
if we have for all λ ∈ k
(x0,..., xn) ∈ X ⇒ (λx0,...,λxn) ∈ X.
If X ⊂ P
n
is a projective algebraic set, then
C(X) := {(x0,..., xn)|(x0 : ··· : xn) ∈ X} ∪ {0}
is called the cone over X (obviously this is a cone).
Remark 3.2.2. In other words, a cone is an algebraic set in A
n+1
that can be written
as a (usually infinite) union of lines through the origin. The cone over a projective algebraic set X ⊂ P
n
is the inverse image of X under the projection map A
n+1\{0} →
(A
n+1\{0})/(k\{0}) = P
n
, together with the origin.
Example 3.2.3. The following picture shows an example of a (two-dimensional) cone
C(X) in A
3 over the (one-dimensional) projective variety X in H = P
2
:
x0
L1
L2
/A3
H
X
C(X)
40 Andreas Gathmann
(C(X) consists only of the “boundary” of the cone, not of the “interior”.) Note that C(X)
contains the two lines L1 and L2, which correspond to “points at infinity” of the projective
space P
2
.
Lemma 3.2.4.
(i) Let I ( k[x0,..., xn] be a homogeneous ideal. If X = Zp(I) ⊂ P
n
, then C(X) =
Za(I) ⊂ A
n+1
.
(ii) Conversely, if X ⊂ P
n
is a projective algebraic set and I(X) ⊂ k[x0,..., xn] is its
homogeneous ideal, then I(C(X)) = I(X).
In other words, there is a one-to-one correspondence between projective algebraic sets in
P
n and affine cones in A
n+1
, given by taking the zero locus of the same homogeneous ideal
(not equal to (1)) either in P
n or in A
n+1
.
Proof. This is obvious from the definitions.
Using this lemma, it is now very simple to derive a projective version of the Nullstellensatz:
Proposition 3.2.5. (“The projective Nullstellensatz”)
(i) If X1 ⊂ X2 are algebraic sets in P
n
then I(X2) ⊂ I(X1).
(ii) For any algebraic set X ⊂ P
n we have Zp(I(X)) = X.
(iii) For any homogeneous ideal I ⊂ k[x0,..., xn] such that Zp(I) is not empty we have
I(Zp(I)) = √
I.
(iv) For any homogeneous ideal I ⊂ k[x0,..., xn] such that Zp(I) is empty we have
either I = (1) or √
I = (x0,..., xn). In other words, Zp(I) is empty if and only if
(x0,..., xn)
r ⊂ I for some r.
Proof. The proofs of (i) and (ii) are literally the same as in the affine case, see proposition
1.2.9.
(iii): Let X = Zp(I). Then
I(Zp(I)) = I(X) = I(C(X)) = I(Za(I)) = √
I
by lemma 3.2.4 and the affine Nullstellensatz of proposition 1.2.9 (iii).
(iv): If Zp(I) is empty, then Za(I) is either empty or just the origin. So corollary 1.2.10
tells us that I = (1) or √
I = (x0,..., xn). In any case, this means that x
ki
i ∈ I for some ki
, so
(x0,..., xn)
k0+···+kn ⊂ I.
Theorem 3.2.6. There is a one-to-one inclusion-reversing correspondence between algebraic sets in P
n and homogeneous radical ideals in k[x0,..., xn] not equal to (x0,..., xn),
given by the operations Z(·) and I(·).
Proof. Immediately from proposition 3.2.5.
3.3. Projective varieties as ringed spaces. So far we have defined projective varieties
as topological spaces. Of course we want to make them into ringed spaces and finally
show that they are varieties in the sense of definitions 2.4.1 and 2.5.1. So let X ⊂ P
n be a
projective variety. First of all we have to make X into a ringed space whose structure sheaf
is a sheaf of k-valued functions. The construction is completely analogous to the affine
case discussed in section 2.1.
Definition 3.3.1. The ring
S(X) := k[x0,..., xn]/I(X)
is called the homogeneous coordinate ring of X.
3. Projective varieties 41
Remark 3.3.2. In contrast to the affine case, the elements of S(X) do not define functions
on X, because the homogeneous coordinates are only determined up to a common scalar.
Rather, to get well-defined functions, we have to take quotients of two homogeneous polynomials of the same degree d, because then a rescaling of the homogeneous coordinates by
a factor λ ∈ k\{0} gives a factor of λ
d
in both the numerator and denominator, so that it
cancels out:
Definition 3.3.3. Let
S(X)
(d)
:= { f
(d)
; f ∈ S(X)}
be the degree-d part of S(X). Note that this is well-defined: if f ∈ I(X) then f
(d) = 0 by
lemma 3.1.8. We define the field of rational functions to be
K(X) :=

f
g
; f,g ∈ S(X)
(d)
and g 6= 0

.
By remark 3.3.2, the elements of K(X) give set-theoretic functions to the ground field k
wherever the denominator is non-zero. Now as in the affine case set
OX,P :=

f
g
∈ K(X) ; g(P) 6= 0

and OX (U) :=
\
P∈U
OX,P
for P ∈ X and U ⊂ X open. It is easily seen that this is a sheaf of k-valued functions.
Remark 3.3.4. In the same way as for affine varieties (see exercise 2.6.9) one can show
that the function field K(X) defined above agrees with the definition for general varieties.
Remark 3.3.5. Note that OX (X) = k, i. e. every regular function on all of X is constant. This
follows trivially from the description of K(X): if the function is to be defined everywhere
g must be a constant. But then f has to be a constant too as it must have the same degree
as g. A (slight) generalization of this will be proved in corollary 3.4.10.
Proposition 3.3.6. Let X be a projective variety. Then (X,OX ) is a prevariety.
Proof. We need to find an open affine cover of X. Consider the open subset
X0 = {(a0 : ··· : an) ∈ X ; a0 6= 0} = X ∩A
n
(where A
n ⊂ P
n
as in remark 3.1.4). If X = Z(f1,..., fr) with fi ∈ k[x0,..., xn] homogeneous, set gi(x1,..., xn) = fi(1, x1,..., xn) ∈ k[x1,..., xn] and define Y = Z(g1,...,gr) ⊂ A
n
.
We claim that there is an isomorphism
F : X ∩A
n → Y, (a0 : ··· : an) 7→

a1
a0
,...,
an
a0

.
In fact, it is obvious that a set-theoretic inverse is given by
F
−1
: Y → X ∩A
n
, (a1,...,an) 7→ (1 : a1 : ··· : an).
Moreover, F is a morphism because it pulls back a regular function on (an open subset of)
Y of the form
p(a1,...,an)
q(a1,...,an)
to
p(
a1
a0
,...,
an
a0
)
q(
a1
a0
,...,
an
a0
)
,
which is a regular function on X ∩ A
n
as it can be rewritten as a quotient of two homogeneous polynomials of the same degree (by canceling the fractions in the numerator and
denominator). In the same way, F
−1 pulls back a regular function on (an open subset of)
X ∩A
n
p(a0,...,an)
q(a0,...,an)
to
p(1,a1,...,an)
q(1,a1,...,an)
,
which is a regular function on Y. So F is an isomorphism.
42 Andreas Gathmann
In the same way we can do this for the open sets Xi = {(x0 : ··· : xn) ∈ X ; xi 6= 0} for
i = 0,...,n. As the xi cannot be simultaneously zero, it follows that the Xi form an affine
cover of X. So X is a prevariety.
Remark 3.3.7. Following the proof of proposition 3.3.6, it is easy to see that our “new”
definition of P
1
agrees with the “old” definition of example 2.4.5 (i) by glueing two affine
lines A
1
.
Remark 3.3.8. Proposition 3.3.6 implies that all our constructions and results for prevarieties apply to projective varieties as well. For example, we know what morphisms are,
and have defined products of projective varieties. We have also defined the field of rational
functions for prevarieties in exercise 2.6.9; it is easy to check that this definition agrees
with the one in definition 3.3.3.
Although this gives us the definition of morphisms and products, we would still have to
apply our glueing techniques to write down a morphism or a product. So we should find a
better description for morphisms and products involving projective varieties:
Lemma 3.3.9. Let X ⊂ P
n be a projective variety (or an open subset of a projective variety). Let f1,..., fm ∈ k[x0,..., xn] be homogeneous polynomials of the same degree in the
homogeneous coordinates of P
n
, and assume that for every P ∈ X at least one of the fi does
not vanish at P. Then the fi define a morphism
f : X → P
m
, P ∈ X 7→ (f0(P) : ··· : fm(P)).
Proof. First of all note that f is well-defined set-theoretically: we have assumed that the
image point can never be (0 : ··· : 0); and if we rescale the homogeneous coordinates xi we
get
(f0(λx0 : ··· : λxn) : ··· : fm(λx0 : ··· : λxn))
= (λ
d
f0(x0 : ··· : xn) : ··· : λ
d
fm(x0 : ··· : xn))
= (f0(x0 : ··· : xn) : ··· : fm(x0 : ··· : xn)),
where d is the common degree of the fi
. To check that f is a morphism, we want to use
lemma 2.4.10, i. e. check the condition on an affine open cover. So let {Vi} be the affine
open cover of P
m with Vi = {(y0 : ··· : ym); yi 6= 0}, and let Ui = f
−1
(Vi). Then in the affine
coordinates on Vi
the map f |Ui
is given by the quotients of polynomials f j
fi
for j = 0,...,m
with j 6= i, hence gives a morphism as fi(P) 6= 0 on Ui
. So f is a morphism by lemma
2.4.10.
Remark 3.3.10. It should be noted however that not every morphism between projective
varieties can be written in this form. The following example shows that this occurs already
in quite simple cases. For a more precise statement see lemma 7.5.14.
Example 3.3.11. By lemma 3.3.9, the map
f : P
1
7→ P
2
, (s : t) 7→ (x : y : z) = (s
2
: st : t
2
)
is a morphism (as we must have s 6= 0 or t 6= 0 for every point of P
1
, it follows that s
2 6= 0
or t
2 6= 0; hence the image point is always well-defined).
Let X = f(P
1
) be the image of f . We claim that X is a projective variety with ideal
I = (xz−y
2
). In fact, it is obvious that f(P
1
) ⊂ Z(I). Conversely, let P = (x : y : z) ∈ Z(I).
As xz−y
2 = 0 we must have x 6= 0 or z 6= 0; let us assume without loss of generality that
x 6= 0. Then (x : y) ∈ P
1
is a point that maps to (x
2
: xy : y
2
) = (x
2
: xy : xz) = (x : y : z).
It is now easy to show that f : P
1 → X is in fact an isomorphism: the inverse image
f
−1
: X → P
1
is given by
f
−1
(x : y : z) = (x : y) and f
−1
(x : y : z) = (y : z).
3. Projective varieties 43
Note that at least one of the two points (x : y) and (y : z) is always well-defined; and if they
are both defined they agree because of the equation xz = y
2
. By lemma 3.3.9 both equations
determine a morphism where they are well-defined; so by lemma 2.4.10 they glue to give
an inverse morphism f
−1
. Note that f
−1
is a (quite simple) morphism between projective
varieties that cannot be written globally in the form of lemma 3.3.9.
Summarizing, we have shown that f is an isomorphism: the curve {xz = y
2} ⊂ P
2
is
isomorphic to P
1
. This example should be compared to exercise 2.6.1 and example 3.1.13.
It is a special case of the Veronese embedding of 3.4.11.
Finally, let us analyze the isomorphism f geometrically. Let Q = (1 : 0 : 0) ∈ X, and
let L ⊂ P
2 be the line {x = 0}. For any point P = (a : b : c) 6= Q there is a unique line PQ
through P and Q with equation yc = zb. This line has a unique intersection point PQ ∩L
with the line L, namely (0 : b : c). If we identify L with P
1
in the obvious way, we see that
the above geometric construction gives us exactly f
−1
(P) = PQ ∩L. We say that f
−1
is
the projection from Q to L.
f
−1 P)(
L
Q
P
X
Example 3.3.12. Consider P
n with homogeneous coordinates x0,..., xn, and P
m with homogeneous coordinates y0,..., ym. We want to find an easy description of the product
P
n ×P
m.
Let P
N = P
(n+1)(m+1)−1 be projective space with homogeneous coordinates zi, j
, 0 ≤ i ≤
n, 0 ≤ j ≤ m. There is an obviously well-defined set-theoretic map f : P
n ×P
m → P
N given
by zi, j = xiyj
.
Lemma 3.3.13. Let f : P
n ×P
m → P
N be the set-theoretic map as above. Then:
(i) The image X = f(P
n ×P
m) is a projective variety in P
N, with ideal generated by
the homogeneous polynomials zi, jzi
0
, j
0 −zi, j
0zi
0
, j
for all 0 ≤ i,i
0 ≤ n and 0 ≤ j, j
0 ≤
m.
(ii) The map f : P
n×P
m → X is an isomorphism. In particular, P
n×P
m is a projective
variety.
(iii) The closed subsets of P
n × P
m are exactly those subsets that can be written as
the zero locus of polynomials in k[x0,..., xn, y0,..., ym] that are bihomogeneous
in the xi and yi
.
The map f is called the Segre embedding.
Proof. (i): It is obvious that the points of f(P
n × P
m) satisfy the given equations. Conversely, let P be a point in P
N with coordinates zi, j
that satisfy the given equations. At least
one of these coordinates must be non-zero; we can assume without loss of generality that
it is z0,0. Let us pass to affine coordinates by setting z0,0 = 1. Then we have zi, j = zi,0z0, j
;
so by setting xi = zi,0 and yj = z0, j we obtain a point of P
n ×P
m that is mapped to P by f .
(ii): Continuing the above notation, let P ∈ f(P
n × P
m) be a point with z0,0 = 1. If
f(xi
, yj) = P, it follows that x0 6= 0 and y0 6= 0, so we can assume x0 = 1 and y0 = 1 as the
xi and yj are only determined up to a common scalar. But then it follows that xi = zi,0 and
yj = z0, j
; i. e. f is bijective.
44 Andreas Gathmann
The same calculation shows that f and f
−1
are given (locally in affine coordinates) by
polynomial maps; so f is an isomorphism.
(iii): It follows by the isomorphism of (ii) that any closed subset of P
n ×P
m is the zero
locus of homogeneous polynomials in the zi, j
, i. e. of bihomogeneous polynomials in the xi
and yj (of the same degree). Conversely, a zero locus of bihomogeneous polynomials can
always be rewritten as a zero locus of bihomogeneous polynomials of the same degree in
the xi and yi by remark 3.1.11. But such a polynomial is obviously a polynomial in the zi, j
,
so it determines an algebraic set in X ∼= P
n ×P
m.
Example 3.3.14. By lemma 3.3.13, P
1 ×P
1
is (isomorphic to) the quadric surface
X = {(z0,0 : z0,1 : z1,0 : z1,1) ; z0,0z1,1 = z1,0z0,1} ⊂ P
3
.
by the isomorphism
P
1 ×P
1 → X, ((x0 : x1),(y0 : y1)) 7→ (x0y0 : x0y1 : x1y0 : x1y1).
In particular, the “lines” P
1 × P and P × P
1
in P
1 × P
1 where the first or second factor is
constant are mapped to lines in X ⊂ P
3
. We can see these two families of lines on the
quadric surface X:
PI
1
PI
1
≅ P
3 X in I
Corollary 3.3.15. Every projective variety is a variety.
Proof. We have already seen in proposition 3.3.6 that every projective variety is a prevariety, so by lemma 2.5.3 and lemma 2.5.4 it only remains to be shown that the diagonal
∆(P
n
) ⊂ P
n ×P
n
is closed. We can describe this diagonal as
∆(P
n
) = {((x0 : ··· : xn),(y0 : ··· : yn)) ; xiyj −xjyi = 0 for all i, j},
because these equations mean exactly that the matrix

x0 x1 ··· xn
y0 y1 ··· yn

has rank (at most 1), i. e. that (x0 : ··· : xn) = (y0 : ··· : yn).
In particular, it follows by lemma 3.3.13 (iii) that ∆(P
n
) ⊂ P
n ×P
n
is closed.
3.4. The main theorem on projective varieties. The most important property of projective varieties is that they are compact in the classical topology (if the ground field is k = C).
We have seen this already for projective spaces in remark 3.1.5, and it then follows for projective algebraic sets as well as they are closed subsets (even in the classical topology) of
the compact projective spaces. Unfortunately, the standard definition of compactness does
not make sense at all in the Zariski topology, so we need to find an alternative description.
One property of compact sets is that they are mapped to compact sets under continuous maps. In our language, this would mean that images of projective varieties under a
morphism should be closed. This is what we want to prove.
3. Projective varieties 45
Remark 3.4.1. Note first that this property definitely does not hold for affine varieties:
consider e. g. the affine variety X = {(x, y) ; xy = 1} ⊂ A
2
and the projection morphism
f : X → A
1
, (x, y) 7→ x. The image of f is A
1\{0}, which is not closed in A
1
. In fact, we
can see from example 3.1.13 why it is not closed: the “vertical point at infinity”, which
would map to x = 0 ∈ A
1
and make the image closed, is missing in the affine variety X.
x
y
X
f ( ) X = A1
\{0}
To prove the above mentioned statement we start with a special case (from which the
general one will follow easily).
Theorem 3.4.2. The projection map π : P
n × P
m → P
n
is closed, i. e. if X ⊂ P
n × P
m is
closed then so is π(X).
Proof. Let X ⊂ P
n ×P
m be an algebraic set. By lemma 3.3.13 (iii) we can write X as the
zero locus of polynomials f1(x, y),..., fr(x, y) bihomogeneous in the coordinates xi of P
n
and yi of P
m (where we use the short-hand notation fi(x, y) for fi(x0,..., xn, y0,..., ym)).
By remark 3.1.11 we may assume that all fi have the same degree d in the yi
.
Let P ∈ P
n be a fixed point. Then P ∈ π(X) if and only if the common zero locus of the
polynomials fi(P, y) in y is non-empty in P
m, which by proposition 3.2.5 is the case if and
only if
(y0,..., ym)
s
6⊂ (f1(P, y),..., fr(P, y)) (∗)
for all s ≥ 0. As (∗) is obvious for s < d, it suffices to show that for any s ≥ d, the set of all
P ∈ P
n
satisfying (∗) is closed, as π(X) will then be the intersection of all these sets and
therefore closed as well.
Note that the ideal (y0,..., ym)
s
is generated by the m+s
m

monomials of degree s in the
yi
, which we denote by Mi(y) (in any order). Hence (∗) is not satisfied if and only if there
are polynomials gi, j(y) such that Mi(y) = ∑j gi, j(y)fj(P, y) for all i. As the Mi and fj are
homogeneous of degree s and d, respectively, this is the same as saying that such relations
exist with the gi, j homogeneous of degree s−d. But if we let Ni(y) be the collection of all
monomials in the yi of degree s−d, this is in turn equivalent to saying that the collection
of polynomials {Ni(y)fj(P, y) ; 1 ≤ i ≤
m+s−d
m

,1 ≤ j ≤ r} generates the whole vector
space of polynomials of degree s. Writing the coefficients of these polynomials in a matrix
A = As(P), this amounts to saying that A has rank (at least) m+s
m

. Hence (∗) is satisfied
if and only if all minors of A of size m+s
m

vanish. But as the entries of the matrix A are
homogeneous polynomials in the coefficients of P, it follows that the set of all P satisfying
(∗) is closed.
Remark 3.4.3. Let us look at theorem 3.4.2 from an algebraic viewpoint. We start with
some equations fi(x, y) and ask for the image of the projection map (x, y) 7→ x, which can
be written as
{x ; there is a y such that fi(x, y) = 0 for all
46 Andreas Gathmann
In other words, we are trying to eliminate the variables y from the system of equations
fi(x, y) = 0. The statement of the theorem is that the set of all such x can itself be written as
the solution set of some polynomial equations. This is sometimes called the main theorem
of elimination theory.
Corollary 3.4.4. The projection map π : P
n ×Y → Y is closed for any variety Y .
Proof. Let us first show the statement for Y ⊂ A
m being an affine variety. Then we can
regard Y as a subspace of P
m via the embedding A
m ⊂ P
m (Y is neither open nor closed
in P
m, but that does not matter). Now if Z ⊂ P
n ×Y is closed, let Z˜ ⊂ P
n × P
m be the
projective closure. By theorem 3.4.2, π(Z˜) is closed in P
m, where π is the projection
morphism. Therefore
π(Z) = π(Z˜ ∩(P
n ×Y)) = π(Z˜)∩Y
is closed in Y.
If Y is any variety we can cover it by affine open subsets. As the condition that a
subset is closed can be checked by restricting it to the elements of an open cover, the
statement follows from the corresponding one for the affine open patches that we have just
shown.
Remark 3.4.5. Corollary 3.4.4 is in fact the property of P
n
that captures the idea of compactness (as we will see in corollary 3.4.7). Let us therefore give it a name: we say that a
variety X is complete if the projection map π : X ×Y → Y is closed for every variety Y.
(You can think of the name “complete” as coming from the geometric idea that it contains
all the “points at infinity” that were missing in affine varieties.) So corollary 3.4.4 says that
P
n
is complete. Moreover, any projective variety Z ⊂ P
n
is complete, because any closed
set in Z ×Y is also closed in P
n ×Y, so its image under the projection morphism to Y will
be closed as well.
Remark 3.4.6. We have just seen that every projective variety is complete. In fact, whereas
the converse of this statement is not true, it is quite hard to write down an example of a
complete variety that is not projective. We will certainly not meet such an example in the
near future. So for practical purposes you can usually assume that the terms “projective
variety” and “complete variety” are synonymous.
Corollary 3.4.7. Let f : X →Y be a morphism of varieties, and assume that X is complete.
Then the image f(X) ⊂ Y is closed.
Proof. We factor f as f : X
Γ
→ X ×Y
π→ Y, where Γ = (idX , f) (the so-called graph morphism), and π is the projection to Y.
We claim that Γ(X) = {(P, f(P)) ; P ∈ X} ⊂ X ×Y is closed. To see this, note first that
the diagonal ∆(Y) ⊂ Y ×Y is closed as Y is a variety. Now Γ(X) is just the inverse image
of ∆(Y) under the morphism (f,idY ) : X ×Y → Y ×Y, and is therefore also closed.
As X is complete, it follows that f(X) = π(Γ(X)) is closed.
Corollary 3.4.8. Let X ⊂ P
n be a projective variety that contains more than one point, and
let f ∈ k[x0,..., xn] be a non-constant homogeneous polynomial. Then X ∩Z(f) 6= 0/.
Proof. Assume that the statement is false, i. e. that f is non-zero on all of X. Let P,Q ∈ X
be two distinct points of X and choose a homogeneous polynomial g ∈ k[x0,..., xn] of the
same degree as f such that g(P) = 0 and g(Q) 6= 0. Let F : X → P
1 be the morphism
defined by R 7→ (f(R) : g(R)); this is well-defined as f is non-zero on X by assumption.
By corollary 3.4.7 the image F(X) is closed in P
1
. Moreover, F(X) is irreducible as X
is. Therefore, F(X) is either a point or all of P
1
. But by assumption (0 : 1) ∈/ F(X), so
F(X) must be a single point. But this is a contradiction, as F(P) = (f(P) : g(P)) = (1 : 0)
and F(Q) = (f(Q) : g(Q)) 6= (1 : 0) by the choice of g. 
3. Projective varieties 47
Remark 3.4.9. Again this statement is false for affine varieties: consider e. g. X = {x =
0} ⊂ A
2
and f = x − 1, then X ∩ Z(f) = 0/ although X is a line (and therefore contains
more than one point). This example worked because in A
2 we can have parallel lines. In
P
2
such lines would meet at infinity, so the intersection would be non-empty then.
Corollary 3.4.10. Every regular function on a complete variety is constant.
Proof. Let f : X → A
1 be a regular function on a complete variety X. Consider f as a
morphism to P
1
that does not assume the value ∞. In particular, f(X) ( P1
, hence it is a
single point by corollary 3.4.7.
Example 3.4.11. (This is a generalization of example 3.3.11 and exercise 3.5.2.) Let
fi(x0,..., xn),0 ≤ i ≤ N =

n+d
n

−1 be the set of all monomials in k[x0,..., xn] of degree
d, i. e. of the monomials of the form x
i0
0
··· x
in
n with i0 +···+in = d. Consider the map
F : P
n → P
N
, (x0 : ··· : xn) 7→ (f0 : ··· : fN).
By lemma 3.3.9 this is a morphism (note that the monomials x
d
0
,..., x
d
n
, which cannot be
simultaneously zero, are among the fi). So by corollary 3.4.7 the image X = F(P
n
) is a
projective variety.
We claim that F : X → F(X) is an isomorphism. All we have to do to prove this is to
find an inverse morphism. This is not hard: we can do this on an affine open cover, so
let us consider the open subset where x0 6= 0 (and therefore x
d
0
6= 0). We can then pass to
affine coordinates and set x0 = 1. The inverse morphism is then given by xi =
xix
d−1
0
x
d
0
for
1 ≤ 1 ≤ n.
The morphism F is therefore an isomorphism and thus realizes P
n
as a subvariety of P
N.
This is usually called the degree-d Veronese embedding. Its importance lies in the fact
that degree-d polynomials in the coordinates of P
n
are translated into linear polynomials
when viewing P
n
as a subvariety of P
N. An example of this application will be given in
corollary 3.4.12.
The easiest examples are the degree-d embeddings of P
1
, given by
P
1 → P
d
, (s : t) 7→ (s
d
: s
d−1
t : s
d−2
t
2
: ··· : t
d
).
The special cases d = 2 and d = 3 are considered in example 3.3.11 and exercise 3.5.2.
Note that by applying corollary 3.4.7 we could conclude that F(X) is a projective variety
without writing down its equations. Of course, in theory we could also write down the
equations, but this is quite messy in this case.
Corollary 3.4.12. Let X ⊂ P
n be a projective variety, and let f ∈ k[x0,..., xn] be a nonconstant homogeneous polynomial. Then X\Z(f) is an affine variety.
Proof. We know this already if f is a linear polynomial (see the proof of proposition 3.3.6).
But by applying a Veronese embedding of degree d, we can always assume this.
3.5. Exercises.
Exercise 3.5.1. Let L1 and L2 be two disjoint lines in P
3
, and let P ∈ P
3\(L1 ∪L2) be a
point. Show that there is a unique line L ⊂ P
3 meeting L1, L2, and P (i. e. such that P ∈ L
and L∩Li 6= 0/ for i = 1,2).
Exercise 3.5.2. Let C ⊂ P
3 be the “twisted cubic curve” given by the parametrization
P
1 → P
3
(s : t) 7→ (x : y : z : w) = (s
3
: s
2
t : st2
: t
3
).
Let P = (0 : 0 : 1 : 0) ∈ P
3
, and let H be the hyperplane defined by z = 0. Let ϕ be the
projection from P to H, i. e. the map associating to a point Q of C the intersection point of
the unique line through P and Q with H
48 Andreas Gathmann
(i) Show that ϕ is a morphism.
(ii) Determine the equation of the curve ϕ(C) in H ∼= P
2
.
(iii) Is ϕ : C → ϕ(C) an isomorphism onto its image?
Exercise 3.5.3. Let I ⊂ k[x1,..., xn] be an ideal. Define I
h
to be the ideal generated by
{ f
h
; f ∈ I} ⊂ k[x0,..., xn], where
f
h
(x0,..., xn) := x
deg(f)
0
· f

x1
x0
,...,
xn
x0

denotes the homogenization of f with respect to x0. Show that:
(i) I
h
is a homogeneous ideal.
(ii) Z(I
h
) ⊂ P
n
is the closure of Z(I) ⊂ A
n
in P
n
. We call Z(I
h
) the projective closure
of Z(I).
(iii) Let I = (f1,..., fk). Show by an example that I
h 6= (f
h
1
,..., f
h
k
) in general. (Hint:
You may consider (again) the twisted cubic curve of exercise 3.5.2.)
Exercise 3.5.4. In this exercise we will make the space of all lines in P
n
into a projective
variety.
Fix n ≥ 1. We define a set-theoretic map
ϕ : {lines in P
n} → P
N
with N =

n+1
2

− 1 as follows. For every line L ⊂ P
n
choose two distinct points P =
(a0 : ··· : an) and Q = (b0 : ··· : bn) on L and define ϕ(L) to be the point in P
N whose
homogeneous coordinates are the
n+1
2

maximal minors of the matrix

a0 ··· an
b0 ··· bn

,
in any fixed order. Show that:
(i) The map ϕ is well-defined and injective.
(ii) The image of ϕ is a projective variety that has a finite cover by affine spaces
A
2(n−1)
(in particular, its dimension is 2(n − 1)). It is called the Grassmannian
G(1,n). Hint: recall that by the Gaussian algorithm most matrices (what does this
mean?) are equivalent to one of the form

1 0 a
0
2
··· a
0
n
0 1 b
0
2
··· b
0
n

for some a
0
i
,b
0
i
.
(iii) G(1,1) is a point, G(1,2) ∼= P
2
, and G(1,3) is the zero locus of a quadratic equation in P
5
.
Exercise 3.5.5. Let V be the vector space over k of homogeneous degree-2 polynomials in
three variables x0, x1, x2, and let P(V) ∼= P
5 be its projectivization.
(i) Show that the space of conics in P
2
can be identified with an open subset U
of P
5
. (One says that U is a “moduli space” for conics in P
2
and that P
5
is a
“compactified moduli space”.) What geometric objects can be associated to the
points in P
5\U?
(ii) Show that it is a linear condition in P
5
for the conics to pass through a given point
in P
2
. More precisely, if P ∈ P
2
is a point, show that there is a linear subspace
L ⊂ P
5
such that the conics passing through P are exactly those in U ∩L. What
happens in P
5\U, i. e. what do the points in (P
5\U)∩L correspond to?
(iii) Prove that there is a unique conic through any five given points in P
2
, as long as
no three of them lie on a line. What happens if three of them do lie on a lin
3. Projective varieties 49
Exercise 3.5.6. Show that an affine variety over C is never compact in the classical topology unless it is a single point. (Hint: Given an affine variety X ⊂ A
n
, show that the image
of X under the projection map A
n → A
1 onto the first coordinate is either a point or an open
subset (in the Zariski topology) of A
1
. Conclude that an affine variety with more than one
point is never bounded, i. e. is never contained in a ball {(z1,...,zn) ; |z1|
2 +···+|zn|
2 ≤
R
2} ⊂ C
n
, and therefore not compact.)
Exercise 3.5.7. Let G(1,n) be the Grassmannian of lines in P
n
as in exercise 3.5.4. Show
that:
(i) The set {(L,P) ; P ∈ L} ⊂ G(1,n)×P
n
is closed.
(ii) If Z ⊂ G(1,n) is any closed subset then the union of all lines L ⊂ P
n
such that
L ∈ Z is closed in P
n
.
(iii) Let X,Y ⊂ P
n be disjoint projective varieties. Then the union of all lines in P
n
intersecting X and Y is a closed subset of P
n
. It is called the join J(X,Y) of X
and Y.
Exercise 3.5.8. Recall that a conic is a curve in P
2
that can be given as the zero locus of
an irreducible homogeneous polynomial f ∈ k[x0, x1, x2] of degree 2. Show that for any 5
given points P1,...,P5 ∈ P
2
in general position, there is a unique conic passing through all
the Pi
. This means: there is a non-empty open subset U ⊂ P
2 × ··· × P
2
such that there
is a unique conic through the Pi whenever (P1,...,P5) ∈ U. (Hint: By mapping a conic
{a0x
2
0 +a1x
2
1 +a2x
2
2 +a3x0x1 +a4x0x2 +a5x1x2 = 0} to the point (a0 : ··· : a5) ∈ P
5
, you
can think of “the space of all conics” as an open subset of P
5
.)
50 Andreas Gathmann
4. DIMENSION
We have already introduced the concept of dimension of a variety. Now we develop
some methods that allow to compute the dimension of most varieties rigorously. We
show that the dimension of A
n
and P
n
is n. The dimension of a variety equals the
dimension of any of its non-empty open subsets. Every irreducible component of
the zero locus of a single function on an affine or projective variety X has dimension
dimX −1.
Two varieties are called birational if they contain isomorphic open subsets. As a
large class of examples of birational varieties we construct the blow-up of an affine
variety in a subvariety or an ideal. We study in detail the case of blowing up a single
point P in a variety X. In this case, the exceptional hypersurface is the tangent cone
CX,P.
For any point P in a variety X, the tangent space TX,P is the linear space dual to
M/M2
, where M ⊂ OX,P is the maximal ideal. The point P is called a smooth point
of X if TX,P = CX,P, i. e. if X “can be approximated linearly” around P. Smoothness
can easily be checked by the Jacobi criterion.
As an application of the theory developed so far, we show that every smooth cubic
surface X has exactly 27 lines on it. We study the configuration of these lines, and
show that X is isomorphic to P
2 blown up in 6 suitably chosen points.
4.1. The dimension of projective varieties. Recall that in section 1.3 we have introduced
the notion of dimension for every (Noetherian) topological space, in particular for every
variety X: the dimension dimX of X is the largest integer n such that there is a chain of
irreducible closed subsets of X
0/ 6= X0 ( X1 ( ··· ( Xn = X.
For simplicity of notation, in what follows we will call this a longest chain in X.
While this definition is quite simple to write down, it is very difficult to use in practice.
In fact, we have not even been able yet to compute the dimensions of quite simple varieties
like A
n or P
n
(although it is intuitively clear that these spaces should have dimension n).
In this section, we will develop techniques that allow us to compute the dimensions of
varieties rigorously.
Remark 4.1.1. We will start our dimension computations by considering projective varieties. It should be said clearly that the theory of dimension is in no way special or easier
for projective varieties than it is for other varieties — in fact, it should be intuitively clear
that the dimension of a variety is essentially a local concept that can be computed in the
neighborhood of any point. The reason for us to start with projective varieties is simply
that we know more about them: the main theorem on projective varieties and its corollaries of section 3.4 are so strong that they allow for quite efficient applications in dimension
theory. One could as well start by looking at the dimensions of affine varieties (and most
textbooks will do so), but this requires quite some background in (commutative) algebra
that we do not have yet.
Remark 4.1.2. The main idea for our dimension computations is to compare the dimensions
of varieties that are related by morphisms with various properties. For example, if f :
X → Y is a surjective morphism, we would expect that dimX ≥ dimY. If f : X → Y is a
morphism with finite fibers, i. e. such that f
−1
(P) is a finite set for all P ∈ Y, we would
expect that dimX ≤ dimY. In particular, if a morphism both is surjective and has finite
fibers, we expect that dimX = dimY.
Example 4.1.3. The standard case in which we will prove and apply the idea of comparing
dimensions is the case of projections from a point. We have already seen such projections
in example 3.3.11 and exercise 3.5.2; let us now consider the general case.
4. Dimension 51
Let X ( Pn be a projective variety, and let P ∈ P
n be a point that is not in X. By a
change of coordinates we can assume that P = (0 : ··· : 0 : 1). Let H ∼= P
n−1 ⊂ P
n be a
linear subspace of codimension 1 that does not contain P; again by a change of coordinates
we can assume that H = {xn = 0}. We define a projection map π : X → H from P as
follows: for every point Q ∈ X let π(Q) be the intersection point of the line PQ with H.
(Note that this is well-defined as Q 6= P by assumption.)
π ( ) Q
Q
P
H
PI
n
≅ PI
n −1
This is in fact a morphism: if Q = (a0 : ··· : an) ∈ X, the line PQ is given parametrically by
PQ = {(λa0 : ··· : λan−1 : λan +µ) ∈ P
n
; (λ : µ) ∈ P
1
}.
The intersection point of this line with H is obviously the point (a0 : ··· : an−1 : 0), which is
well-defined by the assumption that Q 6= P. Hence the projection π is given in coordinates
by
π : X → P
n−1
, (a0 : ··· : an) 7→ (a0 : ··· : an−1).
In particular, this is a polynomial map and therefore a morphism.
Note that projections always have finite fibers: by construction, the inverse image
π
−1
(Q) of a point Q ∈ H must be contained in the line PQ ∼= P
1
, but it must also be
an algebraic set and cannot contain the point P, hence it must be a finite set.
Note also that we can repeat this process if the image of X is not all of P
n−1
: we can
then project π(X) from a point in P
n−1
to P
n−2
, and so on. After a finite number of such
projections, we arrive at a surjective morphism X → P
m for some m that is the composition
of projections as above. In particular, as this morphism is surjective and has finite fibers,
we expect dimX = m. This is the idea that we will use for our dimension computations.
Let us start with some statements about dimensions that are not only intuitively clear
but actually also easy to prove.
Lemma 4.1.4.
(i) If 0/ 6= X0 ( ··· ( Xn = X is a longest chain in X then dimXi = i for all i.
(ii) If Y ( X is a closed subvariety of the variety X then dimY < dimX.
(iii) Let f : X →Y be a surjective morphism of projective varieties. Then every longest
chain 0/ 6= Y0 ( ··· ( Yn in Y can be lifted to a chain 0/ 6= X0 ( ··· ( Xn in X
(i. e. the Xi are closed and irreducible with f(Xi) = Yi
for all i). In particular,
dimX ≥ dimY .
Proof. (i): It is obvious that dimXi ≥ i. If we had dimXi > i there would be a longer chain
in Xi
than 0/ 6= X0 ( ··· ( Xi
. This chain could then be extended by the Xj for j > i to a
chain in X that is longer than the given one.
(ii): We can extend a longest chain 0/ 6= Y0 ( Y1 ( ··· ( Yn = Y in Y to a chain 0/ 6= Y0 (
Y1 ( ··· ( Yn = Y ( X in X which is one element longer.
(iii): We prove the statement by induction on n = dimY; there is nothing to show if n =
0. Otherwise let Z1,...,Zr ⊂ X be the irreducible components of f
−1
(Yn−1), so that f(Z1)∪
··· ∪ f(Zr) = Yn−1. Note that Yn−1 is irreducible and the f(Zi) are closed by corollary
52 Andreas Gathmann
3.4.7, so one Zi must map surjectively to Yn−1. Applying the induction hypothesis to the
restriction f |Zi
: Zi → Yn−1 we get dimZi ≥ dimYn−1 = n−1, so there is a chain 0/ 6= X0 (
··· ( Xn−1 = Zi
. Extending this chain by X at the end, we thus obtain a chain in X of length
n lying over the given chain in Y.
Lemma 4.1.5. Let X ( Pn be a projective variety, and assume without loss of generality
that P = (0 : ··· : 0 : 1) ∈/ X.
(i) Any homogeneous polynomial f ∈ k[x0,..., xn] satisfies a relation of the form
f
D +a1 f
D−1 +a2 f
D−2 +···+aD = 0 in S(X) = k[x0,..., xn]/I(X)
for some D > 0 and some homogeneous polynomials ai ∈ k[x0,..., xn−1] that do
not depend on the last variable xn.
(ii) Let π : X → P
n−1 be the projection from P as in example 4.1.3. If Y ⊂ X is a
closed subvariety such that π(Y) = π(X) then Y = X.
Remark 4.1.6. Before we prove this lemma let us give the idea behind these statements.
In (i), you should think of f as being a polynomial containing the variable xn, while the
ai do not. So for given values of x0,..., xn−1 the relation in (i) is a non-zero polynomial
equation in xn that therefore allows only finitely many values for xn on X. As the projection
from P is just given by dropping the last coordinate xn, the statement of (i) is just that this
projection map has finite fibers.
We have argued in remark 4.1.1 that we then expect the dimension of π(X) to be less
than or equal to the dimension of X. To show this we will want to take a longest chain in X
and project it down to π(X). It is obvious that the images of the elements of such a chain in
X are again closed subvarieties in π(X), but it is not a priori obvious that a strict inclusion
Xi ( Xi+1 translates into a strict inclusion π(Xi) ( π(Xi+1). This is exactly the statement of
(ii).
Proof. (i): Let d be the degree of f . Consider the morphism
π˜ : X → P
n
, (x0 : ··· : xn) 7→ (y0 : ··· : yn) := (x
d
0
: ··· : x
d
n−1
: f(x0,..., xn))
(which is well-defined since P ∈/ X). The image of π˜ is closed by corollary 3.4.7 and is
therefore the zero locus of some homogeneous polynomials F1,...,Fr ∈ k[y0,..., yn]. Note
that
Z(y0,..., yn−1,F1,...,Fr) = 0/ ⊂ P
n
because the Fi require the point to be in the image π˜(X), while the x0,..., xn−1 do not
vanish simultaneously on X. So by the projective Nullstellensatz of proposition 3.2.5 (iv)
it follows that some power of yn is in the ideal generated by y0,..., yn−1,F1,...,Fr
. In other
words,
y
D
n =
n−1
∑
i=0
gi(y0,..., yn)· yi
in S(π˜(X)) = k[y0,..., yn]/(F1,...,Fr)
for some D. Substituting the definition of π˜ for the yi
thus shows that there is a relation
f
D +a1 f
D−1 +a2 f
D−2 +···+aD = 0 in S(X)
for some homogeneous ai ∈ k[x0,..., xn−1].
(ii): Assume that the statement is false, i. e. that Y ( X. Then we can pick a homogeneous polynomial f ∈ I(Y)\I(X) ⊂ k[x0,..., xn] of some degree d that vanishes on Y but
not on X.
Now pick a relation as in (i) for the smallest possible value of D. In particular we then
have aD 6= 0 in S(X), i. e. aD ∈/ I(X). But we have chosen f such that f ∈ I(Y), therefore
the relation (i) tells us that aD ∈ I(Y) as well.
4. Dimension 53
It follows that aD ∈ I(Y)\I(X). But note that aD ∈ k[x0,..., xn−1], so aD is a function on
P
n−1
that vanishes on π(Y) but not on π(X), in contradiction to the assumption.
Corollary 4.1.7. Let X ( Pn be a projective variety, and assume without loss of generality
that P = (0 : ··· : 0 : 1) ∈/ X. Let π : X → P
n−1 be the projection from P as in example 4.1.3.
Then dimX = dimπ(X).
Proof. Let 0/ 6= X0 ( ··· ( Xr = X be a longest chain in X. Then 0/ 6=Y0 ( ··· (Yr =Y with
Yi = π(Xi) is a chain in π(X): note that the Yi are closed by corollary 3.4.7, irreducible as
they are the images of irreducible sets, and no two of them can coincide by lemma 4.1.5.
It follows that dimπ(X) ≥ dimX. But also dimπ(X) ≤ dimX by lemma 4.1.4 (iii), so the
statement follows.
Corollary 4.1.8. The dimension of P
n
is n.
Proof. By lemma 4.1.4 (ii) we know that
dimP
0 < dimP
1 < dimP
2 < dimP
3 < ··· . (∗)
Moreover, we have seen in example 4.1.3 that every projective variety X can be mapped
surjectively to some P
n by a sequence of projections from points; it then follows that
dimX = dimP
n by corollary 4.1.7. In other words, every dimension that occurs as the
dimension of some projective variety must occur already as the dimension of some projective space. But combining (∗) with lemma 4.1.4 (i) we see that every non-negative integer
occurs as the dimension of some projective variety — and therefore as the dimension of
some projective space. So in (∗) we must have dimP
n = n for all n.
Proposition 4.1.9. Let X ⊂ P
n be a projective variety, and let f ∈ k[x0,..., xn] be a nonconstant homogeneous polynomial that does not vanish identically on X. Then dim(X ∩
Z(f)) = dimX −1.
Remark 4.1.10. Note that in the statement of this proposition X ∩ Z(f) may well be reducible; the statement is then that there is at least one component that has dimension
dimX −1 (and that no component has bigger dimension). We will prove a stronger statement, namely a statement about every component of X ∩Z(f), in corollary 4.2.5.
Proof. Let m = dimX. After applying a Veronese embedding of degree deg f as in example 3.4.11 we can assume that f is linear. Now construct linear functions f0,..., fm and
algebraic sets X0,...,Xm+1 ⊂ X inductively as follows: Let X0 = X and f0 = f . For i ≥ 0
let Xi+1 = Xi ∩Z(fi), and let fi+1 be any linear form such that
(i) fi+1 does not vanish identically on any component of Xi+1, and
(ii) fi+1 is linearly independent from the f1,..., fi
.
It is obvious that (i) can always be satisfied. Moreover, (ii) is automatic if Xi+1 is not empty
(as f1,..., fi vanish on Xi+1), and easy to satisfy otherwise (as then (i) is no condition).
Applying lemma 4.1.4 (ii) inductively, we see that no component of Xi has dimension
bigger than m − i. In particular, Xm+1 must be empty. Hence the linear forms f0,..., fm
do not vanish simultaneously on X; so they define a morphism π : X → P
m. As the fi are
linear and linearly independent, π is up to a change of coordinates the same as fi = xi for
0 ≤ i ≤ m, so it is just a special case of a continued projection from points as in example
4.1.3. In particular, dimπ(X) = dimX = m by corollary 4.1.7. By lemma 4.1.4 (ii) it then
follows that π(X) = P
m, i. e. π is surjective.
Now suppose that every component of X1 = X ∩ Z(f) has already dimension at most
m−2, then by the above inductive argument already Xm is empty and the forms f0,..., fm−1
do not vanish simultaneously on X. But this means that (0 : ··· : 0 : 1) ∈/ π(X), which
contradicts the surjectivity of π. 
54 Andreas Gathmann
4.2. The dimension of varieties. After having exploited the main theorem on projective
varieties as far as possible, let us now study the dimension of more general varieties. We
have already remarked that the dimension of a variety should be a local concept; in particular the dimension of any open subvariety U of a variety X should be the same as that of
X. This is what we want to prove first.
Proposition 4.2.1. Let X be a variety, and let U ⊂ X be a non-empty open subset of X.
Then dimU = dimX.
Proof. “≤”: Let 0/ 6= U0 ( U1 ( ··· ( Un = U be a longest chain in U. If Xi denotes the
closure of Ui
in X for all i, then 0/ 6= X0 ( ··· ( Xn = X is a chain in X.
“≥”: We will prove this in several steps.
Step 1: Let 0/ 6= X0 ( ··· ( Xn = X be a longest chain in X, and assume that X0 ⊂ U.
Then set Ui = Xi ∩U for all i; we claim that 0/ 6= U0 ( ··· ( Un = U is a chain in U (from
which it then follows that dimU ≥ dimX). In fact, the only statement that is not obvious
here is that Ui 6= Ui+1 for all i. So assume that Ui = Ui+1 for some i. Then
Xi+1 = (Xi+1 ∩U)∪(Xi+1 ∩(X\U))
= (Xi ∩U)∪(Xi+1 ∩(X\U))
= Xi ∪(Xi+1 ∩(X\U)),
where the last equality follows from Xi∩(X\U) ⊂ Xi+1∩(X\U). But this is a contradiction
to Xi+1 being irreducible, as Xi
is neither empty nor all of Xi+1. So we have now proven
the proposition in the case where the element X0 of a longest chain in X lies in U.
Step 2: Let X be a projective variety. Then we claim that we can always find a longest
chain 0/ 6= X0 ( ··· ( Xn (with n = dimX) such that X0 ⊂ U. We will construct this chain
by descending recursion on n, starting by setting Xn = X. So assume that Xi ( Xi+1 (
··· ( Xn = X has already been constructed such that Xi ∩U 6= 0/. Pick any non-constant
homogeneous polynomial f that does not vanish identically on any irreducible component
of Xi\U. By proposition 4.1.9 there is a component of Xi ∩Z(f) of dimension i − 1; call
this Xi−1. We have to show that Xi−1 ∩U 6= 0/. Assume the contrary; then Xi−1 must be
contained in Xi\U. But by the choice of f we know that Xi−1 is not a whole component
of Xi\U, so it can only be a proper subset of a component of Xi\U. But by lemma 4.1.4
(ii) the components of Xi\U have dimension at most i−1, and therefore proper subsets of
them have dimension at most i−2. This is a contradiction to dimXi−1 = i−1.
Combining steps 1 and 2, we have now proven the proposition if X is a projective variety. Of course the statement then also follows if X is an affine variety: let X¯ be the
projective closure of X as in exercise 3.5.3, then by applying our result twice we get
dimU = dimX¯ = dimX.
Step 3: Let X be any variety, and let 0/ 6= X0 ( ··· ( Xn = X be a longest chain in X.
Let V ⊂ X be an affine open neighborhood of the point X0; then dimV = dimX by step 1.
In the same way we can find an affine open subset W of U such that dimW = dimU. As
V ∩W 6= 0/, it finally follows from steps 1 and 2 that
dimX = dimV = dim(V ∩W) = dimW = dimU.

In particular, as every variety can be covered by affine varieties, this proposition implies
that it is sufficient to study the dimensions of affine varieties. Let us first prove the affine
equivalent of proposition 4.1.9.
Example 4.2.2.
(i) As A
n
is an open subset of P
n
, it follows by corollary 4.1.8 that dimA
n = n.
4. Dimension 55
(ii) As A
m+n
is an open subset of P
n×P
m, it follows by (i) that dim(P
n×P
m) = n+m.
(iii) Let f ∈ k[x1,..., xn] be a non-constant polynomial. We claim that Z(f) ⊂ A
n has
dimension n−1. In fact, let X¯ ⊂ P
n be the projective closure of Z(f); by proposition 4.1.9 there is a component Y of X¯ of dimension n−1. As the homogenized
polynomial f does not contain x0 as a factor, X¯ cannot contain the whole “infinity
locus” P
n\A
n ∼= P
n−1
. So the part of X¯ in the infinity locus has dimension at most
n−2; in particular the component Y of X¯ has non-empty intersection with A
n
. In
other words, Z(f) ⊂ A
n has dimension n−1.
(iv) Let f ∈ k[x1,..., xn] be as in (iii); we claim that in fact the dimension of every
irreducible component of Z(f) ⊂ A
n
is n−1: in fact, as k[x1,..., xn] is a unique
factorization domain, we can write f as a product f1 ··· fr of irreducible polynomials, so that the decomposition of Z(f) into its irreducible components is
Z(f1)∪ ··· ∪Z(fr). Now we can apply (iii) to the fi separately to get the desired
result.
(v) The corresponding statements to (iii) and (iv) are true for the zero locus of a
homogeneous polynomial in P
n
as well (the proof is the same).
By (iv) and (v), there is a one-to-one correspondence between closed subvarieties of A
n
(resp. P
n
) of dimension n − 1 and non-constant irreducible polynomials in k[x1,..., xn]
(resp. non-constant homogeneous polynomials in k[x0,..., xn]). Varieties that are of this
form are called hypersurfaces; if the degree of the polynomial is 1 they are called hyperplanes.
Remark 4.2.3. Next we want to prove for general affine varieties X ⊂ A
n
that the dimension
of (every component of) X ∩Z(f) is dimX −1. Note that this does not follow immediately
from the projective case as it did for X = A
n
in example 4.2.2 (iii) or (iv):
(i) As for example 4.2.2 (iii), of course we can still consider the projective closure
X¯ of X in P
n
and intersect it with the zero locus of the homogenization of f ;
but proposition 4.1.9 only gives us the existence of one component of dimension
dimX − 1 in X¯ ∩ Z(f). It may well be that there is a component of X¯ ∩ Z(f)
that is contained in the “hyperplane at infinity” P
n\A
n
, in which case we get
no information about the affine zero locus X ∩ Z(f). As an example you may
consider the projective variety X = {x0x2 = x
2
1
} ⊂ P
2
and f = x1: then X ∩Z(f) =
(1 : 0 : 0) ∪ (0 : 0 : 1) contains a point (0 : 0 : 1) at infinity as an irreducible
component.
(ii) As for example 4.2.2 (iv), note that a factorization of f as for A
n
is simply not
possible in general. For example, in the case just considered in (i), Z(f) intersects
X in two points, but there is no decomposition of the linear function f into two
factors that vanish on only one of the points.
Nevertheless the idea of the proof is still to use projections from points:
Proposition 4.2.4. Let X ⊂ A
n be an affine variety, and let f ∈ k[x1,..., xn] be a nonconstant polynomial that does not vanish identically on X. Then dim(X ∩Z(f)) = dimX −
1 (unless X ∩Z(f) = 0/).
Proof. We prove the statement by induction on n (not on dimX!); there is nothing to show
for n = 0. If X = A
n
the statement follows from example 4.2.2 (iv), so we can assume that
X ( An
.
Let X¯ be the projective closure in P
n
; we can assume by an affine change of coordinates that P = (0 : ··· : 0 : 1) ∈/ X¯. Consider the projection π¯ : X¯ → P
n−1
from P as in
example 4.1.3. Obviously, we can restrict this projection map to the affine space A
n ⊂ P
n
given by x0 6= 0; we thus obtain a morphism π : X → π(X) that is given in coordinates by
(a1,...,an) 7→ (a1,...,an−1). Note that π(X) is closed in A
n
, as π(X) = π¯(X¯)∩A
n
.
56 Andreas Gathmann
By lemma 4.1.5 (i) applied to the function xn we see that there is a relation
p(xn) := x
D
n +a1x
D−1
n +···aD = 0 in A(X) (∗)
for some D > 0 and some ai ∈ k[x1,..., xn−1] that do not depend on xn. Let K be the field
k(x1,..., xn−1) of rational functions in n−1 variables. Set V = K[xn]/p(xn); by (∗) this is
a D-dimensional vector space over K (with basis 1, xn,..., x
D−1
n
). Obviously, every polynomial g ∈ k[x1,..., xn] defines a vector space homomorphism g : V → V (by polynomial
multiplication), so we can talk about its determinant detg ∈ K. Moreover, it is easy to see
that detg ∈ k[x1,..., xn−1], as the definition of the determinant does not use divisions. Note
also that detg = g
D if g ∈ k[x1,..., xn−1].
Now go back to our original problem: describing the zero locus of the given polynomial
f on X. We claim that
π(X ∩Z(f)) = π(X)∩Z((f)∩k[x1,..., xn−1]) ⊃ π(X)∩Z(det f)
(in fact there is equality, but we do not need this). The first equality is obvious from the
definition of π. To prove the second inclusion, note that by the Nullstellensatz it suffices
to show that (f)∩k[x1,..., xn−1] ⊂
p
(det f). So let g ∈ (f)∩k[x1,..., xn−1]; in particular
g = f · b for some b ∈ k[x1,..., xn]. It follows that
g
D = detg = det f · detb ∈ (det f),
i. e. g ∈
p
(det f), as we have claimed.
The rest is now easy:
dim(X ∩Z(f)) = dimπ(X ∩Z(f)) by corollary 4.1.7 and proposition 4.2.1
≥ dim(π(X)∩Z(det f)) by the inclusion just proven
= dimπ(X)−1 by the induction hypothesis
= dimX −1 by corollary 4.1.7 and proposition 4.2.1 again.
The opposite inequality follows trivially from lemma 4.1.4 (ii).
It is now quite easy to extend this result to a statement about every component of X ∩
Z(f):
Corollary 4.2.5. Let X ⊂ A
n be an affine variety, and let f ∈ k[x1,..., xn] be a non-constant
polynomial that does not vanish identically on X. Then every irreducible component of
X ∩Z(f) has dimension dimX −1.
Proof. Let X ∩Z(f) = Z1 ∪···∪Zr be the decomposition into irreducible components; we
want to show that dimZ1 = dimX −1. Let g ∈ k[x1,..., xn] be a polynomial that vanishes
on Z2,...,Zr but not on Z1, and let U = Xg = X\Z(g). Then U is an affine variety by
lemma 2.3.16, and U ∩ Z(f) has only one component Z1 ∩U. So the statement follows
from proposition 4.2.4 together with proposition 4.2.1.
Remark 4.2.6. Proposition 4.2.1 and especially corollary 4.2.5 are the main properties of
the dimension of varieties. Together they allow to compute the dimension of almost any
variety without the need to go back to the cumbersome definition. Here are two examples:
Corollary 4.2.7. Let f : X →Y be a morphism of varieties, and assume that the dimension
of all fibers n = dim f
−1
(P) is the same for all P ∈ Y . Then dimX = dimY +n.
Proof. We prove the statement by induction on dimY; there is nothing to show for n = 0
(i. e. if Y is a point).
4. Dimension 57
By proposition 4.2.1 we can assume that Y ⊂ A
m is an affine variety. Let f ∈ k[x1,..., xm]
be any non-zero polynomial in the coordinates of A
m that vanishes somewhere, but not everywhere on Y, let Y
0 ⊂ Y be an irreducible component of Y ∩Z(f), and let X
0 = f
−1
(Y
0
).
Then it follows by corollary 4.2.5 and the induction hypothesis that
dimX = dimX
0 +1 = dimY
0 +n+1 = dimY +n.

Example 4.2.8.
(i) For any varieties X, Y we have dim(X ×Y) = dimX + dimY (apply corollary
4.2.7 to the projection morphism X ×Y → X).
(ii) Combining corollary 4.2.7 with proposition 4.2.1 again, we see that it is actually
sufficient that f
−1
(P) is non-empty and of the same dimension for all P in a
non-empty open subset U of Y.
Corollary 4.2.9. Let X and Y be affine varieties in A
n
. Then every irreducible component
of X ∩Y ⊂ A
n has dimension at least dimX +dimY −n.
Proof. Rewrite X ∩Y as the intersection of X ×Y with the diagonal ∆(A
n
) in A
n × A
n
.
The diagonal is given by the zero locus of the n functions xi − yi for 1 ≤ i ≤ n, where
x1,..., xn, y1,..., yn are the coordinates of A
n × A
n
. By corollary 4.2.5, every component
of the intersection of an affine variety Z with the zero locus of a non-constant function
has dimension at least equal to dimZ − 1 (it is dimZ if f vanishes identically on Z, and
dimZ −1 otherwise). Applying this statement n times to the functions xi −yi on X ×Y in
A
n ×A
n we conclude that every component of X ∩Y has dimension at least dim(X ×Y)−
n = dimX +dimY −n.
Remark 4.2.10. (For commutative algebra experts) There is another more algebraic way
of defining the dimension of varieties that is found in many textbooks: the dimension of
a variety X is the transcendence degree over k of the field of rational functions K(X) on
X. Morally speaking, this definition captures the idea that the dimension of a variety is the
number of independent coordinates on X. We have not used this definition here as most
propositions concerning dimensions would then have required methods of (commutative)
algebra that we have not developed yet.
Here are some ideas that can be used to show that this algebraic definition of dimension
is equivalent to our geometric one:
• If U ⊂ X is a non-empty open subset we have K(U) = K(X), so with the algebraic
definition of dimension it is actually trivial that dimU = dimX.
• It is then also obvious that dimA
n = tr degk(x1,..., xn) = n.
• Let π : X → π(X) be a projection map as in the proof of proposition 4.2.4. The
relation (∗) in the proof can be translated into the fact that K(X) is an algebraic
field extension of K(π(X)) (we add one variable xn, but this variable satisfies a
polynomial relation). In particular, these two fields have the same transcendence
degree, translating into the fact that dimπ(X) = dimX.
4.3. Blowing up. We have just seen in 4.2.1 that two varieties have the same dimension if
they contain an isomorphic (non-empty) open subset. In this section we want to study this
relation in greater detail and construct a large and important class of examples of varieties
that are not isomorphic but contain an isomorphic open subset. Let us first make some
definitions concerning varieties containing isomorphic open subsets. We will probably not
use them very much, but they are often found in the literature.
Definition 4.3.1. Let X and Y be varieties. A rational map f from X to Y, written f :
X 99K Y, is a morphism f : U → Y (denoted by the same letter) from a non-empty open
58 Andreas Gathmann
subset U ⊂ X to Y. We say that two such rational maps f : U → Y and g : V → Y with
U,V ⊂ X are the same if f = g on U ∩V.
A rational map f : X 99K Y is called dominant if its image is dense in Y, i. e. if f is
given by a morphism f : U → Y such that f(U) contains a non-empty open subset of Y. If
f : X 99K Y and g : Y 99K Z are rational maps, and if f is dominant, then the composition
g ◦ f : X 99K Z is a well-defined rational map.
A birational map from X to Y is a rational map with an inverse, i. e. it is a (dominant)
rational map f : X 99K Y such that there is a (dominant) rational map g : Y 99K X with
g ◦ f = idX and f ◦ g = idY as rational maps. Two varieties X and Y are called birational
if there is a birational map between them. In other words, X and Y are birational if they
contain an isomorphic non-empty open subset.
We will now construct the most important examples of birational morphisms (resp.
birational varieties), namely blow-ups.
Construction 4.3.2. Let X ⊂ A
n be an affine variety, and let f0,..., fr ∈ k[x1,..., xn] be
polynomial functions that do not vanish identically on X. Then U = X\Z(f0,..., fr) is a
non-empty open subset of X, and there is a well-defined morphism
f : U → P
r
,P 7→ (f0(P) : ··· : fr(P)).
Now consider the graph
Γ = {(P, f(P)) ; P ∈ U} ⊂ X ×P
r
which is isomorphic to U (with inverse morphism (P,Q) 7→ P). Note that Γ is in general
not closed in X ×P
r
, because the points in X\U where (f0 : ··· : fr) is ill-defined as a point
in P
r
are “missing”.
The closure of Γ in X ×P
r
is called the blow-up of X in (f0,..., fr); we denote it by X˜.
It is a closed subset of X × P
r
, and it is irreducible as Γ is; so it is a closed subvariety of
X ×P
r
. In particular, there are projection morphisms π : X˜ → X and p : X˜ → P
r
. Note that
X and X˜ both contain U as a dense open subset, so X and the blow-up X˜ have the same
dimension.
Let us now investigate the geometric meaning of blow-ups.
Example 4.3.3. If r = 0 in the above notation, i. e. if there is only one function f0, the
blow-up X˜ is isomorphic to X. In fact, we then have X˜ ⊂ X ×P
0 ∼= X, so X˜ is the smallest
closed subvariety containing U.
Example 4.3.4. Let X = A
2 with coordinates x0, x1, and let f0 = x0, f1 = x1. Then the
blow-up of X in (f0, f1) is a subvariety of A
2 ×P
1
. The morphism (x0, x1) 7→ (x0 : x1) is
well-defined on U = X\{(0,0)}; so on this open subset the graph is given by
Γ = {((x0, x1),(y0 : y1)) ; x0y1 = x1y0} ⊂ U ×P
1
.
The closure of Γ is now obviously given by the same equation, considered in A
2 ×P
1
:
X˜ = {((x0, x1),(y0 : y1)) ; x0y1 = x1y0} ⊂ A
2 ×P
1
.
The projection morphisms to X = A
2
and P
1
are obvious.
Note that the inverse image of a point P = (x0, x1) ∈ X\{(0,0)} under π is just the single
point ((x0, x1),(x0 : x1)) — we knew this before. The inverse image of (0,0) ∈ X however
is P
1
, as the equation x0y1 = x1y0 imposes no conditions on y0 and y1 if (x0, x1) = (0,0).
To give a geometric interpretation of the points in π
−1
(0,0) let us first introduce one
more piece of notation. Let Y ⊂ X be a closed subvariety that has non-empty intersection
with U. As U is also a subset of X˜, we can consider the closure of Y ∩U in X˜. We call
this the strict transform of Y. Note that by definition the strict transform of Y is just the
blow-up of Y at (f0,..., fr); so we denote it by Y˜.
4. Dimension 59
Now let C ⊂ X = A
2 be a curve, given by the equation
g(x0, x1) = ∑
i, j
ai, jx
i
0
x
j
1 = a0,0 +a1,0x0 +a0,1x1 +a1,1x0x1 +··· .
Assume that a0,0 = 0, i. e. that C passes through the origin in A
2
, and that (a1,0,a0,1) 6=
(0,0), so that C has a well-defined tangent line at the origin, given by the linearization
a1,0x0 + a0,1x1 = 0 of g. Let us compute the strict transform C˜. Of course, the points
((x0, x1),(y0 : y1)) of C˜ satisfy the equation
a1,0x0 +a0,1x1 +a1,1x0x1 +a2,0x
2
0 +a0,2x
2
1 +··· = 0. (∗)
But it is not true that C˜ is just the common zero locus in A
2 ×P
1 of this equation together
with x0y1 = x1y0, because this common zero locus contains the whole fiber π
−1
(0,0) ∼= P
1
— but C˜ has to be irreducible of dimension 1, so it cannot contain this P
1
. In fact, we have
forgotten another relation: on the open set where x0 6= 0 and x1 6= 0 we can multiply (∗)
with y0
x0
; using the relation y0
x0
=
y1
x1
we get
a1,0y0 +a0,1y1 +a1,1y0x1 +a2,0x0y0 +a0,2x1y1 +··· = 0.
This equation must then necessarily hold on the closure C˜ too. Restricting it to the origin
(x0, x1) = (0,0) we get a1,0y0 +a0,1y1 = 0, which is precisely the equation of the tangent
line to C at (0,0). In other words, the strict transform C of C intersects the fiber ˜ π
−1
(0,0)
precisely in the point of P
1
corresponding to the tangent line of C in (0,0). In this sense
we can say that the points of π
−1
(0,0) correspond to tangent directions in X at (0,0).
The following picture illustrates this: we have two curves C1, C2 that intersect at the
origin with different tangent directions. The strict transforms C˜
1 and C˜
2 are then disjoint
on the blow-up X˜.
π
−1(0,0)
X
~
C
~
1
C
~
2
C1
C2
π
X
Let us now generalize the results of this example to general blow-ups. Note that in the
example we would intuitively say that we have “blown up the origin”, i. e. the zero locus
of the functions f0,..., fr
. In fact, the blow-up construction depends only on the ideal
generated by the fi
:
Lemma 4.3.5. The blow-up of an affine variety X at (f0,..., fr) depends only on the ideal
I ⊂ A(X) generated by f0,..., fr
. We will therefore usually call it the blow-up of X at the
ideal I. If I = I(Y) for a closed subset Y ⊂ X, we will also call it the blow-up of X in Y .
Proof. Let (f0,..., fr) and (f
0
0
,..., f
0
s
) be two sets of generators of the same ideal I ⊂ A(X),
and let X˜ and X˜0 be the blow-ups of X at these sets of generators. By assumption we have
relations in A(X)
fi = ∑
j
gi, j
f
0
j
and f
0
j = ∑
k
g
0
j,k
fk.
We want to define a morphism X˜ → X˜0 by sending (P,(y0 : ··· : yr)) to (P,(y
0
0
: ··· : y
0
s
)),
where y
0
j = ∑k g
0
j,k
(P)yk. First of all we show that this defines a morphism to X ×P
s
, i. e.
that the y
0
j
cannot be simultaneously zero. To do this, note that by construction we have the
60 Andreas Gathmann
relation (y0 : ··· : yr) = (f0 : ··· : fr) on X\Z(I) ⊂ X˜ ⊂ X ×P
r
, i. e. these two vectors are
linearly dependent (and non-zero) at each point in this set. Hence the linear relations fi =
∑j,k gi, jg
0
j,k
fk in f0,..., fr
imply the corresponding relations yi = ∑j,k gi, jg
0
j,k
yk in y0,..., yr
on this set, and thus also on its closure, which is by definition X˜. So if we had y
0
j =
∑k g
0
j,k
yk = 0 for all j then we would also have yi = ∑j gi, jy
0
j = 0 for all i, which is a
contradiction.
Hence we have defined a morphism X˜ → X × P
s
. By construction it maps the open
subset X\Z(f0,..., fr) ⊂ X˜ to X\Z(f
0
0
,..., f
0
s
) ⊂ X˜0
, so it must map its closure X˜ to X˜0
as well. By the same arguments we get an inverse morphism X˜0 → X˜, so X˜ and X˜0
are
isomorphic.
Let us now study the variety X˜ itself, in particular over the locus Z(f0,..., fr) where
π : X˜ → X is not an isomorphism.
Lemma 4.3.6. Let X ⊂ A
n be an affine variety, and let X be the blow-up of X at the ideal ˜
I = (f0,..., fr). Then:
(i) The blow-up X is contained in the set ˜
{(P,(y0 : ··· : yr)) ; yi
fj(P) = yj
fi(P) for all i, j = 0,...,r} ⊂ X ×P
r
.
(ii) The inverse image π
−1
(Z(f0,..., fr)) is of pure dimension dimX −1. It is called
the exceptional hypersurface.
Proof. (i): By definition we must have (y0 : ··· : yr) = (f0(P) : ··· : fr(P)) on the nonempty open subset X\Z(I) ⊂ X˜. So these equations must be true as well on the closure of
this open subset, which is X˜ by definition.
(ii): It is enough to prove the statement on the open subset where yi 6= 0, as these open
subsets for all i cover X˜. Note that on this open subset the condition fi(P) = 0 implies
fj(P) = 0 for all j by the equations of (i). So the inverse image π
−1
(Z(f0,..., fr)) is
given by one equation fj = 0, and is therefore of pure dimension dimX˜ − 1 = dimX − 1
by corollary 4.2.5.
Example 4.3.7. In example 4.3.4, X = A
2 has dimension 2, and the exceptional hypersurface was isomorphic to P
1
, which has dimension 1.
Remark 4.3.8. The equations in lemma 4.3.6 (i) are in general not the only ones for X˜.
Note that they do not impose any conditions over the zero locus Z(f0,..., fr) at all, so that
it would seem from these equations that the exceptional hypersurface is always P
r
. This
must of course be false in general just for dimensional reasons (see lemma 4.3.6 (ii)).
In fact, we can write down explicitly the equations for the exceptional hypersurface. We
will do this here only in the case of the blow-up of (the ideal of) a point P, which is the
most important case. By change of coordinates, we can then assume that P is the origin in
A
n
.
For any f ∈ k[x1,..., xn] we let f
in be the “initial polynomial” of f , i. e. if f = ∑i
f
(i)
is
the splitting of f such that f
(i)
is homogeneous of degree i, then f
in is by definition equal
to the smallest non-zero f
(i)
. If I ⊂ k[x1,..., xn], we let I
in be the ideal generated by the
initial polynomials f
in for all f ∈ I. Note that I
in is by definition a homogeneous ideal. So
its affine zero locus Za(I
in) ⊂ A
n
is a cone, and there is also a well-defined projective zero
locus Zp(I
in). By exercise 4.6.8, the exceptional hypersurface of the blowup of an affine
variety X ⊂ A
n
in the origin is precisely Zp(I(X)
in). (The proof of this statement is very
similar to the computation of C˜ in example 4.3.4.)
Let us figure out how this can be interpreted geometrically. By construction, I(X)
in is
obtained from I(X) by only keeping the terms of lowest degree, so it can be interpreted as
an “approximation” of I(X) around zero, just in the same way as the Taylor polynomial
4. Dimension 61
approximates a function around a given point. Note also that Za(I(X)
in) has the same
dimension as X by lemma 4.3.6 (ii). Hence we can regard Za(I(X)
in) ⊂ A
n
as the cone
that approximates X best around the point P. It is called the tangent cone of X in P and
denoted CX,P. The exceptional locus of the blow-up X˜ of X in P is then the “projectivized
tangent cone”, i. e. it corresponds to “tangent directions” in X through P, just as in example
4.3.4.
Example 4.3.9. Here are some examples of tangent cones.
(i) Let X = {(x, y) ; y = x(x − 1)} ⊂ A
2
. The tangent cone of X in P = (0,0) is
given by keeping only the linear terms of the equation y = x(x −1), i. e. CX,P =
{(x, y) ; y = −x} is the tangent line to X in P. Consequently, the exceptional
hypersurface of the blow-up of X in P contains only one point. In fact, X˜ is
isomorphic to X in this case: note that on X, the ideal of P is just given by the
single function x, as (y − x(x − 1), x) = (x, y). So we are blowing up at f0 = x
only. It follows then by example 4.3.3 that X˜ = X.
(ii) Let X = {(x, y) ; y
2 = x
2 + x
3} ⊂ A
2
. This time there are no linear terms in
the equation of X, so the tangent cone in P = (0,0) is given by the quadratic
terms CX,P = {(x, y) ; y
2 = x
2}, i. e. it is the union of the two tangent lines y = x
and y = −x to X in P (see the picture below). The exceptional hypersurface
of the blow-up of X in P therefore contains exactly two points, one for every
tangent direction in P. In other words, the two local branches of X around P get
separated in the blow-up. Note that we cannot apply the argument of (i) here that
X˜ should be isomorphic to X: the ideal of P cannot be generated on X by one
function only. While it is true that the zero locus of (x, y
2 −x
2 −x
3
) is P, the ideal
(x, y
2 −x
2 −x
3
) = (x, y
2
) is not equal to I(P) = (x, y) — and this is the important
point. In particular, we see that the blow-up of X in an ideal I really does depend
on the ideal I and not just on its zero locus, i. e. on the radical of I.
(iii) Let X = {(x, y) ; y
2 = x
3} ⊂ A
2
. This time the tangent cone is CX,P = {y
2 = 0},
i. e. it is only one line. So for X˜ the point P ∈ X is replaced by only one single
point again, as in (i). But in this case X and X˜ are not isomorphic, as we will see
in 4.4.7.
CX,P
CX,P CX,P
x
y
X
P
(i)
x
y
(ii)
x
y
P
(iii)
X P
X
Remark 4.3.10. Let X be any variety, and let Y ⊂ X be a closed subset. For an affine open
cover {Ui} of X, let U˜
i be the blow-up of Ui
in Ui ∩Y. It is then easy to see that the U˜
i can
be glued together to give a blow-up variety X˜.
In what follows, we will only need this in the case of the blow-up of a point, where the
construction is even easier as it is local around the blown-up point: let X be a variety, and
let P ∈ X be a point. Choose an affine open neighborhood U ⊂ X of P, and let U˜ be the
blow-up of U in P. Then we obtain X˜ by glueing X\P to U˜ along the common open subset
U\P. In particular, this defines the tangent cone CX,P to X at P for any variety X: it is the
affine cone over the exceptional hypersurface of the blow-up of X in P.
This sort of glueing currently works only for blow-ups at subvarieties, i. e. for blow-ups
at radical ideals. For the general construction we would need to patch ideals, which we do
not know how to do at the moment.
62 Andreas Gathmann
Note however that it is easy to see that for projective varieties, the blow-up at a homogeneous ideal can be defined in essentially the same way as for affine varieties: let X ⊂ P
n
be a projective variety, and let Y ⊂ X be a closed subset. If f0,..., fr are homogeneous
generators of I(Y) of the same degree, the blow-up of X in Y is precisely the closure of
Γ = {(P,(f0(P) : ··· : fr(P)) ; P ∈ U} ⊂ X ×P
r
in X ×P
r
(this is easily checked on the affine patches fi 6= 0).
Example 4.3.11. The following property of blow-ups follows trivially from the definitions,
yet it is one of their most important properties.
Let X ⊂ A
n be an affine variety, and let f0,..., fr be polynomials that do not vanish
identically on X. Note that the morphism f : P 7→ (f0(P) : ··· : fr(P)) to P
r
is only welldefined on the open subset U = X\Z(f0,..., fr) of X. In general, we can not expect that this
morphism can be extended to a morphism on all of X. But we can always extend it “after
blowing up the ideal (f0,..., fr) of the indeterminacy locus”, i. e. there is an extension ˜f :
X˜ → P
r
(that agrees with f on the open subset U), namely just the projection from X˜ ⊂ X ×
P
r → P
r
. So blowing up is a way to extend morphisms to bigger sets on which they would
otherwise be ill-defined. The same is true for projective varieties and the construction at
the end of remark 4.3.10. Let us consider a concrete example of this idea in the next lemma
and the following remark:
Lemma 4.3.12. P
1 ×P
1 blown up in one point is isomorphic to P
2 blown up in two points.
Proof. We know from example 3.3.14 that P
1 ×P
1
is isomorphic to the quadric surface
Q = {(x0 : x1 : x2 : x3) ; x0x3 = x1x2} ⊂ P
3
.
Let P = (0 : 0 : 0 : 1) ∈ Q, and let Q˜ ⊂ P
3 × P
2 be the blow-up of Q in the ideal I(P) =
(x0, x1, x2).
On the other hand, let R1 = (0 : 1 : 0),R2 = (0 : 0 : 1) ∈ P
2
, and let P˜ 2 ⊂ P
2 × P
3 be
the blow-up of P
2
in the ideal I = (y
2
0
, y0y1, y0y2, y1y2). Note that this is not quite the ideal
I(R1 ∪R2) = (y0, y1y2), but this does not matter: the blow-up is a local construction, so let
us check that we are doing the right thing around R1. There is an open affine neighborhood
around R1 given by y1 6= 0, and on this neighborhood the ideal I is just (y
2
0
, y0, y0y2, y2) =
(y0, y2), which is precisely the ideal of R1. The same is true for R2, so the blow-up of P
2
in I is actually the blow-up of P
2
in the two points R1 and R2.
Now we claim that an isomorphism is given by
f : Q˜ 7→ P˜ 2
, ((x0 : x1 : x2 : x3),(y0 : y1 : y2)) 7→ ((y0 : y1 : y2),(x0 : x1 : x2 : x3)).
In fact, this is easy to check: obviously, f is an isomorphism P
2 × P
3 → P
3 × P
2
, so we
only have to check that f maps Q˜ to P˜ 2
, and that f
−1 maps P˜ 2
to Q˜. Note that it suffices
to check this away from the blown-up points: f
−1
(P˜ 2
) is a closed subset of P
3 ×P
2
, so if
it contains a non-empty open subset U ⊂ Q (e. g. Q˜ minus the exceptional hypersurface),
it must contain all of Q.
But this is now easy to check: on Q˜ we have x0x3 = x1x2 and (y0 : y1 : y2) = (x0 : x1 : x2)
(where this is well-defined), so in the image of f we get the correct equations
(x0 : x1 : x2 : x3) = (x
2
0
: x0x1 : x0x2 : x0x3) = (x
2
0
: x0x1 : x0x2 : x1x2) = (y
2
0
: y0y1 : y0y2 : y1y2)
for the image point to lie in P˜ 2
. Conversely, on P˜ 2 we have (x0 : x1 : x2 : x3) = (y
2
0
: y0y1 :
y0y2 : y1y2) where defined, so we conclude x0x3 = x1x2 and (y0 : y1 : y2) = (x0 : x1 : x2).
Remark 4.3.13. The proof of lemma 4.3.12 is short and elegant, but not very insightful.
Let us try to understand geometrically what is going on.
As in the proof, we think of P
1 ×P
1
as the quadric
Q = {(x0 : x1 : x2 : x3) ; x0x3 = x1x2} ⊂ P
3
.
4. Dimension 63
Consider the projection π from P to P
2
, given in coordinates by π(x0 : x1 : x2 : x3) = (x0 :
x1 : x2). We have considered projections from points before, but so far the projection point
P was always assumed not to lie on the given variety Q. This is not the case here, and
consequently π is only well-defined on Q\P. To construct π(P) we would have to take
“the line through P and P” and intersect it with a given P
2 ⊂ P
3
that does not contain
P. Of course this is ill-defined. But there is a well-defined line through P and any point
P
0 near P which we can intersect with P
2
. It is obvious that π(P) should be the limit of
these projection points when P
0
tends to P. The line P0P will then become a tangent line
to Q. But Q, being two-dimensional, has a one-parameter family of tangent lines. This is
why π(P) is ill-defined. But we also see from this discussion that blowing up P on Q, i. e.
replacing it by the set of tangent lines through P, will exactly resolve the indeterminacy.
We have thus constructed a morphism Q˜ = P^1 ×P1 → P
2 by projection from P. If there
is an inverse morphism, it is easy to see what it would have to look like: pick a point
R ∈ P
2 ⊂ P
3
. The points mapped to R by π are exactly those on the line PR not equal to
P. In general, this line intersects the quadric Q in two points, one of which is P. So there
is exactly one point on Q which maps to R. This reasoning is false however if the whole
line PR = P
1
lies in Q. This whole line would then be mapped to R, so that we cannot have
an isomorphism. But of course we expect again that this problem can be taken care of by
blowing up R in P
2
, so that it is replaced by a P
1
that can then be mapped one-to-one to
PR.
There are obviously two such lines PR1 and PR2, given by R1 = (0 : 1 : 0) and R2 = (0 :
0 : 1). If you think of Q as P
1 × P
1
again, these lines are precisely the “horizontal” and
“vertical” lines P
1 × {point} and {point}×P
1 passing through P. So we would expect that
π˜ can be made into an isomorphism after blowing up R1 and R2, which is what we have
shown in lemma 4.3.12.
R1
R2 PI
2
Q
P
P’
π(P’)
4.4. Smooth varieties. Let X ⊂ A
n be an affine variety, and let P ∈ X be a point. By a
change of coordinates let us assume that P = (0,...,0) is the origin. In remark 4.3.8 we
have defined the tangent cone of X in P to be the closed subset of A
n given by the initial
ideal of X, i. e. the “local approximation” of X around P given by keeping only the terms
of the defining equations of X of minimal degree. Let us now make a similar definition,
but where we only keep the linear terms of the defining equations.
Definition 4.4.1. For any polynomial f ∈ k[x1,..., xn] denote by f
(1)
the linear part of f .
For an ideal I ⊂ k[x1,..., xn] denote by I
(1) = { f
(1)
; f ∈ I} the vector space of all linear
parts of the elements of I; this is by definition a vector subspace of the n-dimensional space
k[x1,..., xn]
(1) of all linear forms
{a1x1 +···+anxn ; ai ∈ k}.
64 Andreas Gathmann
The zero locus Z(I
(1)
) is then a linear subspace of A
n
. It is canonically dual (as a vector
space) to k[x1,..., xn]
(1)/I
(1)
, since the pairing
k[x1,..., xn]
(1)
/I
(1) ×Z(I
(1)
) → k, (f,P) 7→ f(P)
is obviously non-degenerate.
Now let X ⊂ A
n be a variety. By a linear change of coordinates, assume that P =
(0,...,0) ∈ X. Then the linear space Z(I(X)
(1)
) is called the tangent space to X at P and
denoted TX,P.
Remark 4.4.2. Let us make explicit the linear change of coordinates mentioned in the
definition. If P = (a1,...,an) ∈ X, we need to change coordinates from the xi
to yi = xi−ai
.
By a (purely formal) Taylor expansion we can rewrite any polynomial f ∈ k[x1,..., xn] as
f(x1,..., xn) = f(P) +∑
i
∂ f
∂xi
(P)· yi +(terms at least quadratic in the yi),
so we see that the tangent space TX,P to any point P = (a1,...,an) ∈ X is given by the
equations
∑
i
∂ f
∂xi
(P)·(xi −ai) = 0
for all f ∈ I(X).
Here is an alternative description of the tangent space. For simplicity, we will assume
again that the coordinates have been chosen such that P = (0,...,0).
Lemma 4.4.3. Let X ⊂ A
n be a variety, and assume that P = (0,...,0) ∈ X. Then
k[x1,..., xn]
(1)
/I(X)
(1) = M/M2
,
where M = {ϕ ; ϕ(P) = 0} ⊂ OX,P is the maximal ideal in the local ring of X at P.
Proof. Recall that
OX,P =
n f
g
; f,g ∈ A(X),g(P) 6= 0
o
,
and therefore
M =
n f
g
; f,g ∈ A(X), f(P) = 0,g(P) 6= 0
o
.
There is an obvious homomorphism k[x1,..., xn]
(1)/I(X)
(1) → M/M2 of k-vector spaces.
We will show that it is bijective.
Injectivity: Let f ∈ k[x1,..., xn]
(1) be a linear function. Then f
1
is zero in OX,P if and
only if it is zero in A(X), i. e. if and only if f ∈ I(X).
Surjectivity: Let ϕ =
f
g
∈ M. Without loss of generality we can assume that g(P) = 1.
Set
ϕ
0 = ∑
i
∂ϕ
∂xi
(P)· xi
,
4. Dimension 65
which is obviously an element of k[x1,..., xn]
(1)
. We claim that ϕ−ϕ
0 ∈ M2
. In fact,
g(ϕ−ϕ
0
) = f −g ∑
i
∂ f
∂xi
(P)g(P)−
∂g
∂xi
(P)f(P)
g(P)
2
xi
= f −g ∑
i
∂ f
∂xi
(P) xi
≡ f −g(P) ∑
i
∂ f
∂xi
(P) xi (mod M2
) (as g−g(P) and xi are in M)
= f −∑
i
∂ f
∂xi
(P) xi
≡ 0 (mod M2
) (as this is the linear Taylor expression for f).
So ϕ = ϕ
0
in M/M2
.
Remark 4.4.4. In particular, this lemma gives us a more intrinsic definition of the tangent
space TX,P: we can say that TX,P is the dual of the k-vector space M/M2
, where M is the
maximal ideal in the local ring OX,P. This alternative definition shows that the tangent
space TX,P (as an abstract vector space) is independent of the chosen embedding of X in
affine space. It also allows us to define the tangent space TX,P for any variety X (that is not
necessarily affine).
Let us now compare tangent spaces to tangent cones.
Remark 4.4.5. Let X be an affine variety, and assume for simplicity that P = (0,...,0) ∈ X.
For all polynomials f ∈ k[x1,..., xn] vanishing at P, linear terms are always initial. Hence
the ideal generated by I(X)
(1)
is contained in the ideal I(X)
in defining the tangent cone (see
remark 4.3.8). So the tangent cone CX,P ⊂ A
n
is contained in the tangent space TX,P ⊂ A
n
.
In particular, we always have dimTX,P ≥ dimCX,P = dimX. Summarizing, we can say that,
in studying the local properties of X around P, the tangent cone has the advantage that it
always has the “correct” dimension dimX, whereas the tangent space has the advantage
that it is always a linear space. We should give special attention to those cases when both
notions agree, i. e. when X “can be approximated linearly” around P.
Definition 4.4.6. A variety X is called smooth at the point P ∈ X if TX,P = CX,P, or equivalently, if the tangent space TX,P to X at P has dimension (at most) dimX. It is called
singular at P otherwise. We say that X is smooth if it is smooth at all points P ∈ X;
otherwise X is singular.
Example 4.4.7. Consider again the curves of example 4.3.9:
(i) X = {y = x(x−1)} ⊂ A
2
,
(ii) X = {y
2 = x
2 +x
3} ⊂ A
2
,
(iii) X = {y
2 = x
3} ⊂ A
2
.
In case (i), the tangent space is {y = −x} ⊂ A
2
and coincides with the tangent cone: X is
smooth at P = (0,0). In the cases (ii) and (iii), there are no linear terms in the defining
equations of X. So the tangent space of X at P is all of A
2
, whereas the tangent cone is
one-dimensional. Hence in these cases X is singular at P.
In case (iii) let us now consider the blow-up of X in P = (0,0). Let us first blow up the
ambient space A
2
in P; we know already that this is given by
A˜ 2 = {((x, y),(x
0
: y
0
)) ; xy0 = x
0
y} ⊂ A
2 ×P
1
.
So local affine coordinates of A˜ 2
around the point ((0,0),(1 : 0)) are (u, v) ∈ A
2
, where
u =
y
0
x
0
and v = x
66 Andreas Gathmann
so that ((x, y),(x
0
: y
0
)) = ((v,uv),(1 : u)). In these local coordinates, the equation y
2 = x
3
of the curve X is given by (uv)
2 = v
3
. The exceptional hypersurface has the local equation
v = 0, so away from this hypersurface the curve X is given by the equation v = u
2
. By
definition, this is then also the equation of the blow-up X˜.
So we conclude first of all that the blow-up X is smooth ˜ , although X was not. We say
that the singularity P ∈ X got “resolved” by blowing up. We can also see that the blow-up
of the curve (with local equation v = u
2
) is tangent to the exceptional hypersurface (with
local equation v = 0). All this is illustrated in the following picture (the blow-up of A
2
is
the same as in example 4.3.4):
π
−1(0,0)
X
~
π
X
It can in fact be shown that every singularity can be “resolved” in a similar way by successively blowing up the singular locus.
The good thing about smoothness is that is very easy to check:
Proposition 4.4.8.
(i) (Affine Jacobi criterion) Let X ⊂ A
n be an affine variety with ideal I(X) =
(f1,..., fr), and let P ∈ X be a point on X. Then X is smooth at P if and only
if the rank of the r ×n “Jacobi matrix”
∂ fi
∂x j
(P)

is (at least) n−dimX.
(ii) (Projective Jacobi criterion) Let X ⊂ P
n be a projective variety with ideal I(X) =
(f1,..., fr), and let P ∈ X be a point on X. Then X is smooth at P if and only if
the rank of the r ×n Jacobi matrix
∂ fi
∂x j
(P)

is (at least) n−dimX.
In particular, if the rank is r (the number of functions) then X is smooth of dimension n−r.
Proof. (i): By remark 4.4.2, the linearization of the functions fi around the point P =
(a1,...,an) is given by ∑j
∂ fi
∂x j
(P)·(xi −ai). By definition, X is smooth at P if these functions define a linear subspace of A
n of dimension (at most) dimX, i. e. if and only if the
linear subspace of k[x1,..., xn]
(1)
spanned by the above linearizations has dimension (at
least) n − dimX. But the dimension of this linear space is exactly the rank of the matrix
whose entries are the coefficients of the various linear function.
(ii): This follows easily by covering the projective space P
n by the n+1 affine spaces
{xi 6= 0} ∼= A
n
, and applying the criterion of (i) to these n+1 patches.
Remark 4.4.9. Note that a matrix has rank less than k if and only if all k × k minors are
zero. These minors are all polynomials in the entries of the matrix. In particular, the
locus of singular points, i. e. where the Jacobi matrix has rank less than n−dimX as in the
proposition, is closed.
It follows that the set
{P ∈ X ; X is singular at P} ⊂
4. Dimension 67
is closed. In other words, the set of smooth points of a variety is always open. One can
show that the set of smooth points is also non-empty for every variety (see e. g. [H] theorem
I.5.3). Hence the set of smooth points is always dense.
Example 4.4.10.
(i) For given n and d, let X be the so-called Fermat hypersurface
X = {(x0 : ··· : xn) ; x
d
0 +···+x
d
n = 0}.
Then the Jacobi matrix has only one row, and the entries of this row are d xd−1
i
for i = 0,...,n. Assuming that the characteristic of the ground field is zero (or at
least not a divisor of d), it follows that at least one of the entries of this matrix is
non-zero at every point. In other words, the rank of the Jacobi matrix is always 1.
Therefore X is smooth by proposition 4.4.8.
(ii) Let X be the “twisted cubic curve” of exercise 3.5.2
X = {(s
3
: s
2
t : st2
: t
3
) ; (s : t) ∈ P
1
}.
We have seen earlier that X can be given by the equations
X = {(x0 : x1 : x2 : x3) ; x
2
1 −x0x2 = x
2
2 −x1x3 = x0x3 −x1x2 = 0}.
So the Jacobi matrix is given by


−x2 2x1 −x0 0
0 −x3 2x2 −x1
x3 −x2 −x1 x0

.
By proposition 4.4.8, X is smooth if and only if the rank of this matrix is 2. (We
know already that the rank cannot be bigger than 2, which is also easily checked
directly).
The 2 × 2 minor given by the last two rows and the first two columns is x
2
3
.
The 2×2 minor given by last two rows and the first and last column is x1x3 = x
2
2
.
Similarly we find 2×2 minors that are x
2
1
and x
2
0
. These cannot all be simultaneously zero; hence X is smooth. (Of course we have known this before, since X is
just the degree-3 Veronese embedding of P
1
(see example 3.4.11. In particular, X
is isomorphic to P
1
and therefore smooth.)
Remark 4.4.11. The Jacobi criterion of proposition 4.4.8 gives us a direct connection to
complex analysis. Assume that we are given r holomorphic functions on C
n
(e. g. polynomials), and that the matrix of the derivatives of the fi has rank n − dimX at a point
P, where X is the zero locus of the fi
. Assume for simplicity that the square matrix

∂ fi
∂x j
(P)

1≤i≤n−dimX,dimX<j≤n
of size n − dimX is invertible. Then the inverse function
theorem states that the coordinates xdimX+1,..., xn are locally around P determined by the
other coordinates x1,..., xdimX . Thus there is a neighborhood U of P in C
n
(in the classical
topology!) and holomorphic functions gdimX+1,...,gn of x1,..., xdimX such that for every
P = (x1,..., xdimX ) ∈ U the functions fi vanish at P if and only if xi = gi(x1,..., xdimX ) for
i = dimX +1,...,n.
So the zero locus of the fi
is “locally the graph of a holomorphic map” given by the
gi
. In other words, smoothness in algebraic geometry means in a sense the same thing as
differentiability in analysis: the geometric object has “no edges”.
Note however that the inverse function theorem is not true in the Zariski topology, because the open sets are too big. For example, consider the curve X = {(x, y) ; f(x, y) =
y−x
2 = 0} ⊂ C
2
. Then ∂ f
∂x
6= 0 say at the point P = (1,1) ∈ X. Consequently, in complex
analysis x can be expressed locally in terms of y around P: it is just the square root of y. But
any non-empty Zariski open subset of X will contain pairs of points (x, x
2
) and (−x, x
2
) for
some x, so the inverse function theorem cannot hold here in algebraic geometry.
68 Andreas Gathmann
4.5. The 27 lines on a smooth cubic surface. As an application of the theory that we
have developed so far, we now want to study lines on cubic surfaces in P
3
. We have
already mentioned in example 0.1.7 that every smooth cubic surface has exactly 27 lines
on it. We now want to show this. We also want to study the configuration of these lines,
and show that every smooth cubic surface is birational to P
2
.
The results of this section will not be needed later on. Therefore we will not give all the
proofs in every detail here. The goal of this section is rather to give an idea of what can be
done with our current methods.
First let us recall some notation from exercise 3.5.4. Let G = G(1,3) be the Grassmannian variety of lines in P
3
. This is a 4-dimensional projective variety. In this section
we will use local affine coordinates on G: if L0 ∈ G is the line in P
3
(with coordinates
x0,..., x3) given by the equations x2 = x3 = 0 (of course every line is of this form after a
linear change of coordinates), then there is an open neighborhood A
4 ⊂ G of L0 in G given
by sending a point (a,b) := (a2,b2,a3,b3) ∈ A
4
to the line through the points (1,0,a2,a3)
and (0,1,b2,b3).
The cubic surfaces in P
3
are parametrized by homogeneous polynomials of degree 3
in x0, x1, x2, x3 up to scalars, which is a 19-dimensional projective space P
19. A cubic
surface given by the equation fc := ∑α cαx
α = 0 (in multi-index notation, so α runs over
all quadruples of indices (α0,α1,α2,α3) with αi ≥ 0 and ∑i αi = 3) corresponds to the
point in P
19 with homogeneous coordinates c = (cα). We denote the corresponding cubic
surface by Xc = { fc = 0}.
To study lines in cubic surfaces, we consider the so-called incidence correspondence
M := {(L,X) ; L ⊂ X} ⊂ G×P
19
consisting of all pairs of a line and a cubic such that the line lies in the cubic. Let us start
by proving some facts about this incidence correspondence.
Lemma 4.5.1. With the above notation, the incidence correspondence M has an open
cover by affine spaces A
19. In particular, M is a smooth 19-dimensional variety.
Proof. In the coordinates (a,b, c) = (a2,a3,b2,b3, cα) as above, the incidence correspondence M is given by the equations
(a,b, c) ∈ M ⇐⇒ s(1,0,a2,a3) +t(0,1,b2,b3) ∈ Xc for all s,t
⇐⇒ ∑α
cαs
α0
t
α1 (s a2 +t b2)
α2 (s a3 +t b3)
α3 = 0 for all s,t
⇐⇒ : ∑
i
s
i
t
3−iFi(a,b, c) = 0 for all s,t
⇐⇒ Fi(a,b, c) = 0 for 0 ≤ i ≤ 3.
Note that the Fi are linear in the cα. Moreover, ci,3−i,0,0 occurs only in Fi for i = 0,...,3, and
it occurs there with coefficient 1. So these equations can be written as ci,3−i,0,0 = Gi(a,b, c)
for i = 0,...,3, where the Gi depend only on those cα where α2 > 0 or α3 > 0. Therefore
the variety A
4 × P
15 (with coordinates a2,a3,b2,b3, and all cα with α2 > 0 or α3 > 0)
is isomorphic to an open subvariety of M, with the isomorphism given by the equations
ci,3−i,0,0 = G(a,b, c). It follows that M has an open cover by affine spaces A
4 × A
15 =
A
19
.
Lemma 4.5.2. Again with notations as above, let (a,b, c) ∈ M be a point such that the
corresponding cubic surface Xc is smooth. Then the 4×4 matrix ∂(F0,F1,F2,F3)
∂(a2,a3,b2,b3)
is invertible.
4. Dimension 69
Proof. After a change of coordinates we can assume for simplicity that a = b = 0. Then
∂
∂a2
(∑
i
s
i
t
3−iFi)|(0,0,c) =
∂
∂a2
fc(s,t,s a2 +t b2,s a3 +t b3)|(0,0,c)
= s
∂ fc
∂x2
(s,t,0,0).
The (s,t)-coefficients of this polynomial are the first row in the matrix ∂Fi
∂(a,b)
(0,0, c). The
other rows are obviously s
∂ fc
∂x3
(s,t,0,0), t
∂ fc
∂x2
(s,t,0,0), and t
∂ fc
∂x3
(s,t,0,0). So if the matrix
∂Fi
∂(a,b)
(0,0, c) were not invertible, there would be a relation
(λ2s+µ2t)
∂ fc
∂x2
(s,t,0,0) + (λ3s+µ3t)
∂ fc
∂x3
(s,t,0,0) = 0
identically in s,t, with (λ2,µ2,λ3,µ3) 6= (0,0,0,0). But this means that ∂ fc
∂x2
(s,t,0,0) and
∂ fc
∂x3
(s,t,0,0) have a common linear factor, i. e. there is a point P = (x0, x1,0,0) ∈ P
3
such
that ∂ fc
∂x2
(P) = ∂ fc
∂x3
(P) = 0. But as the line L0 lies in the cubic fc, we must have fc =
x2 · g2(x0, x1, x2, x3) + x3 · g3(x0, x1, x2, x3) for some g2,g3. Hence ∂ fc
∂x0
(P) = ∂ fc
∂x1
(P) = 0
also, which means that P is a singular point of the cubic Xc. This is a contradiction to our
assumptions.
Remark 4.5.3. By remark 4.4.11, lemma 4.5.2 means that locally (in the classical topology)
around any point (a,b, c) ∈ M such that Xc is smooth, the coordinates a2,a3,b2,b3 are
determined uniquely in M by the cα. In other words, the projection map π : M → P
19 is a
local isomorphism (again in the classical topology!) around such a point (a,b, c) ∈ M. So
the local picture looks as follows:
IP 19
π
M
As the number of lines in a given cubic Xc is just the number of inverse image points of
c ∈ P
19 under this projection map, it follows that the number of lines on a smooth cubic
surface is independent of the particular cubic chosen.
Theorem 4.5.4. Every smooth cubic surface X ⊂ P
3
contains exactly 27 lines.
Proof. We have just argued that the number of lines on a smooth cubic surface does not
depend on the surface, so we can pick a special one. We take the surface X given by
the equation f = x
3
0 + x
3
1 + x
3
2 + x
3
3 = 0 (which is smooth in characteristic not equal to
3). Up to a permutation of coordinates, every line in P
3
can be written x0 = a2x2 +a3x3,
70 Andreas Gathmann
x1 = b2x2 +b3x3. Substituting this in the equation f yields the conditions
a
3
2 +b
3
2 = −1, (1)
a
3
3 +b
3
3 = −1, (2)
a
2
2a3 = −b
2
2b3, (3)
a2a
2
3 = −b2b
2
3
. (4)
Assume that a2,a3,b2,b3 are all non-zero. Then (3)
2/(4) gives a
3
2 = −b
3
2
, while (4)
2/(3)
yields a
3
3 = −b
3
3
. This is obviously a contradiction to (1) and (2). Hence at least one of the
a2,a3,b2,b3 must be zero. Assume without loss of generality that a2 = 0. Then b3 = 0 and
a
3
3 = b
3
2 = −1. This gives 9 lines by setting a3 = −ω
i
and b2 = −ω
j
for 0 ≤ i, j ≤ 2 and ω
a third root of unity. So by allowing permutations of the coordinates we find that there are
exactly the following 27 lines on X:
x0 +x1ω
i = x2 +x3ω
j = 0, 0 ≤ i, j ≤ 2,
x0 +x2ω
i = x1 +x3ω
j = 0, 0 ≤ i, j ≤ 2,
x0 +x3ω
i = x1 +x2ω
j = 0, 0 ≤ i, j ≤ 2.

Remark 4.5.5. We will now study to a certain extent the configuration of the 27 lines on a
cubic surface, i. e. determine which of the lines intersect. Consider the special cubic X of
the proof of theorem 4.5.4, and let L be the line
L = {x0 +x1 = x2 +x3 = 0}
in X. Then we can easily check that L meets exactly 10 of the other lines in X, namely
x0 +x1ω
i = x2 +x3ω
j = 0, (i, j) 6= (0,0)
x0 +x2 = x1 +x3 = 0,
x0 +x3 = x1 +x2 = 0.
The same is true for every other line in X. In fact, the statement is also true for every
smooth cubic surface, and not just for the special one that we have just considered. The
proof of this is very similar to the proof above that the number of lines on a smooth cubic
surface does not depend on the particular cubic chosen.
Now let L1 and L2 be two disjoint lines on a smooth cubic surface X. We claim that
there are exactly 5 lines on X that intersect both L1 and L2. To show this, one can proceed
in the same way as above: check the statement directly on a special cubic surface, and then
show that it must then be true for all other smooth cubic surfaces as well.
Proposition 4.5.6. Any smooth cubic surface in P
3
is birational to P
2
.
Proof. By remark 4.5.5 there are two disjoint lines L1,L2 ⊂ X. The following mutually
inverse rational maps X 99K L1 ×L2 and L1 ×L2 99K X show that X is birational to P
1 ×P
1
and hence to P
2
:
“X 99K L1 ×L2”: By exercise 3.5.1, for every point P not on L1 or L2 there is a unique
line L(P) in P
3
through L1, L2 and P. Take the rational map P 7→ (L1 ∩L(P),L2 ∩L(P))
that is obviously well-defined away from L1 ∪L2.
“L1 ×L2 99K X”: Map any pair of points (P,Q) ∈ L1 ×L2 to the third intersection point
of X with the line PQ. This is well-defined whenever PQ is not contained in X.
Proposition 4.5.7. Any smooth cubic surface in P
3
is isomorphic to P
1 ×P
1 blown up in
5 (suitably chosen) points, or equivalently, to P
2 blown up in 6 (suitably chosen) points.
4. Dimension 71
Proof. We will only sketch the proof. Let X be a smooth cubic surface, and let f : X 99K
L1 ×L2
∼= P
1 ×P
1 be the rational map as in the proof of proposition 4.5.6.
First of all we claim that f is actually a morphism. To see this, note that there is a
different description for f : if P ∈ X\L1, let H be the unique plane in P
3
that contains L1
and P, and let f2(P) = H ∩L2. If one defines f1(P) similarly, then f(P) = (f1(P), f2(P)).
Now if the point P lies on L1, let H be the tangent plane to X at P, and again let f2(P) =
H ∩L2. Extending f1 similarly, one can show that this extends f = (f1, f2) to a well-defined
morphism X → P
1 ×P
1 on all of X.
Now let us investigate where the inverse map P
1 × P
1 99K X is not well-defined. As
already mentioned in the proof of proposition 4.5.6, this is the case if the point (P,Q) ∈
L1 ×L2 is such that PQ ⊂ X. In this case, the whole line PQ ∼= P
1 will be mapped to (P,Q)
by f , and it can be checked that f is actually locally the blow-up of this point. By remark
4.5.5 there are exactly 5 such lines PQ on X. Hence f is the blow-up of P
1 ×P
1
at 5 points.
By lemma 4.3.12 it then follows that f is also the blow-up of P
2
in 6 suitably chosen
points.
Remark 4.5.8. It is interesting to see the 27 lines on a cubic surface X in the picture where
one thinks of X as a blow-up of P
2
in 6 points. It turns out that the 27 lines correspond to
the following curves that we all already know (and that are all isomorphic to P
1
):
• the 6 exceptional hypersurfaces,
• the strict transforms of the
6
2

= 15 lines through two of the blown-up points,
• the strict transforms of the
6
5

= 6 conics through five of the blown-up points (see
exercise 3.5.8).
In fact, it is easy to see by the above explicit description of the isomorphism of X with the
blow-up of P
2
that these curves on the blow-up actually correspond to lines on the cubic
surface.
It is also interesting to see again in this picture that every such “line” meets 10 of the
other “lines”, as mentioned in remark 4.5.5:
• Every exceptional hypersurface intersects the 5 lines and the 5 conics that pass
through this blown-up point.
• Every line through two of the blown-up points meets
– the 2 exceptional hypersurfaces of the blown-up points,
– the
4
2

= 6 lines through two of the four remaining points,
– the 2 conics through the four remaining points and one of the blown-up
points.
• Every conic through five of the blown-up points meets the 5 exceptional hypersurfaces at these points, as well as the 5 lines through one of these five points and
the remaining point.
4.6. Exercises.
Exercise 4.6.1. Let X,Y ⊂ P
n be projective varieties. Show that X ∩Y is not empty if
dimX +dimY ≥ n.
On the other hand, give an example of a projective variety Z and closed subsets X,Y ⊂ Z
with dimX +dimY ≥ dimZ and X ∩Y = 0/.
(Hint: Let H1,H2 be two disjoint linear subspaces of dimension n in P
2n+1
, and consider
X ⊂ P
n ∼= H1 ⊂ P
2n+1
and Y ⊂ P
n ∼= H2 ⊂ P
2n+1
as subvarieties of P
2n+1
. Show that the
join J(X,Y) ⊂ P
2n+1 of exercise 3.5.7 has dimension dimX + dimY + 1. Then construct
X ∩Y as a suitable intersection of J(X,Y) with n+1 hyperplane
72 Andreas Gathmann
Exercise 4.6.2. (This is a generalization of corollary 4.2.7). Let f : X →Y be a morphism
of varieties. Show that there is a non-empty open subset U of Y such that every component
of the fiber f
−1
(P) has dimension dimX −dimY for all P ∈ U.
(Hint: You can assume X ⊂ A
n
and Y ⊂ A
m to be affine. By considering the graph
(P, f(P)) ∈ A
n+m, reduce to the case where f : A
n+1 → A
n
is the projection map.)
Exercise 4.6.3. Let f : X → Y be a morphism of varieties, and let Z ⊂ X be a closed
subset. Assume that f
−1
(P)∩Z is irreducible and of the same dimension for all P ∈ Y.
Use exercise 4.6.2 to prove that then Z is irreducible too. (This is a quite useful criterion
to check the irreducibility of closed subsets.)
Show by example that the conclusion is in general false if the f
−1
(P)∩Z are irreducible
but not all of the same dimension.
Exercise 4.6.4. Let X be a variety, and let Y ⊂ X a closed subset. For every element in an
open affine cover {Ui} of X, let Vi = Ui ∩Y, and let U˜
i be the blow-up of Ui at Vi
. Show
that the spaces U˜
i can be glued together to give a variety X˜. (This variety is then called the
blow-up of X at Y.)
Exercise 4.6.5. A quadric in P
n
is a projective variety in P
n
that can be given as the zero
locus of a quadratic polynomial. Show that every quadric in P
n
is birational to P
n−1
.
Exercise 4.6.6. Show that for four general lines L1,...,L4 ⊂ P
3
, there are exactly two
lines in P
3
intersecting all the Li
. (This means: the subset of G(1,3)
4 of all (L1,...,L4)
such that there are exactly two lines in P
3
intersecting L1,...,L4 is dense. You may want
to use the result of exercise 3.5.4 (iii) that G(1,3) is a quadric in P
5
.)
Exercise 4.6.7. Let P1 = (1 : 0 : 0),P2 = (0 : 1 : 0),P3 = (0 : 0 : 1) ∈ P
2
, and let U =
P
2\{P1,P2,P3}. Consider the morphism
f : U 7→ P
2
,(a0 : a1 : a2) 7→ (a1a2 : a0a2 : a0a1).
(i) Show that there is no morphism F : P
2 → P
2
extending f .
(ii) Let P˜ 2 be the blow-up of P
2
in the three points P1,P2,P3. Show that there is an
isomorphism ˜f : P˜ 2 → P˜ 2
extending f . This is called the Cremona transformation.
Exercise 4.6.8. Let X ⊂ A
n be an affine variety. For every f ∈ k[x0,..., xn] denote by
f
in the initial terms of f , i. e. the terms of f of the lowest occurring degree (e. g. if f =
x
2
2 + 3x1x3 − x2x
2
3
then the lowest occurring degree in f is 2, so the initial terms are the
terms of degree 2, namely f
in = x
2
2 +3x1x3). Let I(X)
in = { f
in ; f ∈ I(X)} be the ideal of
the initial terms in I(X).
Now let π : X˜ → X be the blow-up of X in the origin {0} = Z(x1,..., xn). Show that the
exceptional hypersurface π
−1
(0) ⊂ P
n
is precisely the projective zero locus of the homogeneous ideal I(X)
in
.
Exercise 4.6.9. Let X ⊂ A
n be an affine variety, and let P ∈ X be a point. Show that the
coordinate ring A(CX,P) of the tangent cone to X at P is equal to ⊕k≥0I(P)
k/I(P)
k+1
, where
I(P) is the ideal of P in A(X).
Exercise 4.6.10. Let X ⊂ A
n be an affine variety, and let Y1,Y2 ( X be irreducible, closed
subsets, no-one contained in the other. Let X˜ be the blow-up of X at the (possibly nonradical, see exercise 1.4.1) ideal I(Y1)+I(Y2). Then the strict transforms of Y1 and Y2 on X˜
are disjoint.
Exercise 4.6.11. Let C ⊂ P
2 be a smooth curve, given as the zero locus of a homogeneous
polynomial f ∈ k[x0, x1, x2]. Consider the morphism
ϕC : C → P
2
, P 7→
 ∂ f
∂x0
(P) :
∂ f
∂x1
(P) :
∂ f
∂x2
(P)

.
4. Dimension 73
The image ϕC(C) ⊂ P
2
is called the dual curve to C.
(i) Find a geometric description of ϕ. What does it mean geometrically if ϕ(P) =
ϕ(Q) for two distinct points P,Q ∈ C ?
(ii) If C is a conic, prove that its dual ϕ(C) is also a conic.
(iii) For any five lines in P
2
in general position (what does this mean?) show that
there is a unique conic in P
2
that is tangent to these five lines. (Hint: Use exercise
3.5.8.)
Exercise 4.6.12. Resolve the singularities of the following curves by subsequent blow-ups
of the singular points. This means: starting with the given curve C, blow up all singular
points of C, and replace C by its strict transform. Continue this process until the resulting
curve is smooth.
Also, describe the singularities that occur in the intermediate steps of the resolution
process.
(i) C = {(x, y) ; x
2 −x
4 −y
4 = 0} ⊂ A
2
,
(ii) C = {(x, y) ; y
3 −x
5 = 0} ⊂ A
2
,
(iii) C = {(x, y) ; y
2 −x
k = 0} ⊂ A
2
, k ∈ N.
Exercise 4.6.13. Show that “a general hypersurface in P
n
is smooth”. In other words, for
any given d we can consider P
(
n+d
d )−1
as the “space of all hypersurfaces of degree d in
P
n
”, by associating to any hypersurface { f(x0,..., xn) = 0} ⊂ P
n with f homogeneous of
degree d the projective vector of all
n+d
d

coefficients of f . Then show that the subset of
P
(
n+d
d )−1
corresponding to smooth hypersurfaces is non-empty and open.
Exercise 4.6.14. (This is a generalization of exercises 3.5.8 and 4.6.11 (iii).) For i =
0,...,5, determine how many conics there are in P
2
that are tangent to i given lines and in
addition pass through 5−i given points
74 Andreas Gathmann
5. SCHEMES
To any commutative ring R with identity we associate a locally ringed space called
SpecR, the spectrum of R. Its underlying set is the set of prime ideals of R, so if
R is the coordinate ring of an affine variety X over an algebraically closed field,
then SpecR as a set is the set of non-empty closed irreducible subvarieties of X.
Moreover, in this case the open subsets of SpecR are in one-to-one correspondence
with the open subsets of X, and the structure sheaves of SpecR and X coincide via
this correspondence.
A morphism of locally ringed spaces is a morphism of ringed spaces that respects
the maximal ideals of the local rings. Locally ringed spaces of the form SpecR are
called affine schemes; locally ringed spaces that are locally of the form SpecR are
called schemes. Schemes are the fundamental objects of study in algebraic geometry.
Prevarieties correspond exactly to those schemes that are reduced, irreducible, and
of finite type over an algebraically closed field.
For any two morphisms of schemes X → S and Y → S there is a fiber product
X ×SY; this is a scheme such that giving morphisms Z → X and Z →Y that commute
with the given morphisms to S is “the same” as giving a morphism Z → X ×SY. If X
and Y are prevarieties over k and we take S = Spec k, we get back our old notion of
the product X ×Y of prevarieties.
For any graded ring R there is a scheme ProjR whose points are the homogeneous prime ideals of R that do not contain the irrelevant ideal. This construction
generalizes our earlier construction of projective varieties; if R is the homogeneous
coordinate ring of a projective variety X over an algebraically closed field then ProjR
“is” just the projective variety X.
5.1. Affine schemes. We now come to the definition of schemes, which are the main
objects of study in algebraic geometry. The notion of schemes extends that of prevarieties
in a number of ways. We have already met several instances where an extension of the
category of prevarieties could be useful:
• We defined a prevariety to be irreducible. Obviously, it makes sense to also consider reducible spaces. In the case of affine and projective varieties we called
them algebraic sets, but we did not give them any further structure or defined regular functions and morphisms of them. Now we want to make reducible spaces
into full-featured objects of our category.
• At present we have no geometric objects corresponding to non-radical ideals in
k[x1,..., xn], or in other words to coordinate rings with nilpotent elements. These
non-radical ideals pop up naturally however: e. g. we have seen in exercise 1.4.1
that intersections of affine varieties correspond to sums of their ideals, modulo
taking the radical. It would seem more natural to define the intersection X1 ∩X2
of two affine varieties X1,X2 ⊂ A
n
to be a geometric object associated to the ideal
I(X1) + I(X2) ⊂ k[x1,..., xn]. This was especially obvious when we discussed
blow-ups: blowing up X1 ∩X2 in A
n
“separates” X1 and X2 (if none of these two
sets is contained in the other), i. e. their strict transforms X˜
1 and X˜
2 are disjoint
in A˜ n
, but this is only true if we blow-up at the ideal I(X1) +I(X2) and not at its
radical (see exercise 4.6.10).
• Recall that by lemma 2.3.7 and remark 2.3.14 we have a one-to-one correspondence between affine varieties over k and finitely generated k-algebras that are
domains, both modulo isomorphism. We have just seen that we should drop the
condition on the k-algebra to be a domain. We can go even further and also drop
the condition that it is finitely generated — then we would expect to arrive at
“infinite-dimensional” objects. Moreover, it turns out that we do not even need a
k-algebra to do geometry; it is sufficient to start with any commutative ring with
5. Schemes 75
identity, i. e. we do not have to have a ground field. This can be motivated by
noting that most constructions we made with the coordinate ring of a variety —
defining the structure sheaf, setting up correspondences between points and maximal ideals, and so on — actually only used the ring structure of the coordinate
ring, and not the k-algebra structure.
All these generalizations are included in the definition of a scheme. Note that they apply
already to affine varieties; so we will start by defining an affine scheme to be “an affine
variety generalized as above”. Later we will then say that a scheme is an object that looks
locally like an affine scheme, just as we did it in the case of prevarieties.
We are now ready to construct from any ring R (which will always mean a commutative
ring with identity) an affine scheme, which will be a ringed space and which will be denoted
SpecR, the spectrum of R.
Definition 5.1.1. Let R be a ring (commutative with identity, as always). We define SpecR
to be the set of all prime ideals of R. (As usual, R itself does not count as a prime ideal,
but (0) does if R is a domain.) We call SpecR the spectrum of R, or the affine scheme
associated to R. For every p ∈ SpecR, i. e. p ⊂ R a prime ideal, let k(p) be the quotient field
of the domain R/p.
Remark 5.1.2. Let X = SpecR be an affine scheme. We should think of X as the analogue
of an affine variety, and of R as the analogue of its coordinate ring.
Remark 5.1.3. Any element f ∈ R can be considered to be a “function” on SpecR in the
following sense: for p ∈ SpecR, denote by f(p) the image of f under the composite map
R → R/p → k(p). We call f(p) the value of f at the point p. Note that these values will
in general lie in different fields. If R = k[x1,..., xn]/I(X) is the coordinate ring of an affine
variety X and p is a maximal ideal (i. e. a point in X), then k(p) = k and the value of an
element f ∈ R as defined above is equal to the value of f at the point corresponding to p
in the classical sense. If p ⊂ R is not maximal and corresponds to some subvariety Y ⊂ X,
the value f(p) lies in the function field K(Y) and can be thought of as the restriction of the
function f to Y.
Example 5.1.4.
(i) If k is a field, then Spec k consists of a single point (0).
(ii) The space SpecC[x] (that will correspond to the affine variety A
1 over C) contains
a point (x − a) for every a ∈ A
1
, together with a point (0) corresponding to the
subvariety A
1
.
(iii) More generally, if R = A(X) is the coordinate ring of an affine variety X over an
algebraically closed field, then the set SpecR contains a point for every closed
subvariety of X (as subvarieties correspond exactly to prime ideals). This affine
scheme SpecR will be the analogue of the affine variety X. So an affine scheme
has “more points” than the corresponding affine variety: we have enlarged the
set by throwing in an additional point for every closed subvariety Y of X. This
point is usually called the generic point (or general point) of Y. In other words,
in the scheme corresponding to an affine variety with coordinate ring R we will
have a point for every prime ideal in R, and not just for every maximal ideal.
These additional points are sometimes important, but quite often one can ignore
this fact. Many textbooks will even adopt the convention that a point of a scheme
is always meant to be a point in the old geometric sense (i. e. a maximal ideal).
(iv) In contrast to (ii), the affine scheme SpecR[x] contains points that are not of the
form (x−a) or (0), e. g. (x
2 +1) ∈ SpecR[x].
(v) The affine scheme SpecZ contains an element for every prime number, and in
addition the generic point (0).
76 Andreas Gathmann
So far we have defined SpecR as a set. This is not particularly interesting, so let us
move on and make SpecR into a topological space. This is done in the same way as for
affine varieties.
Definition 5.1.5. Let R be a ring. For every subset S ⊂ R, we define the zero locus of S to
be the set
Z(S) := {p ∈ SpecR ; f(p) = 0 for all f ∈ S} ⊂ SpecR,
where f(p) is the value of f at p as in remark 5.1.3. (Obviously, S and (S) define the same
zero locus, so we will usually only consider zero loci of ideals.)
Remark 5.1.6. By the definition of the value of an element f ∈ R at a point p ∈ SpecR, we
can also write the definition of the zero locus as
Z(S) = {p ∈ SpecR ; f ∈ p for all f ∈ S}
= {p ∈ SpecR ; p ⊃ S}.
Lemma 5.1.7. Let R be a ring.
(i) If {Ii} is a family of ideals of R then T
i Z(Ii) = Z(∑i
Ii) ⊂ SpecR.
(ii) If I1,I2 ⊂ R then Z(I1)∪Z(I2) = Z(I1I2) ⊂ SpecR.
(iii) If I1,I2 ⊂ R then Z(I1) ⊂ Z(I2) if and only if √
I2 ⊂
√
I1.
Proof. The proof is literally the same as in the case of affine algebraic sets.
Hence we can define a topology on SpecR by taking the subsets of the form Z(S) as the
closed subsets. In particular, this defines the notions of irreducibility and dimension for
SpecR, as they are purely topological concepts.
Remark 5.1.8. Note that points p in SpecR are not necessarily closed: in fact,
{p} = Z(p) = {q ∈ SpecR ; q ⊃ p}.
This is equal to {p} only if p is maximal. Hence the closed points of SpecR correspond to
the points of an affine variety in the classical sense. The other points are just generic points
of irreducible closed subsets of SpecR, as already mentioned in example 5.1.4.
Example 5.1.9. The motivation for the name “generic point” can be seen from the following example. Let k be an algebraically closed field, and let R = Spec k[x1, x2] be the affine
scheme corresponding to A
2
. Consider Z(x2) ⊂ SpecR, which “is” just the x1-axis; so its
complement SpecR\Z(x2) should be the set of points that do not lie on the x1-axis. But
note that the element p = (x1) is contained in SpecR\Z(x2), although the zero locus of x1,
namely the x2-axis, does intersect the x1-axis. So the geometric way to express the fact
that (x1) ∈ SpecR\Z(x2) is to say that the generic point of the x2-axis does not lie on the
x1-axis.
Remark 5.1.10. Let R be a ring, let X = SpecR, and let f ∈ R. As in the case of affine
varieties, we call Xf
:= X\Z(f) the distinguished open subset associated to f . Note that
any open subset of X is a (not necessarily finite) union of distinguished open subsets. This
is often expressed by saying that the distinguished open subsets form a base of the topology
of X.
Now we come to the definition of the structure sheaf of SpecR. Recall that in the case
of an affine variety X, we first defined the local ring OX,P of the functions regular at a point
P ∈ X to be the localization of A(X) at the maximal ideal corresponding to P, and then
said that an element in OX (U) for an open subset U ⊂ X is a function that is regular at
every point P ∈ U. We could accomplish that in the case of varieties just by intersecting
the local rings OX,P, as they were all contained in the function field K(X). But in the case
of a general affine scheme SpecR the various local rings Rp for p ∈ SpecR do not lie inside
5. Schemes 77
some big space, so we cannot just take their intersection. The way around this problem is
to say that an element in OX (U) (for X = SpecR and U ⊂ X open) is given by a collection
of elements in the various local rings Rp for all p ∈ U, and require that these elements can
locally be written as quotients of elements of R (recall that we had a similar condition for
affine varieties in lemma 2.1.8):
Definition 5.1.11. Let R be a ring, and let X = SpecR. For every open subset U ⊂ X we
define OX (U) to be
OX (U) := {ϕ = (ϕp)p∈U with ϕp ∈ Rp for all p ∈ U
such that “ϕ is locally of the form f
g
for f,g ∈ R”}
= {ϕ = (ϕp)p∈U with ϕp ∈ Rp for all p ∈ U
such that for every p ∈ U there is a neighborhood V in U and f,g ∈ R
with g ∈/ q and ϕq =
f
g
∈ Rq for all q ∈ V.}
As the conditions imposed on the elements of OX (U) are local, it is easy to verify that
this defines a sheaf OX on X = SpecR. The first thing to do is to check that this sheaf has
the properties that we expect from the case of affine varieties (see definition 2.1.5, remark
2.1.6, and proposition 2.1.10).
Proposition 5.1.12. Let R be a ring and X = SpecR.
(i) For any p ∈ X the stalk OX,p of the sheaf OX is isomorphic to the local ring Rp.
(ii) For any f ∈ R, the ring OX (Xf) is isomorphic to the localized ring Rf
. In particular, OX (X) = R.
Proof. (i): There is a well-defined ring homomorphism
ψ : OX,p → Rp, (U,ϕ) 7→ ϕp.
We have to show that ψ is a bijection.
ψ is surjective: Any element of Rp has the form f
g
with f,g ∈ R and g ∈/ p. The function
f
g
is well-defined on Xg, so (Xg,
f
g
) defines an element in OX,p that is mapped by ψ to the
given element.
ψ is injective: Let ϕ1,ϕ2 ∈ OX (U) for some neighborhood U of p, and assume that
(ϕ1)p = (ϕ2)p. We have to show that ϕ1 and ϕ2 coincide in a neighborhood of p, so that
they define the same element in OX,p. By shrinking U if necessary we may assume that
ϕi =
fi
gi
on U for i = 1,2, where fi
,gi ∈ R and gi ∈/ p. As ϕ1 and ϕ2 have the same image
in Rp, it follows that h(f1g2 − f2g1) = 0 in R for some h ∈/ p. Therefore we also have
f1
g1
=
f2
g2
in every local ring Rq such that g1,g2,h ∈/ q. But the set of such q is the open set
Xg1 ∩Xg2 ∩Xh, which contains p. Hence ϕ1 = ϕ2 on some neighborhood of p, as required.
(ii): There is a well-defined ring homomorphism
ψ : Rf → OX (Xf),
g
f
r
7→
g
f
r
(i. e. we map g
f
r to the element of OX (Xf) that assigns to any p the image of g
f
r in Rp).
ψ is injective: Assume that ψ(
g1
f
r1
) = ψ(
g2
f
r2
), i. e. for every p ∈ Xf
there is an element
h ∈/ p such that h(g1 f
r2 −g2 f
r1 ) = 0. Let I ⊂ R be the annihilator of g1 f
r2 −g2 f
r1 , then we
have just shown that I 6⊂ p, as h ∈ I but h ∈/ p. This holds for every p ∈ Xf
, so Z(I)∩Xf = 0/,
or in other words Z(I) ⊂ Z(f). By lemma 5.1.7 (iii) this means that f
r ∈ I for some r, so
f
r
(g1 f
r2 −g2 f
r1 ) = 0, hence g1
f
r1 =
g2
f
r2
in Rf
.
ψ is surjective: Let ϕ ∈ OX (Xf). By definition, we can cover Xf by open sets Ui on
which ϕ is represented by a quotient gi
fi
, with fi ∈/ p for all p ∈ Ui
, i. e. Ui ⊂ Xfi
. As
78 Andreas Gathmann
the open subsets of the form Xhi
form a base for the topology of X, we may assume that
Ui = Xhi
for some hi
.
We want to show that we can assume fi = hi
. In fact, as Xhi ⊂ Xfi
, i. e. by taking
complements we get Z(fi) ⊂ Z(hi), and therefore hi ∈
√
fi by lemma 5.1.7 (iii). Hence
h
r
i = c fi
, so
gi
fi
=
cgi
h
r
i
. Replacing hi by h
r
i
(as Xhi = Xh
r
i
) and gi by cgi we can assume that
Xf
is covered by open subsets of the form Xhi
, and that ϕ is represented by gi
hi
on Xhi
.
Next we prove that Xf can actually be covered by finitely many such Xhi
. Indeed, Xf ⊂
S
i Xhi
if and only if Z(f) ⊃
T
i Z(hi) = Z(∑(hi)). By lemma 5.1.7 (iii) this is equivalent
to saying that f
r ∈ ∑(hi) for some r. But this means that f
r
can be written as a finite sum
f
r = ∑bihi
. Hence we can assume that we have only finitely many hi
.
On Xhi ∩Xhj = Xhihj
, we have two elements gi
hi
and gj
hj
representing ϕ, so by the injectivity
proven above it follows that gi
hi
=
gj
hj
in Rhihj
, hence (hihj)
n
(gihj − gjhi) = 0 for some n.
As we have only finitely many hi
, we may pick one n that works for all i, j. Now replace gi
by gih
n
i
and hi by h
n+1
i
for all i, then we still have ϕ represented by gi
hi
on Xhi
, and moreover
gihj −gjhi = 0 for all i, j.
Now write f
r = ∑bihi as above, which is possible since the Xhi
cover Xf
. Let g = ∑bigi
.
Then for every j we have
ghj = ∑
i
bigihj = ∑
i
bihigj = f
r
gj
,
so
f
g =
hj
gj
on Xhj
. Hence ϕ is represented on Xf by g
f
r ∈ Rf
, i. e. ψ is surjective.
Remark 5.1.13. Note that a regular function is in general no longer determined by its values
on points. For example, let R = k[x]/(x
2
) and X = SpecR. Then X has just one point (x).
On this point, the function x ∈ R = OX (X) takes the value 0 = x ∈ (k[x]/(x
2
))/(x) = k. In
particular, the functions 0 and x have the same values at all points of X, but they are not
the same regular function.
5.2. Morphisms and locally ringed spaces. As in the case of varieties, the next step after
defining regular functions on an affine scheme is to define morphisms between them. Of
course one is tempted to define a morphism f : X → Y between affine schemes to be a
morphism of ringed spaces as in definition 2.3.1, but recall that for this definition to work
we needed a notion of pull-back f
∗ of regular functions. In the case of varieties we got
this by requiring that the structure sheaves be sheaves of k-valued functions, so that a settheoretic pull-back exists. But this is not possible for schemes, as we do not have a ground
field, and the values ϕ(p) of a regular function ϕ lie in unrelated rings. Even worse, we
have seen already in example 5.1.13 that a regular function is not determined by its values
on points.
The way out of this dilemma is to make the pull-back maps f
∗
: OY (U) → OX (f
−1
(U))
part of the data required to define a morphism. Hence we say that a morphism f : X → Y
between affine schemes is given by a continuous map f : X → Y between the underlying
topological spaces, together with pull-back maps f
∗ = f
∗
U
: OY (U) → OX (f
−1
(U)) for
every open subset U ⊂ Y. Of course we need some compatibility conditions among the
f
∗
U
. The most obvious one is compatibility with the restriction maps, i. e. f
∗
V
◦ ρU,V =
ρf −1(U), f −1(V)
◦ f
∗
U
. But we also need some sort of compatibility between the f
∗
U
and the
continuous map f . To explain this condition, note that the maps f
∗
U
give rise to a map
between the stalks
f
∗
P
: OY, f(P) → OX,P, (U,ϕ) 7→ (f
−1
(U), f
∗ϕ)
for every point P ∈ X (this is easily seen to be well-defined). These stalks are local rings,
call their maximal ideals mY, f(P) and mX,P, respectively. Now the fact that f maps P
5. Schemes 79
to f(P) should be reflected on the level of the pull-back maps f
∗ by the condition that
(f
∗
P
)
−1
(mX,P) = mY, f(P)
. This leads to the following definition.
Definition 5.2.1. A locally ringed space is a ringed space (X,OX ) such that at each point
P ∈ X the stalk OX,P is a local ring. The maximal ideal of OX,P will be denoted by mX,P,
and the residue field OX,P/mX,P will be denoted k(P).
A morphism of locally ringed spaces from (X,OX ) to (Y,OY ) is given by the following
data:
• a continuous map f : X → Y,
• for every open subset U ⊂ Y a ring homomorphism f
∗
U
: OY (U) → OX (f
−1
(U)),
such that f
∗
V
◦ρU,V = ρf −1(U), f −1(V)
◦ f
∗
U
for all V ⊂U ⊂Y (i. e. the f
∗
are compatible with
the restriction maps) and (f
∗
P
)
−1
(mX,P) = mY, f(P)
, where the f
∗
P
: OY, f(P) → OX,P are the
maps induced on the stalks, as explained above. We will often omit the index of the various
pull-back maps f
∗
if it is clear from the context on which spaces they act.
A morphism of affine schemes is a morphism as locally ringed spaces.
The following proposition is the analogue of lemma 2.3.7. It shows that definition 5.2.1
was “the correct one”, because it gives us finally what we want.
Proposition 5.2.2. Let R,S be rings, and let X = SpecR and Y = SpecS the corresponding
affine schemes. There is a one-to-one correspondence between morphisms X →Y and ring
homomorphisms S → R.
Proof. If ψ : S → R is a ring homomorphism, we define a map f : X →Y by f(p) = ψ
−1
(p).
For every ideal I ⊂ S it follows that f
−1
(Z(I)) = Z(ψ(I)), so f is continuous. For each p ∈
SpecR, we can localize ψ to get a homomorphism of local rings ψp : OY, f(p) = Sψ−1(p) →
Rp = OX,p satisfying the condition ψ
−1
p (mX,p) = mY, f(p)
. By definition of the structure
sheaf, this gives homomorphisms of rings f
∗
: OY (U) → OX (f
−1
(U)), and by construction
f
∗
p = ψp, so we get a morphism of locally ringed spaces.
If f : X →Y is a morphism, we get a ring homomorphism f
∗
: S = OY (Y) → OX (X) = R
by proposition 5.1.12 (ii). By the above this again determines a morphism g : X → Y.
We leave it as an exercise to check that the various compatibility conditions imply that
f = g.
Example 5.2.3. Let X = SpecR be an affine scheme. If I ⊂ R is an ideal, then we can
form the affine scheme Y = Spec(R/I), and the ring homomorphism R → R/I gives us a
morphism Y → X. Note that the prime ideals of R/I are exactly the ideals p ⊂ R with p ⊃ I,
so the map Y → X is an inclusion with image Z(I). So we can view Y as an affine “closed
subscheme” of X. For a precise definition of this concept see example 7.2.10.
Now let Y1 = Spec(R/I1) and Y2 = Spec(R/I2) be closed subschemes of X. We define
the intersection scheme Y1 ∩Y2 in X to be Y1 ∩Y2 = SpecR/(I1 +I2).
For example, let X = SpecC[x1, x2], Y1 = SpecC[x1, x2]/(x2), Y2 = SpecC[x1, x2]/(x2 −
x
2
1 +a
2
) for some a ∈ C. Then the intersection scheme Y1 ∩Y2 is SpecC[x1]/((x1 −a)(x1 +
a)). For a 6= 0 we have C[x1]/((x1−a)(x1+a)) ∼= C[x1]/(x1−a)×C[x1]/(x1+a) ∼= C×C,
so Y1 ∩Y2 is just the disjoint union of the two points (a,0) and (−a,0) in C
2
. For a = 0
however we have Y1 ∩Y2 = SpecC[x1]/(x
2
1
), which has only one point (0,0). But in all
cases the ring C[x1]/((x1 −a)(x1 +a)) has dimension 2 as a vector space over C. We say
that Y1 ∩Y2 is a “scheme of length 2”, which consists either of two distinct points of length
1 each, or of one point of length (i. e. multiplicity) 2.
Note also that there is always a unique line in A
2
through Y1 ∩Y2, even in the case a = 0
where the scheme has only one geometric point. This is because the scheme Y1 ∩Y2 =
SpecC[x1, x2]/(x2,(x1 −a)(x1 +a)) is a subscheme of the line L = SpecC[x1, x2]/(c1x1 +
80 Andreas Gathmann
c2x2) if and only if (c1x1 +c2x2) ⊂ (x2,(x1 −a)(x1 +a)), which is the case only if c1 = 0.
In particular, the x1-axis is the only line in A
2
that contains SpecC[x1, x2]/(x2, x
2
1
). One
can therefore think of this scheme as “the origin together with a tangent direction along the
x1-axis”.
x 1
x 2
Y1
Y2
x 1
x 2
Y1
Y2
−a a
a=0 a=0
Example 5.2.4. Again let Y1 = Spec(R/I1) and Y2 = Spec(R/I2) be closed subschemes
of of the affine scheme X = SpecR. Note that for affine varieties the ideal of the union
of two closed subsets equals the intersection of their ideals (see exercise 1.4.1 (i)). So
scheme-theoretically we just define the union Y1 ∪Y2 to be SpecR/(I1 ∩I2).
The following lemma is the scheme-theoretic analogue of lemma 2.3.16.
Lemma 5.2.5. Let X = SpecR be an affine scheme, and let f ∈ R. Then the distinguished
open subset Xf
is the affine scheme SpecRf
.
Proof. Note that both Xf and SpecRf have the description {p ∈ X ; f ∈/ p}. So it only
remains to be checked that the structure sheaves on Xf and SpecRf agree. Now let g ∈ R
and consider the distinguished open subset Xf g = (SpecRf)g. By proposition 5.1.12 (ii)
we have
OXf
(Xf g) = OX (Xf g) = Rf g
and OSpecRf
((SpecRf)g) = (Rf)g = Rf g.
So the rings of regular functions are the same for Xf and SpecRf on every distinguished
open subset. But every open subset is the intersection of such distinguished opens, so the
rings of regular functions must be the same on every open subset.
5.3. Schemes and prevarieties. Having defined affine schemes and their morphisms, we
can now define schemes as objects that look locally like affine schemes — this is in parallel
to the definition 2.4.1 of prevarieties.
Definition 5.3.1. A scheme is a locally ringed space (X,OX ) that can be covered by open
subsets Ui ⊂ X such that (Ui
,OX |Ui
) is isomorphic to an affine scheme SpecRi for all i. A
morphism of schemes is a morphism as locally ringed spaces.
Remark 5.3.2. From the point of view of prevarieties, it would seem more natural to call
the objects defined above preschemes, and then say that a scheme is a prescheme having
the “Hausdorff” property, i. e. a prescheme with closed diagonal (see definition 2.5.1 and
lemma 2.5.3). This is in fact the terminology of [M1], but nowadays everyone seems to
adopt the definition that we gave above, and then say that a scheme having the “Hausdorff
property” is a separated scheme.
From our definitions we see that prevarieties are in a sense special cases of schemes
— if we have an affine variety X = Z(I) ⊂ A
n with I ⊂ k[x1,..., xn] an ideal, the scheme
SpecA(X) corresponds to X (where A(X) = k[x1,..., xn] is the coordinate ring of X); and
any glueing along isomorphic open subsets that can be done in the category of prevarieties
can be done equally well for the corresponding schemes. Hence we would like to say
that every prevariety is a scheme. In the strict sense of the word this is not quite true
5. Schemes 81
however, because the topological space of a scheme contains a point for every irreducible
closed subset, whereas the topological space of a prevariety consists only of the geometric
points in the classical sense (i. e. the closed points). But of course there is a natural way to
consider every prevariety as a scheme, by throwing in additional generic points for every
irreducible closed subset. We give the precise statement and leave its proof as an exercise:
Proposition 5.3.3. Let k be an algebraically closed field, and let X be a prevariety over
k. Let Xsch be the space of all non-empty closed irreducible subsets of X. Then Xsch is a
scheme in a natural way. The open subsets of X correspond bijectively to the open subsets
of Xsch, and for every open subset U of X (which can then also be considered as an open
subset of Xsch) we have OXsch (U) = OX (U). Every morphism X → Y of prevarieties over k
extends to a morphism Xsch → Ysch of schemes in a natural way.
Let us now investigate the properties of schemes that arise from prevarieties in this way.
As we have mentioned already, the glueing of schemes from affine schemes is exactly the
same as that of prevarieties from varieties. Hence the special properties of schemes that
come from prevarieties can already be seen on the level of affine schemes. We have also
seen above that in an affine scheme SpecR the ring R corresponds to what is the coordinate
ring A(X) of an affine variety. Moreover we know by remark 2.3.14 that the coordinate
ring of an affine variety is a finitely generated k-algebra that is a domain. So we have to
write down conditions on a scheme that reflect the property that its local patches SpecR
are not made from arbitrary rings, but rather from finitely generated k-algebras that are
domains.
Definition 5.3.4. Let Y be a scheme. A scheme over Y is a scheme X together with a
morphism X → Y. A morphism of schemes X1, X2 over Y is a morphism of schemes
X1 → X2 such that
X1
/

X2

Y
commutes. If R is a ring, a scheme over R is a scheme over SpecR.
A scheme X over Y is said to be of finite type over Y if there is a covering of Y by open
affine subsets Vi = SpecBi such that f
−1
(Vi) can be covered by finitely many open affines
Ui, j = SpecAi, j
, where each Ai, j
is a finitely generated Bi-algebra. In particular, a scheme
X over a field k is of finite type over k if it can be covered by finitely many open affines
Ui = SpecAi
, where each Ai
is a finitely generated k-algebra.
A scheme X is called reduced if the rings OX (U) have no nilpotent elements for all
open subsets U ⊂ X.
Now it is obvious what these conditions mean for an affine scheme SpecR:
• SpecR is a scheme over k if and only if we are given a morphism k → R, i. e. if R
is a k-algebra. Moreover, a morphism SpecR → SpecS is a morphism of schemes
over k if and only if the corresponding ring homomorphism S → R is a morphism
of k-algebras.
• SpecR is of finite type over k if and only if R is a finitely generated k-algebra.
• SpecR is reduced and irreducible if and only if f · g = 0 in R implies f = 0 or
g = 0, i. e. if and only if R is a domain. To see this, assume that f ·g = 0, but f 6= 0
and g 6= 0. If f and g are the same up to a power, then R is not nilpotent-free,
so SpecR is not reduced. Otherwise, we get a decomposition of SpecR into two
proper closed subsets Z(f) and Z(g), so SpecR is not irreducible.
82 Andreas Gathmann
As glueing affine patches is allowed for varieties in the same way as for schemes, we get
the following result:
Proposition 5.3.5. Let k be an algebraically closed field. There is a one-to-one correspondence between prevarieties over k (and their morphisms) and reduced, irreducible schemes
of finite type over k (and their morphisms).
Hence, from now on a prevariety over k will mean a reduced and irreducible scheme of
finite type over k.
Remark 5.3.6. As in the case of prevarieties, schemes and morphisms of schemes can
(almost by definition) be glued together. As for glueing schemes lemma 2.4.7 holds in
the same way (except that one may now also glue infinitely many patches Xi
, and the
isomorphic open subsets Ui, j ⊂ Xi and Uj,i ⊂ Xj can be empty, which might give rise to
disconnected schemes). A morphism from the glued scheme X to some scheme Y can then
be given by giving morphisms Xi → Y that are compatible on the overlaps in the obvious
sense.
The following generalization of proposition 5.2.2 is an application of these glueing
techniques.
Proposition 5.3.7. Let X be any scheme, and let Y = SpecR be an affine scheme. Then
there is a one-to-one correspondence between morphisms X →Y and ring homomorphisms
R = OY (Y) → OX (X).
Proof. Let {Ui} be an open affine cover of X, and let {Ui, j,k} be an open affine cover
of Ui ∩Uj
. Then by remark 5.3.6 giving a morphism f : X → Y is the same as giving
morphisms fi
: Ui → Y such that fi and fj agree on Ui ∩Uj
, i. e. such that fi
|Ui, j,k = fj
|Ui, j,k
for all i, j, k. But as the Ui and Ui, j,k are affine, by proposition 5.2.2 the morphisms fi
and fi
|Ui, j,k
correspond exactly to ring homomorphisms OY (Y) → OUi
(Ui) = OX (Ui) and
OY (Y) → OUi, j,k
(Ui, j,k) = OX (Ui, j,k), respectively. Hence a morphism f : X →Y is the same
as a collection of ring homomorphisms f
∗
i
: OY (Y) → OX (Ui) such that the compositions
ρUi
,Ui, j,k
◦ f
∗
i
: OY (Y) → OX (Ui, j,k) and ρUj
,Ui, j,k
◦ f
∗
j
: OY (Y) → OX (Ui, j,k) agree for all
i, j, k. But by the sheaf axiom for OX , this is exactly the data of a ring homomorphism
OY (Y) → OX (X).
Remark 5.3.8. By the above proposition, every scheme X admits a unique morphism to
SpecZ, determined by the natural map Z → OX (X). More explicitly, on points this map
is given by associating to every point P ∈ X the characteristic of its residue field k(P). In
particular, if X is a scheme over C (or any ground field of characteristic 0 for that matter)
then the morphism X → SpecZ maps every point to the zero ideal (0).
5.4. Fiber products. In example 2.3.9 and exercise 2.6.13 we defined the product X ×Y
for two given prevarieties X and Y by giving the product set X ×Y a suitable structure
of a ringed space. The idea of this construction was that the coordinate ring A(X ×Y)
should be A(X)⊗A(Y) if X and Y are affine (see remark 2.3.13), and then to globalize this
construction by glueing techniques. The characteristic property of the product X ×Y was
that giving a morphism to it is equivalent to giving a morphism to X and a morphism to Y
(see lemma 2.3.11 and exercise 2.6.13).
Now we want to do the same thing for schemes. More generally, if X and Y are two
schemes over a third scheme S (i. e. if morphisms f : X → S and g : Y → S are given)
we want to construct the so-called fiber product X ×S Y, that should na¨ıvely correspond to
the points (x, y) ∈ X ×Y such that f(x) = g(y). As in the case of prevarieties this will be
done by first constructing this product in the affine case, and then glueing these products
together to obtain the fiber product of general schemes. We start by defining fiber products
using the characteristic property mentioned above.
5. Schemes 83
Definition 5.4.1. Let f : X → S and g : Y → S be morphisms of schemes. We define the
fiber product X ×SY to be a scheme together with “projection” morphisms πX : X ×SY →
X and πY : X ×S Y → Y such that the square in the following diagram commutes, and
such that for any scheme Z and morphisms Z → X and Z → Y making a commutative
diagram with f and g there is a unique morphism Z → X ×S Y making the whole diagram
commutative:
Z
%
"

X ×S Y πY
/
πX

Y
g

X
f
/S
Let us first show that the fiber product is uniquely determined by this property:
Lemma 5.4.2. The fiber product X ×S Y is unique if it exists. (In other words, if F1 and
F2 are two fiber products satisfying the above characteristic property, then F1 and F2 are
canonically isomorphic.)
Proof. Let F1 and F2 be two fiber products satisfying the characteristic property of the
definition. In particular, F2 comes together with morphisms to X and Y. As F1 is a fiber
product, we get a morphism ϕ : F2 → F1
F2
#
ϕ


F1
/

Y
g

X
f
/S
so that this diagram commutes. By symmetry, we get a morphism ψ : F1 → F2 as well. The
diagram
F1
#
ϕ◦ψ


F1
/

Y
g

X
f
/S
is then commutative by construction. But the same diagram is commutative too if we
replace ϕ ◦ψ by the identity morphism. So by the uniqueness part of the definition of a
fiber product it follows that ϕ ◦ψ is the identity. Of course ψ◦ ϕ is then also the identity
by symmetry. So F1 and F2 are canonically isomorphic.
Remark 5.4.3. The following two properties of fiber products are easily seen from the
definition:
84 Andreas Gathmann
(i) If S ⊂ U is an open subset, then X ×S Y = X ×U Y (morphisms from any Z to X
and Y commuting with f and g are then the same regardless of whether the base
scheme is S or U).
(ii) If U ⊂ X and V ⊂ Y are open subsets, then the fiber product
U ×SV = π
−1
X
(U)∩π
−1
Y
(V) ⊂ X ×S Y
is an open subset of the total fiber product X ×S Y.
Now we want to show that fiber products always exist. We have already mentioned
that in the affine case, fiber products should correspond to tensor products in commutative
algebra. So let us define the corresponding tensor products first.
Definition 5.4.4. Let R be a ring, and let M and N be R-modules. For every m ∈ M and
n ∈ N let m ⊗ n be a formal symbol. We let F be the “free R-module generated by the
symbols m⊗n”, i. e. F is the R-module of formal finite linear combinations
F =

∑
i
ri(mi ⊗ni) ; ri ∈ R,mi ∈ M,ni ∈ N
	
.
Now we define the tensor product M ⊗R N of M and N over R to be the R-module F
modulo the relations
(m1 +m2)⊗n = m1 ⊗n+m2 ⊗n,
m⊗(n1 +n2) = m⊗n1 +m⊗n2,
r(m⊗n) = (rm)⊗n = m⊗(rn)
for all m,mi ∈ M, n,ni ∈ N, and r ∈ R. Obviously, M ⊗R N is an R-module as well.
Example 5.4.5.
(i) Let k be a field. Then k[x]⊗k k[y] = k[x, y], where the isomorphism is given by
k[x]⊗k k[y] → k[x, y], f(x)⊗g(y) 7→ f(x)· g(y)
and
k[x, y] → k[x]⊗k k[y], ∑
i, j
ai, jx
i
y
j
7→ ∑
i, j
ai, j(x
i ⊗y
j
).
(ii) Let R be a ring, and let I1 and I2 be ideals. Then R/I1 and R/I2 are R-modules,
and we have R/I1 ⊗R R/I2 = R/(I1 +I2). In fact, the isomorphism is given by
R/I1 ⊗R R/I2 → R/(I1 +I2), r1 ⊗r2 7→ r1 ·r2
and
R/(I1 +I2) → R/I1 ⊗R R/I2, r 7→ r(1⊗1) = (r ⊗1) = (1⊗r).
(iii) If M is any R-module, then M ⊗R R = R⊗R M = M.
Remark 5.4.6. It is easy to see that the tensor product of modules satisfies the following
characteristic property (which is exactly the same as that of definition 5.4.1, just with all
the arrows reversed):
Let R, M, and N be rings, and assume that we are given ring homomorphisms f : R → M
and g : R → N (that make M and N into R-modules). Then for every ring A and homomorphisms M → A and N → A making a commutative diagram with f and g there is a unique
5. Schemes 85
ring homomorphism M ⊗R N → A making the whole diagram commutative:
A
M ⊗R N
b
o N
l
M
OO
U
R
f
o
g
OO
where M → M ⊗R N and N → M ⊗R N are the obvious maps m 7→ m⊗1 and n 7→ 1⊗n. In
fact, if a : M → A and b : N → A are the two ring homomorphisms, then M ⊗R N → A is
given by m⊗n 7→ a(m)· b(n).
Using the tensor product of modules, we can now construct the fiber product of schemes.
Lemma 5.4.7. Let f : X → S and g : Y → S be morphisms of schemes. Then there is a fiber
product X ×S Y .
Proof. First assume that X, Y, and S are affine schemes, so X = SpecM, Y = SpecN, and
S = SpecR. The morphisms X → S and Y → S make M and N into R-modules by proposition 5.2.2. We claim that Spec(M ⊗R N) is the fiber product X ×S Y. Indeed, giving a
morphism Z → Spec(M ⊗RN) is the same as giving a homomorphism M ⊗RN → OZ(Z) by
proposition 5.3.7. By remark 5.4.6, this is the same as giving homomorphisms M → OZ(Z)
and N → OZ(Z) that induce the same homomorphism on R, which again by proposition
5.3.7 is the same as giving morphisms Z → X and Z → Y that give rise to the same morphism from Z → S. Hence Spec(M ⊗R N) is the desired product.
Now let X, Y and S be general schemes. Cover S by open affines Si
, then cover f
−1
(Si)
and g
−1
(Si) by open affines Xi, j and Yi,k, respectively. Consider the fiber products Xi, j ×Si
Yi,k that exist by the above tensor product construction. Note that by remark 5.4.3 (i) these
will then be fiber products over S as well. Now if we have another such product Xi
0
, j
0 ×S
Yi
0
,k
0 , both of them will contain the (unique) fiber product (Xi, j ∩Xi
0
, j
0) ×S (Yi,k ∩Yi
0
,k
0) as
an open subset by remark 5.4.3 (ii), hence they can be glued along these isomorphic open
subsets. It is obvious that the final scheme X ×SY obtained by glueing the patches satisfies
the defining property of a fiber product.
Example 5.4.8. Let X and Y be prevarieties over a field k. Then the scheme-theoretic
fiber product X ×Spec kY is just the product prevariety X ×Y considered earlier. In fact, this
follows from remark 2.3.13 in the affine case, and the glueing is done in the same way for
prevarieties and schemes.
Consequently, we will still use the notation X ×Y to denote the fiber product X ×Spec kY
over Speck. Note however that for general schemes X and Y one also often defines X ×Y
to be X ×SpecZ Y (see remark 5.3.8). For schemes over k, X ×Spec k Y and X ×SpecZ Y will
in general be different (see exercise 5.6.10), so one has to make clear what is meant by the
notation X ×Y.
Example 5.4.9. Let Y1 → X and Y2 → X be morphisms of schemes that are “inclusion
morphisms”, i. e. the Yi might be open subsets of X, or closed subschemes as in example
5.2.3. Then Then Y1 ×X Y2 is defined to be the intersection scheme of Y1 and Y2 in X and is
usually written Y1 ∩Y2. For example, if X = SpecR, Y1 = SpecR/I1, and Y2 = SpecR/I2 as
in example 5.2.3, then Y1 ∩Y2 is SpecR/(I1 +I2), which is consistent with example 5.4.5
(ii).
86 Andreas Gathmann
Example 5.4.10. Let Y be a scheme, and let P ∈ Y be a point. Let k = k(P) be the residue
field of P. Then there is a natural morphism Spec k → Y that maps the unique point of
Spec k to P and pulls back a section ϕ ∈ OY (U) (with P ∈ U) to the element in k(P) determined by the composition of maps OY (U) → OY,P → k(P).
Now let X →Y be a morphism. Then the fiber product X ×Y Spec k (with the morphism
Spec k →Y constructed above) is called the inverse image or fiber of X →Y over the point
P ∈ Y (hence the name “fiber product”).
As an example, consider the morphism X = A
1
C → Y = A
1
C
given by x 7→ y = x
2
. Over
the point 0 ∈Y the fiber is then Spec(C[x]⊗C[y] C), where the maps are given by y ∈ C[y] 7→
x
2 ∈ C[x] and y ∈ C[y] 7→ 0 ∈ C. This tensor product is equal to C[x]/(x
2
), so the fiber over
0 is the double point SpecC[x]/(x
2
); it is a non-reduced scheme and therefore different
from the set-theoretic inverse image of 0 as defined earlier for prevarieties.
Y
0 0
X
Example 5.4.11. Continuing the above example, one might want to think of a morphism
X → Y as some sort of fibered object, giving a scheme X ×Y Spec k(P) for every point
P ∈ Y. (This is analogous to fibered objects in topology.) Now let f : Y
0 → Y be any
morphism. Then the fiber product X
0 = X ×Y Y
0 has a natural projection morphism to Y
0
,
and its fiber over a point P ∈ Y
0
is equal to the fiber of X → Y over the point P ∈ Y. This
is usually called a base extension of the morphism X → Y. (It corresponds to e. g. the
pull-back of a vector bundle in topology.)
Y
X X
Y´
´
5.5. Projective schemes. We know that projective varieties are a special important class
of varieties that are not affine, but still can be described globally without using glueing
techniques. They arise from looking at homogeneous ideals, i. e. graded coordinate rings.
A completely analogous construction exists in the category of schemes, starting with a
graded ring and looking at homogeneous ideals in it.
Definition 5.5.1. Let R be a graded ring (think of the homogeneous coordinate ring S(X)
of a projective variety X), i. e. a ring together with a decomposition R =
L
d≥0 R
(d)
into
abelian groups such that R
(d)
·R
(e) ⊂ R
(d+e)
. An element of R
(d)
is called homogeneous of
degree d. An ideal I ⊂ R is called homogeneous if it can be generated by homogeneous
elements. Let R+ be the ideal L
d>0 R
(d)
.
We define the set ProjR to be the set of all homogeneous prime ideals p ⊂ R with R+ 6⊂ p
(compare this to theorem 3.2.6; R+ corresponds to the “irrelevant ideal” (x0,..., xn) ⊂
k[x0,..., xn]). If I ⊂ R is a homogeneous ideal, we define Z(I) = {p ∈ ProjR ; p ⊃ I} to be
the zero locus of I.
5. Schemes 87
The proof of the following lemma is the same as in the case of affine or projective
varieties:
Lemma 5.5.2. Let R be a graded ring.
(i) If {Ii} is a family of homogeneous ideals of R then T
i Z(Ii) = Z(∑i
Ii) ⊂ ProjR.
(ii) If I1,I2 ⊂ R are homogeneous ideals then Z(I1)∪Z(I2) = Z(I1I2) ⊂ ProjR.
In particular, we can define a topology on ProjR by taking the subsets of the form Z(I)
for some I to be the closed sets. Of course, the next thing to do is to define a structure of
(locally) ringed space on ProjR. This is in complete analogy to the affine case.
Next we have to define the rings of regular functions on ProjR. This is a mixture of the
case of affine schemes and projective varieties. We will more or less copy definition 5.1.11
for affine schemes, keeping in mind that in the projective (i. e. homogeneous) case our
functions should locally be quotients of homogeneous elements of R of the same degree.
Definition 5.5.3. Let R be a graded ring, and let X = ProjR. For every p ∈ ProjR, let
R(p) =

f
g
; g ∈/ p and f,g ∈ R
(d)
for some d

be the ring of degree zero elements of the localization of R with respect to the multiplicative
system of all homogeneous elements of R that are not in p. (Of course, this will correspond
to the local ring at the point p, see proposition 5.5.4 below.)
Now for every open subset U ⊂ X we define OX (U) to be
OX (U) := {ϕ = (ϕp)p∈U with ϕp ∈ R(p)
for all p ∈ U
such that “ϕ is locally of the form f
g
for f,g ∈ R
(d)
for some d”}
= {ϕ = (ϕp)p∈U with ϕp ∈ R(p)
for all p ∈ U
such that for every p ∈ U there is a neighborhood V in U and f,g ∈ R
(d)
for some d with g ∈/ q and ϕq =
f
g
∈ R(q)
for all q ∈ V.}
It is clear from the local nature of the definition of OX (U) that OX is a sheaf.
Proposition 5.5.4. Let R be a graded ring.
(i) For every p ∈ ProjR the stalk OX,p is isomorphic to the local ring R(p)
.
(ii) For every homogeneous f ∈ R+, let Xf ⊂ X be the distinguished open subset
Xf
:= X\Z(f) = {p ∈ ProjR ; f ∈/ p}.
These open sets cover X, and for each such open set we have an isomorphism of
locally ringed spaces (Xf
,OX |Xf
) ∼= SpecR(f)
, where
R(f) =

g
f
r
; g ∈ R
(r·deg f)

is the ring of elements of degree zero in the localized ring Rf
.
In particular, ProjR is a scheme.
Proof. (i): There is a well-defined homomorphism
OX,p → R(p)
, (U,ϕ) 7→ ϕ(p).
The proof that this is an isomorphism is the same as in the affine case (see proposition
5.1.12 (i).
(ii): Let p ∈ X be a point. By definition, R+ 6⊂ p, so there is a f ∈ R+ with f ∈/ p. But
then p ∈ Xf
; hence the open subsets of the form Xf cover X.
88 Andreas Gathmann
Now fix f ∈ R+; we will define an isomorphism ψ : Xf → SpecR(f)
. For any homogeneous ideal I ⊂ R, set ψ(I) := (I Rf)∩R(f)
. In particular, restricting this to prime ideals
gives a map of sets Xf → SpecR(f)
, which is easily seen to be a bijection. Moreover,
if I ⊂ R is any ideal then ψ(p) ⊃ ψ(I) if and only if p ⊃ I, so ψ : Xf → SpecR(f)
is a
homeomorphism. Note also that for p ∈ Xf
the local rings
OProjR,p = R(p) =
ng
h
; g and h homogeneous of the same degree, h ∈/ p
o
and
OSpecR(f)
,ψ(p) = (R(f)
)ψ(p)
=

g/ f
r
h/ f
s
; g and h homogeneous of degrees r· deg f and s· deg f , h ∈/ p

are isomorphic for f ∈/ p. This gives rise to isomorphisms between the rings of regular
functions OXf
(U) and OSpecR(f)
(U) (as they are by definition made up of the local rings).

Example 5.5.5. If k is an algebraically closed field, then by construction Proj k[x0,..., xn]
is the scheme that corresponds to projective n-space P
n
k
over k. More generally, the scheme
associated to a projective variety X is just ProjS(X), where S(X) = k[x0,..., xn]/I(X) is
the homogeneous coordinate ring of X.
Of course, scheme-theoretically we can now also consider schemes that are of the form
Proj k[x0,..., xn]/I where I is any homogeneous ideal of the polynomial ring. This allows
projective “subschemes of P
n
” that are not necessarily irreducible or reduced. Let us turn
this into a definition.
Definition 5.5.6. Let k be an algebraically closed field. A projective subscheme of P
n
k
is
a scheme of the form Proj k[x0,..., xn]/I for some homogeneous ideal I.
As mentioned above, every projective variety is a projective subscheme of P
n
. However,
the category of projective subschemes of P
n
is bigger because it contains schemes that are
reducible (e. g. the union of the coordinate axes in the plane Projk[x0, x1, x2]/(x1x2)) or
non-reduced (e. g. the double point Projk[x0, x1]/(x
2
1
)).
As in the case of projective varieties, we now want to make precise the relation between projective subschemes of P
n
and homogeneous ideals in k[x0,..., xn]. Note that the
existence of the irrelevant ideal (x0,..., xn) implies that this correspondence is not one-toone: the example Proj k[x0,..., xn]/(f) = Proj k[x0,..., xn]/(f x0,..., f xn) of remark 3.1.11
works for schemes as well.
Definition 5.5.7. Let I ⊂ S = k[x0,..., xn] be a homogeneous ideal. The saturation ¯I of I
is defined to be
¯I = {s ∈ S ; x
m
i
·s ∈ I for some m and all i}.
Example 5.5.8. If I = (f x0,..., f xn) then ¯I = (f). So in this case the saturation removes
the ambiguity of the ideal associated to a projective subscheme of P
n
. We will now show
that this is true in general:
Lemma 5.5.9. Let I, J ⊂ S = k[x0,..., xn] be homogeneous ideals. Then
(i) ¯I is a homogeneous ideal.
(ii) ProjS/I = ProjS/ ¯I.
(iii) ProjS/ ¯I = ProjS/J if and only if ¯ ¯I = J.¯
(iv) I
(d) = ¯I
(d)
for d  0. Here and in the following we say that a statement holds
for d  0 if and only if it holds for large enough d, i. e. if and only if there is a
number D ≥ 0 such that the statement holds for all d ≥ D.
5. Schemes 89
Proof. (i): Let s ∈ ¯I any (possibly non-homogeneous) element. Then by definition x
m
i
·s ∈ I
for some m and all i. As I is homogeneous, it follows that the graded pieces x
m
i
·s
(d)
are
in I as well for all d. Therefore, by definition, it follows that s
(d) ∈ ¯I for all i. Hence ¯I is
homogeneous.
(ii): As the open affines Ui
:= {xi 6= 0} ⊂ P
n
cover P
n
, it suffices to show that Ui ∩
ProjS/I = Ui ∩ProjS/ ¯I. But this is obvious as I|xi=1 = ¯Ixi=1.
(iii): The direction “⇒” is trivial. For “⇐” it suffices to show that the saturated ideal
¯I can be recovered from the projective scheme X = ProjS/ ¯I alone. Thinking of projective
varieties, ¯I should just be “the ideal I(X) of X”, i. e. the ideal of functions vanishing on X.
Now the elements of S do not define functions on X, but after setting one xi equal to 1 they
do define functions on X ∩Ui
. Hence we can recover ¯I from X as
¯I = {s ∈ S ; s|xi=1 = 0 on X ∩Ui for all i}
(note that the right hand side depends only on the scheme X and not on its representation
as ProjS/I for a certain I.
(iv): The inclusion I
(d) ⊂ ¯I
(d)
is obvious (for all d) as I ⊂ ¯I. So we only have to show
that ¯I
(d) ⊂ I
(d)
for d  0.
First of all note that ¯I is finitely generated; let f1,..., fm be (homogeneous) generators.
Let D1 be the maximum degree of the fi
. Next, by definition of ¯I there is a number D2 such
that x
d
j
· fi ∈ I for all 0 ≤ j ≤ n, 1 ≤ i ≤ m, and d ≥ D2. Set D = D1 + (n+1)D2.
Now let f ∈ ¯I
(d) be any homogeneous element in the saturation of degree d ≥ D. We
can write f as ∑i ai
fi
, with the ai homogeneous of degree at least (n+1)D2. This degree
bound implies that every monomial of ai contains at least one xj with a power of at least
D2. But then this power multiplied with fi
lies in I by construction. So it follows that
ai
fi ∈ I for all i, and therefore f ∈ I
(d)
.
Definition 5.5.10. If X is a projective subscheme of P
n
, we let I(X) be the saturation
of any ideal I ⊂ k[x0,..., xn] such that X = Proj k[x0,..., xn]/I. (This is well-defined by
lemma 5.5.9 (iii) and generalizes the notion of the ideal of a projective variety to projective
subschemes of P
n
.) We define S(X) to be k[x0,..., xn]/I(X). As usual, we call I(X) the
ideal of X and S(X) the homogeneous coordinate ring of X.
Corollary 5.5.11. There is a one-to-one correspondence between projective subschemes
of P
n
k
and saturated homogeneous ideals in k[x0,..., xn], given by X 7→ I(X) and I 7→
Proj k[x0,..., xn]/I.
5.6. Exercises.
Exercise 5.6.1. Find all closed points of the real affine plane A
2
R
. What are their residue
fields?
Exercise 5.6.2. Let f(x, y) = y
2 − x
2 − x
3
. Describe the affine scheme X = SpecR/(f)
set-theoretically for the following rings R:
(i) R = C[x, y] (the standard polynomial ring),
(ii) R = C[x, y](x,y)
(the localization of the polynomial ring at the origin),
(iii) R = C[[x, y]] (the ring of formal power series).
Interpret the results geometrically. In which of the three cases is X irreducible?
Exercise 5.6.3. For each of these cases below give an example of an affine scheme X with
that property, or prove that such an X does not exist:
(i) X has infinitely many points, and dimX = 0.
(ii) X has exactly one point, and dimX = 1.
(iii) X has exactly two points, and dimX = 1.
90 Andreas Gathmann
(iv) X = SpecR with R ⊂ C[x], and dimX = 2.
Exercise 5.6.4. Let X be a scheme, and let Y be an irreducible closed subset of X. If ηY
is the generic point of Y, we write OX,Y for the stalk OX,ηY
. Show that OX,Y is “the ring
of rational functions on X that are regular at a general point of Y”, i. e. it is isomorphic to
the ring of equivalence classes of pairs (U,ϕ), where U ⊂ X is open with U ∩Y 6= 0/ and
ϕ ∈ OX (U), and where two such pairs (U,ϕ) and (U
0
,ϕ
0
) are called equivalent if there is
an open subset V ⊂ U ∩U
0 with V ∩Y 6= 0/ such that ϕ|V = ϕ|V0 .
(In particular, if X is a scheme that is a variety, then OX,ηX
is the function field of X
as defined earlier. Hence the stalks of the structure sheaf of a scheme generalize both the
concepts of the local rings and the function field of a variety.)
Exercise 5.6.5. Let X be a scheme of finite type over an algebraically closed field k. Show
that the closed points of X are dense in every closed subset of X. Conversely, give an
example of a scheme X such that the closed points of X are not dense in X.
Exercise 5.6.6. Let X = {(x, y,z) ∈ C
3
; xy = xz = yz = 0} be the union of the three coordinate lines in C
3
. Let Y = {(x, y) ∈ C
2
; xy(x−y) = 0} be the union of three concurrent
lines in C
2
.
Are X and Y isomorphic as schemes? (Hint: Define and compute the tangent spaces of
X and Y at the origin.)
Exercise 5.6.7. Let X ⊂ P
3
the complex cubic surface
X = {(x0 : x1 : x2 : x3) ; x
3
0 = x1x2x3}.
(i) Show that X is singular.
(ii) Let M ⊂ G(1,3) be the subset of the Grassmannian of lines in P
3
that corresponds
to all lines in P
3
that lie in X. By writing down explicit equations for M, show
that M has the structure of a scheme in a natural way.
(iii) Show that the scheme M contains exactly 3 points, but that it has length 27 over
C, i. e. it is of the form M = SpecR with R a 27-dimensional C-algebra. Hence in
a certain sense we can say that even the singular cubic surface X contains exactly
27 lines, if we count the lines with their correct multiplicities.
Exercise 5.6.8. Let k be an algebraically closed field. An n-fold point (over k) is a scheme
of the form X = SpecR such that X has only one point and R is a k-algebra of vector space
dimension n over k (i. e. X has length n). Show that every double point is isomorphic
to Spec k[x]/(x
2
). On the other hand, find two non-isomorphic triple points over k, and
describe them geometrically.
Exercise 5.6.9. Show that for a scheme X the following are equivalent:
(i) X is reduced, i. e. for every open subset U ⊂ X the ring OX (U) has no nilpotent
elements.
(ii) For any open subset Ui of an open affine cover {Ui} of X, the ring OX (Ui) has no
nilpotent elements.
(iii) For every point P ∈ X the local ring OX,P has no nilpotent elements.
Exercise 5.6.10. Show that A
2
C  A1
C ×SpecZ A
1
C
.
Exercise 5.6.11. Let X = Z(x
2
1
x2 + x1x
2
2
x3) ⊂ A
3
C
, and denote by πi
the projection to the
i-th coordinate. Compute the scheme-theoretic fibers Xxi=a = π
−1
i
(a) for all a ∈ C, and
determine the set of isomorphism classes of these schemes.
Exercise 5.6.12. Let X be a prevariety over an algebraically closed field k, and let P ∈ X be
a (closed) point of X. Let D = Spec k[x]/(x
2
) be the “double point”. Show that the tangent
space TX,P to X at P can be canonically identified with the set of morphisms D → X that
map the unique point of D to P.
5. Schemes 91
(In particular, this gives the set of morphisms D → X with fixed image point P ∈ X the
structure of a vector space over k. Can you see directly how to add two such morphisms,
and how to multiply them with a scalar in k ?)
Exercise 5.6.13. Let X be an affine variety, let Y be a closed subscheme of X defined by
the ideal I ⊂ A(X), and let X˜ be the blow-up of X at I. Show that:
(i) X˜ = Proj(
L
d≥0
I
d
), where we set I
0
:= A(X).
(ii) The projection map X˜ → X is the morphism induced by the ring homomorphism
I
0 →
L
d≥0
I
d
.
(iii) The exceptional divisor of the blow-up, i. e. the fiber Y ×X X˜ of the blow-up X˜ →
X over Y, is isomorphic to Proj(
L
d≥0
I
d/I
d+1
).
Exercise 5.6.14. Let X = SpecR and Y = SpecS be affine schemes. Show that the disjoint
union X tY is an affine scheme with
X tY = Spec(R×S),
where as usual R × S = {(r,s) ; r ∈ R,s ∈ S} (with addition and multiplication defined
componentwise).
92 Andreas Gathmann
6. FIRST APPLICATIONS OF SCHEME THEORY
To every projective subscheme of P
n
k we associate the Hilbert function hX : Z →
Z, d 7→ dimk S(X)
(d)
. For large d the Hilbert function is a polynomial in d of degree
dimX, the so-called Hilbert polynomial χX .
We define (dimX)! times the leading coefficient of χX to be the degree of X;
this is always a positive integer. For zero-dimensional schemes the degree is just the
number of points in X counted with their scheme-theoretic multiplicities. The degree
is additive for unions of equidimensional schemes and multiplicative for intersections
with hypersurfaces (Bezout’s theorem). ´
We give some elementary applications of Bezout’s theorem for plane curves. ´
Among others, we give upper bounds for the numbers of singularities of a plane
curve and the numbers of loops of a real plane curve.
A divisor on a curve C is just a formal linear combination of points on C with
integer coefficients. To every polynomial or rational function on C we can associate
a divisor, namely the divisor of “zeros minus poles” of the polynomial or function.
The group of all divisors modulo the subgroup of divisors of rational functions is
called the Picard group PicC of C.
We show that the degree-0 part of PicC is trivial forC = P
1
, whereas it is bijective
to C itself if C is a smooth plane cubic curve. This defines a group structure on such
cubic curves that can also be interpreted geometrically. In complex analysis, plane
cubic curves appear as complex tori of the form C/Λ, where Λ is a rank-2 lattice in
C.
Finally, we give a short outlook to the important parts of algebraic geometry that
have not been covered yet in this class.
6.1. Hilbert polynomials. In this section we will restrict our attention to projective subschemes of P
n over some fixed algebraically closed field. Let us start by defining some
numerical invariants associated to a projective subscheme of P
n
.
Definition 6.1.1. Let X be a projective subscheme of P
n
k
. Note that the homogeneous coordinate ring S(X) is a graded ring, and that each graded part S(X)
(d)
is a finite-dimensional
vector space over k. We define the Hilbert function of X to be the function
hX : Z → Z
d 7→ hX (d) := dimk S(X)
(d)
.
(Note that we trivially have hX (d) = 0 for d < 0 and hX (d) ≥ 0 for d ≥ 0, so we will often
consider hX as a function hX : N → N.)
Example 6.1.2. Let X = P
n be projective space itself. Then S(X) = k[x0,..., xn], so the
Hilbert function hX (d) =
d+n
n

is just the number of degree-d monomials in n+1 variables
x0,..., xn. In particular, note that hX (d) = (d+n)(d+n−1)···(d+1)
n!
is a polynomial in d of degree
n with leading coefficient 1
n!
(compare this to proposition 6.1.5).
Example 6.1.3. Let us now consider some examples of zero-dimensional schemes.
(i) Let X = {(1 : 0),(0 : 1)} ⊂ P
1 be two points in P
1
. Then I(X) = (x0x1). So a
basis of S(X)
(d)
is given by {1} for d = 0, and {x
d
0
, x
d
1
} for d > 0. We conclude
that
hX (d) = (
1 for d = 0,
2 for d > 0.
(ii) Let X = {(1 : 0 : 0),(0 : 1 : 0),(0 : 0 : 1)} ⊂ P
2 be three points in P
2
that are not
on a line. Then I(X) = (x0x1, x0x2, x1x2). So in the same way as in (i), a basis o
6. First applications of scheme theory 93
S(X)
(d)
is given by {1} for d = 0 and {x
d
0
, x
d
1
, x
d
2
} for d > 0. Therefore
hX (d) = (
1 for d = 0,
3 for d > 0.
(iii) Let X = {(1 : 0),(0 : 1),(1 : 1)} ⊂ P
1 be three collinear points. Then I(X) =
(x0x1(x0 −x1)). The relation x
2
0
x1 = x0x
2
1
allows us to reduce the number of x0 in
a monomial x
i
0
x
j
1
provided that i ≥ 2 and j ≥ 1. So a basis of S(X)
(d)
is given by
{1} for d = 0, {x0, x1} for d = 1, and {x
d
0
, x0x
d−1
1
, x
d
1
} for d > 1. Hence
hX (d) =



1 for d = 0,
2 for d = 1,
3 for d > 1.
It is easy to see that we get the same result for three collinear points in P
2
. So
comparing this with (ii) we conclude that the Hilbert function does not only depend on the scheme X up to isomorphism, but also on the way the scheme is
embedded into projective space.
(iv) Let X ⊂ P
1 be the “double point” given by the ideal I(X) = (x
2
0
). A basis of
S(X)
(d)
is given by {1} for d = 0 and {x0x
d−1
1
, x
d
1
} for d > 0, so it follows that
hX (d) = (
1 for d = 0,
2 for d > 0.
just as in (i). So the double point “behaves like two separate points” for the Hilbert
function.
So we see that in these examples the Hilbert function becomes constant for d large enough,
whereas its initial values for small d may be different. We will now show that this is what
happens in general for zero-dimensional schemes:
Lemma 6.1.4. Let X be a zero-dimensional projective subscheme of P
n
. Then
(i) X is affine, so equal to SpecR for some k-algebra R.
(ii) This k-algebra R is a finite-dimensional vector space over k. Its dimension is
called the length of X and can be interpreted as the number of points in X
(counted with their scheme-theoretic multiplicities).
(iii) hX (d) = dimk R for d  0. In particular, hX (d) is constant for large values of d.
Proof. (i): As X is zero-dimensional, we can find a hyperplane that does not intersect X.
Then X = X\H is affine by proposition 5.5.4 (ii).
(ii): First we may assume that X is irreducible, i. e. consists of only one point (but may
have a non-trivial scheme structure), since in the reducible case X = X1 t ··· t Xm with
Xi = SpecRi for i = 1,...,m we have R = R1 × ··· × Rm by exercise 5.6.14. Moreover,
by a change of coordinates we can assume that this point is the origin in A
n
. If X =
Spec k[x1,..., xn]/I we then must have (x1,..., xn) = √
I by the Nullstellensatz. It follows
that x
d
i ∈ I for some d and all i. Consequently, every monomial of degree at least D := d ·n
lies in I (as it must contain at least one xi with a power of at least d). In other words,
k[x1,..., xn]/I has a basis (as a vector space over k) of polynomials of degree less than D.
But the space of such polynomials is finite-dimensional.
(iii): Note that I(X) is simply the homogenization of I. Conversely, I is equal to
I(X)|x0=1. So for d ≥ D an isomorphism S
(d) → R as vector spaces over k is given by
(k[x0,..., xn]/I(X))(d) → k[x1,..., xn]/I, f 7→ f |x0=1
94 Andreas Gathmann
and the inverse
k[x1,..., xn]/I 7→ (k[x0,..., xn]/I(X))(d)
, f 7→ f
h
· x
d−deg f
0
where f
h denotes the homogenization of a polynomial as in exercise 3.5.3 (note that the
second map is well-defined as k[x1,..., xn]/I has a basis of polynomials of degree less than
D).
We will now discuss the Hilbert function of arbitrary projective subschemes of P
n
(that
are not necessarily zero-dimensional).
Proposition 6.1.5. Let X be a (non-empty) m-dimensional projective subscheme of P
n
.
Then there is a (unique) polynomial χX ∈ Z[d] such that hX (d) = χX (d) for d  0. Moreover,
(i) The degree of χX is m.
(ii) The leading coefficient of χX is 1
m!
times a positive integer.
Remark 6.1.6. As the Hilbert polynomial is defined in terms of the Hilbert function for
large d, it suffices to look at the graded parts of I(X) (or S(X)) for d  0. So by lemma
5.5.9 (iv) we do not necessarily need to take the saturated ideal of X for the computation
of the Hilbert polynomial. We have as well that
χX (d) = dimk(k[x0,..., xn]/I)
(d)
for d  0
for any homogeneous ideal I such that X = Proj k[x0,..., xn]/I.
Proof. We will prove the proposition by induction on the dimension m of X. The case
m = 0 follows from lemma 6.1.4, so let us assume that m > 0. By a linear change of
coordinates we can assume that no component of X lies in the hyperplane H = {x0 = 0}.
Then there is an exact sequence of graded vector spaces over k
0 −→ k[x0,..., xn]/I(X)
·x0 −→ k[x0,..., xn]/I(X) −→ k[x0,..., xn]/(I(X) + (x0)) −→ 0.
(if the first map was not injective, there would be a homogeneous polynomial f such that
f ∈/ I(X) but f x0 ∈ I(X). We would then have X = (X ∩Z(f))∪(X ∩ H). But as no irreducible component lies in H by assumption, we must have X = X ∩Z(f), in contradiction
to f ∈/ I(X)). Taking the d-th graded part of this sequence (and using remark 6.1.6 for the
ideal I(X) + (x0)), we get
hX∩H(d) = hX (d)−hX (d −1).
for large d. By the induction assumption, hX∩H(d) is a polynomial of degree m − 1 for
large d whose leading coefficient is 1
(m−1)!
times a positive integer. We can therefore write
hX∩H(d) =
m−1
∑
i=0
ci

d
i

for d  0
for some constants ci
, where cm−1 is a positive integer (note that
d
i

is a polynomial of
degree i in d with leading coefficient 1
i!
). We claim that
hX (d) = c+
m−1
∑
i=0
ci

d +1
i+1

for d  
6. First applications of scheme theory 95
for some c ∈ Z. In fact, this follows by induction on d, as
hX (d) = hX∩H(d) +hX (d −1)
=
m−1
∑
i=0
ci

d
i

+c+
m−1
∑
i=0
ci

d
i+1

= c+
m−1
∑
i=0
ci

d +1
i+1

.

The statement of proposition 6.1.5 motivates the following definition:
Definition 6.1.7. Let X be a projective subscheme of P
n
. The degree degX of X is defined
to be (dimX)! times the leading coefficient of the Hilbert polynomial χX . (By proposition
6.1.5, this is a positive integer.)
Example 6.1.8.
(i) If X is a zero-dimensional scheme then degX is equal to the length of X, i. e. to
“the number of points in X counted with their scheme-theoretic multiplicities”.
(ii) degP
n = 1 by example 6.1.2.
(iii) Let X = Proj k[x0,..., xn]/(f) be the zero locus of a homogeneous polynomial.
We claim that degX = deg f . In fact, taking the d-th graded part of S(X) =
k[x0,..., xn]/ f · k[x0,..., xn] we get
hX (d) = dimk k[x0,..., xn]
(d) −dimk k[x0,..., xn]
(d−deg f)
=

d +n
n

−

d −deg f +n
n

=
1
n!
((d +n)···(d +1)−(d −deg f +n)···(d −deg f +1))
=
deg f
(n−1)!
d
n−1 +lower order terms.
Proposition 6.1.9. Let X1 and X2 be m-dimensional projective subschemes of P
n
, and
assume that dim(X1 ∩X2) < m. Then deg(X1 ∪X2) = degX1 +degX2.
Proof. For simplicity of notation let us set S = k[x0,..., xn]. Note that
X1 ∩X2 = ProjS/(I(X1) +I(X2)) and X1 ∪X2 = ProjS/(I(X1)∩I(X2)).
So from the exact sequence
0 → S/(I(X1)∩I(X2)) → S/I(X1)⊕S/I(X2) → S/(I(X1) +I(X2)) → 0
f 7→ (f, f)
(f,g) 7→ f −g
we conclude that
hX1
(d) +hX2
(d) = hX1∪X2
(d) +hX1∩X2
(d)
for large d. In particular, the same equation follows for the Hilbert polynomials. Comparing only the leading (i. e. d
m) coefficient we then get the desired result, since the degree of
χX1∩X2
is less than m by assumption.
Example 6.1.10. Let X be a projective subscheme of P
n
. We call
g(X) := (−1)
dimX
·(χX (0)−1)
the (arithmetic) genus of X. The importance of this number comes from the following
two facts (that we unfortunately cannot prove yet with our current techniques):
96 Andreas Gathmann
(i) The genus of X is independent of the projective embedding, i. e. if X and Y are
isomorphic projective subschemes then g(X) = g(Y). See section 6.6.3 and exercise 10.6.8 for more details.
(ii) If X is a smooth curve over C, then g(X) is precisely the “topological genus”
introduced in example 0.1.1. (Compare for example the degree-genus formula of
example 0.1.3 with exercise 6.7.3 (ii).)
Remark 6.1.11. In general, the explicit computation of the Hilbert polynomial hX of a
projective subscheme X = Proj k[x0,..., xn]/I from the ideal I is quite complicated and
requires methods of computer algebra.
6.2. Bezout’s theorem. ´ We will now prove the main property of the degree of a projective
variety: that it is “multiplicative when taking intersections”. We will prove this here only
for intersections with hypersurfaces, but there is a more general version about intersections
in arbitrary codimension (see e. g. cite Ha theorem 18.4).
Theorem 6.2.1. (Bezout’s theorem ´ ) Let X be a projective subscheme of P
n of positive
dimension, and let f ∈ k[x0,..., xn] be a homogeneous polynomial such that no component
of X is contained in Z(f). Then
deg(X ∩Z(f)) = degX · deg f.
Proof. The proof is very similar to that of the existence of the Hilbert polynomial in proposition 6.1.5. Again we get an exact sequence
0 −→ k[x0,..., xn]/I(X)
· f
−→ k[x0,..., xn]/I(X) −→ k[x0,..., xn]/(I(X) + (f)) −→ 0
from which it follows that
χX∩Z(f) = χX (d)−χX (d −deg f).
But we know that
χX (d) = degX
m!
d
m +cm−1d
m−1 +terms of order at most d
m−2
,
where m = dimX. Therefore it follows that
χX∩Z(f) =
degX
m!
(d
m −(d −deg f)
m
) +cm−1 (d
m−1 −(d −deg f)
m−1
)
+terms of order at most d
m−2
=
degX
m!
·m deg f · d
m−1 +terms of order at most d
m−2
.
We conclude that deg(X ∩Z(f)) = degX · deg f .
Example 6.2.2. Let C1 and C2 be two curves in P
2 without common irreducible components. These curves are then given as the zero locus of homogeneous polynomials of
degrees d1 and d2, respectively. We conclude that deg(C1 ∩C2) = d1 · d2 by Bezout’s the- ´
orem. By example 6.1.8 (i) this means that C1 and C2 intersect in exactly d1 · d2 points, if
we count these points with their scheme-theoretic multiplicities in the intersection scheme
C1 ∩C2. In particular, as these multiplicities are always positive integers, it follows that C1
and C2 intersect set-theoretically in at most d1 · d2 points, and in at least one point. This
special case of theorem 6.2.1 is also often called Bezout’s theorem in textbooks. ´
Example 6.2.3. In the previous example, the scheme-theoretic multiplicity of a point in
the intersection scheme C1 ∩C2 is often easy to read off from geometry: let P ∈C1 ∩C2 be
a point. Then:
(i) If C1 and C2 are smooth at P and have different tangent lines at P then P counts
with multiplicity 1 (we say: the intersection multiplicity of C1 and C2 at P is 1).
6. First applications of scheme theory 97
(ii) IfC1 andC2 are smooth at P and are tangent to each other at P then the intersection
multiplicity at P is at least 2.
(iii) If C1 is singular and C2 is smooth at P then the intersection multiplicity at P is at
least 2.
(iv) If C1 and C2 are singular at P then the intersection multiplicity at P is at least 3.
The key to proving these statements is the following. As the computation is local around
P we can assume that the curves are affine in A
2
, that P = (0,0) is the origin, and that the
two curves are given as the zero locus of one equation
C1 = { f1 = 0} where f1 = a1x+b1y+higher order terms,
C2 = { f2 = 0} where f2 = a2x+b2y+higher order terms.
If both curves are singular at the origin, their tangent space at P must be two-dimensional,
i. e. all of A
2
. This means that a1 = b1 = a2 = b2 = 0. It follows that 1, x, and y are
three linearly independent elements in k[x, y]/(f1, f2) (whose spectrum is by definition the
intersection scheme). So the intersection multiplicity is at least 3. In the same way, we get
at least 2 linearly independent elements (the constant 1 and one linear function) if only one
of the curves is singular, or both curves have the same tangent line (i. e. the linear parts of
their equations are linearly dependent).
Example 6.2.4. Consider again the twisted cubic curve in P
3
C = {(s
3
: s
2
t : st2
: t
3
) ; (s : t) ∈ P
1
}
= {(x0 : x1 : x2 : x3) ; x
2
1 −x0x2 = x
2
2 −x1x3 = x0x3 −x1x2 = 0}.
We have met this variety as the easiest example of a curve in P
3
that cannot be written as
the zero locus of two polynomials. We are now able to prove this statement very easily
using Bezout’s theorem: assume that ´ I(C) = (f,g) for some homogeneous polynomials f
and g. As the degree ofC is 3 by exercise 6.7.2, it follows that deg f ·degg = 3. This is only
possible if deg f = 3 and degg = 1 (or vice versa), i. e. one of the polynomials has to be
linear. But C is not contained in a linear space (its ideal does not contain linear functions).
In particular we see thatC cannot be the intersection of two of the quadratic polynomials
given above, as this intersection must have degree 4. In fact,
Z(x
2
1 −x0x2, x
2
2 −x1x3) = C∪ {x1 = x2 = 0}
in accordance with Bezout’s theorem and proposition ´ 6.1.9 (note that {x1 = x2 = 0} is a
line and thus has degree 1).
Let us now prove some corollaries of Bezout’s theorem. ´
Corollary 6.2.5. (Pascal’s theorem) Let X ⊂ P
2 be a conic (i. e. the zero locus of a homogeneous polynomial f of degree 2). Pick six points A,B,C,D,E,F on X that form the
vertices of a hexagon inscribed in X. Then the three intersection points of the opposite
edges of the hexagon (i. e. P = AB∩DE, Q = BC∩EF, and R = CD∩FA) lie on a line.
X
A
B
C
D
F E
P
Q
R
98 Andreas Gathmann
Proof. Consider the two reducible cubics X1 = AB ∪CD ∪ EF and X2 = BC ∪ DE ∪ FA,
and let f1 = 0 and f2 = 0 be the equations of X1 and X2, respectively. In accordance with
Bezout’s theorem, ´ X1 and X2 meet in the 9 points A,B,C,D,E,F,P,Q,R.
Now pick any point S ∈ X not equal to the previously chosen ones. Of course there are
λ,µ ∈ k such that λ f1 +µ f2 vanishes at S. Set X
0 = Z(λ f1 +µ f2); this is a cubic curve too.
Note that X
0 meets X in the 7 points A,B,C,D,E,F,S, although degX
0
· degX = 6. We
conclude by Bezout’s theorem that ´ X
0
and X have a common component. For degree
reasons the only possibility for this is that the cubic X
0
is reducible and contains the conic
X as a factor. Therefore X
0 = X ∪L, where L is a line.
Finally note that P,Q,R lie on X
0
as they lie on X1 and X2. Therefore P,Q,R ∈ X ∪L.
But these points are not on X, so they must be on the line L.
Corollary 6.2.6. Let C ⊂ P
2 be an irreducible curve of degree d. Then C has at most
d−1
2

singular points.
Remark 6.2.7. For d = 1 C must be a line, so there is no singular point. A conic is either
irreducible (and smooth) or a union of two lines, so for d = 2 the statement is obvious
too. For d = 3 the corollary states that there is at most one singular point on an irreducible
curve. In fact, the projectivization of the singular cubic affine curve y
2 = x
2 +x
3
is such an
example with one singular point (namely the origin).
Proof. Assume the contrary and let P1,...,P(
d−1
2 )+1
be distinct singular points of C. Moreover, pick arbitrary further distinct points Q1,...,Qd−3 on C (we can assume d ≥ 3 by
remark 6.2.7). We thus have a total of
d−1
2

+1+d −3 =
d
2
2 −
d
2 −1 points Pi and Qj
.
We claim that there is a curve C
0 of degree d − 2 that passes through all Pi and Qj
.
In fact, the space of all homogeneous degree-(d − 2) polynomials in three variables is a

d
2

-dimensional vector space over k, so the space of hypersurfaces of degree d − 2 is a
projective space P
N of dimension N =

d
2

−1, with the coefficients of the equation as the
homogeneous coordinates. Now the condition that such a hypersurface passes through a
given point is obviously a linear condition in this P
N. As N hyperplanes in P
N always
have a non-empty intersection, it follows that there is a hypersurface passing through any
N given points. But N =

d
2

−1 =
d
2
2 −
d
2 −1 is precisely the number of points we have.
(Compare this argument to exercise 3.5.8 and the parametrization of cubic surfaces at the
beginning of section 4.5.)
Now compute the degree of the intersection scheme C ∩C
0
. By Bezout’s theorem, it ´
must be degC · degC
0 = d(d − 2). Counting the intersection points, we see that we have
the d − 3 points Qi
, and the
d−1
2

+ 1 points Pj
that count with multiplicity at least 2 as
they are singular points of C (see example 6.2.3). So we get
deg(C∩C
0
) ≥ (d −3) +2
d −1
2

+1

= d
2 −2d +1 > degC· degC
0
.
By Bezout’s theorem it follows that ´ C and C
0 must have a common component. But C is
irreducible of degree degC > degC
0
, so this is impossible. We thus arrive at a contradiction
and conclude that the assumption of the existence of
d−1
2

+ 1 singular points was false.

The following statement about real plane curves looks quite different from corollary
6.2.6, yet the proof is largely identical. Note that every smooth real plane curve consists of
a certain number of connected components (in the classical topology); here are examples
with one real component (the left two curves) and with two real components (the right

6. First applications of scheme theory 99
x
2
4 +y
2 −4 = 0 y
2 −x
2 −
x
3
4 −1 = 0 y
2 −x
2 −
x
3
4 +1 = 0
We want to know the maximum number of such components that a real smooth curve of
degree d can have. One way of constructing curves with many components is to start with
a singular curve, and then to deform the equation a little bit to obtain a smooth curve. The
following example starts with a reducible quartic curve and deforms it into a smooth curve
with two and four components, respectively.
(
x
2
4 +y
2 −4)(x
2 +
y
2
4 −4) = 0 (
x
2
4 +y
2 −4)(x
2 +
y
2
4 −4) = 1 (
x
2
4 +y
2 −4)(x
2 +
y
2
4 −4) = −1
As in the complex case, it is more convenient to pass to the projective plane P
2
R
instead
of A
2
R
. This will add points at infinity of the curves so that every component becomes
a loop (i. e. it has no ends). For example, in the two cubic curves above one point each
is added to the curves, so that the components extending to infinity become a loop. We
are therefore asking for the maximum number of loops that a projective smooth real plane
curve of degree d can have.
There is an extra topological twist in P
2
R
that we have not encountered before. As usual,
we construct P
2
R
by taking A
2
R
(which we will draw topologically as an open disc here)
and adding a point at infinity for every direction in A
2
R
. This has the effect of adding a
boundary to the disc (with the boundary point corresponding to the point at infinity). But
note that opposite points of the boundary of the disc belong to the same direction in A
2
R
and hence are the same point in P
2
R
. In other words, P
2
R
is topologically equivalent to a
closed disc with opposite boundary points identified:
IPIR
2
identify
A A
B
B
It is easy to see that this is a non-orientable surface: if we start with a small circle and
move it across the boundary of the disc (i. e. across the infinity locus of P
2
R
then it comes
out with opposite orientation:
A
B
C
D
D
B
A
A
C
C
C
A
B
D
100 Andreas Gathmann
Consequently, we have two different types of loops. A “type 1 loop” is a loop such that
its complement has only one component (which is topologically a disc). A “type 2 loop”
is a loop such that its complement has two components (an “interior” and “exterior” of the
loop). It is interesting to note that of these two components one is a disc, and the other is a
Mobius strip. ¨
A
A
Type 1 loop Type 2 loop
(Those of you who know some algebraic topology will note that the homology group
H1(P
2
R
) is isomorphic to Z/2Z; so the two types of curves correspond to the two elements
of Z/2Z.)
With these prerequisites at hand, we can now prove the following statement (modulo
some topology statements that should be intuitively clear):
Corollary 6.2.8. (Harnack’s theorem) A real smooth curve in P
2
R
of degree d has at most

d−1
2

+1 loops.
Remark 6.2.9. A line (d = 1) has always exactly one loop. A non-empty conic (d = 2) is
a hyperbola, parabola, or ellipse, so in every case the number of loops is 1. For d = 3 the
corollary gives a maximum number of 2 loops, and for d = 4 we get at most 4 loops. We
have just seen examples of these numbers of loops above. One can show that the bound
given in Harnack’s theorem is indeed sharp, i. e. for every d one can find smooth real curves
of degree d with exactly
d−1
2

+1 loops.
Proof. Assume that the statement is false, so that there are
d−1
2

+ 2 loops in a smooth
real plane curve C. Note that any two type 1 loops must intersect (which is impossible
for a smooth curve), so there can be at most one type 1 loop. Hence assume that the first

d−1
2

+ 1 loops are of type 2, and pick one point P1,...,P(
d−1
2 )+1
on each of them. By
remark 6.2.9 we can assume that d ≥ 3, so pick d −3 further distinct points Q1,...,Qd−3
on the last loop (which can be of any type). We thus have a total of
d−1
2

+ 1 + d − 3 =
d
2
2 −
d
2 −1 points Pi and Qj
.
As in the proof of corollary 6.2.6 there is a curve C
0 of degree d −2 that passes through
all Pi and Qj
. Compute the degree of the intersection scheme C∩C
0
. By Bezout’s theorem, ´
it must be degC· degC
0 = d(d −2). Counting the intersection points, we see that we have
the d − 3 points Qi
, and the
d−1
2

+ 1 points Pj
that count with multiplicity at least 2 as
every type 2 loop divides the real projective plane in an interior and exterior region; so if
C
0
enters the interior of a type 2 loop it must exit it again somewhere. (It may also be that
C
0
is tangent to the loop or singular at the intersection point, but in this case the intersection
multiplicity must be at least 2 too.)
P1
P4
Q1
Q2 Q3
P3

6. First applications of scheme theory 101
So we get
deg(C∩C
0
) ≥ (d −3) +2
d −1
2

+1

= d
2 −2d +1 > degC· degC
0
.
By Bezout’s theorem it follows that ´ C and C
0 must have a common component. But C is
irreducible of degree degC > degC
0
, so this is impossible. We thus arrive at a contradiction
and conclude that the assumption of the existence of
d−1
2

+2 loops was false.
Corollary 6.2.10. Every isomorphism f : P
n → P
n
is linear, i. e. it is of the form f(x) =
A· x, where x = (x0,..., xn) and A is an invertible (n+1)×(n+1) matrix with elements in
the ground field.
Proof. Let H ⊂ P
n be a hyperplane, and let L ⊂ P
n be a line not contained in H. Of course,
H ∩L is scheme-theoretically just one reduced point. As f is an isomorphism, f(H)∩ f(L)
must also be scheme-theoretically one reduced point, i. e. deg(f(H) ∩ f(L)) = 1. As
degrees are always positive integers, it follows by Bezout’s theorem that deg ´ f(H) =
deg f(L) = 1. In particular, f maps hyperplanes to hyperplanes. Applying this to all hyperplanes {xi = 0} in turn, we conclude that f maps all coordinate functions xi
to linear
functions, so f(x) = A· x for some scalar matrix A. Of course A must be invertible if f has
an inverse.
6.3. Divisors on curves. Bezout’s theorem counts the number of intersection points of a ´
projective curve with a hypersurface. For example, if C ⊂ P
2
is a plane cubic then the
intersection of C with any line consists of 3 points (counted with their scheme-theoretic
multiplicities). But of course not every collection of three points on C can arise this way,
as three points will in general not lie on a line. So by reducing the intersections of curves
to just the number of intersection points we are losing information about the possible configurations of intersection schemes. In contrast, we will now present a theory that is able
to keep track of the configurations of (intersection) points on curves.
Definition 6.3.1. Let C ⊂ P
n be a smooth irreducible projective curve. A divisor on C
is a formal finite linear combination D = a1P1 + ··· + amPm of points Pi ∈ C with integer
coefficients ai
. Obviously, divisors can be added and subtracted. The group of divisors on
C is denoted DivC.
Equivalently, DivC is the free abelian group generated by the points of C.
The degree degD of a divisor D = a1P1 +···+amPm is defined to be the integer a1 +
···+am. Obviously, the degree function is a group homomorphism deg : DivC → Z.
Example 6.3.2. Divisors on a curve C can be associated to several objects:
(i) Let Z ⊂ P
n be a zero-dimensional projective subscheme of P
n
, and let P1,...,Pm
be the points in Z. Each of these points comes with a scheme-theoretic multiplicity ai (the length of the component of Z at Pi) which is a positive integer. If the
points Pi are on C, then a1P1 +···amPm is a divisor on C which we denote by (Z).
It is called the divisor associated to Z.
(ii) Let f ∈ k[x0,..., xn] be a homogeneous polynomial such thatC is not contained in
Z(f). Then C ∩Z(f) is a zero-dimensional subscheme of P
n whose points lie in
C, so by (i) there is an associated divisor (C∩Z(f)) on C. It is called the divisor
of f and denoted (f); we can think of it as the zeros of f on C counted with
their respective multiplicities. By Bezout’s theorem, the number of such zeros is ´
deg(f) = degC· deg f .
(iii) Note that the intersection scheme C ∩Z(f) and therefore the divisor (f) do not
change if we add to f an element of the ideal I(C). Hence there is a well-defined
divisor (f) for every non-zero f ∈ S(C)
(d)

102 Andreas Gathmann
(iv) Assume that C ⊂ P
2
, and that C
0 = Z(f
0
) ⊂ P
2
is another (not necessarily irreducible) curve that does not contain C as a component. Then the divisor (f
0
) is
also called the intersection product of C and C
0
and denoted C·C
0 ∈ DivC.
Lemma 6.3.3. Let C ⊂ P
n be a smooth irreducible curve, and let f,g ∈ S(C) be non-zero
homogeneous elements in the coordinate ring of C. Then (f g) = (f) + (g).
Proof. Let (f g) = a1P1 + ··· + amPm. It is obvious that set-theoretically the zeros of f g
are the union of the zeros of f and g, so f and g vanish at most at the points Pi
. Let
(f) = b1P1 +···+bmPm and (g) = c1P1 +··· cmPm. We have to show that ai = bi +ci for
all i = 1,...,m.
Fix a certain i and choose an affine open subset U = SpecR ⊂ C that contains Pi
, but
no other zero of f g. Then by definition we have ai = dimk R/(f g), bi = dimk R/(f), and
ci = dimk R/(g). The statement now follows from the exact sequence
0 −→ R/(f)
·g
−→ R/(f g)
·1
−→ R/(g) −→ 0.

Definition 6.3.4. LetC ⊂ P
n be a smooth irreducible curve, and let ϕ ∈ K(C) be a non-zero
rational function. By definition we can write ϕ =
f
g
for some non-zero f,g ∈ S(C)
(d)
. We
define the divisor of ϕ to be (ϕ) = (f)−(g) (this is well-defined by lemma 6.3.3). It can
be thought of as the zeros minus the poles of the rational function.
Remark 6.3.5. Note that the divisor of a rational function always has degree zero: if ϕ =
f
g
with f,g ∈ S(C)
(d)
, then
deg(ϕ) = deg(f)−deg(g) = d degC −d degC = 0
by Bezout’s theorem. ´
Example 6.3.6. Let C = P
1
, and consider the two homogeneous polynomials f(x0, x1) =
x0x1 and g(x0, x1) = (x0 − x1)
2
. Then (f) = P1 + P2 with P1 = (1 : 0) and P2 = (0 : 1),
and (g) = 2P3 with P3 = (1 : 1). The quotient f
g
defines a rational function ϕ on P
1 with
(ϕ) = P1 + P2 − 2P3. We have deg(f) = deg(g) = 2 and deg(ϕ) = 0 (in accordance with
remark 6.3.5).
Remark 6.3.7. By lemma 6.3.3, the map K(C)\{0} → DivC that sends every rational
function ϕ to its divisor (ϕ) is a group homomorphism, if we regard K(C)\{0} as an
abelian group under multiplication. In particular, the subset of DivC of all divisors of the
form (ϕ) is a subgroup of DivC.
Definition 6.3.8. The Picard group (or divisor class group) PicC of C is defined to be
the group DivC modulo the subgroup of all divisors of the form (ϕ) for ϕ ∈ K(C)\{0}.
If f ∈ S(C)
(d)
, we will usually still write (f) for the divisor class in PicC associated to f .
Two divisors D1 and D2 are said to be linearly equivalent if D1 −D2 = 0 ∈ PicC, i. e. if
they define the same divisor class.
Remark 6.3.9. By remark 6.3.5, the degree function deg : DivC → Z passes to a group
homomorphism deg : PicC → Z. So it makes sense to talk about the degree of a divisor
class. We define Pic0C ⊂ PicC to be the group of divisor classes of degree 0.
Remark 6.3.10. The divisor group DivC is a free (and very “big”) abelian group and therefore not very interesting. In contrast, the divisor class group PicC has quite a rich structure
that we want to study now in some easy examples.
Lemma 6.3.11. PicP
1 ∼= Z (with an isomorphism being the degree homomorphism). In
other words, on P
1 all divisors of the same degree are linearly equivalent.
6. First applications of scheme theory 103
Proof. Let D = a1P1 +···amPm be a divisor of degree zero, i. e. a1 +···+am = 0. We have
to show that D is the divisor of a rational function. In fact, assume the Pi have homogeneous
coordinates (xi
: yi); then
ϕ =
m
∏
i=1
(x yi −y xi)
ai
is a rational function such that (ϕ) = D.
Let us now move on to more complicated curves. We know already that smooth conics
in P
2
are isomorphic to P
1
, so their Picard group is isomorphic to the integers too. Let
us therefore consider cubic curves in P
2
. We will compute PicC and show that it is not
isomorphic to Z (thereby showing that cubic curves are not isomorphic to P
1
). Let us
prove a lemma first.
Lemma 6.3.12. Let C = Z(f) ⊂ P
2 be a smooth cubic curve, and let C0 = Z(g) with
g ∈ k[x0, x1, x2]
(d) be another curve that does not have C as a component. Assume that
“three points of C ∩C
0
lie on a line”, i. e. that C ·C
0
contains three points P1,P2,P3 (that
need not be distinct) such that there is a line L = Z(l) with C·L = P1 +P2 +P3. Then there
is a polynomial g0 ∈ k[x0, x1, x2]
(d−1)
such that g = l · g
0
in S(C).
Proof. By Bezout’s theorem we have ´ C
0
· L = P1 + ··· + Pd for some points Pi (that need
not be distinct, but they must contain the first three given points P1,P2,P3). Let a ∈
k[x0, x1, x2]
(d−3) be a homogeneous polynomial such that Z(a)· L = P4 + ··· + Pd (it is
obvious that this can always be found). Then Z(a f)·L = P1 +···Pd too.
Now pick any point Q ∈ L distinct from the Pi
. As g and a f do not vanish at Q, we can
find a λ ∈ k such that g+λa f vanishes at Q. It follows that g+λa f vanishes on L at least at
the d +1 points P1,...,Pd,Q. So it follows by Bezout’s theorem that ´ Z(g+λa f) contains
the line L, or in other words that g+λa f = lg0
for some g
0
. Passing to the coordinate ring
S(C) = k[x0, x1, x2]/I(C) we get the desired result.
Proposition 6.3.13. Let C ⊂ P
2 be a smooth cubic curve, and let P,Q be distinct points on
C. Then P − Q 6= 0 in PicC. In other words, there is no rational function ϕ ∈ K(C)\{0}
with (ϕ) = P − Q, i. e. no rational function that has exactly one zero which is at P, and
exactly one pole which is at Q.
Remark 6.3.14. It follows from this proposition already that a smooth plane cubic curve is
not isomorphic to P
1
(as the statement of the proposition is false for P
1 by lemma 6.3.11).
Proof. Assume the contrary. Then there is a positive integer d and homogeneous polynomials f,g ∈ S(C)
(d)
such that
(i) There are points P1,...,P3d−1 and P 6= Q such that
(f) = P1 +···+P3d−1 +P and (g) = P1 +···+P3d−1 +Q
(hence (ϕ) = P−Q for ϕ =
f
g
).
(ii) Among the P1,...,P3d−1 there are at least 2d −1 distinct points. (If this is not the
case in the first place, we can replace f by f ·l and g by g ·l some linear function
l that vanishes on C at three distinct points that are not among the Pi
. This raises
the degree of the polynomials by 1 and the number of distinct points by 3, so by
doing this often enough we can get at least 2d −1 distinct points.)
Pick d minimal with these properties.
If d = 1 then (f) = P1 +P2 +P and (g) = P1 +P2 +Q, so both f and g define the unique
line through P1 and P2 (or the tangent to C at P1 if P1 = P2). In particular, it follows that
P = Q as well, which is a contradiction. So we can assume that d > 1. We can rearrange
the Pi such that P2 6= P3, and such that P1 = P2 if there are any equal points among the Pi
.
104 Andreas Gathmann
Now consider curves given by linear combinations λ f +µg. These curves will intersect
C at least in the points P1,...,P3d−1 (as Z(f) and Z(g) do). Note that for any point R ∈ C
we can adjust λ and µ so that (λ f +µg)(R) = 0. Such a curve will then have intersection
divisor P1 +···+P3d−1 +R with C. In other words, by passing to linear combinations of
f and g we can assume that the last points P and Q in the divisors of f and g are any two
points we like. We choose P to be the third intersection point of P1P2 with C, and Q to be
the third intersection point of P1P3 with C.
By lemma 6.3.12, it now follows that f = l · f
0
and g = l
0
· g
0
in S(C) for some linear
functions l and l
0
that have intersection divisors P1 +P2 +P and P1 +P3 +Q with C. Hence
(f
0
) = P4 +···+P3d−1 +P3 and (g
0
) = P4 +···+P3d−1 +P2
Note that these f
0
and g
0
satisfy (i) for d replaced by d − 1, as P2 6= P3 by assumption.
Moreover, f
0
and g
0
satisfy (ii) because if there are any equal points among the Pi at all,
then by our relabeling of the Pi
there are only two distinct points among P1,P2,P3, so there
must still be at least 2(d −1)−1 distinct points among P4,...,P3d−1.
This contradicts the minimality of d and therefore proves the proposition.
Corollary 6.3.15. Let C be a smooth cubic curve, and let P0 ∈C be a point. Then the map
C → Pic0C, P 7→ P−P0
is a bijection.
Proof. The map is well-defined and injective by proposition 6.3.13. We will show that it
is surjective. Let D = P1 +···+Pm −Q1 −··· −Qm be any divisor of degree 0.
If m > 1 let P be the third intersection point of P1P2 with C, and let Q be the third
intersection point of Q1Q2 with C. Then P1 +P2 +P and Q1 +Q2 +Q are both the divisors
of linear forms onC. The quotient of these linear forms is a rational function whose divisor
P1 +P2 +P−Q1 −Q2 −Q is therefore 0 in PicC. It follows that D = P3 +···+Pm +Q−
Q3 − ··· − Qm −P. We have thus reduced the number m of (positive and negative) points
in D by 1. Continuing this process, we can assume that m = 1, i. e. D = P − Q for some
P,Q ∈ C.
Now let P
0 be the third intersection point of PP0 with C, and let Q
0 be the third intersection point of P0Q with C. Then P
0 + P + P0 = P
0 + Q + Q
0
in PicC as above, so
D = P−Q = Q
0 −P0, as desired.
6.4. The group structure on a plane cubic curve. Let C ⊂ P
2 be a smooth cubic curve.
Corollary 6.3.15 gives a canonical bijection between the variety C and the abelian group
Pic0C, so between two totally different mathematical objects. Using this bijection, we can
give C a group structure (after choosing a base point P0 as in the corollary) and Pic0C the
structure of a smooth projective variety.
We should mention that Pic0C can be made into a variety (the so-called Picard variety)
for every smooth projective curve C; it is in general not isomorphic to C however. (If C is
not P
1 one can show that the map P 7→ P − P0 of corollary 6.3.15 is at least injective, so
we can think of C as a subvariety of the Picard variety.)
In contrast, the statement that C can be made into an abelian group is very special to
cubic plane curves (or to be precise, to curves of genus 1). Curves of other types do not
admit such a group structure.
Example 6.4.1. Let us investigate the group structure on C geometrically. If P and Q
are two points on C (not necessarily distinct), we denote by ϕ(P,Q) the third point of
intersection of the line PQ with C, i. e. the unique point of C such that P+Q+ϕ(P,Q) is
linearly equivalent to the divisor of a linear function. We will denote the group structure
6. First applications of scheme theory 105
on C by ⊕, to distinguish it from the addition of points in DivC or PicC. Consequently,
we write 	P for the inverse of P, and nP for P⊕··· ⊕P (n times).
Of course, the zero element of the group structure on C is just P0.
By construction, P ⊕ Q is the unique point of C such that (P − P0) + (Q − P0) = (P ⊕
Q) − P0 in PicC, i. e. P + Q = (P ⊕ Q) + P0. Now let R = ϕ(P,Q). Then P + Q + R =
(P⊕Q) +P0 +R ∈ PicC, so
P⊕Q = ϕ(R,P0) = ϕ(ϕ(P,Q),P0).
In other words, to construct the point P ⊕ Q we draw a line through P and Q. Then we
draw another line through the third intersection point R of this line with C and the point P0.
The third intersection point of this second line with C is P ⊕ Q (see the picture below on
the left).
Similarly, to construct 	P we are looking for a point such that (P−P0)+ ((	P)−P0) =
0, so P+ (	P) = 2P0. In the same way as above we conclude
	P = ϕ(ϕ(P0,P0),P).
In other words, to construct the inverse 	P we draw the tangent to C through P0. Then we
draw another line through the (scheme-theoretic) third intersection point R of this tangent
with C and the point P. The third intersection point of this second line with C is 	P:
P0 P Q P0
P P
Q
R
R
P
C C
Of special geometric importance are the (tangent) lines that meet C in a point with
multiplicity (at least) 3. In analogy with the real analysis case such points will be called
inflection points:
Definition 6.4.2. Let C ⊂ P
2 be a smooth curve. A point P ∈ C is called an inflection
point of C if the tangent line to C at P intersects C in P with multiplicity at least 3. Such a
tangent line is then called a flex.
flex
C
inflection point
For cubic curves C, any line intersects C in three points, so P ∈ C is a flex if and only if
3P is the divisor of a linear function. Let us first prove that there are some inflection points
on every smooth cubic curve.
Lemma 6.4.3. Let C = Z(f) ⊂ P
2 be a smooth curve of degree d. Then
h = det
∂
2
f
∂xi∂xj

0≤i, j≤2
is a homogeneous polynomial of degree 3(d −2). (It is called the Hessian polynomial of
C. The corresponding curve H = Z(h) ⊂ P
2
is called the Hessian curve of C.)
Then P ∈ C is an inflection point of C if and only if P ∈ H.
106 Andreas Gathmann
Proof. By a linear change of coordinates we can assume that P = (1 : 0 : 0) and that the
tangent line to C at P is L = {x2 = 0}. Let f = ∑i+j+k=d ai, j,k x
i
0
x
j
1
x
k
2
. In inhomogeneous
coordinates (x0 = 1) the restriction of f to L is
f(1, x1,0) =
d
∑
i=0
ad−i,i,0x
i
1
.
As f passes through P and is tangent to L there, f |L(x1) must have a zero of order at least
2 at P, so ad,0,0 = ad−1,1,0 = 0. Now note that
∂
2
f
∂x
2
0
(P) = d(d −1)ad,0,0,
∂
2
f
∂x0∂x1
(P) = (d −1)ad−1,1,0,
∂
2
f
∂x0∂x2
(P) = (d −1)ad−1,0,1,
∂
2
f
∂x
2
1
(P) = 2ad−2,2,0.
So the Hessian polynomial at P has the form
h(P) = det


0 0 (d −1)ad−1,0,1
0 2ad−2,2,0 ∗
(d −1)ad−1,0,1 ∗ ∗

.
In the same way, note that
(
∂ f
∂x0
,
∂ f
∂x1
,
∂ f
∂x2
)(P) = (dad,0,0,ad−1,1,0,ad−1,0,1) = (0,0,ad−1,0,1),
which must be a non-zero vector by the Jacobian criterion of proposition 4.4.8 (ii) as C is
smooth at P. So ad−1,0,1 6= 0, and therefore h(P) = 0 if and only if ad−2,2,0 = 0. This is
the case if and only if f |L(x1) vanishes to order at least 3 at P, i. e. if and only if P is an
inflection point.
Corollary 6.4.4. Every smooth cubic curve in P
2 has exactly 9 inflection points.
Proof. By lemma 6.4.3 the inflection points of C are precisely the points of C ∩ H ⊂ P
2
,
where H is the Hessian curve ofC. But by Bezout’s theorem, deg ´ (C∩H) = d ·3(d −2) = 9
for d = 3. So we only have to check that every point in C ∩ H occurs with intersection
multiplicity 1.
Let us continue with the notation of the proof of lemma 6.4.3, and assume that P is an
inflection point, so that a3,0,0 = a2,1,0 = a1,2,0 = 0. We will show that the Hessian curve
H is smooth at P and has a tangent line different from that of C (i. e. its tangent line is
not L = {x2 = 0}. Both statements follow if we can prove that h(1, x1, x2) contains the
monomial x1 with a non-zero coefficient, i. e. that h contains the monomial x
2
0
x1 with a
non-zero coefficient. But note that
h(x2 = 0) = det


0 0 2a2,0,1x0 +a1,1,1x1
0 6a0,3,0x1 ∗
2a2,0,1x0 +a1,1,1x1 ∗ ∗

,
so the x
2
0
x1-coefficient of h is −24a
2
2,0,1
a0,3,0. The corollary now follows from the following
two observations:
(i) the Jacobian matrix of f at P is (3a3,0,0,a2,1,0,a2,0,1). As C is smooth this matrix
must have rank 1 by proposition 4.4.8 (ii). But a3,0,0 and a2,1,0 are zero already,
so a2,0,1 6= 0.
(ii) We know already that f |L = a0,3,0x
3
1
. As L cannot be a component of C, it follows
that a0,3,0 6= 0.

6. First applications of scheme theory 107
Remark 6.4.5. IfC is a smooth curve of degree d in P
2
, we would still expect from Bezout’s ´
theorem thatC has 3d(d −2) inflection points. This is indeed the “general” number, but for
d > 3 it may occur that C and its Hessian H do not intersect at all points with multiplicity
1, so that there are fewer than 3d(d −2) inflection points.
Lemma 6.4.6. Let C ⊂ P
2 be a smooth cubic curve, and choose an inflection point P0 as
the zero element of the group structure on C. Then a point P ∈ C is an inflection point if
and only if 3  P = P0. In particular, there are exactly 9 3-torsion points in PicC, i. e. 9
points P ∈ C such that 3P = P0.
Proof. Assume that P0 is an inflection point, i. e. 3P0 is the divisor of a linear function on
C. Then P is an inflection point if and only if 3P is the divisor of a linear function too,
which is the case if and only if 3P−3P0 = 3(P−P0) is the divisor of a rational function
(a quotient of two linear functions). This in turn is by definition the case if and only if
3  P = P0. It then follows by corollary 6.4.4 that there are exactly 9 3-torsion points in
PicC.
Corollary 6.4.7. Let C ⊂ P
2 be a smooth cubic curve. Then any line through two inflection
points of C passes through a third inflection point of C.
Proof. Choose an inflection point P0 ∈ C as the zero element for the group structure on
C. Now let P and Q be two inflection points, and let R = ϕ(P,Q) be the third intersection
point of PQ with C. Then P+Q+R is the divisor of a linear function and hence equal to
3P0 in PicC. It follows that
3(R−P0) = 3(2P0 −P−Q) = 3(P0 −P) +3(P0 −Q) = 0 ∈ PicC.
So 3R = P0, i. e. R is an inflection point by lemma 6.4.6.
Example 6.4.8. There is an interesting application of the group structure on a cubic curve
to cryptography. The key observation is that “multiplication is easy, but division is hard”.
More precisely, assume that we are given a specific cubic curve C and a zero point P0 ∈ C
for the group structure. (For practical computations one will usually do this over a finite
field to avoid rounding errors. The group structure exists in these cases too by exercise
6.7.10.) Then:
(i) Given any point P and a positive integer n, the point n  P can be computed
quickly, even for very large n (think of numbers with hundreds of digits):
(a) By repeatedly applying the operation P 7→ P⊕P, we can compute all points
2
k P for all k such that 2k < n.
(b) Now we just have to add these points 2k P for all k such that the k-th digit
in the binary representation of n is 1.
This computes the point nP in a time proportional to logn (i. e. in a very short
time).
(ii) On the other hand, given a point P and a positive integer n, it is essentially impossible to compute a point Q such that n  Q = P (assuming that such a point
exists). This is not a mathematically precise statement; there is just no algorithm
known to exist that can perform the “inverse” of the multiplication P 7→ n  P
in shorter time than a simple trial-and-error approach. Of course, if the ground
field is large and C contains enough points, this is practically impossible. In the
same way, given two points P and Q on C, there is no way to find the (smallest)
number n such that n  Q = P except trying out all integers in turn. Again, if n
has hundreds of digits this is of course practically impossible.
Using this idea, assume that Alice wants to send a secret message to Bob. We can think
of this message as just a number N (every message can be converted into a sequence of
numbers, of course). There is an easy way to achieve this if they both know a secret
108 Andreas Gathmann
key number N0: Alice just sends Bob the number N + N0 in public, and then Bob can
reconstruct the secret N by subtracting the key N0 from the transmitted number N + N0.
Any person who observed the number N +N0 in transit but does not know the secret key
N0 is not able to reconstruct the message N.
The problem is of course that Alice and Bob must first have agreed on a secret key N0,
which seems impossible as they do not have a method for secure communication yet.
This is where our cubic curve can help. Let us describe a (simplified) version of what
they might do. Alice and Bob first (publicly) agree on a ground field, a specific cubic
curve C, a zero point P0 ∈ C, and another point P ∈ C. Now Alice picks a secret (very
large) integer a, and Bob picks a secret integer b. They are not telling each other what their
secret numbers are. Instead, Alice computes aP and sends (the coordinates of) this point
to Bob. In the same way, Bob computes bP and sends this point to Alice. Now the point
abP can be used as a secret key number N0:
(i) Alice got the information about bP from Bob and knows her own secret number
a, so she can compute abP = a(bP).
(ii) In the same way, Bob knows abP = b(aP).
(iii) The only information that Alice and Bob exchanged was the data of the cubic
curve chosen, P, aP, and bP. But we have just noted that there is no practical
way to reconstruct a and b from this information, so anybody else will not be able
to determine the secret key abP from this data.
6.5. Plane cubic curves as complex tori. We will now restrict our attention to the ground
field k = C and see how smooth plane cubic curves arise in complex analysis in a totally
different way. We will only sketch most arguments; more details can be found e. g. in [K]
section 5.1 (and many other books on complex analysis).
Let U ⊂ C be an open set in the classical topology. Recall that a (set-theoretic) function
f : U → C is called holomorphic at z0 ∈ U if it is complex differentiable at z0, i. e. if the
limit
f
0
(z0) := lim
z→z0
f(z)− f(z0)
z−z0
exists. A function f : U\{z0} → C is called meromorphic if there is a number n ∈ Z and
a holomorphic function ˜f : V → C in a neighborhood V of z0 in U such that
f(z) = (z−z0)
n
·
˜f(z) and ˜f(z0) 6= 0
on V. Note that the number n is then uniquely determined; it is called the order of f at z0
and denoted ordz0
f . If n > 0 we say that f(z) has a zero of order n at z0. If n < 0 we say
that f(z) has a pole of order −n at z0. A function that is meromorphic at z0 is holomorphic
at z0 if and only if its order is non-negative.
Example 6.5.1. Any regular function on A
1
C
(i. e. any polynomial in z) is a holomorphic
function on C. Similarly, any rational function ϕ on A
1
C
is a meromorphic function on C.
The notion of zeros and poles of ϕ as a meromorphic function agrees with our old one of
definition 6.3.4, so the multiplicity of a point z ∈ C in the divisor of ϕ is precisely the order
of ϕ at z.
Conversely, there are holomorphic (resp. meromorphic) functions on C that are not
regular (resp. rational), e. g. f(z) = e
z
.
Remark 6.5.2. Although the definition of holomorphic, i. e. complex differentiable functions is formally exactly the same as that of real differentiable functions, the behavior of
the complex and real cases is totally different. The most notable differences that we will
need are:
(i) Every holomorphic function is automatically infinitely differentiable: all higher
derivatives f
(k)
exist for k > 0 and are again holomorphic functions.
6. First applications of scheme theory 109
(ii) Every holomorphic function f is analytic, i. e. it can be represented locally around
every point z0 by its Taylor series. The radius of convergence is “as large as
it can be”, i. e. if f is holomorphic in an open ball B around z0, then the Taylor series of f at z0 converges and represents f at least on B. Consequently, a
meromorphic function f of order n at z0 can be expanded in a Laurent series as
f(z) = ∑k≥n ck(z−z0)
k
. The coefficient c−1 of this series is called the residue of
f at z0 and denoted resz0
f .
(iii) (Liouville’s theorem) Every function f that is holomorphic and bounded on the
whole complex plane C is constant.
(iv) (Identity theorem) Let f and g be holomorphic functions on a connected open
subset U ⊂ C. If f and g agree on any open subset V ⊂ U then they agree on U.
By (ii) this is e. g. the case if their Taylor series agree at some point in U. One
should compare this to the algebro-geometric version of remark 2.1.9.
(v) (Residue theorem) If γ is a closed (positively oriented) contour in C and f is a
meromorphic function in a neighborhood of γ and its interior that has no poles on
γ itself, then
Z
γ
f(z)dz = 2πi ∑z0
resz0
f(z),
with the sum taken over all z0 in the interior of γ (at which f has poles). In
particular, if f is holomorphic then this integral vanishes.
In this section we will study a particular meromorphic function on C associated to
a lattice. Let us describe the construction. Fix once and for all two complex numbers
ω1,ω2 ∈ C that are linearly independent over R, i. e. that do not lie on the same real line in
C through the origin. Then the subset
Λ = Zω1 +Zω2 = {mω1 +nω2 ; m,n ∈ Z} ⊂ C
is called a lattice in C. Obviously, the same lattice in C can be obtained by different
choices of ω1 and ω2. The constructions that we will make in this section will only depend
on the lattice Λ and not on the particular choice of basis ω1,ω2.
Im z
Re z
ω
ω
1
2
Proposition and Definition 6.5.3. Let Λ = Zω1 + Zω2 be a lattice in C. There is a
meromorphic function℘(z) on C defined by
℘(z) = 1
z
2
+ ∑
ω∈Λ\{0}

1
(z−ω)
2
−
1
ω2

.
It is called the Weierstraß℘-function. It has poles of order 2 exactly at the lattice points.
Proof. It is a standard fact that an (infinite) sum of holomorphic functions is holomorphic
at z0 provided that the sum converges uniformly in a neighborhood of z0. We will only
sketch the proof of this convergence: let z0 ∈ C\Λ be a fixed point that is not in the lattice.
Then every summand is a holomorphic function in a neighborhood of z0. The expansions
110 Andreas Gathmann
of these summands for large ω are
1
(z0 −ω)
2
−
1
ω2
=
1
ω2

1
(1−
z0
ω
)
2
−1

=
z0
ω3
+terms of order at least 1
ω4
so the summands grow like ω
3
. Let us add up these values according to the absolute
value of ω. As the number of lattice points with a given absolute value (approximately)
equal to N grows linearly with N, the final sum behaves like ∑N N ·
1
N3 = ∑N
1
N2
, which is
convergent.
Note that the sum would not have been convergent without subtraction of the constant
1
ω2
in each summand, as then the individual terms would grow like 1
ω2 and therefore the
final sum would be of the type ∑N
1
N
, which is divergent.
Remark 6.5.4. It is a standard fact that in an absolutely convergent series as above all
manipulations (reordering of the summands, term-wise differentiation) can be performed
as expected. In particular, the following properties of the℘-function are obvious:
(i) The℘-function is an even function, i. e.℘(z) =℘(−z) for all z ∈ C. In particular,
its Laurent series at 0 contains only even exponents.
(ii) Its derivative is℘0
(z) = ∑ω∈Λ
−2
(z−ω)
3
. It is an odd function, i. e.℘0
(z) = −℘0
(−z).
In particular, its Laurent series at 0 contains only odd exponents. It has poles of
order 3 exactly at the lattice points.
(iii) The℘-function is doubly periodic with respect to Λ, i. e.℘(z0) =℘(z0+ω) for all
z0 ∈ C and ω ∈ Λ. To show this note first that it is obvious from (ii) that℘0
(z0) =
℘0
(z0 + ω). Now integrate ℘0
(z) along the closed contour γ = γ1 + γ2 + γ3 + γ4
shown in this picture:
γ
1
γ
2
γ
3
γ 4
0
z
z
0
+ ω
ω_
−
2
ω_
2
0 −ω ω
Of course, the result is 0, since℘is an integral of℘0
. But also the integral along
γ2 cancels the integral along γ4 as℘0
(z) is periodic. The integral along γ3 is equal
to ℘(−
ω
2
) −℘(
ω
2
) and hence vanishes too as ℘(z) is an even function. So we
conclude that
0 =
Z
γ1
℘0
(z)dz =℘(z0 +ω)−℘(z0),
i. e.℘(z) is periodic with respect to Λ too.
Lemma 6.5.5. The℘-function associated to a lattice Λ satisfies a differential equation
℘0
(z)
2 = c3℘(z)
3 +c2℘(z)
2 +c1℘(z) +c0
for some constants ci ∈ C that depend on Λ.
Proof. By remark 6.5.4 (ii) ℘0
(z)
2
is an even function with a pole of order 6 at 0. Hence
its Laurent series around 0 is
℘0
(z)
2 =
a−6
z
6
+
a−4
z
4
+
a−2
z
2
+a0 +terms of order z
>0
for some constants a−6,a−4,a−2 ∈ C. The functions ℘(z)
3
, ℘(z)
2
, ℘(z), and 1 are also
even, and they have poles of order 6,4,2, and 0, respectively. Hence there are constants
c−6, c−4, c−2, c0 ∈ C such that the series of the linear combination
f(z) :=℘0
(z)
2 −c3℘(z)
3 −c2℘(z)
2 −c1℘(z)−c0
6. First applications of scheme theory 111
has only positive powers of z. We conclude that f(z) is holomorphic around 0 and vanishes
at 0. By the identity theorem of remark 6.5.2 (iv) it then follows that f = 0 everywhere.
Remark 6.5.6. An explicit computation shows that the coefficients ci
in lemma 6.5.5 are
given by
c3 = 4, c2 = 0, c1 = −60 ∑
ω∈Λ\{0}
1
ω4
, c0 = −140 ∑
ω∈Λ\{0}
1
ω6
.
Proposition 6.5.7. Let Λ ⊂ C be a given lattice, and let C ⊂ P
2
C
be the cubic curve
C = {(x0 : x1 : x2) ; x
2
2
x0 = c3x
3
1 +c2x
2
1
x0 +c1x1x
2
0 +c0x
3
0
}
for the constants ci ∈ C of lemma 6.5.5. Then there is a bijection
Φ : C/Λ → C, z 7→ (1 :℘(z) :℘0
(z)).
Proof. As℘(z) and℘0
(z) are periodic with respect to Λ and satisfy the differential equation
of lemma 6.5.5, it is clear that Φ is well-defined. (Strictly speaking, for z = 0 we have to
note that ℘(z) has a pole of order 2 and ℘0
(z) has a pole of order 3, so ℘(z) = f(z)
z
2 and
℘0
(z) = g(z)
z
3
locally around 0 for some holomorphic functions f,g around 0 that do not
vanish at 0. Then
(1 :℘(0) :℘0
(0)) = (z
3
: z f(z) : g(z))|z=0 = (0 : 0 : 1),
so Φ is well-defined at 0 too.)
Now let (x0 : x1 : x2) ∈ C be a given point; we will show that it has exactly one inverse
image point under Φ. By what we have just said this is obvious for the “point at infinity”
(0 : 0 : 1), so let us assume that we are not at this point and hence pass to inhomogeneous
coordinates where x0 = 1.
We will first look for a number z ∈ C such that℘(z) = x1. To do so, consider the integral
Z
γ
℘0
(z)
℘(z)−x1
dz
over the boundary of any “parallelogram of periodicity” as in the following picture:
Re z
Im z
The integrals along opposite sides of the parallelogram vanish because of the periodicity
of ℘and ℘0
, so the integral must be 0. So by the residue theorem of remark 6.5.2 (v) we
get
0 = ∑
z0∈C/Λ
resz0
℘0
(z)
℘(z)−x1
. (∗)
Now note that if F(z) is any meromorphic function of order n around 0 then
res0
F
0
(z)
F(z)
= res0
nanz
n−1 +···
anz
n +···
= n,
so we conclude from (∗) that ∑z0∈C/Λ ordz0
(℘(z) − x1) = 0: the function ℘(z) − x1 has
as many zeros as it has poles in C/Λ, counted with multiplicities. (This is a statement
112 Andreas Gathmann
in complex analysis corresponding to remark 6.3.5.) As ℘(z) has a pole of order 2 in the
lattice points, it thus follows that there are exactly two points z1,z2 ∈ C/Λ such that℘(z) =
x1. Since the ℘-function is an even function, these two points are obviously negatives of
each other. Now as ℘0
is an odd function, it follows that ℘0
(z1) = −℘0
(z2). So if we
specify℘(z) and℘0
(z) there is exactly one point z ∈ C/Λ leading to the given image point
in C.
Remark 6.5.8. We are again in a similar situation as in corollary 6.3.15: we have a bijection
between a group C/Λ and a variety C. In fact, one can show that the group structure of
C/Λ is precisely the same as that of Pic0C, so we have just rediscovered our old group
structure on a plane cubic curve. But the group structure is a lot more obvious in this new
picture: e. g. the n-torsion points of C are easily read off to be

1
n
(iω1 + jω2) ; 0 ≤ i, j < n

.
In particular, there are exactly n
2 points P ∈ C such that n  P = 0, in accordance with
exercise 6.7.11 and lemma 6.4.6.
It should be said however that the bijection of proposition 6.5.7 differs from that of
corollary 6.3.15 in that both C/Λ and C can independently be made into a complex manifold (which you should roughly think of as a variety whose structure sheaf consists of
holomorphic functions instead of just polynomial functions). The map Φ of the above
proposition is then an isomorphism between these two complex manifolds.
Remark 6.5.9. The topology of a plane cubic curve becomes very clear from proposition
6.5.7: it is just a parallelogram with opposite sides identified, i. e. a torus. This agrees
with our earlier statements that a smooth plane cubic curve has genus 1, and that the genus
should be thought of as the number of “holes” in the (real) surface.
6.6. Where to go from here. After having discussed some basic algebraic geometry we
now want to sketch which important parts of the general theory are still missing in our
framework.
Example 6.6.1. Intersection theory. Let X ⊂ P
n be a projective variety of dimension r,
and let X1,...,Xr ⊂ P
n be r hypersurfaces. If the hypersurfaces are in sufficiently general
position, the intersection X1∩···∩Xr ∩X will be zero-dimensional. Bezout’s theorem then ´
tells us that the intersection consists of exactly degX1 · ··· · degXr
· degX points, counted
with multiplicities.
There is obvious room for generalizations here. Assume that we do not have r hypersurfaces X1,...,Xr
, but rather closed subvarieties X1,...,Xs of X whose codimensions in X
add up to r. If these subvarieties are in sufficiently general position then we still expect the
intersection X1 ∩···∩Xs ∩X to be zero-dimensional. So we can still ask for the number of
points in the intersection and expect a finite answer.
If X = P
r
is projective space itself, then the answer is still just degX1 · ··· ·degXs
: in P
r
the degree is multiplicative when taking intersections. For general X the situation is a lot
more subtle though — there is no single number that can be associated to any subvariety
of X and that is just multiplicative with respect to intersections. This is easy to see: if e. g.
X = P
1 ×P
1
and we consider the three 1-dimensional subvarieties of X
X1 = P
1 × {0}, X2 = P
1 × {1}, X3 = {0} ×P
1
,
then X1 ∩ X2 is empty, so if there were numbers associated to X1 and X2 whose product
gives the number of intersection points (namely zero), then one of these two numbers (say
for X1) must obviously itself be zero. But then the product of the numbers for X1 and X3
would also be zero, although X1 and X3 intersect in precisely one point.
6. First applications of scheme theory 113
It turns out however that there is a finite collection of numbers that can be associated to
any subvariety of X such that the number of points in X1 ∩ ··· ∩Xs
is given by an explicit
multilinear form in these collections of numbers. For example, in the P
1 ×P
1
case above,
curves (like X1,X2,X3 given above) are characterized by their bidegree (i. e. the bidegree of
the defining equation). In our example, the bidegrees of X1, X2, and X3 are (1,0), (1,0), and
(0,1), respectively. Two curves of bidegrees (d1, e1) and (d2, e2) then intersect in exactly
d1e2 +d2e1 points.
Setting up a corresponding theory for any variety X is the object of intersection theory.
It is essentially a well-established theory that can be set up both in algebraic geometry and
(for the ground field C) topology. In the latter case it is a part of algebraic topology. In
both cases the theory allows you to answer most questions concerning numbers of intersection points quite effectively (and without the need for computer algebra techniques).
Intersection theory is used in one form or the other in virtually every geometric field of
mathematics.
Example 6.6.2. Sheaves and vector bundles. Let us illustrate the idea behind vector bundles by an example. In section 4.5 we have shown that every smooth cubic surface in P
3
has exactly 27 lines on it. We did this by first proving that the number of lines does not
depend on the particular cubic chosen, and then calculating the number for a specific cubic
for which the answer happened to be directly computable.
Now let us consider a slightly more difficult setting. Let X ⊂ P
4 be a (3-dimensional)
smooth hypersurface of degree 5. We will see momentarily that we again expect there to
be a finite number of lines in X. So again we ask for the number of such lines. Compared
to the cubic surface case it is still true that the answer does not depend on the particular
quintic hypersurface chosen. There is no specific quintic any more however for which we
can read off the answer by simply writing down all the lines explicitly. So we need to apply
a different technique to obtain the answer.
As before, we first consider again the Grassmannian variety G(1,4) of lines in P
4
(see
exercise 3.5.4). The dimension of G(1,4) is 6. Now define the set
E := {(L, f) ; L ∈ G(1,4), f is a homogeneous polynomial of degree 5 on L ∼= P
1},
so elements of E are pairs of a line in P
4
and a quintic equation on this line. There is an
obvious projection map π : E → G(1,4) given by forgetting f .
We claim that E is a variety in a natural way. In fact, as in exercise 3.5.4 consider the
open subset U ⊂ G(1,4) isomorphic to A
6
(with coordinates a2,b2,a3,b3,a4,b4) where the
line L ∈ U can be represented by the matrix

1 0 a2 a3 a4
0 1 b2 b3 b4

. (1)
For every such line we can obviously take x0 and x1 as homogeneous coordinates on L ∼=
P
1
, so every quintic equation on L is of the form ∑i cix
i
0
x
5−i
1
for some c0,..., c5. Then
π
−1
(U) can obviously be thought of as a 12-dimensional affine space with coordinates
a2,a3,a4,b2,b3,b4, c0,..., c5. As E can be covered by these spaces, it is a 12-dimensional
variety.
Note that the fibers π
−1
(L) for L ∈ G(1,4) are all 6-dimensional vector spaces, namely
the spaces of degree-5 homogeneous polynomials on L. They are not just 6-dimensional
affine spaces but rather linear affine spaces in the sense that it is meaningful to add two
polynomials on L, and to multiply them with a scalar. So two points in E that map to the
same base point in G(1,4) can be “added”, just by summing up their coordinates ci
. In
contrast, it does not make much sense to add the coefficients ai and bi
in two matrices as
in (1), as the resulting line is not related to the two original lines in any obvious way. So
114 Andreas Gathmann
although the coordinates a2,a3,a4,b2,b3,b4 in U live in an affine space A
6
, it does not
make sense to think of this A
6
as a vector space.
Note also that E is not just the direct product of G(1,4) with a constant 6-dimensional
vector space k[x0, x1]
(5)
, as the coordinates that we can use on the line L vary with the line.
Only the fibers of π are all 6-dimensional vector spaces. We say that E is a vector bundle
of rank 6 on G(1,4).
Now let us return to our original question: to count the lines on X. Let f ∈ k[x0,..., x4]
(5)
be the polynomial whose zero locus is X. There is an obvious morphism
σ : G(1,4) → E, L 7→ (L, f |L) (2)
such that π◦σ = idG(1,4)
. Such a morphism is called a section of E: it assigns to every point
L in the base G(1,4) an element in the vector space π
−1
(L) “sitting over” L. Note that this
can indeed be thought of as a section in the sheaf-theoretic sense: suppose that we have an
open cover {Ui} of G(1,4) and morphisms σi
:Ui → π
−1
(Ui) such that π◦σi = idUi
(i. e. on
every Ui we associate to any point L ∈Ui an element in the vector space π
−1
(L)). If σi = σj
on Ui ∩Uj for all i, j, then there is obviously a global section σ : U → E that restricts to the
σi on the Ui
. In other words, we can think of the vector bundle E as a sheaf, with E(U) (in
the sense of definition 2.2.1) being the space of all morphisms σ : U → π
−1
(U) such that
π ◦σ = idU .
Finally, return to our specific section σ in (2). As the fibers of π are vector spaces, there
is also a well-defined zero section
σ0 : G(1,4) → E, L 7→ (L,0).
Obviously, a line L lies in the quintic hypersurface X if and only if f |L = 0, i. e. if and
only if σ(L) = σ0(L). So the number of lines we are looking for is simply the number
of intersection points of σ(G(1,4)) and σ0(G(1,4)). As these are both 6-dimensional
varieties in the 12-dimensional variety E, we expect a finite number of such intersection
points, showing that we expect a finite number of lines in X. Their number is now given by
intersection theory methods as explained in example 6.6.1. It can be computed explicitly
and the result turns out to be 2875. (To mention the corresponding keywords: we need
the 6th Chern class of the vector bundle E on G(1,4), and the result can be obtained using
Schubert calculus, i. e. the intersection theory on the Grassmannian G(1,4).)
Another example of a vector bundle on a smooth r-dimensional variety X is the tangent
bundle: it is just the rank-r vector bundle whose fiber over a point P ∈ X is the tangent
space TX,P. The dual vector bundle (i. e. the rank-r bundle whose fiber over a point P ∈ X
is the dual vector space to TX,P) is called the cotangent bundle and denoted ΩX,P. It can be
thought of as the vector bundle of differential forms on X.
Any operations that can be done with vector spaces can be done with vector bundles as
well, just by performing the corresponding operation in every fiber. So there are e. g. direct
sums of vector bundles, tensor products, symmetric products, exterior products, and so on.
If X is a smooth r-dimensional variety, the r-th exterior power Λ
rΩX of the cotangent
bundle is called the canonical bundle and denoted KX . Obviously it is a vector bundle of
rank 1: such bundles are called line bundles. Its importance (and name) stems from the
fact that it is canonically given for any smooth variety X.
Vector bundles (and corresponding sheaves) occur in almost any branch of algebraic
geometry, as well as in topology and differential geometry.
Example 6.6.3. Sheaf cohomology. Let X be a variety, and let E be a vector bundle on
X. By the remark above, (global) sections σ : X → E can be added and multiplied with a
scalar, so the space of global sections is in fact a vector space over the ground field k. It is
denoted H
0
(X,E).
6. First applications of scheme theory 115
As an example, let X ⊂ P
2 be a curve, and let n be an integer. For an open subset U ⊂ X
define
E(U) = 
f
g
; f,g ∈ S(X) homogeneous with deg f −degg = n, g(P) 6= 0 for all P ∈ U

.
These data form a sheaf E that can be thought of as the sheaf of regular “functions”
ϕ(x0, x1, x2) on X that satisfy ϕ(λx0,λx1,λx2) = λ
nϕ(x0, x1, x2) under rescaling of the homogeneous coordinates. An element in the fiber of E over a point P is then just given by a
number in k that rescales with λ
n
. So E is a line bundle. We will usually denote it by O(n).
For n = 0 we obviously just get the ordinary structure sheaf O.
The spaces H
0
(X,O(n)) of sections are easily written down:
H
0
(X,O(n)) = (
S(X)
(n)
for n ≥ 0,
0 for n < 0.
In particular, their dimensions (usually denoted h
0
(X,O(n))) are just the values hX (n) of
the Hilbert function. So the Hilbert function can be thought of as the dimension of the
space of global sections of a line bundle O(n).
In our study of Hilbert polynomials we have seen that Hilbert functions and polynomials
are usually computed using exact sequences (of graded vector spaces). In the same way,
the spaces of sections H
0
(X,E) are usually computed using exact sequences of vector
bundles. For example, if Y is a smooth subvariety of a smooth variety X, then there is an
exact sequence of vector bundles on X
0 → TY → TX |Y → NY/X → 0,
where NY/X is the normal bundle of Y in X — it is by definition simply the vector bundle
whose fibers are the normal spaces TX,P/TY,P. The sequence is then exact by definition
(i. e. it is exact locally at every fiber). This does not mean however that the spaces of
global sections necessarily form an exact sequence
0 → H
0
(Y,TY ) → H
0
(Y,TX |Y ) → H
0
(Y,NY/X ) → 0.
In fact one can show that one always gets an exact sequence
0 → H
0
(Y,TY ) → H
0
(Y,TX |Y ) → H
0
(Y,NY/X ),
but exactness need not be preserved in the last term: a surjective map E → F of vector
bundles need not give rise to a surjective map H
0
(X,E) → H
0
(X,F) of global sections.
An example is easily found: consider the morphism of vector bundles
O ⊕O → O(2), (ϕ1,ϕ2) 7→ x
2
0ϕ1 +x
2
1ϕ2
on P
1
. This is obviously surjective in every fiber — for every point P = (x0 : x1) ∈ P
1
at
least one of the coordinates is non-zero, so by picking suitable ϕ1(P) and ϕ2(P) we can get
any number for x
2
0ϕ1(P) +x
2
1ϕ2(P). But the corresponding morphism of global sections
H
0
(P
1
,O ⊕O) → H
0
(P
1
,O(2))
cannot be surjective simply for dimensional reasons, as the dimensions of these vector
spaces are 2 and 3, respectively.
It turns out however that there are canonically defined cohomology groups Hi
(X,E) for
i > 0 and every vector bundle E (in fact even for more general sheaves) such that every
exact sequence
0 → E1 → E2 → E3 → 0
of the bundles gives rise to an exact sequence of cohomology groups
0 → H
0
(X,E1) → H
0
(X,E2) → H
0
(X,E3) → H
1
(X,E1) → H
1
(X,E2) → H
1
(X,E3) → H
2
(X,E1) → ··· .
116 Andreas Gathmann
So every such sequence of vector bundles gives rise to a relation between the (dimensions
of the) cohomology groups: if we set
h
i
(X,E) = dimH
i
(X,E) and χ(X,E) = ∑
i
(−1)
i
h
i
(X,E)
then
χ(X,E2) = χ(X,E1) +χ(X,E3).
It can be shown that the sums in the definition of χ(X,E) are always finite. In fact, the
higher cohomology groups vanish in many cases anyway (there are a lot of so-called “vanishing theorems”), so that the above long sequence between the cohomology groups is
usually by far not as complicated as it seems to be here.
The problem of computing these numbers h
i
(X,E) (or rather χ(X,E)) is solved by the
Riemann-Roch theorem: expressed in simple terms this theorem states that χ(X,E) can
always be computed using the intersection-theoretic data of the vector bundle (namely the
Chern classes mentioned above in example 6.6.2). It is an explicit multilinear function in
these Chern classes that is usually easily computable. In particular, χ(X,O(n)) turns out to
be a polynomial in n — it is just the Hilbert polynomial of X. There is a vanishing theorem
that implies h
i
(X,O(n)) = 0 for i > 0 and n  0, so we arrive at our old characterization
of the Hilbert polynomial as the polynomial that agrees with the Hilbert function for large
n.
In particular, we see that the arithmetic genus of a variety (see example 6.1.10) is just
(−1)
dimX
(χ(X,O)−1), which obviously does not depend on the embedding of X in projective space.
The easiest case of the Riemann-Roch theorem is that of line bundles on smooth curves.
If E is a line bundle on a curve X (e. g. a bundle of the form O(n) if X is projective), we
can associate to it:
(i) intersection-theoretic data: given a (rational) section of E, how many zeros and
poles does this section have? This number is called the degree of E. For example,
the degree of O(n) on a plane curve of degree d is d · n, as every global section
of O(n) (i. e. a polynomial of degree n) vanishes on X at d · n points by Bezout’s ´
theorem.
(ii) cohomological data: how many sections of E are there? Ideally we would like
to know h
0
(X,E), but the Riemann-Roch theorem will only give us χ(X,E) =
h
0
(X,E)−h
1
(X,E).
The Riemann-Roch theorem then states that
χ(X,E) = degE +1−g,
where g is the genus of the curve X. For example, for X = P
1 we get χ(X,O(n)) = n+1−0,
which is indeed the Hilbert polynomial of P
1
.
Example 6.6.4. Moduli spaces. We have now met several instances already where it
proved useful to make the set of all geometric objects of a certain type into a scheme
(or maybe a variety):
(i) The Grassmannian G(1,n) is a variety that can be thought of as the set of all lines
in P
n
.
(ii) The affine space A
N = k[x0,..., xn]
(d)
(with N =

n+d
d

) can be thought of as the
set of all degree-d hypersurfaces in P
n
.
(iii) The vector bundle E of example 6.6.2 can be thought of as the set of pairs (L, f),
where L is a line in P
4
and f is a quintic polynomial on L
6. First applications of scheme theory 117
Schemes whose points describe geometric objects in this sense are called moduli spaces.
So we say e. g. that G(1,n) is the moduli space of lines in P
n
. There are many other moduli
spaces one may want to consider. The most prominent ones are:
(i) moduli spaces of curves (with a fixed given genus),
(ii) moduli spaces of projective subschemes of P
n with a fixed given Hilbert polynomial (the so-called Hilbert schemes),
(iii) moduli spaces of vector bundles over a given variety,
but you can try to give more or less every set of geometric objects a scheme structure. Such
a scheme structure may or may not exist, and it may or may not behave nicely.
Moduli spaces come into play when you want to consider families of geometric objects,
e. g. families of varieties. For example, a family of lines in P
n over a base scheme B
is simply a morphism f : B → G(1,n) to the moduli space of lines. This assigns to every
point of B a line in P
n
in a continuously varying way (as a morphism is given by continuous
functions). For example, if the ground field is C and you have a sequence of points Pi
in B
converging to a point P ∈ B, then we get a corresponding sequence of lines f(Pi) in P
n
that
converges to f(P). We can thus talk about convergence, limits, or “small deformations” of
the objects for which we have a moduli space. Deformations are often a powerful tool to
make complicated objects into easier ones. For example, in example 0.1.3 we computed
the genus of a plane curve by deforming it into a union of lines, for which the genus could
be read off easily.
Example 6.6.5. Classification theory. Closely related to the study of moduli spaces is the
desire to “classify all algebraic varieties” (or other objects occurring in algebraic geometry). For smooth curves the result is quite easy to state:
(i) Every smooth curve has a genus (see e. g. example 0.1.1 and 6.1.10) that is a
non-negative integer.
(ii) The moduli space of all smooth curves of a given genus g is an irreducible projective variety (with only mild singularities). Its dimension is 0 for g = 0, 1 for
g = 1, and 3g−3 for g > 1.
So this result says that curves are characterized by one discrete invariant, namely its genus.
Once the genus is fixed, every curve of this genus can be deformed continuously into any
other curve of the same genus. In contrast, curves cannot be deformed into each other if
their genera are different.
For higher-dimensional varieties the situation is a lot more complicated. As above, one
first looks for discrete invariants, i. e. “integers that can be associated to the variety in a
natural way” and that are invariant under deformation. In a second step, one can then ask
for the dimension (and other properties) of the moduli space of varieties with the given
fixed discrete invariants.
Examples of discrete invariants are:
(i) the dimension (of course),
(ii) cohomological or intersection-theoretic properties of the tangent bundle and related bundles, e. g. h
i
(X,TX ), h
i
(X,ΩX ), the Chern classes of the tangent bundle,
. . .
(iii) the genus (−1)
dimX
(χ(X,O)−1),
(iv) various intersection-theoretic data, e. g. the collection of numbers and the multilinear functions describing intersection products as in example 6.6.1.
For surfaces, this classification problem is solved, but the result is quite complicated. For
higher-dimensional varieties, the problem is still largely unsolved.
6.7. Exercises.
118 Andreas Gathmann
Exercise 6.7.1. Let X be a collection of four distinct points in some P
n
. What are the
possible Hilbert functions hX ?
Exercise 6.7.2. Compute the Hilbert function and the Hilbert polynomial of the “twisted
cubic curve” C = {(s
3
: s
2
t : st2
: t
3
) ; (s : t) ∈ P
1} ⊂ P
3
.
Exercise 6.7.3. Let X ⊂ P
n be a projective scheme with Hilbert polynomial χ. As in
example 6.1.10 define the arithmetic genus of X to be g(X) = (−1)
dimX
·(χ(0)−1).
(i) Show that g(P
n
) = 0.
(ii) If X is a hypersurface of degree d in P
n
, show that g(X) =
d−1
n

. In particular, if
C ⊂ P
2
is a plane curve of degree d, then g(C) = 1
2
(d −1)(d −2) (compare this
to example 0.1.3).
(iii) Compute the arithmetic genus of the union of the three coordinate axes
Z(x1x2, x1x3, x2x3) ⊂ P
3
.
Exercise 6.7.4. For N = (n+1)(m+1)−1 let X ⊂ P
N be the image of the Segre embedding P
n ×P
m → P
N. Show that the degree of X is
n+m
n

.
Exercise 6.7.5. Let X be an ellipse in the real plane R
2
, and let P be a given point on X.
Using only a ruler with no markings, construct the tangent line to X at P.
(In other words: start with a piece of paper which has only the ellipse X and the marked
point P ∈ X on it. The only thing you are now allowed to do is to repeatedly draw straight
lines through two points that have already been constructed (the point P, intersection points
of previously drawn curves, or arbitrarily chosen points). No measuring of lengths or
angles is permitted. Give an algorithm that finally allows you to draw the tangent line to X
at P this way.)
Exercise 6.7.6. Let C ⊂ P
n be an irreducible curve of degree d. Show that C is contained
in a linear subspace of P
n of dimension d.
Exercise 6.7.7. Let X and Y be subvarieties of P
n
k
that lie in disjoint linear subspaces of
P
n
k
. Recall from exercises 3.5.7 and 4.6.1 that the join J(X,Y) ⊂ P
n
k
of X and Y is defined
to be the union of all lines PQ with P ∈ X and Q ∈ Y.
(i) Show that S(J(X,Y))(d) ∼=
L
i+j=d S(X)
(i) ⊗k S(X)
(j)
.
(ii) Show that degJ(X,Y) = degX · degY.
Exercise 6.7.8. Let C1 = { f1 = 0} and C2 = { f2 = 0} be affine curves in A
2
k
, and let
P ∈ C1 ∩C2 be a point. Show that the intersection multiplicity of C1 and C2 at P (i. e. the
length of the component at P of the intersection scheme C1 ∩C2) is equal to the dimension
of the vector space OA2,P
/(f1, f2) over k.
Exercise 6.7.9. Let C1,C2 ⊂ P
2 be distinct smooth cubic curves, and assume that C1 and
C2 intersect in 9 (distinct) points P1,...,P9. Prove that every cubic curve passing through
P1,...,P8 also has to pass through P9.
Can you find a stronger version of this statement that applies in the case that the intersection multiplicities in C1 ∩C2 are not all equal to 1 ?
Exercise 6.7.10. Let C be a smooth cubic curve of the form
C = {(x : y : z) ; y
2
z = x
3 +axz2 +bz3
} ⊂ P
2
k
for some given a,b ∈ k. (It can be shown that every cubic can be brought into this form
by a change of coordinates.) Pick the point P0 = (0 : 1 : 0) as the zero element for the
group structure on C. For given points P1 = (x1 : y1 : 1) and P2 = (x2 : y2 : 1) compute
explicitly the coordinates of the inverse 	P1 and of the sum P1 ⊕ P2. Conclude that the
group structure on C is well-defined even if k is not necessarily algebraically close
6. First applications of scheme theory 119
Exercise 6.7.11. Let C ⊂ P
2
C
be a smooth cubic curve, and let P ∈C be an inflection point
of C. Show that there are exactly 4 tangents of C that pass through P. Conclude that there
are exactly 4 divisor classes D in PicC such that 2D = 0.
Exercise 6.7.12. LetC ⊂ P
2 be a smooth cubic curve, and let P,Q ∈C be two points. Show
that there is an isomorphism f : C → C with f(P) = Q. Is this isomorphism unique?
Exercise 6.7.13. Check that the cubic curve C ⊂ P
2
C
defined by a lattice Λ ⊂ C as in
proposition 6.5.7 is smooth.
Exercise 6.7.14. Using the complex analysis methods of section 6.5, reprove the statement
of proposition 6.3.13 that there is no rational function ϕ on a smooth plane complex cubic
curve C with divisor (ϕ) = P−Q if P and Q are two distinct points on C.
Exercise 6.7.15. Let C ⊂ P
2
C
be a smooth cubic curve arising from a lattice Λ ⊂ C. Show
that the group structure of Pic0
C
is isomorphic to the natural group structure of C/Λ.
Exercise 6.7.16. Let Λ ⊂ C be a lattice. Given a point z ∈ C/Λ and any n ∈ Z, it is
obviously very easy to find a point w ∈ C/Λ such that n ·w = z (in the group structure of
C/Λ). Isn’t this a contradiction to the idea of example 6.4.8?
120 Andreas Gathmann
7. MORE ABOUT SHEAVES
We present a detailed study of sheaves on a scheme X, in particular sheaves of OX -
modules. For any presheaf F
0 on X there is an associated sheaf F that describes “the
same objects as F
0 but with the conditions on the sections made local”. This allows
us to define sheaves by constructions that would otherwise only yield presheaves. We
can thus construct e. g. direct sums of sheaves, tensor products, kernels and cokernels
of morphisms of sheaves, as well as push-forwards and pull-backs along morphisms
of schemes.
A sheaf of OX -modules is called quasi-coherent if it is induced by an R-module
on every affine open subset U = SpecR of X. Almost all sheaves that we will consider are of this form. This reduces local computations regarding these sheaves to
computations in commutative algebra.
A quasi-coherent sheaf on X is called locally free of rank r if it is locally isomorphic to O
⊕r
X
. Locally free sheaves are the most well-behaved sheaves; they
correspond to vector bundles in topology. Any construction and theorem valid for
vector spaces can be carried over to the category of locally free sheaves. Locally free
sheaves of rank 1 are called line bundles.
For any morphism f : X → Y we define the sheaf of relative differential forms
ΩX/Y on X relative Y. The most important case is when Y is a point, in which case
we arrive at the sheaf ΩX of differential forms on X. It is locally free of rank dimX
if and only if X is smooth. In this case, its top alternating power Λ
dimXΩX is a line
bundle ωX called the canonical bundle. On a smooth projective curve it has degree
2g−2, where g is the genus of the curve.
On every smooth curve X the line bundles form a group which is isomorphic to
the Picard group PicX of divisor classes. A line bundle together with a collection
of sections that do not vanish simultaneously at any point determines a morphism to
projective space.
If f : X →Y is a morphism of smooth projective curves, the Riemann-Hurwitz formula states that the canonical bundles of X and Y are related by ωX = f
∗ωY ⊗OX (R),
where R is the ramification divisor. For any smooth projective curve X of genus g
and any divisor D the Riemann-Roch theorem states that h
0
(D) − h
0
(KX − D) =
degD+1−g, where h
0
(D) denotes the dimension of the space of global sections of
the line bundle O(D) associated to D.
7.1. Sheaves and sheafification. The first thing we have to do to discuss the more advanced topics mentioned in section 6.6 is to get a more detailed understanding of sheaves.
Recall from section 2.2 that we defined a sheaf to be a structure on a topological space X
that describes “function-like” objects that can be patched together from local data. Let us
first consider an informal example of a sheaf that is not just the sheaf of regular functions
on a scheme.
Example 7.1.1. Let X be a smooth complex curve. For any open subset U ⊂ X, we have
seen that the ring of regular functions OX (U) onU can be thought of as the ring of complexvalued functions ϕ : U → C,P 7→ ϕ(P) “varying nicely” (i. e. as a rational function) with
P.
Now consider the “tangent sheaf” TX , i. e. the sheaf “defined” by
TX (U) = {ϕ = (ϕ(P))P∈U ; ϕ(P) ∈ TX,P“varying nicely with P”}
(of course we will have to make precise what “varying nicely” means). In other words, a
section ϕ ∈ TX (U) is just given by specifying a tangent vector at every point in U. As an
example, here is a picture of a section of TP1 (P
1
):
7. More about sheaves 121
P
TX,P
φ(P)
As the tangent spaces TX,P are all one-dimensional complex vector spaces, ϕ(P) can again
be thought of as being specified by a single complex number, just as for the structure sheaf
OX . The important difference (that is already visible from the definition above) is that
these one-dimensional vector spaces vary with P and thus have no canonical identification
with the complex numbers. For example, it does not make sense to talk about “the tangent
vector 1” at a point P. Consequently, there is no analogue of “constant functions” for
sections of the tangent sheaf. In fact, we will see in lemma 7.4.15 that every global section
of TP1 has two zeros, so there is really no analogue of constant functions. (In the picture
above, the north pole of the sphere is a point where the section of TP1 would be ill-defined
if we do not choose a section in which the lengths of the tangent vectors approach zero
towards the north pole.) Hence we have seen that the tangent sheaf of P
1
is a sheaf that is
not isomorphic to the structure sheaf OP1 although its sections are given locally by “one
complex number varying nicely”.
(We should mention that the above property of P
1
is purely topological: there is not
even a continuous nowhere-zero tangent field on the unit sphere in R
3
. This is usually
called the “hairy ball theorem” and stated as saying that “you cannot comb a hedgehog
(i. e. a ball) without a bald spot”.)
Let us now get more rigorous. Recall that a presheaf of rings F on a topological space
X was defined to be given by the data:
• for every open set U ⊂ X a ring F (U),
• for every inclusion U ⊂V of open sets in X a ring homomorphism ρV,U : F (V) →
F (U) called the restriction map,
such that
• F (0/) = 0,
• ρU,U is the identity map for all U,
• for any inclusion U ⊂ V ⊂ W of open sets in X we have ρV,U ◦ ρW,V = ρW,U .
The elements of F (U) are then called the sections of F over U, and the restriction maps
ρV,U are written as f 7→ f |U . The space of global sections F (X) is often denoted Γ(F ).
A presheaf F of rings is called a sheaf of rings if it satisfies the following glueing
property: if U ⊂ X is an open set, {Ui} an open cover of U and fi ∈ F (Ui) sections for all i
such that fi
|Ui∩Uj = fj
|Ui∩Uj
for all i, j, then there is a unique f ∈ F (U) such that f |Ui = fi
for all i. In other words, sections of a sheaf can be patched from compatible local data.
The same definition applies equally to categories other than rings, e. g. we can define
sheaves of Abelian groups, k-algebras, and so on. For a ringed space (X,OX ), e. g. a
scheme, we can also define sheaves of OX -modules in the obvious way: every F (U) is
required to be an OX (U)-module, and these module structures have to be compatible with
122 Andreas Gathmann
the restriction maps in the obvious sense. For example, the tangent sheaf of example 7.1.1
on a curve X is a sheaf of OX -modules: “sections of the tangent sheaf can be multiplied
with regular functions”.
Example 7.1.2. Let X ⊂ P
N be a projective variety over an algebraically closed field k, and
let S(X) = S =
L
d≥0 S
(d) be its homogeneous coordinate ring. For any integer n, let K(n)
be the n-th graded piece of the localization of S at the non-zero homogeneous elements,
i. e.
K(n) = 
f
g
; f ∈ S
(d+n)
,g ∈ S
(d)
for some d ≥ 0 and g 6= 0

.
Now for any P ∈ X and open set U ⊂ X we set
OX (n)P =

f
g
∈ K(n) ; g(P) 6= 0

and OX (n)(U) = \
P∈U
OX (n)P.
For n = 0 this is precisely the definition of the structure sheaf, so OX (0) = OX . In general,
OX (n) is a sheaf of OX -modules whose sections can be thought of as “functions” of degree
n in the homogeneous coordinates of X. For example:
(i) Every homogeneous polynomial of degree n defines a global section of OX (n).
(ii) There are no global sections of OX (n) for n < 0.
(iii) In P
1 with homogeneous coordinates x0, x1, we have
1
x0
∈ OP1 (−1)(U)
for U = {(x0 : x1) ; x0 6= 0}.
Note that on the distinguished open subset Xxi
(where xi are the coordinates of P
N) the
sheaf OX (n) is isomorphic to the structure sheaf OX : for every open subset U ⊂ Xxi
the
maps
OX (U) → OX (n)(U), ϕ 7→ ϕ· x
n
i
and OX (n)(U) → OX (U), ϕ 7→
ϕ
x
n
i
give an isomorphism, hence OX (n)|Xxi
∼= OX |Xxi
. So OX (n) is locally isomorphic to the
structure sheaf, but not globally. (This is the same situation as for the tangent sheaf of a
smooth curve in example 7.1.1.)
The sheaves O(n) on a projective variety (or more generally on a projective scheme)
are called the twisting sheaves. They are probably the most important sheaves after the
structure sheaf.
If we want to deal with more general sheaves, we certainly need to set up a suitable
category, i. e. we have to define morphisms of sheaves, kernels, cokernels, and so on. Let
us start with some simple definitions.
Definition 7.1.3. Let X be a topological space. A morphism f : F1 → F2 of presheaves
of abelian groups (or rings, sheaves of OX -modules etc.) on X is a collection of group
homomorphisms (resp. ring homomorphisms, OX (U)-module homomorphisms etc.) fU :
F1(U) → F2(U) for every open subset U ⊂ X that commute with the restriction maps, i. e.
the diagram
F1(U)
ρU,V
/
fU

F1(V)
fV

F2(U)
ρU,V
/F2(V)
is required to be commutative.
7. More about sheaves 123
Example 7.1.4. If X ⊂ P
N is a projective variety and f ∈ k[x0,..., xN] is a homogeneous
polynomial of degree d, we get morphisms of sheaves of OX -modules
OX (n) → OX (n+d), ϕ 7→ f ·ϕ
for all n.
Definition 7.1.5. If f : X → Y is a morphism of topological spaces and F is a sheaf on
X, then we define the push-forward f∗F of F to be the sheaf on Y given by f∗F (U) =
F (f
−1
(U)) for all open subsets U ⊂ Y.
Example 7.1.6. By definition, a morphism f : X → Y of ringed spaces comes equipped
with a morphism of sheaves OY → f∗OX . This is exactly given by the data of the pull-back
morphisms OY (U) → OX (f
−1
(U)) for all open subsets U ⊂ Y (see definition 5.2.1).
Definition 7.1.7. Let f : F1 → F2 be a morphism of sheaves of e. g. Abelian groups on a
topological space X. We define the kernel ker f of f by setting
(ker f)(U) = ker(fU : F1(U) → F2(U)).
We claim that ker f is a sheaf on X. In fact, it is easy to see that ker f with the obvious
restriction maps is a presheaf. Now let {Ui} be an open cover of an open subset U ⊂ X,
and assume we are given ϕi ∈ ker(F1(Ui) → F2(Ui)) that agree on the overlaps Ui ∩Uj
. In
particular, the ϕi are then in F1(Ui), so we get a unique ϕ ∈ F1(U) with ϕ|Ui = ϕi as F1
is a sheaf. Moreover, f(ϕi) = 0, so (f(ϕ))|Ui = 0 by definition 7.1.3. As F2 is a sheaf, it
follows that f(ϕ) = 0, so ϕ ∈ ker f .
What the above argument boils down to is simply that the property of being in the
kernel, i. e. of being mapped to zero under a morphism, is a local property — a function is
zero if it is zero on every subset of an open cover. So the kernel is again a sheaf.
Remark 7.1.8. Now consider the dual case to definition 7.1.7, namely cokernels. Again let
f : F1 → F2 be a morphism of sheaves of e. g. Abelian groups on a topological space X.
As above we define a presheaf coker0
f by setting
(coker0
f)(U) = coker(fU : F1(U) → F2(U)) = F2(U)/im fU .
Note however that coker0
f is not a sheaf. To see this, consider the following example. Let
X = A
1\{0}, Y = A
2\{0}, and let i : X → Y be the inclusion morphism (x1) 7→ (x1,0).
Let i
#
: OY → i∗OX be the induced morphisms of sheaves on Y of example 7.1.6, and
consider the presheaf coker0
i
# on Y. Look at the cover of Y by the affine open subsets
U1 = {x1 6= 0} ⊂ Y and U2 = {x2 6= 0} ⊂ Y. Then the maps
k

x1,
1
x1
, x2

= OY (U1) → OX (U1 ∩X) = k

x1,
1
x1

and k

x1, x2,
1
x2

= OY (U2) → OX (U2 ∩X) = 0
are surjective, hence (coker0
i
#
)(U1) = (coker0
i
#
)(U2) = 0. But on global sections the map
k[x1, x2] = OY (Y) → OX (X) = k

x1,
1
x1

is not surjective, hence (coker0
i
#
)(Y) 6= 0. This shows that coker0
i
#
cannot be a sheaf —
the zero section on the open cover {U1,U2} has no unique extension to a global section on
Y.
What the above argument boils down to is simply that being in the cokernel of a morphism, i. e. of being a quotient in F2(U)/im fU , is not a local property — it is a question
about finding a global section of F2 on U that cannot be answered locally.
124 Andreas Gathmann
Example 7.1.9. Here is another example showing that quite natural constructions involving sheaves often lead to only presheaves because the constructions are not local. Let
X ⊂ P
N be a projective variety. Consider the tensor product presheaf of the sheaves OX (1)
and OX (−1), defined by
(OX (1)⊗
0 OX (−1))(U) = OX (1)(U)⊗OX (U) OX (−1)(U).
As OX (1) describes “functions” of degree 1 and OX (−1) “functions” of degree −1, we expect products of them to be true functions of pure degree 0 in the homogeneous coordinates
of X. In other words, the tensor product of OX (1) with OX (−1) should just be the structure
sheaf OX . However, OX (1)⊗0 OX (−1) is not even a sheaf: consider the case X = P
1
and
the open subsets U0 = {x0 6= 0} and U1 = {x1 6= 0}. On these open subsets we have the
sections
x0 ⊗
1
x0
∈ (OX (1)⊗
0 OX (−1))(U0)
and x1 ⊗
1
x1
∈ (OX (1)⊗
0 OX (−1))(U1).
Obviously, both these local sections are the constant function 1, so in particular they agree
on the overlap U0 ∩U1. But there is no global section in OX (1)(X)⊗OX (X) OX (−1)(X) that
corresponds to the constant function 1, as OX (−1) has no non-zero global sections at all.
The way out of this trouble is called sheafification. This means that for any presheaf
F
0
there is an associated sheaf F that is “very close” to F
0
and that should usually be
the object that one wants. Intuitively speaking, if the sections of a presheaf are thought
of as function-like objects satisfying some conditions, then the associated sheaf describes
the same objects with the conditions on them made local. In particular, if we look at F
0
locally, i. e. at the stalks, then we should not change anything; it is just the global structure
that changes. We have done this construction quite often already without explicitly saying
so, e. g. in the construction of the structure sheaf of schemes in definition 5.1.11. Here is
the general construction:
Definition 7.1.10. Let F
0 be a presheaf on a topological space X. The sheafification of
F
0
, or the sheaf associated to the presheaf F
0
, is defined to be the sheaf F such that
F (U) := {ϕ = (ϕP)P∈U with ϕP ∈ F
0
P
for all P ∈ U
such that for every P ∈ U there is a neighborhood V in U
and a section ϕ
0 ∈ F
0
(V) with ϕQ = ϕ
0
Q ∈ F
0
Q
for all Q ∈ V.}
(For the notion of the stalk F
0
P
of a presheaf F
0
at a point P ∈ X see definition 2.2.7.) It is
obvious that this defines a sheaf.
Example 7.1.11. Let X ⊂ A
N be an affine variety. Let O
0
X
be the presheaf given by
O
0
X
(U) =n
ϕ : U → k ; there are f,g ∈ k[x1,..., xN] with g(P) 6= 0
and ϕ(P) = f(P)
g(P)
for all P ∈ U
o
for all open subsets U ⊂ X, i. e. the “presheaf of functions that are (globally) quotients of
polynomials”. Then the structure sheaf OX is the sheafification of O
0
X
, i. e. the sheaf of
functions that are locally quotients of polynomials. We have seen in example 2.1.7 that in
general O
0
X
differs from OX , i. e. it is in general not a sheaf.
Example 7.1.12. If X is a topological space and F the presheaf of constant real-valued
functions on X, then the sheafification of F is the sheaf of locally constant functions on X
(see also remark 2.2.5).
The sheafification has the following nice and expected properties:
7. More about sheaves 125
Lemma 7.1.13. Let F
0 be a presheaf on a topological space X, and let F be its sheafification.
(i) The stalks FP and F
0
P
agree at every point P ∈ X.
(ii) If F
0
is a sheaf, then F = F
0
.
Proof. (i): The isomorphism between the stalks is given by the following construction:
• An element of FP is by definition represented by (U,ϕ), where U is an open
neighborhood of P and ϕ = (ϕQ)Q∈U is a section of F over U. To this we can
associate the element ϕP ∈ F
0
P
.
• An element of F
0
P
is by definition represented by (U,ϕ), where ϕ ∈ F
0
(U). To
this we can associate the element (ϕQ)Q∈U in F (U), which in turn defines an
element of FP.
(ii): Note that there is always a morphism of presheaves F
0 → F given by F
0
(U) →
F (U),ϕ 7→ (ϕP)P∈U .
Now assume that F
0
is a sheaf; we will construct an inverse morphism F → F
0
. Let
U ⊂ X be an open subset and ϕ = (ϕP)P∈U ∈ F (U) a section of F. For every P ∈ U the
germ ϕP ∈ F
0
P
is represented by some (V,ϕ) with ϕ ∈ F
0
(V). As P varies over U, we are
thus getting sections of F
0 on an open cover of U that agree on the overlaps. As F
0
is a
sheaf, we can glue these sections together to give a global section in F
0
(U).
Using sheafification, we can now define all the “natural” constructions that we would
expect to be possible:
Definition 7.1.14. Let f : F1 → F2 be a morphism of sheaves of e. g. Abelian groups on a
topological space X.
(i) The cokernel coker f of f is defined to be the sheaf associated to the presheaf
coker0
f .
(ii) The morphism f is called injective if ker f = 0. It is called surjective if coker f =
0.
(iii) If the morphism f is injective, its cokernel is also denoted F2/F1 and called the
quotient of F2 by F1.
(iv) As usual, a sequence of sheaves and morphisms
··· → Fi−1 → Fi → Fi+1 → ···
is called exact if ker(Fi → Fi+1) = im(Fi−1 → Fi) for all i.
Remark 7.1.15. Let us rephrase again the results of definition 7.1.7 and remark 7.1.8 in
this new language:
(i) A morphism f : F1 → F2 of sheaves is injective if and only if the maps fU :
F1(U) → F2(U) are injective for all U.
(ii) If a morphism f : F1 → F2 of sheaves is surjective, this does not imply that all
maps fU : F1(U) → F2(U) are surjective. (The converse of this is obviously true
however: if all maps fU : F1(U) → F2(U) are surjective, then coker0
f = 0, so
coker f = 0.)
This very important fact is the basis of the theory of cohomology, see chapter 8.
Example 7.1.16. Let X = P
1
k with homogeneous coordinates x0, x1. Consider the morphism of sheaves f : OX (−1) → OX given by the linear polynomial x0 (see example 7.1.4).
We claim that f is injective. In fact, every section of OX (−1) over an open subset of X
has the form g(x0,x1)
h(x0,x1)
for some homogeneous polynomials g,h with degg−degh = −1. But
f(
g
h
) = gx0
h
is zero on an open subset of X if and only if g = 0 (note that we are not asking
126 Andreas Gathmann
for zeros of gx0
h
, but we are asking whether this function vanishes on a whole open subset).
As this means that g
h
itself is zero, we see that the kernel of f is trivial, i. e. f is injective.
We have seen already in example 7.1.2 that f is in fact an isomorphism when restricted
to U = X\{P} where P := (0 : 1). In particular, f is surjective when restricted to U.
However, f is not surjective on X (otherwise it would be an isomorphism, which is not true
as we already know). Let us determine its cokernel.
First we have to compute the cokernel presheaf coker0
f . Consider an open subset U ⊂
X. By the above argument, (coker0
f)(U) = 0 if P ∈/ U. So assume that P ∈ U. Then we
have an exact sequence of OX (U)-modules
0 → OX (−1)(U) → OX (U) → k → 0
g
h
7→ gx0
h
ϕ =
g
h
7→ ϕ(P)
as the functions in the image of OX (−1)(U) → OX are precisely those that vanish on P. So
we have found that
(coker0
f)(U) = (
k if P ∈ U,
0 if P ∈/ U.
It is easily verified that coker0
f is in fact a sheaf. It can be thought of as the ground field
k “concentrated at the point P”. For this reason it is often called a skyscraper sheaf and
denoted kP.
Summarizing, we have found the exact sequence of sheaves of OX -modules
0 → OX (−1) →
·x0 OX → kP → 0.
Example 7.1.17. Let F1,F2 be two sheaves of OX -modules on a ringed space X. Then we
can define the direct sum, the tensor product, and the dual sheaf in the obvious way:
(i) The direct sum F1 ⊕F2 is the sheaf of OX -modules defined by (F1 ⊕F2)(U) =
F1(U) ⊕ F2(U). (It is easy to see that this is a sheaf already, so that we do not
need sheafification.)
(ii) The tensor product F1⊗F2 is the sheaf of OX -modules associated to the presheaf
U 7→ F1(U)⊗OX (U) F2(U).
(iii) The dual F
∨
1
of F1 is the sheaf of OX -modules associated to the presheaf U 7→
F1(U)
∨ = HomOX (U)
(F1(U),OX (U)).
Example 7.1.18. Similarly to example 7.1.16 consider the morphism f : OX (−2) → OX
of sheaves on X = P
1
k
given by multiplication with x0x1 (instead of with x0). The only
difference to the above example is that the function x0x1 vanishes at two points P0 = (0 : 1),
P1 = (1 : 0). So this time we get an exact sequence of sheaves
0 → OX (−2)
·x→0x1 OX → kP0 ⊕kP1 → 0,
where the last morphism is evaluation at the points P0 and P1.
The important difference is that this time the cokernel presheaf is not equal to the cokernel sheaf: if we consider our exact sequence on global sections, we get
0 → Γ(OX (−2)) → Γ(OX ) → k ⊕k,
where Γ(OX (−2)) = 0, and Γ(OX ) are just the constant functions. But the last morphism
is evaluation at P and Q, and constant functions must have the same value at P and Q. So
the last map Γ(OX ) → k ⊕ k is not surjective, indicating that some sheafification is going
on. (In example 7.1.16 we only had to evaluate at one point, and the corresponding map
was surjective.)
7. More about sheaves 127
Example 7.1.19. On X = P
N, we have OX (n)⊗OX (m) = OX (n+m), with the isomorphism
given on sections by
f1
g1
⊗
f2
g2
7→
f1 f2
g1g2
.
Similarly, we have OX (n)
∨ = OX (−n), as the OX (U)-linear homomorphisms from OX (n)
to OX are precisely given by multiplication with sections of OX (−n).
7.2. Quasi-coherent sheaves. It turns out that sheaves of modules are still too general
objects for many applications — usually one wants to restrict to a smaller class of sheaves.
Recall that any ring R determines an affine scheme X = SpecR together with its structure
sheaf OX . Hence one would expect that any R-module M determines a sheaf M˜ of OX -
modules on X. This is indeed the case, and almost any sheaf of OX -modules appearing
in practice is of this form. For computations, this means that statements about this sheaf
M˜ on X are finally reduced to statements about the R-module M. But it does not follow
from the definitions that a sheaf of OX -modules has to be induced by some R-module in
this way (see example 7.2.3), so we will say that it is quasi-coherent if it does, and in most
cases restrict our attention to these quasi-coherent sheaves. If X is a general scheme, we
accordingly require that it has an open cover by affine schemes SpecRi over which the
sheaf is induced by an Ri-module for all i.
Let us start by showing how an R-module M determines a sheaf of modules M˜ on
X = SpecR. This is essentially the same construction as for the structure sheaf in definition
5.1.11.
Definition 7.2.1. Let R be a ring, X = SpecR, and let M be an R-module. We define a
sheaf of OX -modules M˜ on X by setting
M˜(U) := {ϕ = (ϕp)p∈U with ϕp ∈ Mp for all p ∈ U
such that “ϕ is locally of the form m
r
for m ∈ M,r ∈ R”}
= {ϕ = (ϕp)p∈U with ϕp ∈ Mp for all p ∈ U
such that for every p ∈ U there is a neighborhood V in U and m ∈ M,r ∈ R
with r ∈/ q and ϕq =
m
r
∈ Mq for all q ∈ V}.
It is clear from the local nature of the definition that M˜ is a sheaf.
The following proposition corresponds exactly to the statement of proposition 5.1.12
for structure sheaves. Its proof can be copied literally, replacing R by M at appropriate
places.
Proposition 7.2.2. Let R be a ring, X = SpecR, and let M be an R-module.
(i) For every p ∈ X the stalk of M at ˜ p is Mp.
(ii) For every f ∈ R we have M˜(Xf) = Mf
. In particular, M˜(X) = M.
Example 7.2.3. The following example shows that not all sheaves of OX -modules on X =
SpecR have to be of the form M˜ for some R-module M.
Let X = A
1
k
, and let F be the sheaf associated to the presheaf
U 7→
(
OX (U) if 0 ∈/ U,
0 if 0 ∈ U.
with the obvious restriction maps. Then F is a sheaf of OX -modules. The stalk F0 is zero,
whereas FP = OX,P for all other points P ∈ X.
Note that F has no non-trivial global sections: if ϕ ∈ F (X) then we obviously must
have ϕ0 = 0 ∈ F0, which by definition of sheafification means that ϕ is zero in some neighborhood of 0. But as X is irreducible, ϕ must then be the zero function. Hence it follows
128 Andreas Gathmann
that F (X) = 0. So if F was of the form M˜ for some R-module M, it would follow from
proposition 7.2.2 (ii) that M = 0, hence F would have to be the zero sheaf, which it obviously is not.
Definition 7.2.4. Let X be a scheme, and let F be a sheaf of OX -modules. We say that F
is quasi-coherent if for every affine open subset U = SpecR ⊂ X the restricted sheaf F |U
is of the form M˜ for some R-module M.
Remark 7.2.5. It can be shown that it is sufficient to require the condition of the definition
only for every open subset in an affine open cover of X (see e. g. [H] proposition II.5.4). In
other words, quasi-coherence is a local property.
Example 7.2.6. On any scheme the structure sheaf is quasi-coherent. The sheaves OX (n)
are quasi-coherent on any projective subscheme of P
N as they are locally isomorphic to
the structure sheaf. In the rest of this section we will show that essentially all operations
that you can do with quasi-coherent sheaves yield again quasi-coherent sheaves. Therefore
almost all sheaves that occur in practice are in fact quasi-coherent.
Lemma 7.2.7. Let R be a ring and X = SpecR.
(i) For any R-modules M,N there is a one-to-one correspondence
{morphisms of sheaves M˜ → N˜ } ↔ {R-module homomorphisms M → N}.
(ii) A sequence of R-modules 0 → M1 → M2 → M3 → 0 is exact if and only if the
sequence of sheaves 0 → M˜
1 → M˜
2 → M˜
3 → 0 is exact on X.
(iii) For any R-modules M,N we have M˜ ⊕N˜ = (M ⊕N)˜.
(iv) For any R-modules M,N we have M˜ ⊗N˜ = (M ⊗N)˜.
(v) For any R-module M we have (M˜)
∨ = (M∨)˜.
In particular, kernels, cokernels, direct sums, tensor products, and duals of quasi-coherent
sheaves are again quasi-coherent on any scheme X.
Proof. (i): Given a morphism M˜ → N˜ , taking global sections gives an R-module homomorphism M → N by proposition 7.2.2 (ii). Conversely, an R-module homomorphism M → N
gives rise to morphisms between the stalks Mp → Np for all p, and therefore by definition
determines a morphism M˜ → N˜ of sheaves. It is obvious that these two operations are
inverse to each other.
(ii): By exercise 7.8.2, exactness of a sequence of sheaves can be seen on the stalks.
Hence by proposition 7.2.2 (i) the statement follows from the algebraic fact that the sequence 0 → M1 → M2 → M3 → 0 is exact if and only if 0 → (M1)p → (M2)p → (M3)p → 0
is for all prime ideals p ∈ R.
(iii), (iv), and (v) follow in the same way as (ii): the statement can be checked on
the stalks, hence it follows from the corresponding algebraic fact about localizations of
modules.
Example 7.2.8. Let X = P
1
and P = (0 : 1) ∈ X. The skyscraper sheaf kP of example
7.1.16 is quasi-coherent by lemma 7.2.7 as it is the cokernel of a morphism of quasicoherent sheaves. One can also check explicitly that kP is quasi-coherent: if U0 = {x0 6=
0} = P
1\{P} and U1 = {x1 6= 0} = Spec k[x0] ∼= A
1
then kP|U0 = 0 (so it is the sheaf
associated to the zero module) and kP|U1
∼= M˜ where M = k is the k[x0]-module with the
module structure
k[x0]×k → k
(f,λ) 7→ f(0)· λ.
Proposition 7.2.9. Let f : X →Y be a morphism of schemes, and let F be a quasi-coherent
sheaf on X. Assume moreover that every open subset of X can be covered by finitely many
7. More about sheaves 129
affine open subsets (this should be thought of as a technical condition that is essentially
always satisfied — it is e. g. certainly true for all subschemes of projective spaces). Then
f∗F is quasi-coherent on Y .
Proof. Let us first assume that X and Y are affine, so X = SpecR, Y = SpecS, and F =
M˜ for some R-module M. Then it follows immediately from the definitions that f∗F =
(M as an S-module)˜, hence push-forwards of quasi-coherent sheaves are quasi-coherent if
X and Y are affine.
In the general case, note that the statement is local on Y, so we can assume that Y is
affine. But it is not local on X, so we cannot assume that X is affine. Instead, cover X by
affine opens Ui
, and cover Ui ∩Uj by affine opens Ui, j,k. By our assumption, we can take
these covers to be finite.
Now the sheaf property for F says that for every open set V ⊂ Y the sequence
0 → F (f
−1
(V)) →
M
i
F (f
−1
(V)∩Ui) →
M
i, j,k
F (f
−1
(V)∩Ui, j,k)
is exact, where the last map is given by (...,si
,...) 7→ (...,si
|Ui, j,k − sj
|Ui, j,k
,...). This
means that the sequence of sheaves on Y
0 → f∗F →
M
i
f∗(F |Ui
) →
M
i, j,k
f∗(F |Ui, j,k
)
is exact. But as we have shown the statement already for morphisms between affine
schemes and as finite direct sums of quasi-coherent sheaves are quasi-coherent, the last two
terms in this sequence are quasi-coherent. Hence the kernel f∗F is also quasi-coherent by
lemma 7.2.7.
Example 7.2.10. With this result we can now define (and motivate) what a closed embedding of schemes is. Note that for historical reasons closed embeddings are usually called
closed immersions in algebraic geometry (in contrast to differential geometry, where an
immersion is defined to be a local embedding).
We say that a morphism f : X → Y of schemes is a closed immersion if
(i) f is a homeomorphism onto a closed subset of Y, and
(ii) the induced morphism OY → f∗OX is surjective.
The kernel of the morphism OY → f∗OX is then called the ideal sheaf IX/Y of the immersion.
Let us motivate this definition. We certainly want condition (i) to hold on the level
of topological spaces. But this is not enough — we have seen that even isomorphisms
cannot be detected on the level of topological spaces (see example 2.3.8), so we need some
conditions on the structure sheaves as well. We have seen in example 5.2.3 that a closed
immersion should be a morphism that is locally of the form SpecR/I → SpecR for some
ideal I ⊂ R. In fact, this is exactly what condition (ii) means: assume that we are in the
affine case, i. e. X = SpecS and Y = SpecR. As OY and f∗OX are quasi-coherent (the
former by definition and the latter by proposition 7.2.9), so is the kernel of OY → f∗OX by
lemma 7.2.7. So the exact sequence
0 → IX/Y → OY → f∗OX → 0
comes from an exact sequence of R-modules
0 → I → R → S → 0
by lemma 7.2.7 (ii). In other words, I ⊂ R is an ideal of R, and S = R/I. So indeed the
morphism f is of the form SpecR/I → SpecR and therefore corresponds to an inclusion
morphism of a closed subset.
130 Andreas Gathmann
Example 7.2.11. Having studied push-forwards of sheaves, we now want to consider pullbacks, i. e. the “dual” situation: given a morphism f : X →Y and a sheaf F on Y, we want
to construct a “pull-back” sheaf f
∗F on X. Note that this should be “more natural” than
the push-forward, as sheaves describe “function-like” objects, and for functions pull-back
is more natural than push-forward: given a “function” ϕ : Y → k, there is set-theoretically
a well-defined pull-back function ϕ◦ f : X → k. In contrast, a function ϕ : X → k does not
give rise to a function Y → k in a natural way.
Let us first consider the affine case: assume that X = SpecR, and Y = SpecS, so that
the morphism f corresponds to a ring homomorphism S → R. Assume moreover that the
sheaf F on Y is quasi-coherent, so that it corresponds to an S-module M. Then M ⊗S R is
a well-defined R-module, and the corresponding sheaf on X should be the pull-back f
∗F .
Indeed, if e. g. M = S, i. e. F = OY , then M ⊗S R = S⊗S R = R, so f
∗F = OX : pull-backs
of regular functions are just regular functions.
This is our “local model” for the pull-back of sheaves. To show that this extends to the
global case (and to sheaves that are not necessarily quasi-coherent), we need a different
description though. So assume now that X, Y, and F are arbitrary. The first thing to do is
to define a sheaf of abelian groups on X from F . This is more complicated than for the
push-forward constructed in definition 7.1.5, because f(U) need not be open if U is.
We let f
−1F be the sheaf on X associated to the presheaf U 7→ limV⊃f(U)F (V), where
the limit is taken over all open subsets V with f(U) ⊂ V ⊂ Y. This notion of limit means
that an element in limV⊃f(U)F (V) is given by a pair (V,ϕ) with V ⊃ f(U) and ϕ ∈ F (V),
and that two such pairs (V,ϕ) and (V
0
,ϕ
0
) define the same element if and only if there is
an open subset W with f(U) ⊂ W ⊂ V ∩V
0
such that ϕ|W = ϕ
0
|W . This is the best we can
do to adapt definition 7.1.5 to the pull-back case. It is easily checked that this construction
does what we want on the stalks: we have (f
−1F )P = Ff(P)
for all P ∈ X.
Note that f
−1F is obviously a sheaf of (f
−1OY )-modules, but not a sheaf of OX -
modules. (This corresponds to the statement that in the affine case considered above, M
is an S-module, but not an R-module.) We have seen in our affine case what we have to
do: we have to take the tensor product over f
−1OY with OX (i. e. over S with R). In other
words, we define the pull-back f
∗F of F to be
f
∗F = f
−1F ⊗f −1OY
OX ,
which is then obviously a sheaf of OX -modules. As this construction restricts to the one
given above if X and Y are affine and F quasi-coherent, it also follows that pull-backs of
quasi-coherent sheaves are again quasi-coherent.
It should be stressed that this complicated limit construction is only needed to prove
the existence of f
∗F in the general case. To compute the pull-back in practice, one will
almost always restrict to affine open subsets and then use the tensor product construction
given above.
Example 7.2.12. Here is a concrete example in which we can see again why the tensor
product construction is necessary in the construction of the pull-back. Consider the morphism f : X = P
1 → Y = P
1 given by (s : t) 7→ (x : y) = (s
2
: t
2
). We want to compute the
pull-back sheaf f
∗OY (1) on X.
As we already know, local sections of OY (1) are of the form g(x,y)
h(x,y)
, with g and h homogeneous such that degg − degh = 1. Pulling this back just means inserting the equations
x = s
2
and y = t
2 of f into this expression; so the sheaf f
−1OY (1) has local sections g(s
2
,t
2
)
h(s
2,t
2)
,
where now deg(g(s
2
,t
2
))−deg(h(s
2
,t
2
)) = 2.
But note that these sections do not even describe a sheaf of OX -modules: if we try to
multiply the section s
2 with the function t
s
(i. e. a section of OX ) on the open subset where
7. More about sheaves 131
s 6= 0, we get st, which is not of the form g(s
2
,t
2
)
h(s
2,t
2)
. We have just seen the solution to this
problem: consider the tensor product with OX . So sections of f
∗OY (1) are of the form
g(s
2
,t
2
)
h(s
2
,t
2)
⊗
g
0
(s,t)
h
0(s,t)
with deg(g(s
2
,t
2
)) − deg(h(s
2
,t
2
)) = 2 and degg
0 − degh
0 = 0. It is easy to see that this
describes precisely all expressions of the form g
00(s,t)
h
00(s,t)
with degg
00 −degh
00 = 2, so the result
we get is f
∗OY (1) = OX (2).
In the same way one shows that f
∗OY (n) = OX (dn) for all n ∈ Z and any morphism
f : X → Y between projective schemes that is given by a collection of homogeneous polynomials of degree d.
We have seen now that most sheaves occurring in practice are in fact quasi-coherent.
So when we talk about sheaves from now on, we will usually think of quasi-coherent
sheaves. This has the advantage that, on affine open subsets, sheaves (that form a somewhat
complicated object) are essentially replaced by modules, which are usually much easier to
handle.
7.3. Locally free sheaves. We now come to the discussion of locally free sheaves, i. e.
sheaves that are locally just a finite direct sum of copies of the structure sheaf. These are
the most important and best-behaved sheaves one can imagine.
Definition 7.3.1. Let X be a scheme. A sheaf of OX -modules F is called locally free of
rank r if there is an open cover {Ui} of X such that F |Ui
∼= O
⊕r
Ui
for all i. Obviously, every
locally free sheaf is also quasi-coherent.
Remark 7.3.2. The geometric interpretation of locally free sheaves is that they correspond
to “vector bundles” as known from topology — objects that associate to every point P of a
space X a vector bundle. For example, the “tangent sheaf” of P
1
in example 7.1.1 is such
a vector bundle (of rank 1). Let us make this correspondence precise.
A vector bundle of rank r on a scheme X over a field k is a k-scheme F and a kmorphism π : F → X, together with the additional data consisting of an open covering
{Ui} of X and isomorphisms ψi
: π
−1
(Ui) → Ui ×A
r
k
over Ui
, such that the automorphism
ψi ◦ψ
−1
j
of (Ui ∩Uj) × A
r
is linear in the coordinates of A
r
for all i, j. In other words,
the morphism π : F → X looks locally like the projection morphism U × A
r
k → U for
sufficiently small open subsets U ⊂ X.
A
F r
X
Ui
ψi
Ui
π
We claim that there is a one-to-one correspondence
{vector bundles π : F → X of rank r} ↔ {locally free sheaves F of rank r on X}
given by the following constructions:
132 Andreas Gathmann
(i) Let π : F → X be a vector bundle of rank r. Define a sheaf F on X by
F (U) = {k-morphisms s : U → F such that π ◦ s = idU }.
(This is called the sheaf of sections of F.) Note that this has a natural structure
of a sheaf of OX -modules (over every point in X we can multiply a vector with
a scalar — doing this on an open subset means that we can multiply a section in
F (U) with a regular function in OX (U)).
Locally, on an open subset U on which π is of the form U × A
r
k → U, we
obviously have
F (U) = {k-morphisms s : U → A
r
k
},
so sections are just given by r independent functions. In other words, F |U is
isomorphic to O
⊕r
U
. So F is locally free by definition.
(ii) Conversely, let F be a locally free sheaf. Take an open cover {Ui} of X such that
there are isomorphisms ψi
: F |Ui → O
⊕r
Ui
. Now consider the schemes Ui ×A
r
k
and
glue them together as follows: for all i, j we glue Ui × A
r
k
and Uj × A
r
k
on the
common open subset (Ui ∩Uj)×A
r
k
along the isomorphism
(Ui ∩Uj)×A
r
k → (Ui ∩Uj)×A
r
k
, (P,s) 7→ (P,ψi ◦ψ
−1
j
).
Note that ψi ◦ ψ
−1
j
is an isomorphism of sheaves of OX -modules and therefore
linear in the coordinates of A
r
k
.
It is obvious that this gives exactly the inverse construction to (i).
Remark 7.3.3. Let π : F → X be a vector bundle of rank r, and let P ∈ X be a point. We call
π
−1
(P) the fiber of F over P; it is an r-dimensional vector space. If F is the corresponding
locally free sheaf, the fiber can be realized as i
∗F where i : P → X denotes the inclusion
morphism (note that i
∗F is a sheaf on a one-point space, so its data consists only of one
k-vector space (i
∗F )(P), which is precisely the fiber FP).
Lemma 7.3.4. Let X be a scheme. If F and G are locally free sheaves of OX -modules of
rank r and s, respectively, then the following sheaves are also locally free: F ⊕G (of rank
r + s), F ⊗ G (of rank r·s), and F
∨ (of rank r). If f : X → Y is a morphism of schemes
and F is a locally free sheaf on Y , then f ∗F is a locally free sheaf on X of the same rank.
(The push-forward of a locally free sheaf is in general not locally free.)
Proof. The proofs all follow from the corresponding statements about vector spaces (or
free modules over a ring): for example, if M and N are free R-modules of dimension r and
s respectively, then M ⊕N is a free R-module of dimension r+s. Applying this to an open
affine subset U = SpecR in X on which F and G are isomorphic to O
⊕r
U = M˜ and O
⊕s
U = N˜
gives the desired result. The statement about tensor products and duals follows in the same
way. As for pull-backs, we have already seen that f
∗OY = OX , so f
∗F will be of the form
O
⊕r
f −1(U)
on the inverse image f
−1
(U) ⊂ X of an open subset U ⊂ Y on which F is of the
form O
⊕r
U
.
Remark 7.3.5. Lemma 7.3.4 is an example of the general principle that any “canonical”
construction or statement that works for vector spaces (or free modules) also works for
vector bundles. Here is another example: recall that for any vector space V over k (or any
free module) one can define the n-th symmetric product S
nV and the n-th alternating
product Λ
nV to be the vector space of formal totally symmetric (resp. antisymmetric)
products
v1 · ··· · vn ∈ S
nV and v1 ∧··· ∧vn ∈ Λ
nV.
7. More about sheaves 133
If V has dimension r, then S
nV and Λ
nV have dimension
n+r−1
n

and
r
n

, respectively.
More precisely, if {v1,..., vr} is a basis of V, then
{vi1
· ··· · vin
; i1 ≤ ··· ≤ in} is a basis of S
nV, and
{vi1 ∧ ··· ∧vin
; i1 < ··· < in} is a basis of Λ
nV.
Using the same construction, we can get symmetric and alternating products S
nF and Λ
nF
on X for every locally free sheaf F on X of rank r. They are locally free sheaves of ranks

n+r−1
n

and
r
n

, respectively.
Here is an example of a linear algebra lemma that translates directly into the language
of locally free sheaves:
Lemma 7.3.6. Let 0 →U →V →W → 0 be an exact sequence of vector spaces of dimensions a, a+b, and b, respectively. Then Λ
a+bV = Λ
aU ⊗Λ
bW.
Proof. Denote the two homomorphisms by i : U → V and p : V → W. Then there is a
canonical isomorphism
Λ
aU ⊗Λ
bW → Λ
a+bV
(u1 ∧··· ∧ua)⊗(w1 ∧··· ∧wb) 7→ i(u1)∧··· ∧i(ua)∧ p
−1
(w1)∧··· ∧ p
−1
(wb).
The key remark here is that the p
−1
(wi) are well-defined up to an element of U by the
exact sequence. But if the above expression is non-zero at all, the u1,...,ua must form
a basis of U, so if we plug in any element of U in the last b entries of the alternating
product we will get zero. Therefore the ambiguity in the p
−1
(wi) does not matter and the
above homomorphism is well-defined. It is obviously not the zero map, and it is then an
isomorphism for dimensional reasons (both sides are one-dimensional vector spaces).
Corollary 7.3.7. Let 0 → F1 → F2 → F3 → 0 be an exact sequence of locally free sheaves
of ranks a1,a2,a3 on a scheme X. Then Λ
a2F2 = Λ
a1F1 ⊗Λ
a3F3.
Proof. Immediately from lemma 7.3.6 using the above principle.
7.4. Differentials. We have seen in proposition 4.4.8 that (formal) differentiation of functions is useful to compute the tangent spaces at the (closed) points of a scheme X. We now
want to introduce this language of differentials. The idea is that the various tangent spaces
TP for P ∈ X should not just be independent vector spaces at every point, but rather come
from a global object on X. For example, if X is smooth over C, so that it is a complex
manifold, we know from complex geometry that X has a cotangent bundle whose fiber at
a point P is just the cotangent space, i. e. the dual of the tangent space, at P. We want to
give an algebro-geometric analogue of this construction. So let us first define the process
of formal differentiation. We start with the affine case.
Definition 7.4.1. Let f : X = SpecR → Y = SpecS be a morphism of affine schemes,
corresponding to a ring homomorphism S → R. We define the R-module ΩR/S
, the module
of relative differentials, to be the free R-module generated by formal symbols {dr; r ∈ R},
modulo the relations:
• d(r1 +r2) = dr1 +dr2 for r1,r2 ∈ R,
• d(r1r2) = r1dr2 +r2dr1 for r1,r2 ∈ R,
• ds = 0 for s ∈ S.
Example 7.4.2. Let S = k be a field and R = k[x1,..., xn], so that we consider the morphism
f : A
n
k → pt. Then by the relations in ΩR/k
, which are exactly the rules of differentiation
with the elements of k being the “constant” functions, it follows that d f = ∑i
∂ f
∂xi
dxi for all
f ∈ k[x1,..., xn]. So ΩR/k
is just the free R-module generated by the symbols dx1,...,
134 Andreas Gathmann
Again let S = k, but now let R = k[x1,..., xn]/(f1,..., fm) be the coordinate ring of an
affine variety. By the same calculation as above, ΩR/S
is still generated as an R-module by
dx1,...,dxn, but the relations fi give rise to relations d fi = 0 in ΩR/S
. It is easy to see that
these are all relations in ΩR/S
, so we have
ΩR/S = (Rdx1 +···+Rdxn)/(∑
i
∂ fj
∂xi
dxi
, j = 1,...,m).
In particular, if X = SpecR, k is algebraically closed, and P ∈ X is a closed point of X
corresponding to a morphism R → k, then by definition 4.4.1 we see that
ΩR/S ⊗R k = hdx1,...,dxni/(∑
i
∂ fj
∂xi
(P)dxi
, j = 1,...,m)
is just the dual T
∨
X,P
of the tangent space to X at P.
Example 7.4.3. If Y is not a point, then the difference in the module of differentials is just
that all elements of S (i. e. all differentials that come from Y) are treated as “constants”. So
then ΩR/S can be thought of as “the differentials on X modulo pull-backs of differentials
on Y”. We will probably not need this very often.
Of course, if f : X → Y is a morphism of general (not necessarily affine) schemes, we
want to consider the relative differentials of every restriction of f to affine opens of X and
Y, and glue them together to get a quasi-coherent sheaf ΩX/Y . To do this, we have to give
a different description of the relative differentials, as the construction given above does not
glue very well.
Lemma 7.4.4. Let S → R be a homomorphism of rings. Consider the map δ : R⊗S R → R
given by δ(r1 ⊗r2) = r1r2 and let I ⊂ R⊗S R be its kernel. Then I/I
2
is an R-module that
is isomorphic to ΩR/S
.
Proof. The R-module structure of I/I
2
is given by r·(r1 ⊗r2) := rr1 ⊗r2 = r1 ⊗rr2, where
the second equality follows from
rr1 ⊗r2 −r1 ⊗rr2 = (r1 ⊗r2)·(r ⊗1−1⊗r) ∈ I ·I
if r1 ⊗ r2 ∈ I. Define a map of R-modules ΩR/S → I/I
2 by dr 7→ 1 ⊗ r − r ⊗ 1. Now
we construct its inverse. The R-module E := R ⊕ ΩR/S
is a ring by setting (r1 ⊕ dr0
1
)·
(r2 ⊕dr0
2
) := r1r2 ⊕(r1dr0
2 +r2dr0
1
). It is easy to check that the map R×R → E given by
(r1,r2) 7→ (r1r2,r1dr2) is an S-bilinear ring homomorphism, hence gives rise to a map g :
R⊗S R → E. As g(I) ⊂ ΩR/S by definition and g(I
2
) = 0, this induces a map I/I
2 → ΩR/S
.
It is easy to see that this is in fact the inverse of the map ΩR/S → I/I
2 given above.
Remark 7.4.5. It is easy to translate this lemma into the language of schemes: let X =
SpecR and Y = SpecS, so that the ring homomorphism S → R corresponds to a map X →Y.
Then SpecR ⊗S R = X ×Y X, and δ : R ⊗S R → R corresponds to the diagonal morphism
X → X ×Y X. Hence I ⊂ R⊗S R is the ideal of the diagonal ∆(X) ⊂ X ×Y X. This motivates
the following construction.
Definition 7.4.6. Let f : X → Y be a morphism of schemes. Let ∆ : X → X ×Y X be the
diagonal morphism, and let I = I∆(X)/X×Y X be its ideal sheaf. Then the sheaf of relative
differentials ΩX/Y is defined to be the sheaf ∆
∗
(I/I
2
) on X. If X is a scheme over a field
k and Y = Spec k is a point, then we will usually write ΩX/Y as ΩX .
Remark 7.4.7. Here we assume that the diagonal morphism ∆ is a closed immersion, which
is the case if the schemes in question are separated (this is the analogue of lemma 2.5.3 for
schemes). We will always assume this here to avoid further complications.
7. More about sheaves 135
Remark 7.4.8. It should be stressed that definition 7.4.6 is essentially useless for practical
computations. Its only use is to show that a global object ΩX/Y exists that restricts to the
old definition 7.4.1 on affine open subsets. For applications, we will always use definition
7.4.1 and example 7.4.2 on open subsets.
Remark 7.4.9. The sheaf ΩX/Y is always quasi-coherent: on affine open subsets it restricts
to the sheaf associated to the module ΩR/S constructed above.
Remark 7.4.10. Any morphism f : X → Y of schemes over a field induces a morphism of
sheaves f
∗ΩY → ΩX on X that is just given by dϕ 7→ d(f
∗ϕ) = d(ϕ◦ f) for any function
ϕ on Y.
Proposition 7.4.11. An n-dimensional scheme X (of finite type over an algebraically
closed field, e. g. a variety) is smooth if and only if ΩX is locally free of rank n. (Actually, this is a local statement: P ∈ X is a smooth point of X if and only if ΩX is (locally)
free in a neighborhood of P.)
Proof. One direction is obvious: if ΩX is locally free of rank n then its fibers at any point
P, i. e. the cotangent spaces T
∨
X,P
, have dimension n. By definition this means that P is a
smooth point of X.
Now let us assume that X is smooth (at P). As the proposition is of local nature we
can assume that X = SpecR with R = k[x1,..., xr
]/(f1,..., fm). By example 7.4.2 we then
have
T
∨
X,P = hdx1,...,dxri/(∑
i
∂ fj
∂xi
(P)dxi
, j = 1,...,m).
As this vector space has dimension n, we know that the matrix of differentials D(P) =
(
∂ fl
∂xi
(P)) at the point P has rank r −n. Without loss of generality we can assume that the
submatrix of D given by the first r −n columns and rows has non-zero determinant. This
means that dxr−n+1,...,dxr form a basis of T
∨
X,P
.
But the condition for a determinant to be non-zero is an “open condition”, i. e. the set on
which it is satisfied is open. In other words, there is a neighborhood U of P in X such that
the submatrix of D(Q) given by the first r−n columns and rows has non-zero determinant
for all Q ∈ U. Consequently, the differentials dxr−n+1,...,dxr generate T
∨
X,Q
for all Q ∈ U.
In particular, the dimension of T
∨
X,Q
is at most n. But the opposite inequality dimT
∨
X,Q ≥ n
is always true; so we conclude that the differentials dxr−n+1,...,dxr actually form a basis
of the cotangent space at all points Q ∈ U. So
ΩX |U = OU dxr−n+1 ⊕··· ⊕OU dxr
,
i. e. ΩX is locally free.
Remark 7.4.12. There is a similar statement for any quasi-coherent sheaf F . It says that:
(i) The dimension of the fibers is an upper semi-continuous function. This means
that if the dimension of the fiber of F at a point P is n, then it is at most n in some
neighborhood of P.
(ii) If the dimension of the fibers is constant on some open subset U, then F |U is
locally free.
The idea of the proof of this statement is very similar to that of proposition 7.4.11.
Definition 7.4.13. Let X be a smooth n-dimensional scheme over an algebraically closed
field. The dual bundle Ω∨
X
of the cotangent bundle is called the tangent bundle and is
denoted TX . It is a locally free sheaf of rank n. The top exterior power Λ
nΩX of the
cotangent bundle is a locally free sheaf of rank 1; it is called the canonical bundle ωX of
X.
136 Andreas Gathmann
Remark 7.4.14. The importance of the cotangent / canonical bundles stems from the fact
that these bundles are canonically defined (hence the name) for any smooth scheme n.
This gives e. g. a new method to show that two varieties are not isomorphic: if we have
two varieties whose canonical bundles have different properties (say their spaces of global
sections have different dimensions), then the varieties cannot be isomorphic.
As an example, let us now compute the cotangent / tangent / canonical bundles of some
easy varieties.
Lemma 7.4.15. The cotangent bundle of P
n
is determined by the exact sequence
0 → ΩPn → O(−1)
⊕(n+1) → O → 0.
(This sequence is usually called the Euler sequence.) Consequently, the tangent bundle
fits into the dual exact sequence
0 → O → O(1)
⊕(n+1) → TPn → 0,
and the canonical bundle is ωPn = O(−n−1).
Proof. We know already from example 7.4.2 that the cotangent bundle ΩPn is generated on
the standard open subsets Ui = {xi 6= 0} ∼= A
n by the differentials d(
x0
xi
),...,d(
xn
xi
) of the
affine coordinates. Therefore the differentials d(
xi
x j
), where defined, generate all of ΩPn .
By the rules of differentiation we have to require formally that
d

xi
xj

=
xjdxi −xidx j
x
2
j
.
Note that the dxi are not well-defined objects, as the xi are not functions. But if we formally
let the symbols dx0,...,dxn be the names of the generators of O(−1)
⊕(n+1)
, the morphism
of sheaves
ΩPn → O(−1)
⊕(n+1)
, d

xi
xj

7→
1
xj
· dxi −
xi
x
2
j
· dxj
is obviously well-defined and injective. It is now easily checked that the sequence of the
lemma is exact, with the last morphism given by
O(−1)
⊕(n+1)
7→ O, dxi
7→ xi
.
The sequence for the tangent bundle is obtained by dualizing. The statement about the
canonical bundle then follows from corollary 7.3.7.
Lemma 7.4.16. Let X ⊂ P
n be a smooth hypersurface of degree d, and let i : X → P
n be the
inclusion morphism. Then the cotangent bundle ΩX is determined by the exact sequence
0 → OX (−d) → i
∗ΩPn → ΩX → 0.
Consequently, the tangent bundle is determined by the exact sequence
0 → TX → i
∗TPn → OX (d) → 0,
and the canonical bundle is ωX = OX (d −n−1).
Proof. We claim that the exact sequence is given by
0 → OX (−d) → i
∗ΩPn → ΩX → 0
ϕ 7→ d(f ·ϕ),
dϕ 7→ d(ϕ|X ),
where f is the equation defining X. In fact, the second map is just the usual pull-back of
differential forms as in remark 7.4.10 (which is just a restriction in this case). It is surjective
because functions on X are locally of the form g
h
for some homogeneous polynomials g and
h of the same degree, so they are locally obtained by restricting a function on P
n
to X. It
7. More about sheaves 137
is not an isomorphism though, because we have the identity f = 0 on X. Consequently,
differentials dϕ are zero when restricted to X if and only if ϕ contains f as a factor. This
explains the first map of the above sequence.
As in the previous lemma, the statements about the tangent and canonical bundles are
obtained by dualizing and applying corollary 7.3.7, respectively.
Remark 7.4.17. In general, if i : X → Y is a closed immersion of smooth schemes over a
field, there is an injective morphism TX → i
∗TY of sheaves on X. In other words, at points
in X the tangent spaces of X are just subspaces of the tangent spaces of Y. The quotient
TY,P/TX,P is called the normal space, and consequently the quotient bundle NX/Y = i
∗TY /TX
is called the normal bundle. This is the same construction as in differential geometry.
Thus lemma 7.4.16 just tells us that the normal bundle of a degree-d hypersurface in P
n
is
NX/Pn = OX (d).
Example 7.4.18. Let us evaluate lemma 7.4.16 in the simplest cases, namely for curves
X ⊂ P
2 of low degrees d.
(i) d = 1: A linear curve in P
2
is just isomorphic to P
1
. We get ΩX = ωX = O(1−
2−1) = O(−2) by lemma 7.4.16. This is consistent with lemma 7.4.15 for n = 1.
(ii) d = 2: We know from example 3.3.11 that a smooth plane conic is again just
isomorphic to P
1 by means of a quadratic map f : P
1 → X ⊂ P
2
. Our formula of
lemma 7.4.16 gives ωX = OX (2 − 2 − 1) = OX (−1). By pulling this back via f
we obtain ωX = OP1 (−2) by example 7.2.12. So by applying the isomorphism to
case (i) we get the same canonical bundle back — which has to be the case, as the
cotangent bundle is canonically defined and cannot change with the embedding
in projective space.
(iii) d = 3: Here we get ωX = O(3−2−1) = O, i. e. the canonical bundle is simply
isomorphic to the sheaf of regular functions. We can understand this from our
representation in proposition 6.5.7 of cubic curves as complex tori of the form
C/Λ for some lattice Λ ⊂ C. If z is the complex coordinate on C, note that the
differential form dz is invariant under shifts in Λ, as d(z+a) = dz for all a ∈ C.
Therefore dz descends to a global differential form on X = C/Λ without zeros or
poles. It follows that we have an isomorphism OX → ωX given by ϕ 7→ ϕ· dz.
7.5. Line bundles on curves. We now want to specialize even further and consider vector
bundles of rank 1 (also called “line bundles”, because their fibers are just lines) on smooth
curves. This section should be compared to section 6.3 where we considered divisors on
such curves. We will show that divisor classes and line bundles are essentially the same
thing.
Recall that the group PicX of divisor classes on a smooth curve X has a group structure
in a natural way. So let us first make the set of all line bundles on X into a group as well.
In fact, this can be done for any scheme:
Definition 7.5.1. Let X be a scheme. A line bundle on X is a vector bundle (i. e. a locally
free sheaf) of rank 1. We denote the set of all line bundles on X by Pic0 X. This set has a
natural structure of Abelian group, with multiplication given by tensor products, inverses
by taking duals, and the neutral element by the structure sheaf.
We will now restrict our attention to smooth curves. To set up a correspondence between
line bundles and divisors, we will have to define the divisor of a (rational) section of a line
bundle. This is totally analogous to the divisor of a rational function in definition 6.3.4.
Definition 7.5.2. Let L be a line bundle on a smooth curve X, and let P ∈ X be a point.
Assume that we are given a section s ∈ L(U) of L on some neighborhood U of P. As L
is a line bundle, there is an isomorphism ψ : L|U → OU (possibly after shrinking U). The
138 Andreas Gathmann
order of vanishing ordP s of the section s at P is defined to be the order of vanishing of the
regular function ψ(s) at P.
Remark 7.5.3. Note that this definition does not depend on the choice of ψ: if ψ
0
: L|U →
OU is another isomorphism, then the composition ψ
0 ◦ψ
−1
: OU → OU is an isomorphism
of the structure sheaf, which must be given by multiplication with a function ϕ that is
nowhere zero (in particular not at P). So we have an equation of divisors
(ψ
0
(s)) = (ψ
0ψ
−1ψ(s)) = (ϕ·ψ(s)) = (ϕ) + (ψ(s)) = (ψ(s)),
which shows that ordP s is well-defined.
Definition 7.5.4. Let L be a line bundle on a smooth curve X. A rational section of L over
U is a section of the sheaf L ⊗OX KX , where KX denotes the “sheaf of rational functions”
whose value at every open subset U ⊂ X is just K(X). In other words, a rational section of
a line bundle is given by an ordinary section of the line bundle, possibly multiplied with a
rational function.
Now let P ∈ X be a point, and let s be a rational section of L in a neighborhood of P.
With the same isomorphism ψ as in definition 7.5.2, the order ordP s of s at P is defined to
be the order of the rational function ψ(s) at P. (This is well-defined for the reason stated
in remark 7.5.3.)
If s is a global rational section of L, we define the divisor (s) of s to be
(s) = ∑
P∈X
ordP s·P ∈ DivX.
Example 7.5.5. Let X = P
1 with homogeneous coordinates x0, x1.
(i) Consider the global section s = x0x1 of OX (2). It vanishes at the points P = (0 : 1)
and Q = (1 : 0) with multiplicity 1 each, so (s) = P+Q.
(ii) The divisor of the global rational section s =
1
x0
of OX (−1) is (s) = −P.
To show that Pic0 X ∼= PicX for smooth curves we need the following key lemma (which
is the only point at which smoothness is needed).
Lemma 7.5.6. Let X be a curve (over some algebraically closed field), and let P ∈ X be a
smooth point. Then there is a function ϕP in a neighborhood of P such that
(i) ϕP vanishes at P with multiplicity 1, i. e. its divisor contains the point P with
multiplicity 1.
(ii) ϕP is non-zero at all points distinct from P.
Proof. We can assume that X = SpecR is affine, with R = k[x1,..., xr
]/(f1,..., fm) being
the coordinate ring of X. As P is a smooth point of X, its cotangent space
T
∨
X,P = hdx1,...,dxri/(∑
i
∂ fj
∂xi
(P)dxi for all j)
is one-dimensional. Let ϕP be any linear function such that dϕP generates this vector
space. Then ϕP vanishes at P with multiplicity 1 by construction. We can now pick a
neighborhood of P such that ϕP does not vanish at any other point.
Remark 7.5.7. If the ground field is C and one thinks of X as a complex one-dimensional
manifold, one can think of the function ϕP of lemma 7.5.6 as a “local coordinate” of X
around P, i. e. a function that gives a local isomorphism of X with C, with P mapping to
0 ∈ C. Note however that this is not true in the algebraic category, as the Zariski open
subsets are too big.
We are now ready to prove the main proposition of this section.
7. More about sheaves 139
Definition 7.5.8. A divisor D = ∑P aPP on a smooth curve X is called effective (written
D ≥ 0) if aP ≥ 0 for all P.
Proposition 7.5.9. Let X be a smooth curve. Then there is an isomorphism of Abelian
groups
Pic0 X → PicX
L 7→ (s) for any rational section s of L.
Its inverse is given by
PicX → Pic0 X
D 7→ O(D),
where O(D) is the line bundle defined by
O(D)(U) = {ϕ ∈ K(X) ; (ϕ) +D ≥ 0 on U}.
Proof. We have to check a couple of things:
(i) If L is a line bundle, then there is a rational section s of L: This is obvious, as L
is isomorphic to O on an open subset of X. So we can find a section of L on this
open subset (corresponding to the constant function 1). This will be a rational
section of L on all of X.
(ii) The divisor class (s) of a rational section s of L does not depend on the choice of
s: If we have another section s
0
, then the quotient s
s
0 will be a rational function,
which has divisor class zero by definition of PicX. So (s) = ( s
s
0 ·s
0
) = ( s
s
0)+(s
0
) =
(s
0
) in PicX.
(iii) If D is a divisor then O(D) is actually a line bundle: let P ∈ X be a point and
choose a neighborhood U of P such that no point of U\P is contained in D. Let
n be the coefficient of P in D. Then an isomorphism ψ : O(D) → O on U is
given by multiplication with ϕ
n
P
, where ϕP is the function of lemma 7.5.6. In fact,
a rational function ϕ in K(X) is by definition a section of O(D) if and only if
ordP ϕ+n ≥ 0, which is the case if and only if ϕ·ϕ
n
P
is regular at P.
(iv) If the divisors D and D
0 define the same element in PicX then O(D) = O(D
0
): By
assumption we have D − D
0 = (ϕ) in PicX for some rational function ϕ. Obviously, this induces an isomorphism O(D) → O(D
0
) through multiplication with
ϕ.
We have now shown that the maps stated in the proposition are well-defined. Let us now
check that the two maps are inverse to each other.
(v) Pic0 X → PicX → Pic0 X: Let s0 be a rational section of a line bundle L, and
consider O((s0)) = {ϕ ∈ K(X) ; (ϕ) + (s0) ≥ 0}. We have an isomorphism
L → O((s0)), s 7→
s
s0
.
(vi) PicX → Pic0 X → PicX: The (constant) rational function 1 defines a rational section of O(D). To determine its order at a point P we have to apply the local
isomorphism with O constructed in (iii): the order of this rational section at P is
just the order of 1 · ϕ
n
P
, which is n. This is exactly the multiplicity of P in D, so
the divisor of our section is precisely D.
Finally, we have to check that the map is a homomorphism of groups. But this is clear:
if s and s
0
are rational sections of L and L
0
, respectively, then ss0
is a rational section of
L ⊗L
0
, and (ss0
) = (s)+ (s
0
). Hence tensor products of line bundles correspond to addition
of divisors under our correspondence.
Definition 7.5.10. Let X be a smooth curve. From now on we will identify line bundles
with divisor classes and call both groups PicX. In particular, this defines the degree of a
140 Andreas Gathmann
line bundle (to be the degree of the associated divisor class). The divisor class associated
to the canonical bundle ωX is denoted KX ; it is called the canonical divisor (class).
Example 7.5.11. We have seen in lemma 6.3.11 that PicP
1 = Z, i. e. there is exactly one
divisor class in every degree. Consequently, there is exactly one line bundle for every
degree n, which is of course just O(n). On the other hand, if X ⊂ P
2
is a smooth cubic
curve we know from corollary 6.3.15 that PicX consists of a copy of X in every degree.
So on a cubic curve there are (many) more line bundles than just the bundles of the form
O(n).
Remark 7.5.12. The correspondence of proposition 7.5.9 allows us to define the pull-back
f
∗D of a divisor class D on Y for any (surjective) morphism of smooth curves f : X → Y:
it is just given by pulling back the corresponding line bundle.
In fact, we can even define a pull-back f
∗D for any divisor D ∈ DivY that induces this
construction on the corresponding divisor class: let P ∈ X be any point, and let Q = f(P)
be its image, considered as an element of DivY. Then the subscheme f
−1
(Q) of X has a
component whose underlying point is P. We define the ramification index eP of f at P to
be the length of this component subscheme. In more down to earth terms, this means that
we take a function ϕQ as in lemma 7.5.6 that vanishes at Q with multiplicity 1, and define
eP to be the order of vanishing of the pull-back function f
∗ϕQ = ϕQ ◦ f at P.
The ramification index has a simple interpretation in complex analysis: in the ordinary
topology the curves X and Y are locally isomorphic to the complex plane, so we can pick
local coordinates z on X around P and w on Y around Q. Every holomorphic map is now
locally of the form z 7→ w = uzn
for some n ≥ 1 and an invertible function u (i. e. a function
that is non-zero at P). The number n is just the ramification index defined above. It is 1 if
and only if f is a local isomorphism at P in complex analysis. We say that f is ramified at
P if n = eP > 1, and unramified at P otherwise.
eP
=1 eP
=2
f
Y
P
Q
X
Y
X
P
f
Q
If we now consider a point Q as an element of DivY, we simply define
f
∗Q = ∑
P: f(P)=Q
eP ·P
and extend this by linearity to obtain a homomorphism f
∗
: DivY → DivX. In other words,
f
∗D is just obtained by taking the inverse image points of the points in D with the appropriate multiplicities.
Using the correspondence of proposition 7.5.9 it is now easily checked that the induced
map f
∗
: PicY → PicX on the Picard groups agrees with the pull-back of line bundles.
Example 7.5.13. Let f : X = P
1 →Y = P
1 be the morphism given by (x0 : x1) 7→ (x
2
0
: x
2
1
).
Then f
∗
(1 : 0) = 2 ·(1 : 0) and f
∗
(1 : 1) = (1 : 1) + (1 : −1) as divisors in X.
As an application of line bundles, we will now see how they can be used to describe
morphisms to projective spaces. This works for all schemes (not just curves).
7. More about sheaves 141
Lemma 7.5.14. Let X be a scheme over an algebraically closed field. There is a one-toone correspondence
{morphisms f : X → P
r} ←→



line bundles L on X together with global
sections s0,...,sr ∈ Γ(X,L) such that:
for all P ∈ X there is some si with si(P) 6= 0



Proof. “←−”: Given r +1 sections of a line bundle L on X that do not vanish simultaneously, we can define a morphism f : X → P
r by setting f(P) = (s0(P) : ··· : sr(P)). Note
that the values si(P) are not well-defined numbers, but their quotients si
sj
(P) are (as they are
sections of L ⊗ L
∨ = O, i. e. ordinary functions). Therefore f(P) is a well-defined point
in projective space.
“−→”: Given a morphism f : X → P
r
, we set L = f
∗OPr(1) and si = f
∗
xi
, where we
consider the xi as sections of O(1) (and thus the si as sections of f
∗O(1)).
Remark 7.5.15. One should regard this lemma as a generalization of lemma 3.3.9 where
we have seen that a morphism to P
r
can be given by specifying r +1 homogeneous polynomials of the same degree. Of course, this was just the special case in which the line
bundle of lemma 7.5.14 is O(d). We had mentioned already in remark 3.3.10 that not all
morphisms are of this form; this translates now into the statement that not all line bundles
are of the form O(n).
7.6. The Riemann-Hurwitz formula. Let X and Y be smooth projective curves, and let
f : X →Y be a surjective morphism. We want to compare the sheaves of differentials on X
and Y. Note that every projective curve admits a surjective morphism to P
1
: by definition
it sits in some P
n
to start with, so we can find a morphism to P
1 by repeated projections
from points not in X. So if we know the canonical bundle of P
1
(which we do by lemma
7.4.15: it is just OP1 (−2)) and how canonical bundles transform under morphisms, we can
at least in theory compute the canonical bundles of every curve.
Definition 7.6.1. Let f : X →Y be a surjective morphism of smooth projective curves. We
define the ramification divisor of f to be R = ∑P∈X (eP −1)· P ∈ DivX, where eP is the
ramification index of f at P defined in remark 7.5.12. So the divisor R contains all points
at which f is ramified, with appropriate multiplicities.
Proposition 7.6.2. (Riemann-Hurwitz formula) Let f : X → Y be a surjective morphism
of smooth projective curves, and let R be the ramification divisor of f . Then KX = f
∗KY +R
(or equivalently ωX = f
∗ωY ⊗OX (R)) in PicX.
Proof. Let P ∈ X be any point, and let Q = f(P) be its image point. Choose local functions
ϕP and ϕQ around P (resp. Q) that vanish at P (resp. Q) with multiplicity 1 as in lemma
7.5.6. Then by the definition of the ramification index we have
f
∗ϕQ = u ·ϕ
eP
P
for some local function u on X with no zero or pole at P. Now pick a global rational section
α of ωY . If its divisor (α) contains the point Q with multiplicity n, we can write locally
α = v ·ϕ
n
QdϕQ,
where v is a local function on Y with no zero or pole at Q. Inserting these equations into
each other, we see that
f
∗α = f
∗
v ·(f
∗ϕ
n
Q)d(f
∗ϕQ) = u
n
f
∗
v ·ϕ
neP
P
·(ϕ
ep
P
du+uepϕ
eP−1
P
dϕP).
This vanishes at P to order neP + eP − 1. Summing this over all points P ∈ X we see
that the divisor of f
∗α is f
∗
(α) + R. As KX = (f
∗α) and f
∗KY = f
∗
(α), the proposition
follows. 
142 Andreas Gathmann
We will now study the same situation from a topological point of view (if the ground
field is C). Then X and Y are two-dimensional compact manifolds.
For such a space X, we say that a cell decomposition of X is given by writing X as a
finite disjoint union of points, (open) lines, and discs. This decomposition should be “nice”
in a certain topological sense, e. g. the boundary points of every line in the decomposition
must be points of the decomposition. It takes some work to make this definition (and
the following propositions) bullet-proof. We do not want to elaborate on this, but only
remark that every “reasonable” decomposition that one could think of will be allowed. For
example, here are three valid decompositions of the Riemann sphere P
1
C
:
(i) (ii) (iii)
(In (i), we have only one point (the north pole), no line, and one “disc”, namely P
1 minus
the north pole). We denote by σ0,σ1,σ2 the number of points, lines and discs in the
decomposition, respectively. So in the above examples we have (σ0,σ1,σ2) = (1,0,1),
(2,2,2), and (6,8,4), respectively.
Of course there are many possible decompositions for a given curve X. But there is an
important number that is invariant:
Lemma 7.6.3. The number σ0 −σ1 +σ2 depends only on X and not on the chosen decomposition. It is called the (topological) Euler characteristic χ(X) of X.
Proof. Let us first consider the case when we move from one decomposition to a “finer”
one, i. e. if we add points or lines to the decomposition. For example, in the above pictures
(iii) is a refinement of (ii), which is itself a refinement of (i). Note that every refinement is
obtained by applying the following steps a finite number of times:
(i) Adding another point on a line: In this case we raise σ0 and σ1 by 1, so the
alternating sum σ0 −σ1 +σ2 does not change (see the picture below).
add a point add a line
(ii) Adding another line in a disc: In this case we raise σ1 and σ2 by 1, so the alternating sum σ0 −σ1 +σ2 again does not change (see the picture above).
So we conclude that the alternating sum σ0 −σ1 +σ2 does not change under refinements.
But it is easily seen that any two decompositions have a common refinement (which is
essentially given by taking all the points and lines in both decompositions, and maybe
add more points where two such lines intersect. For example, the common refinement
of decomposition (ii) above and the same decomposition rotated clockwise by 90 degrees
would be (iii)). It follows that the alternating sum is independent of the decomposition.
We have already noted in example 0.1.1 that a smooth complex curve is topologically a
(real) closed surface with a certain number g of “holes”. The number g is called the genus
7. More about sheaves 143
of the curve. Let us compute the topological Euler characteristic of such a curve of genus
g:
Lemma 7.6.4. The Euler characteristic of a curve of genus g is equal to 2−2g.
Proof. Take e. g. the decomposition illustrated in the following picture:
It has 2g+2 points, 4g+4 lines, and 4 discs, so the result follows.
Let us now compare the Euler characteristics of two curves X and Y if we have a morphism f : X → Y:
Lemma 7.6.5. Let f : X → Y be a morphism of complex smooth projective curves. Let n
be the number of inverse image points of any point of Y under f . As in proposition 7.6.2
let R be the ramification divisor of f . Then −χ(X) = −n · χ(Y) +degR.
Proof. Choose “compatible” decompositions of X and Y, i. e. loosely speaking decompositions such that the inverse images of the points / lines / discs of the decomposition of
Y are (finite) unions of points / lines / discs of the decomposition of X, and such that all
points / lines / discs of the decomposition of X arise in this way. Moreover, we require that
all ramification points of f are points of the decomposition of X. (It is easily seen that this
can always be achieved.) Denote by σ
X
0
, σ
X
1
, σ
X
2
the number of points / lines / discs of the
decomposition of X, and similarly for Y.
As every point of Y that is not the image of a ramification point has n inverse images
under f , it follows that σ
X
1 = nσ
Y
1
and σ
X
2 = nσ
Y
2
. We do not have σ
X
0 = nσ
Y
0
however: if
P is a ramification point, i. e. eP > 1, then f is locally eP-to-one around P, i. e. P counts
for eP in nσ
Y
0
, whereas it is actually only one point in the decomposition of X. Hence we
have to subtract eP − 1 for any ramification point P from nσ
Y
0
to get the correct value of
σ
X
0
. This means that σ
X
0 = nσ
Y
0 −degR and hence −χ(X) = −nχ(Y) +degR.
Corollary 7.6.6. Let X be a (complex) smooth projective curve. Then degKX = 2g−2.
Proof. As we have already remarked, any such curve X admits a surjective morphism f to
P
1 by projection. Using that degKP1 = −χ(P
1
) = −2 (by lemma 7.4.15 and lemma 7.6.4)
and applying lemma 7.6.5 together with the Riemann-Hurwitz formula 7.6.2, we see that
degKX = −χ(X). The result therefore follows from lemma 7.6.4.
7.7. The Riemann-Roch theorem. As in the last section let X be a smooth projective
curve of genus g over an algebraically closed field. For any line bundle L we want to
compute the dimensions of the vector spaces Γ(L) of global sections of L. We will denote
this dimension by h
0
(L) (the reason for this notation will become obvious when we discuss cohomology in chapter 8). By abuse of notation we will also write h
0
(D) instead of
h
0
(O(D)) for any divisor D.
144 Andreas Gathmann
We should remark that this is a classical question that was one of the first problems
studied in algebraic geometry: given a smooth projective curve X (resp. a compact onedimensional complex manifold), points P1,...,Pr ∈ X, and numbers a1,...,ar ≥ 0, what is
the dimension of the space of rational (resp. meromorphic) functions on X that have poles
of order at most ai at the points Pi and are regular (resp. holomorphic) everywhere else? In
our language, this just means that we are looking for the number h
0
(a1P1 +···+arPr).
Example 7.7.1. Let D be a divisor on X with negative degree. Recall that sections of
O(D) are just rational functions ϕ on X such that (ϕ) +D is effective. Taking degrees, this
certainly implies that deg(ϕ) +degD ≥ 0. But deg(ϕ) = 0 by remark 6.3.5 and degD < 0
by assumption, which is a contradiction. Hence we conclude that h
0
(D) = 0 if degD < 0:
there are no global sections of O(D) in this case.
Example 7.7.2. Let L be the line bundle OX (n) for some n ∈ Z. Recall that sections of L
are of the form f
g
with f and g homogeneous such that deg f −degg = n. Now for global
sections g must be a constant function (otherwise we would have a pole somewhere), so
we conclude that Γ(L) is simply the n-th graded piece of the homogeneous coordinate ring
S(X).In other words, h
0
(L) is by definition equal to the value hX (n) of the Hilbert function
introduced in section 6.1. We have seen in proposition 6.1.5 that hX (n) is equal to a linear
polynomial χX (n) in n for n  0. Moreover, the linear coefficient of χX (n) is the degree
of OX (n), and the constant coefficient is 1−g by definition of g (see example 6.1.10). So
we conclude that
h
0
(D) = degD+1−g
if D is the divisor class associated to a line bundle OX (n) for n  0.
Theorem 7.7.3. (Riemann-Roch theorem for line bundles on curves) Let X be a complex
smooth projective curve of genus g. Then for any divisor D on X we have
h
0
(D)−h
0
(KX −D) = degD+1−g.
Proof. Step 1. Recall that for any point P ∈ X and any divisor D we have the exact
“skyscraper sequence” by exercise 7.8.4
0 → O(D) → O(D+P) → kP → 0
where the last morphism is given by evaluation at the point P. From this we get an exact
sequence of global sections
0 → Γ(O(D)) → Γ(O(D+P)) → C
(where the last map is in general not surjective, see example 7.1.18). Therefore h
0
(D +
P)−h
0
(D) is either 0 or 1. If we denote the left hand side of the Riemann-Roch theorem
by χ(D) = h
0
(D)−h
0
(KX −D), we conclude that
χ(D+P)−χ(D) = (h
0
(D+P)−h
0
(D)) + (h
0
(KX −D)−h
0
(KX −D−P))
is either 0, 1, or 2. (Of course, what we want to prove is that χ(D+P)−χ(D) is always
equal to 1.)
Step 2. We want to rule out the case that χ(D + P) − χ(D) = 2. For this we actually
have to borrow a theorem from complex analysis.
So assume that h
0
(D+P)−h
0
(D) = 1 and h
0
(KX −D)−h
0
(KX −D−P) = 1. The fact
that h
0
(D+P)−h
0
(D) = 1 means precisely that there is a global section ϕ of OX (D+P)
that is not a global section of OX (D), i. e. that ϕ is a rational section of OX (D) that has a
simple pole at P and is regular at all other points. Similarly, there is a global section α of
OX (KX −D) that is not a global section of OX (KX −D−P). In other words, α is a global
section of ωX ⊗L
∨ that does not vanish at P. By multiplication we see that ϕ·α is a rational
section of L ⊗(ωX ⊗L
∨) = ωX that has a simple pole at P and is regular at all other points.
In other words, ϕ ·α is a global rational differential form with just a single pole which is
7. More about sheaves 145
of order 1. But this is a contradiction to the residue theorem of complex analysis: the sum
of the residues of any rational (or meromorphic) differential form on a compact Riemann
surface is zero, but in our case we have ∑Q∈X resQ(ϕ·α) = resP(ϕ·α) 6= 0.
Step 3. We claim that
χ(D) ≥ degD+1−g
for all divisors D. Note that we can choose points P1,...,Pr such that D+P1 +···+Pr
is
precisely the intersection divisor of X with a certain number n of hyperplanes: for every
point in D we just choose a hyperplane through that point and add all other intersection
points with X to the Pi
. This then means that O(D + P1 + ··· + Pr) = O(n). By possibly
adding more intersection points of X with hyperplanes we can make n arbitrarily large. So
by example 7.7.2 we find that
h
0
(D+P1 +···+Pr) = degD+r +1−g.
Moreover, if n (and thus r) is large enough we see by example 7.7.1 that h
0
(KX −D−P1 −
··· −Pr) = 0 and therefore
χ(D+P1 +···+Pr) = degD+r +1−g.
But by step 2 we know that subtracting a point from the divisor will decrease χ(·) by 0 or
1. If we apply this r times to the points P1,...,Pr we conclude that χ(D) ≥ (degD + r +
1−g)−r, as we have claimed.
Step 4. Replacing D by KX −D in the inequality of step 3 yields
−χ(D) = h
0
(KX −D)−h
0
(D) ≥ degKX −degD+1−g
= −degD−1+g
as degKX = 2g − 2 by corollary 7.6.6. Combining the two inequalities of steps 3 and 4
proves the theorem.
Remark 7.7.4. If D is the divisor associated to the line bundle O(n) (for any n), note that
χ(D) is just the value χX (n) of the Hilbert polynomial. So for these line bundles we can
reinterpret our main proposition 6.1.5 about Hilbert polynomials as follows: the difference
between hX (n) and χX (n) is simply h
0
(ωX ⊗ OX (−n)). As this vanishes for large n by
degree reasons, it follows that hX (n) = χX (n) for large n.
Example 7.7.5. Setting D = 0 in the Riemann-Roch theorem yields h
0
(KX ) = g. This gives
an alternate definition of the genus of a smooth projective curve: one could define the genus
of such a curve as the dimension of the space of global differential forms. This definition
has the advantage that it is immediately clear that it is well-defined and independent of the
projective embedding (compare this to example 6.1.10).
Remark 7.7.6. In general one should think of the Riemann-Roch theorem as a formula to
compute h
0
(D) for any D, modulo an “unwanted” correction term h
0
(KX − D). In many
applications one can make this correction term vanish, e. g. by making the degree of D
large enough so that deg(KX −D) becomes negative.
Remark 7.7.7. There are numerous generalizations of the Riemann-Roch theorem. In fact,
there are whole books on Riemann-Roch type theorems. Let us mention some of the generalizations without proof:
(i) The requirement that the ground field be C is not essential. The very same statement holds over any algebraically closed ground field (the proof has to be changed
though at step 2 where we invoked complex analysis).
(ii) The requirement that the curve be projective is not essential either, it only needs
to be complete (i. e. “compact”).
146 Andreas Gathmann
(iii) Instead of a line bundle one can take a vector bundle: if F is any vector bundle
on X of rank r then
h
0
(F )−h
0
(ωX ⊗F
∨
) = degΛ
rF +r(1−g)
(see example 10.4.7).
(iv) There are versions of the Riemann-Roch theorem for singular curves as well.
(Note that in the singular case we do not have a canonical bundle, so one needs a
new idea here.)
(v) There are also versions of the Riemann-Roch theorem for varieties of dimension
bigger than 1 (see theorem 10.4.5).
(vi) Finally, the same theorem can be proven (with the same proof actually) in complex analysis, where h
0
(D) then denotes the dimension of the space of meromorphic functions with the specified zeros and poles. As the resulting dimension
does change we conclude that on a projective smooth complex curve every meromorphic function is in fact rational. This is an example of a very general result
that says that complex analysis essentially reduces to algebraic geometry in the
projective case (in other words, we “do not gain much” by allowing holomorphic
functions instead of rational ones in the first place).
As an application of the Riemann-Roch theorem let us consider again morphisms to
projective spaces. Let X be a smooth projective curve, and let D be a divisor on X. Let
s0,...,sr be a basis of the space Γ(O(D)) of global sections of O(D). Then we have seen
in lemma 7.5.14 that we get a morphism
X → P
r
, P 7→ (s0(P) : ··· : sr(P))
provided that the sections si do not vanish simultaneously at any point. Using the RiemannRoch theorem we can now give an easy criterion when this is the case. Note first however
that picking a different basis of section would result in a morphism that differs from the
old one simply by a linear automorphism of P
r
. Thus we usually say that the divisor D (or
its associated line bundle) determines a morphism to P
r up to automorphisms of P
r
.
Proposition 7.7.8. Let X be a smooth projective curve of genus g, and let D be a divisor
on X.
(i) If degD ≥ 2g then the divisor D determines a morphism X → P
r as above.
(ii) If degD ≥ 2g+1 then moreover this morphism is an embedding (i. e. an isomorphism onto its image).
Proof. (i): By what we have said above we simply have to show that for every point P ∈ X
there is a global section s ∈ Γ(O(D)) that does not vanish at P.
By the degree condition we know that deg(KX − D) ≤ 2g − 2 − 2g < 0 and deg(KX −
D+P) ≤ 2g−2−2g+1 < 0. So by example 7.7.1 we get from the Riemann-Roch theorem
that
h
0
(D) = degD+1−g and h
0
(D−P) = (degD−1) +1−g.
In particular we have h
0
(D)−h
0
(D−P) = 1, i. e. there is a section s ∈ Γ(O(D)) that is not
a section of O(D−P), i. e. that does not vanish at P.
(ii): The idea of the proof is the same as in (i). However, as we have not developed
enough powerful techniques yet to prove that a morphism has an inverse, we will restrict
ourselves to proving that the morphism determined by D is bijective. So let P and Q be
distinct points of X. To prove that they are mapped to different points it suffices to show
that there is a section s ∈ Γ(O(D)) with s(P) = 0,s(Q) 6= 0: the morphism R 7→ (s(R) :
s
0
(R) : ···) then maps P to a point with the first coordinate 0, while the first coordinate is
non-zero for the image point of Q.
7. More about sheaves 147
To find this section s, simply apply the argument of (i) to D−P and the point Q: we get
h
0
(D−P)−h
0
(D−P−Q) = 1, i. e. there is a section s ∈ Γ(O(D−P)) that is not a section
of O(D−P−Q), i. e. it is a section of O(D) that vanishes at P but not at Q.
Example 7.7.9. If X is a smooth projective curve of genus g ≥ 2 we get a canonical
embedding X → P
r
into a projective space (up to automorphisms by P
r
) by taking the
morphism associated to the divisor 3KX . This follows by part (ii) of proposition 7.7.8 as
3(2g − 2) ≥ 2g + 1 if g ≥ 2. By remark 7.7.7 (ii) the same is true for any complete (i. e.
“compact”) curve that is not necessarily given initially as a subvariety of projective space.
7.8. Exercises.
Exercise 7.8.1. Let F
0 be a presheaf on a topological space X, and let F be its sheafification as in definition 7.1.10. Show that
(i) There is a natural morphism θ : F
0 → F .
(ii) Any morphism from F
0
to a sheaf factors uniquely through θ.
Exercise 7.8.2. Let f : F → G be a morphism of sheaves of abelian groups on a topological
space X. Show that f is injective / surjective / an isomorphism if and only if all induced
maps fP : FP → GP on the stalks are injective / surjective / isomorphisms.
Exercise 7.8.3. Let f : F1 → F2 be a morphism of locally free sheaves on a scheme X over
a field k. Let P ∈ X be a point, and denote by (Fi)P the fiber of the vector bundle Fi over
P, which is a k-vector space. Are the following statements true or false:
(i) If F1 → F2 is injective then the induced map (F1)P → (F2)P is injective for all
P ∈ X.
(ii) If F1 → F2 is surjective then the induced map (F1)P → (F2)P is surjective for all
P ∈ X.
Exercise 7.8.4. Prove the following generalization of example 7.1.16: If X is a smooth
curve over some field k, L a line bundle on X, and P ∈ X a point, then there is an exact
sequence
0 → L(−P) → L → kP → 0,
where kP denotes the “skyscraper sheaf”
kP(U) = (
k if P ∈ U,
0 if P ∈/ U.
Exercise 7.8.5. If X is an affine variety over a field k and F a locally free sheaf of rank r
on X, is then necessarily F ∼= O
⊕r
X
?
Exercise 7.8.6. Let X be a scheme, and let F be a locally free sheaf on X. Show that
(F
∨)
∨ ∼= F . Show by example that this statement is in general false if F is only quasicoherent but not locally free.
Exercise 7.8.7. Figure out what exactly goes wrong with the correspondence between line
bundles and divisor classes on a curve X if X is singular. Can we still associate a divisor to
any section of a line bundle? Can we still construct a line bundle from any divisor?
Exercise 7.8.8. What is the line bundle on P
n ×P
m leading to the Segre embedding P
n ×
P
m → P
N by the correspondence of lemma 7.5.14? What is the line bundle leading to the
degree-d Veronese embedding P
n → P
N?
Exercise 7.8.9. Show that any smooth projective curve of genus 2. . .
(i) can be realized as a curve of degree 5 in P
3
,
(ii) admits a two-to-one morphism to P
1
. How many ramification points does such a
morphism have?
148 Andreas Gathmann
Exercise 7.8.10. Let X be a smooth projective curve, and let P ∈ X be a point. Show that
there is a rational function on X that is regular everywhere except at P.
8. Cohomology of sheaves 149
8. COHOMOLOGY OF SHEAVES
For any quasi-coherent sheaf F on a scheme X we construct the cohomology groups
H
i
(X,F ) for i ≥ 0 using the Cech complex associated to an affine open cover of ˇ X.
We show that the cohomology groups do not depend on the choice of affine open
cover. The cohomology groups H
i
(X,F ) vanish for i > 0 if X is affine, and in any
case for i > dimX.
For any short exact sequence of sheaves on X there is an associated long exact
sequence of the corresponding cohomology groups.
If L is a line bundle of degree at least 2g−1 on a smooth projective curve of genus
g then the cohomology group H
1
(X,L) is zero. Using this “vanishing theorem” we
reprove the Riemann-Roch theorem in a cohomological version. Comparing this to
the old version yields the equality dimH
0
(KX −D) = dimH
1
(D) for any divisor D,
which is a special case of the Serre duality theorem. As an application we can now
define the genus of a possibly singular curve to be dimH
1
(X,OX ).
We compute the cohomology groups of all line bundles on projective spaces. As a
consequence, we obtain the result that the cohomology groups of coherent sheaves on
projective schemes are always finite-dimensional vector spaces, and that H
i
(X,F ⊗
OX (d)) = 0 for all i > 0 and d  0.
8.1. Motivation and definitions. There are numerous ways to motivate the theory of cohomology of sheaves. Almost all of them are based on the observation that “the functor of
taking global sections of a sheaf is not exact”, i. e. given an exact sequence of sheaves of
Abelian groups
0 → F1 → F2 → F3 → 0
on a scheme (or topological space) X, by taking global sections we get an exact sequence
0 → Γ(F1) → Γ(F2) → Γ(F3)
of Abelian groups in which the last map Γ(F2) → Γ(F3) is in general not surjective. We
have seen one example of this in example 7.1.18. Here is one more example:
Example 8.1.1. Let X ⊂ P
n be a smooth hypersurface of degree d with inclusion morphism
i : X → P
n
. We know from lemma 7.4.15 that the cotangent sheaf of P
n fits into an exact
sequence of vector bundles
0 → ΩPn → O(−1)
⊕(n+1) → O → 0.
Pulling this sequence back by i and taking global sections, we see that we have an exact
sequence
0 → Γ(i
∗ΩPn ) → Γ(OX (−1)
⊕(n+1)
) → ··· .
But OX (−1) has no global sections, so we conclude that i
∗ΩPn has no global sections
either. Now consider the exact sequence of lemma 7.4.16
0 → OX (−d) → i
∗ΩPn → ΩX → 0,
from which we deduce the exact sequence
0 → Γ(OX (−d)) → Γ(i
∗ΩPn ) → Γ(ΩX ).
We have just seen that the first two groups in this sequence are trivial. But Γ(ΩX ) is
not trivial in general (e. g. for a cubic curve in P
2 we have ΩX = OX and thus Γ(ΩX ) = k).
Hence the last map in the above sequence of global sections cannot be surjective in general.
We have however already met a case in which the induced map on global sections is
exact: if X = SpecR is an affine scheme and Fi = M˜
i for some R-modules Mi are quasicoherent sheaves on X then by lemma 7.2.7 (ii) the sequence
0 → F1 → F2 → F3 → 0
150 Andreas Gathmann
is exact if and only if the sequence
0 → Γ(F1) → Γ(F2) → Γ(F3) → 0
is exact (note that Γ(Fi) = Mi by proposition 7.2.2 (ii)). We have mentioned already that
essentially all sheaves occurring in practice are quasi-coherent, so we will assume this from
now on for the rest of this chapter.
The conclusion is that we know that taking global sections is an exact functor if the
underlying scheme is affine. The goal of the theory of cohomology is to extend the
global section sequence to the right for all schemes X in the following sense: for any
(quasi-coherent) sheaf F on X we will define natural cohomology groups H
i
(X,F ) for
all i > 0 satisfying (among other things) the following property: given any exact sequence
0 → F1 → F2 → F3 → 0 of sheaves on X, there is an induced long exact sequence of
cohomology groups
0 → Γ(F1) → Γ(F2) → Γ(F3) → H
1
(X,F1) → H
1
(X,F2) → H
1
(X,F3) → H
2
(X,F1) → ··· .
If X is an affine scheme then H
i
(X,F ) = 0 for all i > 0, so that we arrive again at our old
result that the sequence of global sections is exact in this case.
Let us now give the definition of these cohomology groups. There are various ways to
define these groups. In these notes we will use the approach of so-called Cech cohomology. ˇ
This is the most suitable approach for actual applications (but maybe not the best one from
a purely theoretical point of view). The idea of Cech cohomology is simple: we have seen ˇ
above that the global section functor is exact (i. e. does what we finally want) if X is an
affine scheme. So if X is any scheme we will just choose an affine open cover {Ui} of X
and consider sections of our sheaves on these affine open subsets and their intersections.
Definition 8.1.2. Let X be a scheme, and let F be a (quasi-coherent) sheaf on X. Fix an
affine open cover {Ui}i∈I of X, and assume for simplicity that I is an ordered set. For all
p ≥ 0 we define the Abelian group
C
p
(F ) = ∏
i0<···<ip
F (Ui0 ∩··· ∩Uip
).
In other words, an element α ∈ C
P
(F ) is a collection α = (αi0,...,ip
) of sections of F over
all intersections of p+1 sets taken from the cover. These sections can be totally unrelated.
For every p ≥ 0 we define a “boundary operator” d
p
: C
p
(F ) → C
p+1
(F ) by
(d
pα)i0,...,ip+1 =
p+1
∑
k=0
(−1)
kαi0,...,ik−1
,ik+1
,...,ip+1
|Ui0
∩···∩Uip+1
.
Note that this makes sense as the αi0,...,ik−1
,ik+1
,ip+1
are sections of F on Ui0 ∩ ··· ∩Uik−1 ∩
Uik+1 ∩··· ∩Uip+1
, which contains Ui0 ∩··· ∩Uip+1
as an open subset.
By abuse of notation we will denote all these operators simply by d if it is clear from
the context on which C
p
(F ) they act.
Lemma 8.1.3. Let F be a sheaf on a scheme X. Then dp+1 ◦ d
p
: C
p
(F ) → C
p+2
(F ) is
the zero map for all p ≥ 0.
8. Cohomology of sheaves 151
Proof. This statement is essentially due to the sign in the definition of dα: for every α ∈
C
p
(F ) we have
(d
p+1
d
pα)i0,...,ip+2 =
p+2
∑
k=0
(−1)
k
(dα)i0,...,ik−1
,ik+1
,...,ip+2
=
p+2
∑
k=0
k−1
∑
m=0
(−1)
k+mαi0,...,im−1,im+1,...,ik−1
,ik+1
,...,ip+2
+
p+2
∑
k=0
p+2
∑
m=k+1
(−1)
k+m−1αi0,...,ik−1
,ik+1
,...,im−1,im+1,...,ip+2
= 0
(omitting the restriction maps).
We have thus defined a sequence of Abelian groups and homomorphisms
C
0
(F )
d
0
−→ C
1
(F )
d
1
−→ C
2
(F )
d
2
−→ ···
such that d
p+1 ◦ d
p = 0 at every step. Such a sequence is usually called a complex of
Abelian groups. The maps d
p
are then called the boundary operators.
Definition 8.1.4. Let F be a sheaf on a scheme X. Pick an affine open cover {Ui} of X
and consider the associated groups C
p
(F ) and homomorphisms d
p
: C
p
(F ) → C
p+1
(F )
for p ≥ 0. We define the p-th cohomology group of F to be
H
p
(X,F ) = kerd
p
/imd
p−1
with the convention that C
p
(F ) and d
p
are zero for p < 0. Note that this is well-defined
as imd
p−1 ⊂ kerd
p by lemma 8.1.3. If X is a scheme over a field k then the cohomology
groups will be vector spaces over k. The dimension of the cohomology groups H
i
(X,F )
as a k-vector space is then denoted h
i
(X,F ).
Remark 8.1.5. The definition of the cohomology groups as it stands depends on the choice
of the affine open cover of X. It is a very crucial (and non-trivial) fact that the H
i
(X,F )
actually do not depend on this choice (as we have already indicated by the notation). It is
the main disadvantage of our Cech approach to cohomology that this independence is not ˇ
obvious from the definition. There are other constructions of the cohomology groups (for
example the “derived functor approach” of [H] chapter III) that never use such affine open
covers and therefore do not face this problem. On the other hand, these other approaches
are essentially useless for actual computations. This is why we have given the Cech ap- ˇ
proach here. We will prove the independence of our cohomology groups of the open cover
in section 8.5. For now we will just assume this independence and rather discuss the properties and applications of the cohomology groups.
Example 8.1.6. The following examples follow immediately from the definition and the
assumption of remark 8.1.5:
(i) For any X and F we have H
0
(X,F ) = Γ(F ). In fact, we have H
0
(X,F ) =
ker(d
0
: C
0
(F ) → C
1
(F )) by definition. But an element α ∈ C
0
(F ) is just given
by a section αi ∈ F (Ui) for every element of the open cover, and the map d
0
is
given by (αi − αj)|Ui∩Uj
. By the sheaf axiom this is zero for all i and j if and
only if the αi come from a global section of F . Hence H
0
(X,F ) = Γ(F ). (In
particular, our definition of h
0
(L) in section 7.7 is consistent with our current
definition of h
0
(X,L).)
(ii) If X is an affine scheme then H
i
(X,F ) = 0 for i > 0. In fact, if X is affine we can
pick the open cover consisting of the single element X, in which case the groups
C
i
(F ) and hence the H
i
(X,F ) are trivially zero for i > 0.
152 Andreas Gathmann
(iii) If X is a projective scheme of dimension n then H
i
(X,F ) = 0 whenever i > n.
In fact, by proposition 4.1.9 we can pick homogeneous polynomials f0,..., fn
such that X ∩ Z(f0,..., fn) = 0/. We thus get an open cover of X by the n + 1
subsets X\Z(fi) which are all affine by proposition 5.5.4. Using this open cover
for the definition of the cohomology groups, we see that the C
i
(F ) and hence the
H
i
(X,F ) are zero for i > n. Note that the same is true for any scheme that can be
covered by n+1 affine open subsets.
Note that for (i) we did not need the independence of the cohomology groups of the open
cover, but for (ii) and (iii) we did. In fact, the last two statements are both highly non-trivial
theorems about cohomology groups. They only follow so easily in our setup because we
assumed the independence of the cover.
Example 8.1.7. Let X = P
1
and F = O. By example 8.1.6 (i) we know that H
0
(P
1
,O) ∼= k
is simply the space of (constant) global regular functions, and by part (iii) we know that
H
i
(P
1
,O) = 0 for i > 1. So let us determine H
1
(P
1
,O). To compute this cohomology
group let us pick the obvious affine open cover Ui = {xi 6= 0} for i = 0,1. Then
C
1
(O) = O(U0 ∩U1)
=

f
x
a
0
x
b
1
; f homogeneous of degree a+b

=

x
m
0
x
n
1
x
a
0
x
b
1
; m+n = a+b and m,n,a,b ≥ 0

.
Of course the condition m + n = a + b implies that we always have m ≥ a or n ≥ b. So
every such generator is regular on at least one of the open subsets U0 and U1. It follows
that every such generator is in the image of the boundary map
d
0
: C
0
(O) = O(U0)×O(U1) → O(U0 ∩U1), (α0,α1) 7→ α1 −α0|U0∩U1
.
Consequently H
1
(P
1
,O) = 0 by definition of the cohomology groups.
Example 8.1.8. In the same way as in example 8.1.7 let us now compute the cohomology
group H
1
(P
1
,O(−2)). With the same notations as above we have now
C
1
(O(−2)) = O(−2)(U0 ∩U1)
=

f
x
a
0
x
b
1
; f homogeneous of degree a+b−2

=

x
m
0
x
n
1
x
a
0
x
b
1
; m+n = a+b−2

.
The condition m + n = a + b − 2 implies that m ≥ a − 1 or n ≥ b − 1. If one of these
inequalities is strict, then the corresponding generator x
m
0
x
n
1
x
a
0
x
b
1
is regular on U0 or U1 and is
therefore zero in the cohomology group H
1
(P
1
,O(−2)) as above. So we are only left
with the function 1
x0x1
where neither inequality is strict. As C
2
(O(−2)) = 0 and so the
boundary operator d
1
is trivial, we conclude that H
1
(P
1
,O(−2)) is one-dimensional, with
the function 1
x0x1
as a generator.
8.2. The long exact cohomology sequence. The main property of the cohomology groups
is that they solve the problem of finding an exact sequence of sections associated to a short
exact sequence of sheaves:
8. Cohomology of sheaves 153
Proposition 8.2.1. Let 0 → F1 → F2 → F3 → 0 be an exact sequence of sheaves on a (separated) scheme X. Then there is a canonical long exact sequence of cohomology groups
0 → H
0
(X,F1) → H
0
(X,F2) → H
0
(X,F3)
→ H
1
(X,F1) → H
1
(X,F2) → H
1
(X,F3)
→ H
2
(X,F1) → ··· .
Proof. Consider the diagram of Abelian groups and homomorphisms
···

···

···

0 /C
p−1
(F1)
f
/
d

C
p−1
(F2)
g
/
d

C
p−1
(F3) /
d

0
0 /C
p
(F1)
f
/
d

C
p
(F2)
g
/
d

C
p
(F3) /
d

0
0 /C
p+1
(F1)
f
/
d

C
p+1
(F2)
g
/
d

C
p+1
(F3) /
d

0
··· ··· ···
The columns of this diagram are complexes (i. e. d ◦ d = 0 at all places) by lemma 8.1.3.
We claim that the rows of this diagram are all exact: by lemma 7.2.7 (ii) and what we have
said in section 8.1 we know that the sequences 0 → F1(U) → F2(U) → F3(U) → 0 are
exact on every affine open subset U of X. But the intersection of two (and hence finitely
many) affine open subsets of X is again affine as U ∩V = ∆X ∩(U ×V) is a closed subset
of an affine scheme U ×V (where ∆X ⊂ X ×X denotes the diagonal of X). As the C
p
(Fi)
are made up from sections on such open subsets, the claim follows. Moreover, note that all
squares in this diagram are commutative by construction.
The statement of the proposition now follows from a basic lemma of homological algebra:
Lemma 8.2.2. Any short exact sequence of complexes
···

···

···

0 /C
p−1
f
/
d

D
p−1
g
/
d

E
p−1 /
d

0
0 /C
p
f
/
d

D
p
g
/
d

E
p /
d

0
0 /C
p+1
f
/
d

D
p+1
g
/
d

E
p+1 /
d

0
··· ··· ···
154 Andreas Gathmann
(i. e. the Cp
,D
p
,E
p are Abelian groups, the diagram commutes, the rows are exact and the
columns are complexes) gives rise to a long exact sequence in cohomology
··· → H
p−1
(E) → H
p
(C) → H
p
(D) → H
p
(E) → H
p+1
(C) → ···
where Hp
(C) = ker(C
p → C
p+1
)/im(C
p−1 → C
p
), and similarly for D and E.
Proof. The proof is done by pure “diagram chasing”. We will give some examples.
(i) Existence of the morphisms ψ : H
p
(C) → H
p
(D): let α ∈ H
p
(C) be represented
by an element in C
p
(which we denote by the same letter by abuse of notation).
Then dα = 0 ∈ C
p+1
. Set ψ(α) = f(α). Note that dψ(α) = f(dα) = 0, so
ψ(α) is a well-defined cohomology element. We still have to check that this
definition does not depend on the representative chosen in C
p
. So if α = dα
0
for
some α
0 ∈ C
p−1
(so that α = 0 in H
p
(C)) then ψ(α) = f(dα
0
) = d f(α
0
) (so that
ψ(α) = 0 in H
p
(D)).
(ii) The existence of the morphisms H
p
(D) → H
p
(E) follows in the same way: they
are simply induced by the morphisms g.
(iii) Existence of the morphisms φ : H
p
(E) → H
p+1
(C): The existence of these “connecting morphisms” is probably the most unexpected part of this lemma. Let α be
a (representative of a) cohomology element in E
p
, so that dα = 0. As g : D
p → E
p
is surjective, we can pick a β ∈ D
p
such that g(β) = α. Consider the element
dβ ∈ D
p+1
. We have g(dβ) = dg(β) = dα = 0, so dβ is in fact of the form f(γ)
for a (unique) γ ∈ C
p+1
. We set φ(α) = γ.
We have to check that this is well-defined:
(a) dγ = 0 (so that γ actually defines an element in cohomology): we have
f(dγ) = d f(γ) = d(dβ) = 0 as the middle column is a complex, so dγ = 0
as the f are injective.
(b) The construction does not depend on the choice of β: if we pick another β
0
with g(β
0
) = α then g(β−β
0
) = 0, so β−β
0 = f(δ) for some δ ∈ C
p
as the
p-th row is exact. Now if γ and γ
0
are the elements such that f(γ) = dβ and
f(γ
0
) = β
0
then f(γ−γ
0
) = d(β−β
0
) = d f(δ) = f(dδ). As f is injective we
conclude that γ−γ
0 = dδ, so γ and γ
0 define the same element in H
p+1
(C).
(c) If α = dα
0
for some α
0 ∈ E
p−1
(so that α defines the zero element in cohomology) then we can pick an inverse image β
0 with g(β
0
) = α
0
as g is
surjective. For β we can then take dβ
0
. But then dβ = d(dβ
0
) = 0 as the
middle column is a complex, so the resulting element in H
p+1
(C) is zero.
Summarizing, we can say that the morphism H
p
(E) → H
p+1
(C) is obtained by
going “left, down, left” in our diagram. We have just checked that this really
gives rise to a well-defined map.
We have now seen that there is a canonical sequence of morphisms between the cohomology groups as stated in the lemma. It remains to be shown that the sequence is actually
exact. We will check exactness at the H
p
(D) stage only (i. e. show that ker(H
p
(D) →
H
p
(E)) = im(H
p
(C) → H
p
(D)) and leave the other two checks (at H
p
(C) and H
p
(E))
that are completely analogous as an exercise.
im(H
p
(C) → H
p
(D)) ⊂ ker(H
p
(D) → H
p
(E)): Let α ∈ H
p
(D) be of the form α = f(β)
for some β ∈ H
p
(C)). Then g(α) = g(f(β)) = 0 as the p-th row is exact.
ker(H
p
(D) → H
p
(E)) ⊂ im(H
p
(C) → H
p
(D)): Let α ∈ H
p
(D) be a cohomology element (i. e. dα = 0) such that g(α) = 0 in cohomology, i. e. g(α) = dβ for some E
p−1
. As
g is surjective we can pick an inverse image γ ∈ D
p−1 of β. Then
g(α−dγ) = g(α)−g(dγ) = g(α)−dβ = 0,
8. Cohomology of sheaves 155
so there is a δ ∈ C
p
such that f(δ) = α−dγ as the p-th row is exact. Note that δ defines
an element in H
p
(C) as f(dδ) = d(α−dγ) = 0−0 = 0 and thus dδ = 0 as f is injective.
Moreover, f(δ) = α in H
p
(D) by construction, so α ∈ im(H
p
(C) → H
p
(D)).
Example 8.2.3. Consider the exact sequence of sheaves on X = P
1
0 −→ O(−2)
·x0x1 −→ O −→ kP ⊕kQ −→ 0
from example 7.1.18, where P = (0 : 1) and Q = (1 : 0), and the last map is given by evaluation at P and Q. From proposition 8.2.1 we deduce an associated long exact cohomology
sequence
0 → H
0
(X,O(−2)) → H
0
(X,O) → H
0
(X, kP ⊕kQ) → H
1
(X,O(−2)) → H
1
(X,O) → ··· .
Now H
0
(X,O(−2)) = 0 by example 7.7.1 and H
1
(X,O) = 0 by example 8.1.7. Moreover,
H
0
(X,O) is just the space of global (constant) functions, H
0
(X, kP ⊕kQ) is isomorphic to
k × k (given by specifying values at the points P and Q), and H
1
(X,O(−2)) = h
1
x0x1
i is
1-dimensional by example 8.1.8. So our exact sequence is just
0 → k → k ×k → k → 0.
We can actually also identify the morphisms. The first morphism in this sequence is a 7→
(a,a) as it is the evaluation of the constant function a at the points P and Q. The second
morphism is given by the “left, down, left” procedure of part (iii) of the proof of lemma
8.2.2 in the following diagram:
0 /C
0
(O(−2)) /

C
0
(O) /

C
0
(kP ⊕kQ) /

0
0 /C
1
(O(−2)) /C
1
(O) /C
1
(kP ⊕kQ) /0
Starting with any element (a,b) ∈ C
0
(kP ⊕kQ) we can find an inverse image in C
0
(O) =
O(U0)×O(U1) (with Ui = {xi 6= 0}, namely the pair of constant functions (b,a) (as P ∈U1
and Q ∈ U0). Going down in the diagram yields the function a − b ∈ O(U0 ∩U1) by the
definition of the boundary operator. Recalling that the morphism from O(−2) to O is given
by multiplication with x0x1, we find that a−b
x0x1
is the element in C
1
(O(−2)) that we were
looking for. In terms of the basis vector 1
x0x1
of H
1
(X,O(−2)) this function has the single
coordinate a−b. So in this basis our exact cohomology sequence becomes
0 → k → k ×k → k → 0
a 7→ (a,a)
(a,b) 7→ a−b,
which is indeed exact.
8.3. The Riemann-Roch theorem revisited. Let us now study the cohomology groups
of line bundles on smooth projective curves in some more detail. So let X be such a curve,
and let L be a line bundle on X. Of course by example 8.1.6 (i) and (iii) the only interesting
cohomology group is H
1
(X,L). We will show that this group is trivial if L is “positive
enough”:
Proposition 8.3.1. (Kodaira vanishing theorem for line bundles on curves) Let X be a
smooth projective curve of genus g, and let L be a line bundle on X such that degL ≥
2g−1. Then H1
(X,L) = 0.
Proof. We compute H
1
(X,L) using our definition of cohomology groups. So let U0 ⊂ X
be an affine open subset of X. It must be of the form X\{P1,...,Pr} for some points Pi
on X. Now pick any other affine open subset U1 ⊂ X that contains the points Pi
. Then U1
156 Andreas Gathmann
is of the form X\{Q1,...,Qs} with Pi 6= Qj for all i, j. So we have an affine open cover
X = U0 ∪U1.
By definition we have H
1
(X,L) = L(U0∩U1)/(L(U0)+L(U1)). Note that L(U0∩U1)
is precisely the space of rational sections of L that may have poles at the points Pi and Qj
,
and similarly for L(U0) and L(U1). In other words, to prove the proposition we have to
show that any rational section α of L with poles at the Pi and Qj can be written as the sum
of two rational sections α0 and α1, where α0 has poles only at the Pi and α1 only at the Qj
.
So let α be such a rational section. It is a global section of L ⊗OX (a1P1 +···+arPr +
b1Q1 +···+bsQs) for some ai
,bj ≥ 0.
Let us assume that a1 ≥ 1. Note that then the degree of the line bundle ωX ⊗ L
∨ ⊗
OX (−a1P1 − ··· − arPr) is at most −2 by assumption and corollary 7.6.6. Hence by the
Riemann-Roch theorem 7.7.3 (and example 7.7.1) it follows that
h
0
(L ⊗OX (a1P1 +···+arPr)) = degL+a1 +···+ar +1−g.
In the same way we get
h
0
(L ⊗OX ((a1 −1)P1 +···+arPr)) = degL+a1 −1+a2 +···+ar +1−g.
We conclude that
h
0
(L ⊗OX (a1P1 +···+arPr))−h
0
(L ⊗OX ((a1 −1)P1 +···+arPr)) = 1.
So we can pick a rational section α
0
0
in Γ(L ⊗OX (a1P1+···+arPr)) that is not in Γ(h
0
(L ⊗
OX ((a1 −1)P1 +···+arPr))), i. e. a section that has a pole of order exactly a1 at P1.
Now α and α
0
0
are both sections of the one-dimensional vector space
Γ(L ⊗OX (a1P1 +···+arPr))/Γ(L ⊗OX ((a1 −1)P1 +···+arPr)),
and moreover α
0
0
is not zero in this quotient. So by possibly multiplying α
0
0 with a constant
scalar we can assume that α−α
0
0
is in Γ(L ⊗OX ((a1 −1)P1 +···+arPr)).
Note now that α
0
0
has poles only at the Pi
, whereas the total order of the poles of α−α
0
0
at the Pi
is at most a1 + ··· + ar − 1. Repeating this process we arrive after a1 + ··· + ar
steps at a rational section α0 with poles only at the Pi such that α1 := α−α0 has no poles
any more at the Pi
. This is precisely what we had to construct.
Remark 8.3.2. As in the case of the Riemann-Roch theorem there are vast generalizations
of the Kodaira vanishing theorem, e. g. to higher-dimensional spaces. One version is the
following: if X is a smooth projective variety then H
i
(X,ωX ⊗OX (n)) = 0 for all i > 0 and
n > 0. Note that in the case of a smooth curve this follows from our version of proposition
8.3.1, as deg(ωX ⊗OX (n)) = 2g−2+1 ≥ 2g−1.
In general cohomology groups “tend to be zero quite often”. There are many so-called
vanishing theorems that assert that certain cohomology groups are zero under some conditions that can hopefully easily be checked. We will prove one more vanishing theorem in
theorem 8.4.7 (ii). Of course, the advantage of vanishing cohomology groups is that they
break up the long exact cohomology sequence of proposition 8.2.1 into smaller pieces.
Using our Kodaira vanishing theorem we can now reprove the Riemann-Roch theorem in a “cohomological version”. In analogy to the notation of section 7.7 let us denote
H
1
(X,OX (D)) also by H
1
(D) for any divisor D, and similarly for h
1
(D).
Corollary 8.3.3. (Riemann-Roch theorem for line bundles on curves, second version)
Let X be a smooth projective curve of genus g. Then for any divisor D on X we have
h
0
(D)−h
1
(D) = degD+1−g.
Proof. From the exact skyscraper sequence
0 → OX (D) → OX (D+P) → kP → 0
8. Cohomology of sheaves 157
for any point P ∈ X we get the long exact sequence in cohomology
0 → H
0
(D) → H
0
(D+P) → k → H
1
(D) → H
1
(D+P) → 0
by proposition 8.2.1. Taking dimensions, we conclude that χ(D + P) − χ(D) = 1, where
χ(D) := h
0
(D)−h
1
(D). It follows by induction that we must have
h
0
(D)−h
1
(D) = degD+c
for some constant c (that does not depend on D). But by our first version of the RiemannRoch theorem 7.7.3 we have
h
0
(D)−h
0
(KX −D) = degD+1−g.
So to determine the constant c we can pick a divisor D of degree at least 2g − 1: then
h
1
(D) vanishes by proposition 8.3.1 and h
0
(KX − D) by example 7.7.1. So we conclude
that c = 1−g, as desired.
Remark 8.3.4. Comparing our two versions of the Riemann-Roch theorem we see that we
must have h
0
(ωX ⊗L
∨) = h
1
(L) for all line bundles L on a smooth projective curve X. In
fact, this is just a special case of the Serre duality theorem that asserts that for any smooth
n-dimensional variety X and any locally free sheaf F there are canonical isomorphisms
H
i
(X,F ) ∼= H
n−i
(X,ωX ⊗F
∨
)
∨
for all i = 0,...,n. Unfortunately, these isomorphisms cannot easily be written down.
There are even more general versions for singular varieties X and more general sheaves F .
We refer to [H] section III.7 for details.
Note that our new version of the Riemann-Roch theorem can be used to define the genus
of singular curves:
Definition 8.3.5. Let X be a (possibly singular) curve. Then the genus of X is defined to
be the non-negative integer h
1
(X,OX ). (This definition is consistent with our old ones as
we can see by setting L = OX in corollary 8.3.3.)
Let us investigate the geometric meaning of the genus of singular curves in two cases:
Example 8.3.6. Let C1,...,Cn be smooth irreducible curves of genera g1,...,gn, and denote by C˜ = C1 ∪ ··· ∪Cn their disjoint union. Now pick r pairs of points Pi
,Qi ∈ C˜ that
are all distinct, and denote by C the curve obtained from C˜ by identifying every Pi with
the corresponding Qi for i = 1,...,r. Curves obtained by this procedure are called nodal
curves.
To compute the genus of the nodal curve C we consider the exact sequence
0 → OC → ⊕n
i=1OCi → ⊕r
i=1
kPi → 0
where the last maps ⊕n
i=1OCi → kPi
are given by evaluation at Pi minus evaluation at Qi
.
The sequence just describes the fact that regular functions on C are precisely functions on
C˜ that have the same value at Pi and Qi for all i.
By proposition 8.2.1 we obtain a long exact cohomology sequence
0 → H
0
(C,OC) → ⊕n
i=1H
0
(Ci
,OCi
) → k
⊕r → H
1
(C,OC) → ⊕n
i=1H
1
(Ci
,OCi
) → 0.
Taking dimensions, we get 1−n+r−h
1
(C,OC) +∑i gi = 0, so we see that the genus of C
is ∑i gi +r+1−n. If C is connected, note that r+1−n is precisely the number of “loops”
in the graph of C. So the genus of a nodal curve is the sum of the genera of its components
plus the number of “loops”. This fits well with our topological interpretation of the genus
given in examples 0.1.2 and 0.1.3.
158 Andreas Gathmann
C2
C1 C1
C
P1 Q1
C1 C2
genus = g1
+ g2
C3
2
+ g3
genus = g +1 1
+ g genus = g1
+1
Proposition 8.3.7. Let X ⊂ P
2 be a (possibly singular) curve of degree d, given as the
zero locus of a homogeneous polynomial f of degree d. Then the genus of X is equal to
1
2
(d −1)(d −2).
Proof. Let x0, x1, x2 be the coordinates of P
2
. By a change of coordinates we can assume
that the point (0 : 0 : 1) is not on X. Then the affine open subsets U0 = {x0 6= 0} and
U1 = {x1 6= 0} cover X. So in the same way as in the proof of proposition 8.3.1 we get
H
1
(X,OX ) = OX (U0 ∩U1)/(OX (U0) +OX (U1)).
Moreover, the equation of f must contain an x
d
2
-term, so the relation f = 0 can be used to
restrict the degrees in x2 of functions on X to at most d −1. Hence we get
OX (U0 ∩U1) = (
x
i
2
x
j
0
x
k
1
; 0 ≤ i ≤ d −1 and i = j +k
)
and
OX (U0) = (
x
i
2
x
j
0
x
k
1
; 0 ≤ i ≤ d −1, k ≤ 0, and i = j +k
)
(and similarly for OX (U1)). We conclude that
H
1
(X,OX ) = (
x
i
2
x
j
0
x
k
1
; 0 ≤ i ≤ d −1, j > 0, k > 0, and i = j +k
)
.
To compute the dimension of this space note that for a given value of i (which can run from
0 to d −1) we get i−1 choices of j and k (namely (1,i−1),(2,i−2),...,(i−1,1)). So
the total dimension is h
1
(X,OX ) = 1+2+···+ (d −2) = 1
2
(d −1)(d −2).
Remark 8.3.8. The important point of proposition 8.3.7 is that the genus of a curve is
constant in families: if we degenerate a smooth curve into a singular one (by varying the
coefficients in its equation) then the genus of the singular curve will be the same as the
genus of the original smooth curve. This also fits well with our idea in examples 0.1.2 and
0.1.3 that we can compute the genus of a plane curve by degenerating it into a singular one,
where the result is then easy to read off.
Remark 8.3.9. Our second (cohomological) version of the Riemann-Roch theorem is in
fact the one that is needed for generalizations to higher-dimensional varieties. If X is an
n-dimensional projective variety and F a sheaf on X then the generalized Riemann-Roch
theorem mentioned in remark 7.7.7 (v) will compute the Euler characteristic
χ(X,F ) :=
n
∑
i=0
(−1)
i
h
i
(X,F )
8. Cohomology of sheaves 159
in terms of other data that are usually easier to determine than the cohomology groups
themselves.
8.4. The cohomology of line bundles on projective spaces. Let us now turn to higherdimensional varieties and compute the cohomology groups of the line bundles OX (d) on
the projective space X = P
n
.
Proposition 8.4.1. Let X = P
n
, and denote by S = k[x0,..., xn] the graded coordinate ring
of X. Then the sheaf cohomology groups of the line bundles OX (d) on X are given by:
(i) L
d∈Z H
0
(X,OX (d)) = S as graded k-algebras,
(ii) L
d∈Z H
n
(X,OX (d)) = S
0 as graded k-vector spaces, where S0 ∼= S with the grading given by S0
d = S−n−1−d.
(iii) H
i
(X,OX (d)) = 0 whenever i 6= 0 and i 6= n.
Remark 8.4.2. By splitting up the equations of (i) and (ii) into the graded pieces one obtains
the individual cohomology groups H
i
(X,OX (d)). So for example we have
h
n
(X,OX (d)) = h
0
(X,OX (−n−1−d)) = (−d−1
n

if d ≤ −n−1,
0 if d > −n−1.
(Note that the equality of these two dimensions is consistent with the Serre duality theorem
of remark 8.3.4, since ωX = OX (−n−1) by lemma 7.4.15.)
Proof. (i) is clear from example 8.1.6 (i).
(ii): Let {Ui} for 0 ≤ i ≤ n be the standard affine open cover of X, i. e. Ui = {xi 6= 0}. We
will prove the proposition for all d together by computing the cohomology of the quasicoherent graded sheaf FX =
L
d∈Z OX (d) while keeping track of the grading (note that
cohomology commutes with direct sums). This is just a notational simplification.
Of course we have Ui0,...,ik = {xi0
· ··· · xik
6= 0}. So F (Ui0,...,ik
) is just the localization
Sxi0
···xi
k
. It follows that the sequence of groups C
k
(FX ) reads
∏
i0
Sxi0 → ∏
i0<i1
Sxi0
xi1 → ··· → ∏
j
Sx0···x j−1x j+1···xn → Sx0···xn
. (∗)
Looking at the last term in this sequence, we compute that
H
n
(X,F ) = coker(∏
j
Sx0···x j−1x j+1···xn → Sx0···xn
)
= hx
j0
0
··· x
jn
n
; ji ∈ Zi/hx
j0
0
··· x
jn
n
; ji ≥ 0 for some ii
= hx
j0
0
··· x
jn
n
; ji < 0 for all ii
=
1
x0 ··· xn
k[x
−1
0
,..., x
−1
n
],
so up to a shift of degx0 ··· xn = n+1 these are just the polynomials in xi with non-positive
exponents. This shows (ii).
(iii): We prove this by induction on n. There is nothing to show for n = 1. Let H =
{xn = 0} ∼= P
n−1 be a hyperplane. Note that there is an exact sequence of sheaves on X
0 → OX (d −1) → OX (d) → OH(d) → 0
for all d, where the first map is given by multiplication with xn, and the second one by
setting xn to 0. Taking these sequences together for all d ∈ Z we obtain the exact sequence
0 → F (−1) →
·xn F → FH → 
160 Andreas Gathmann
where we set F (−1) = F ⊗ OX (−1). From the associated long exact cohomology sequence and the induction hypothesis we get the following exact sequences:
0 → H
0
(X,F (−1)) → H
0
(X,F ) → H
0
(H,FH) → H
1
(X,F (−1)) → H
1
(X,F ) → 0,
0 → H
i
(X,F (−1)) → H
i
(X,F ) → 0 for 1 < i < n−1,
0 → H
n−1
(X,F (−1)) → H
n−1
(X,F ) → H
n−1
(H,FH) → H
n
(X,F (−1)) → H
n
(X,F ) → 0.
So first of all we see that H
i
(X,F (−1)) ∼= H
i
(X,F ) for all 1 < i < n−1. We claim that
this holds in fact for 1 ≤ i ≤ n−1. To see this for i = 1 note that the first exact sequence
above starts with
0 → k[x0,..., xn] →
·xn
k[x0,..., xn] → k[x0,..., xn−1] → ··· ,
which is obviously exact on the right, so it follows that H
1
(X,F (−1)) ∼= H
1
(X,F ). A
similar analysis of the third exact sequence above, using the explicit description of the
proof of part (ii), shows that H
n−1
(X,F (−1)) ∼= H
n−1
(X,F ). So we see that the map
H
i
(X,F (−1)) →
·xn H
i
(X,F ) is an isomorphism for all 1 ≤ i ≤ n − 1. (Splitting this up
into the graded parts, this means that H
i
(X,OX (d −1)) ∼= H
i
(X,OX (d)) for all d, i. e. the
cohomology groups do not depend on d. We still have to show that they are in fact zero.)
Now localize the Cech complex ˇ (∗) with respect to xn. Geometrically this just means
that we arrive at the complex that computes the cohomology of F on Un = {xn 6= 0}. As
Un is an affine scheme and therefore does not have higher cohomology groups by example
8.1.6 (ii), we see that
H
i
(X,F )xn = H
i
(Un,F |Un
) = 0.
So for any α ∈ H
i
(X,F ) we know that x
k
n
·α = 0 for some k. But we have shown above
that multiplication with xn in H
i
(X,F ) is an isomorphism, so α = 0. This means that
H
i
(X,F ) = 0, as desired.
Example 8.4.3. As a consequence of this computation we can now of course compute the
cohomology groups of all sheaves on P
n
that are made up of line bundles in some way. Let
us calculate the cohomology groups H
i
(X,ΩX ) as an example. By the Euler sequence of
lemma 7.4.15
0 → ΩPn → O(−1)
⊕(n+1) → O → 0
we get the long exact cohomology sequence
0 → H
0
(ΩPn ) → H
0
(O(−1))⊕(n+1) → H
0
(O)
→ H
1
(ΩPn ) → H
1
(O(−1))⊕(n+1) → H
1
(O)
→ H
2
(ΩPn ) → ··· .
By proposition 8.4.1 the cohomology groups of O(−1) are all zero, while the cohomology
groups H
i
(O) are zero unless i = 0, in which case we have h
0
(O) = 1. So we conclude that
h
i
(P
n
,ΩPn ) = (
1 if i = 1,
0 otherwise.
As an application of our computation of the cohomology groups of line bundles on projective spaces, we now want to prove in the rest of this section that the cohomology groups
of certain “finitely generated” quasi-coherent sheaves on projective schemes are always
finite-dimensional. Let us first define what we mean by this notion of finite generation.
Definition 8.4.4. Let X be a scheme. A sheaf F on X is called coherent if for every affine
open subset U = SpecR ⊂ X the restricted sheaf F |U is the sheaf associated to a finitely
generated R-module in the sense of definition 7.2.1.
8. Cohomology of sheaves 161
Remark 8.4.5. Except for the finite generation condition this definition is precisely the
same as for quasi-coherent sheaves. Consequently, our results that essentially all operations
that one can do with quasi-coherent sheaves yield again quasi-coherent sheaves carry over
to coherent sheaves without much change.
To show that the cohomology groups of coherent sheaves on projective schemes are
finite-dimensional we need an auxiliary lemma first.
Lemma 8.4.6. Let X be a projective scheme over a field, and let F be a coherent sheaf on
X. Then there is a surjective morphism OX (−d)
⊕n → F for some d and n.
Proof. Let X ⊂ P
r = Proj k[x0,..., xr
] and consider the standard affine open subsets Ui =
SpecRi ⊂ X given by xi 6= 0. As F is coherent, F |Ui
is of the form M˜
i
, where Mi
is a
finitely generated Ri-module. Let si,1,...,si,ki
be generators. Then the si, j define sections
of F over Ui
, and their germs generate the stalk of F at every point of Ui
.
The si, j do not need to extend to global sections of F , but we will now show that after
multiplying with x
d
i
for some d we get global sections si, j
· x
d
i ∈ Γ(F ⊗OX (d)). As X\Ui
is covered by the affine open subsets Uk for k 6= i, it is sufficient to show that we can
extend si, j
to all Uk in this way. But F (Uk) = Mk and F (Ui ∩Uk) = (Mk)xi
by proposition
7.2.2 (ii), so si, j ∈ F (Ui ∩Uk) ∈ (Mk)xi
obviously gives an element in F (Uk) = Mk after
multiplying with a sufficiently high power of xi
.
Hence we have shown that for some d we get global sections si, j ∈ Γ(F ⊗OX (d)) that
generate the stalk of F ⊗ OX (d) at all points of X. So these sections define a surjective
morphism O → F ⊗OX (d)
⊕n
(where n is the total number of sections chosen) and hence
a surjective morphism OX (−d)
⊕n → F .
Theorem 8.4.7. Let X be a projective scheme over a field, and let F be a coherent sheaf
on X.
(i) The cohomology groups Hi
(X,F ) are finite-dimensional vector spaces for all i.
(ii) We have Hi
(X,F ⊗OX (d)) = 0 for all i > 0 and d  0.
Proof. Let i : X → P
r be the inclusion morphism. As i∗F is coherent by proposition 7.2.9
(or rather its analogue for coherent sheaves) and the cohomology groups of F and i∗F
agree by definition, we can assume that X = P
r
.
We will prove the proposition by descending induction on i. By example 8.1.6 (iii)
there is nothing to show for i > r. By lemma 8.4.6 there is an exact sequence 0 → R →
OX (−d)
⊕n → F → 0 for some d and n, where R is a coherent sheaf on X by lemma 7.2.7.
Tensoring with OX (e) for some e ∈ Z and taking the corresponding long exact cohomology
sequence, we get
··· → H
i
(X,OX (e−d)
⊕n
) → H
i
(X,F ⊗OX (e)) → H
i+1
(X,R ⊗OX (e)) → ··· .
(i): Take e = 0. Then the vector space on the left is always finite-dimensional by the
explicit computation of proposition 8.4.1, and the one on the right is finite-dimensional by
the induction hypothesis. Hence H
i
(X,F ) is finite-dimensional as well.
(ii): For e  0 the group on the left is zero again by the explicit calculation of proposition 8.4.1, and the one on the right is zero by the induction hypothesis. Hence H
i
(X,F ⊗
OX (e)) = 0 for e  0.
Remark 8.4.8. Of course the assumption of projectivity is essential in theorem 8.4.7, as for
example H
0
(A
1
,OA1 ) = k[x] is not finite-dimensional as a vector space over k.
162 Andreas Gathmann
For a more interesting example, consider X = A
2\{(0,0)} and compute H
1
(X,OX ).
Using the affine open cover X = U1 ∪U2 with Ui = {xi 6= 0} for i = 1,2, we get
H
1
(X,OX ) = OX (U1 ∩U2)/(OX (U1) +OX (U2))
=
D
x
i
1
x
j
2
; i, j ∈ Z
E
/
D
x
i
1
x
j
2
; j ≥ 0 or i ≥ 0
E
=
D
x
i
1
x
j
2
; i, j < 0
E
,
which is not finite-dimensional. So we conclude that X is not projective (which is obvious). But we have also reproven the statement that X is not affine (see remark 2.3.17), as
otherwise we would have a contradiction to example 8.1.6 (ii).
8.5. Proof of the independence of the affine cover. To make our discussion of sheaf
cohomology rigorous it remains to be proven that the cohomology groups as of definition
8.1.4 do not depend on the choice of affine open cover. So let us go back to the original
definitions 8.1.2 and 8.1.4 that (seem to) depend on this choice. For simplicity let us
assume that all affine covers involved are finite.
Lemma 8.5.1. Let F be a quasi-coherent sheaf on an affine scheme X. Then Hi
(X,F ) = 0
for all i > 0 and every choice of affine open cover {Ui}.
Proof. Let us define a “sheafified version” of the Cech complex as follows: we set ˇ
C
p
(F ) = ∏
i0<···<ip
i∗F |Ui0
∩···∩Uip
where i : Ui0 ∩ ··· ∩Uip → X denotes the various inclusion maps. Then the C
p
(F ) are
quasi-coherent sheaves on X by proposition 7.2.9. Their spaces of global sections are
Γ(C
p
(F )) =C
p
(F ) by definition. There are boundary morphisms d
p
: C
p
(F )→C
p+1
(F )
defined by the same formula as in definition 8.1.2, giving rise to a complex
C
0
(F ) → C
1
(F ) → C
2
(F ) → ··· . (∗)
Note that it suffices to prove that this sequence is exact: as taking global sections of quasicoherent sheaves on affine schemes preserves exact sequences by proposition 7.2.2 (ii) it
then follows that the sequence
C
0
(F ) → C
1
(F ) → C
2
(F ) → ···
is exact as well, which by definition means that H
i
(X,F ) = 0 for i > 0.
The exactness of (∗) can be checked on the stalks. So let P ∈ X be any point, and let
Uj be an affine open subset of the given cover that contains P. We define a morphism of
stalks of sheaves at P
k : C
k
P → C
k−1
P
, α 7→ kα
by (kα)i0,...,ip−1 = αj,i0,...,ip−1
, where we make the following convention: if the indices
j,i0,...,ip−1 are not in sorted order and σ ∈ Sp+1 is the permutation such that σ(j) <
σ(i0) < ··· < σ(ip−1) then by αj,i0,...,ip−1 we mean (−1)
σ
·ασ(j),σ(i0),...,σ(ip−1)
.
We claim that kd +dk : C
k
P → C
k
P
is the identity. In fact, we have
(dkα)i0,...,ip = αi0,...,ip −
p
∑
k=1
(−1)
k αj,i0,...,ik−1
,ik+1
,...,ip
and
(kdα)i0,...,ip =
p
∑
k=1
(−1)
k αj,i0,...,ik−1
,ik+1
,...,ip
from which the claim follows.
8. Cohomology of sheaves 163
Finally we can now prove that the sequence (∗) is exact at any point P: we know
already that imd
k−1 ⊂ kerd
k
as d
k ◦ d
k−1 = 0. Conversely, if α ∈ kerd
k
, i. e. dα = 0, then
α = (kd +dk)(α) = d(kα), i. e. α ∈ imd
k−1
.
Lemma 8.5.2. Let F be a quasi-coherent sheaf on a scheme X. Pick an affine open cover
U = {U1,...,Uk}. Let U0 ⊂ X be any other affine open subset, and denote by U˜ the affine
open cover {U0,...,Uk}. Then the cohomology groups determined by the open covers U
and U˜ are the same.
Proof. LetC
p
(F ) and H
p
(X,F ) be the groups of Cech cycles and the cohomology groups ˇ
for the cover U, and denote by C˜ p
(F ) and H˜ p
(X,F ) the corresponding groups for the
cover U˜ .
Note that there are natural morphisms C˜ p
(F ) → C
p
(F ) and H˜ p
(X,F ) → H
p
(X,F )
given by “forgetting the data that involves the open subset U0”, i. e. by
(αi0,...,ip
)0≤i0<i1<···<ip≤k 7→ (αi0,...,ip
)1≤i0<i1<···<ip≤k.
More precisely, an element α˜ ∈ C˜ p
(F ) can be thought of as a pair α˜ = (α,α
0
), where
α ∈ C
p
(F ) is given by αi0,...,ip = α˜i0,...,ip
(for i0 > 0) and α
0 ∈ C
p−1
(U0,F |U0
) is given by
α
0
i0,...,ip−1
= α˜ 0,i0,...,ip−1
. Moreover, dα˜ = 0 if and only if
dα = 0 (1)
(these are the equations (dα˜)i0,...,ip+1 = 0 for i0 > 0) and
α|U0 −dα
0 = 0 (2)
(these are the equations (dα˜)i0,...,ip+1 = 0 for i0 = 0).
We have to show that the morphism H˜ p
(X,F ) → H
p
(X,F ) is injective and surjective.
(i) H˜ p
(X,F ) → H
p
(X,F ) is surjective: Let α ∈ H
p
(X,F ) be a cohomology cycle,
i. e. dα = 0. We have to find an α
0 ∈ C
p−1
(U0,F |U0
) such that α˜ = (α,α
0
)
satisfies dα˜ = 0, i. e. by (2) such that dα
0 = α|U0
. But d(α|U0
) = (dα)|U0 = 0, so
by lemma 8.5.1 α|U0 = dα
0
for some α
0
.
(ii) H˜ p
(X,F ) → H
p
(X,F ) is injective: Let α˜ ∈ H˜ p
(X,F ) be a cohomology cycle
(i. e. dα˜ = 0) such that α = 0 ∈ H
p
(X,F ), i. e. α = dβ for some β ∈ C
p−1
(F ).
We have to show that α˜ = 0 ∈ H˜ p
(X,F ), i. e. we have to find a ˜β = (β,β
0
) ∈
C˜ p−1
(F ) such that d
˜β = α˜. By (2) this means that we need β|U0 − dβ
0 = α
0
.
But d(β|U0 − α
0
) = α|U0 − α|U0 = 0, so by lemma 8.5.1 there is a β
0
such that
β|U0 −α
0 = dβ
0
.

Corollary 8.5.3. The cohomology groups of quasi-coherent sheaves on any scheme do not
depend on the choice of open affine cover.
Proof. Let F be a quasi-coherent sheaf on a scheme X. Let U = {U1,...,Uk} and U0 =
{U
0
1
,...,U
0
m} be two affine open covers of X. Then the cohomology groups H
i
(X,F )
determined by U are the same as those determined by U ∪U0 by (a repeated application
of) lemma 8.5.2, which in turn are equal to those determined by U0 by the same lemma.
8.6. Exercises.
Exercise 8.6.1. Let X be a smooth projective curve. For any point P ∈ X consider the
exact skyscraper sequence of sheaves on X
0 → ωX → ωX ⊗OX (P) → kP → 0
as in exercise 7.8.4. Show that the induced sequence of global sections is not exact, i. e.
the last map Γ(ωX ⊗OX (P)) → Γ(kP) is not surjective.
164 Andreas Gathmann
Exercise 8.6.2. Complete the proof of lemma 8.2.2, i. e. show that the sequence of morphisms of cohomology groups
··· → H
p−1
(E) → H
p
(C) → H
p
(D) → H
p
(E) → H
p+1
(C) → ···
associated to an exact sequence of complexes 0 → C → D → E → 0 is exact at the H
p
(C)
and H
p
(E) positions.
Exercise 8.6.3. Compute the cohomology groups H
i
(P
1 × P
1
, p
∗OP1 (a) ⊗ q
∗OP1 (b)) for
all a,b ∈ Z, where p and q denote the two projection maps from P
1 ×P
1
to P
1
.
Exercise 8.6.4. Give an example of a smooth projective curve X and line bundles L1,L2
on X of the same degree such that h
0
(X,L1) 6= h
0
(X,L2).
Exercise 8.6.5. Let X ⊂ P
r be a complete intersection of dimension n ≥ 1, i. e. it is the
scheme-theoretic zero locus of r−n homogeneous polynomials. Show that X is connected.
(Hint: Prove by induction on n that the natural map H
0
(P
r
,OPr(d)) → H
0
(X,OX (d)) is
surjective for all d ∈ Z.)
9. Intersection theory 165
9. INTERSECTION THEORY
A k-cycle on a scheme X (that is always assumed to be separated and of finite type
over an algebraically closed field in this section) is a finite formal linear combination
∑i ni
[Vi
] with ni ∈ Z, where the Vi are k-dimensional subvarieties of X. The group of
k-cycles is denoted Zk(X). A rational function ϕ on any subvariety Y ⊂ X of dimension k+1 determines a cycle div(ϕ) ∈ Zk(X), which is just the zeroes of ϕ minus the
poles of ϕ, counted with appropriate multiplicities. The subgroup Bk(X) ⊂ Zk(X)
generated by cycles of this form is called the group of k-cycles that are rationally
equivalent to zero. The quotient groups Ak(X) = Zk(X)/Bk(X) are the groups of
cycle classes or Chow groups. They are the main objects of study in intersection
theory. The Chow groups of a scheme should be thought of as being analogous to
the homology groups of a topological space.
A morphism f : X → Y is called proper if inverse images of compact sets (in the
classical topology) are compact. Any proper morphism f gives rise to push-forward
homomorphisms f∗ : A∗(X) → A∗(Y) between the Chow groups. On the other hand,
some other morphisms f : X →Y (e. g. inclusions of open subsets or projections from
vector bundles) admit pull-back maps f
∗
: A∗(Y) → A∗(X).
If X is a purely n-dimensional scheme, a Weil divisor is an element of Zn−1(X).
In contrast, a Cartier divisor is a global section of the sheaf K ∗
X
/O
∗
X
. Every Cartier
divisor determines a Weil divisor. On smooth schemes, Cartier and Weil divisors
agree. On almost any scheme, Cartier divisors modulo linear equivalence correspond
exactly to line bundles.
We construct bilinear maps PicX × Ak(X) → Ak−1(X) that correspond geometrically to taking intersections of the divisor (a codimension-1 subset of X) with the
k-dimensional subvariety. If one knows the Chow groups of a space and the above
intersection products, one arrives at Bezout style theorems that allow to compute the ´
number of intersection points of k divisors on X with a k-dimensional subspace.
9.1. Chow groups. Having discussed the basics of scheme theory, we will now start with
the foundations of intersection theory. The idea of intersection theory is the same as that of
homology in algebraic topology. Roughly speaking, what one does in algebraic topology is
to take e. g. a real differentiable manifold X of dimension n and an integer k ≥ 0, and consider formal linear combinations of real k-dimensional submanifolds (with boundary) on X
with integer coefficients, called cycles. If Zk(X) is the group of closed cycles (those having
no boundary) and Bk(X) ⊂ Zk(X) is the group of those cycles that are boundaries of (k+1)-
dimensional cycles, then the homology group Hk(X,Z) is the quotient Zk(X)/Bk(X).
There are (at least) two main applications of this. First of all, the groups Hk(X,Z) are
(in contrast to the Zk(X) and Bk(X)) often finitely generated groups and provide invariants
of the manifold X that can be used for classification purposes. Secondly, there are intersection products: homology classes in Hn−k(X,Z) and Hn−l(X,Z) can be “multiplied” to
give a class in Hn−k−l(X,Z) that geometrically corresponds to taking intersections of submanifolds. Hence if we are for example given submanifolds Vi of X whose codimensions
sum up to n (so that we expect a finite number of points in the intersection T
iVi), then this
number can often be computed easily by taking the corresponding products in homology.
Our goal is to establish a similar theory for schemes. For any scheme of finite type
over a ground field and any integer k ≥ 0 we will define the so-called Chow groups Ak(X)
whose elements are formal linear combinations of k-dimensional closed subvarieties of X,
modulo “boundaries” in a suitable sense. The formal properties of these groups Ak(X) will
be similar to those of homology groups; if the ground field is C you might even want to
think of the Ak(X) as being “something like” H2k(X,Z), although these groups are usually
different. But there is always a map Ak(X) → H2k(X,Z) (at least if one uses the “right”
homology theory, see [F] chapter 19 for details), so you can think of elements in the Chow
166 Andreas Gathmann
groups as something that determines a homology class, but this map is in general neither
injective nor surjective.
Another motivation for the Chow groups Ak(X) is that they generalize our notions of
divisors and divisor classes. In fact, if X is a smooth projective curve then A0(X) will be by
definition the same as PicX. In general, the definition of the groups Ak(X) is very similar
to our definition of divisors: we consider the free Abelian groups Zk(X) generated by the
k-dimensional subvarieties of X. There is then a subgroup Bk(X) ⊂ Zk(X) that corresponds
to those linear combinations of subvarieties that are zeros minus poles of rational functions.
The Chow groups are then the quotients Ak(X) = Zk(X)/Bk(X).
To make sense of this definition, the first thing we have to do is to define the divisor of a
rational function (see definition 6.3.4) in the higher-dimensional case. This is essentially a
problem of commutative algebra, so we will only sketch it here. The important ingredient
is the notion of the length of a module.
Remark 9.1.1. (For the following facts we refer to [AM] chapter 6 and [F] section A.1.)
Let M be a finitely generated module over a Noetherian ring R. Then there is a so-called
composition series, i. e. a finite chain of submodules
0 = M0 ( M1 ( ··· ( Mr = M (∗)
such that Mi/Mi−1
∼= R/pi for some prime ideals pi ∈ R. The series is not unique, but for
any prime ideal p ⊂ R the number of times p occurs among the pi does not depend on the
series.
The geometric meaning of this composition series is easiest explained in the case where
R is an integral domain and M = R/I for some ideal I ⊂ R. In this case SpecM is a closed
subscheme of the irreducible scheme SpecR (see examples 5.2.3 and 7.2.10). The prime
ideals pi are then precisely the ideals of the irreducible (and maybe embedded) components
of SpecM, or in other words the prime ideals associated to all primary ideals in the primary
decomposition of I. The number of times p occurs among the pi can be thought of as
the “multiplicity” of the corresponding component in the scheme. For example, if I is a
radical ideal (so SpecM is reduced) then the pi are precisely the ideals of the irreducible
components of SpecM, all occurring once.
We will need this construction mainly in the case where I = (f) ⊂ R is the ideal generated by a single (non-zero) function. In this case all irreducible components of SpecM have
codimension 1. If p ⊂ R is a prime ideal corresponding to any codimension-1 subvariety
of SpecR we can consider a composition series as above for the localized module Mp over
Rp. As the only prime ideals in Rp are (0) and pRp (corresponding geometrically to SpecR
and SpecM, respectively) and f does not vanish identically on SpecM, the only prime
ideal that can occur in the composition series of Mp is pRp. The number of times it occurs,
i. e. the length r of the composition series, is then called the length of the module Mp over
Rp, denoted lRp
(Mp). It is equal to the number of times p occurs in the composition series
of M over R. By what we have said above, we can interpret this number geometrically as
the multiplicity of the subvariety corresponding to p in the scheme SpecR/(f), or in other
words as the order of vanishing of f at this codimension-1 subvariety.
We should rephrase these ideas in terms of general (not necessarily affine) schemes.
So let X be a scheme, and let V ⊂ X be a subvariety of codimension 1. Note that V can
be considered as a point in the scheme X, so it makes sense to talk about the stalk OX,V
of the structure sheaf OX at V. If U = SpecR ⊂ X is any affine open subset with nonempty intersection with V then OX,V is just the localized ring Rp where p is the prime ideal
corresponding to the subvariety V ∩U of U (see proposition 5.1.12 (i)). So if f ∈ OX,V is
a local function around V then its order of vanishing at the codimension-1 subvariety V is
simply the length lOX,V
(OX,V /(f)). To define the order of a possibly rational function ϕ on
X we just have to observe that the field of fractions of the ring OX,V is equal to the field of
9. Intersection theory 167
rational functions on X. So we can write ϕ as
f
g
for some f,g ∈ OX,V and simply define
the order of ϕ at V to be the difference of the orders of f and g at V.
With these prerequisites we can now define the Chow groups in complete analogy to the
Picard group of divisor classes in section 6.3. For the rest of this section by a scheme we
will always mean a scheme of finite type over some algebraically closed field (that is not
necessarily smooth, irreducible, or reduced). A variety is a reduced and irreducible (but
not necessarily smooth) scheme.
Definition 9.1.2. Let X be a variety, and let V ⊂ X be a subvariety of codimension 1, and
set R = OX,V . For every non-zero f ∈ R ⊂ K(X) we define the order of f at V to be the
integer ordV (f) := lR(R/(f)). If ϕ ∈ K(X) is a non-zero rational function we write ϕ =
f
g
with f,g ∈ R and define the order of ϕ at V to be
ordV (ϕ) := ordV (f)−ordV (g).
To show that this is well-defined, i. e. that ordV
f
g = ordV
f
0
g
0 whenever f g0 = g f 0
, one uses
the exact sequence
0 → R/(a)
·b
→ R/(ab) → R/(b) → 0
and the fact that the length of modules is additive on exact sequences. From this it also
follows that the order function is a homomorphism of groups ordV : K(X)
∗
:= K(X)\{0} →
Z.
Example 9.1.3. Let X = A
1 = Spec k[x] and let V = {0} ⊂ X be the origin. Consider the
function ϕ = x
r
for r ≥ 0. Then R = OX,V = k[x](x)
, and R/(x) ∼= k. So as R/(x
r
) = {a0 +
a1x+···+ar−1x
r−1} has vector space dimension r over k we conclude that ord0(x
r
) = r,
as expected. By definition, we then have the equality ord0(x
r
) = r for all r ∈ Z.
Definition 9.1.4. Let X be a scheme. For k ≥ 0 denote by Zk(X) the free Abelian group
generated by the k-dimensional subvarieties of X. In other words, the elements of Zk(X) are
finite formal sums ∑i ni
[Vi
], where ni ∈ Z and the Vi are k-dimensional (closed) subvarieties
of X. The elements of Zk(X) are called cycles of dimension k.
For any (k+1)-dimensional subvariety W of X and any non-zero rational function ϕ on
W we define a cycle of dimension k on X by
div(ϕ) = ∑
V
ordV (ϕ)[V] ∈ Zk(X),
called the divisor of ϕ, where the sum is taken over all codimension-1 subvarieties V of
W. Note that this sum is always finite: it suffices to check this on a finite affine open cover
{Ui} of W and for ϕ ∈ OUi
(Ui), where it is obvious as Z(ϕ) is closed and Ui
is Noetherian.
Let Bk(X) ⊂ Zk(X) be the subgroup generated by all cycles of the form div(ϕ) for all
W ⊂ X and ϕ ∈ K(W)
∗
as above. We define the group of k-dimensional cycle classes to be
the quotient Ak(X) = Zk(X)/Bk(X). These groups are usually called the Chow groups of
X. Two cycles in Zk(X) that determine the same element in Ak(X) are said to be rationally
equivalent.
We set Z∗(X) = L
k≥0 Zk(X) and A∗(X) = L
k≥0 Ak(X).
Example 9.1.5. Let X be a scheme of pure dimension n. Then Bn(X) is trivially zero, and
thus An(X) = Zn(X) is the free Abelian group generated by the irreducible components of
X. In particular, if X is an n-dimensional variety then An(X) ∼= Z with [X] as a generator.
In the same way, Zk(X) and Ak(X) are trivially zero if k > n.
Example 9.1.6. Let X be a smooth projective curve. Then Z0(X) = DivX and A0(X) =
PicX by definition. In fact, the 1-dimensional subvariety W of X in definition 9.1.4 can
only be X itself, so we arrive at precisely the same definition as in section 6.3.
168 Andreas Gathmann
Example 9.1.7. Let X = {x1x2 = 0} ⊂ P
2 be the union of two projective lines X = X1 ∪X2
that meet in a point. Then A1(X) = Z[X1]⊕Z[X2] by example 9.1.5. Moreover, A0(X) ∼= Z
is generated by the class of any point in X. In fact, any two points on X1 are rationally
equivalent by example 9.1.6, and the same is true for X2. As both X1 and X2 contain the
intersection point X1 ∩ X2 we conclude that all points in X are rationally equivalent. So
A0(X) ∼= Z.
Now let P1 ∈ X1\X2 and P2 ∈ X2\X1 be two points. Note that the line bundles OX (P1)
and OX (P2) (defined in the obvious way: OX (Pi) is the sheaf of rational functions that
are regular away from Pi and have at most a simple pole at Pi) are not isomorphic: if
i : X1 → X is the inclusion map of the first component, then i
∗OX (P1) ∼= OP1 (1), whereas
i
∗OX (P2) ∼= OP1 . So we see that for singular curves the one-to-one correspondence between
A0(X) and line bundles no longer holds.
Example 9.1.8. Let X = A
n
. We claim that A0(X) = 0. In fact, if P ∈ X is any point,
pick a line W ∼= A
1 ⊂ A
n
through P and a linear function ϕ on W that vanishes precisely
at P. Then div(ϕ) = [P]. It follows that the class of any point is zero in A0(X). Therefore
A0(X) = 0.
Example 9.1.9. Now let X = P
n
; we claim that A0(X) ∼= Z. In fact, if P and Q are any two
distinct points in X let W ∼= P
1 ⊂ P
n be the line through P and Q, and let ϕ be a rational
function on W that has a simple zero at P and a simple pole at Q. Then div(ϕ) = [P]−[Q],
i. e. the classes in A0(X) of any two points in X are the same. It follows that A0(X) is
generated by the class [P] of any point in X.
On the other hand, if W ⊂ X = P
n
is any curve and ϕ a rational function on W then we
have seen in remark 6.3.5 that the degree of the divisor of ϕ is always zero. It follows that
the class n · [P] ∈ A0(X) for n ∈ Z can only be zero if n = 0. We conclude that A0(X) ∼= Z
with the class of any point as a generator.
Example 9.1.10. Let X be a scheme, and let Y ⊂ X be a closed subscheme with inclusion
morphism i : Y → X. Then there are canonical push-forward maps i∗ : Ak(Y) → Ak(X) for
any k, given by [Z] 7→ [Z] for any k-dimensional subvariety Z ⊂ Y. It is obvious from the
definitions that this respects rational equivalence.
Example 9.1.11. Let X be a scheme, and let U ⊂ X be an open subset with inclusion
morphism i : U → X. Then there are canonical pull-back maps i
∗
: Ak(X) → Ak(U) for
any k, given by [Z] 7→ [Z ∩U] for any k-dimensional subvariety Z ⊂ X. This respects
rational equivalence as i
∗ div(ϕ) = div(ϕ|U ) for any rational function ϕ on a subvariety of
X.
Remark 9.1.12. If f : X → Y is any morphism of schemes it is an important part of intersection theory to study whether there are push-forward maps f∗ : A∗(X) → A∗(Y) or
pull-back maps f
∗
: A∗(Y) → A∗(X) and which properties they have. We have just seen
two easy examples of this. Note that neither example can be reversed (at least not in an
obvious way):
(i) if Y ⊂ X is a closed subset, then a subvariety of X is in general not a subvariety of
Y, so there is no pull-back morphism A∗(X) → A∗(Y) sending [V] to [V] for any
subvariety V ⊂ X.
(ii) if U ⊂ X is an open subset, there are no push-forward maps A∗(U) → A∗(X): if
U = A
1
and X = P
1
then the class of a point is zero in A∗(U) but non-zero in
A∗(P
1
) by examples 9.1.8 and 9.1.9.
We will construct more general examples of push-forward maps in section 9.2, and more
general examples of pull-back maps in proposition 9.1.14.
9. Intersection theory 169
Lemma 9.1.13. Let X be a scheme, let Y ⊂ X be a closed subset, and let U = X\Y . Denote
the inclusion maps by i : Y → X and j : U → X. Then the sequence
Ak(Y) →
i∗
Ak(X)
j
∗
→ Ak(U) → 0
is exact for all k ≥ 0. The homomorphism i∗ is in general not injective however.
Proof. This follows more or less from the definitions. If Z ⊂ U is any k-dimensional
subvariety then the closure Z¯ of Z in X is a k-dimensional subvariety of X with j
∗
[Z¯] = [Z].
So j
∗
is surjective.
If Z ⊂ Y then Z ∩U = 0, so j
∗ ◦ i∗ = 0. Conversely, assume that we have a cycle
∑ar
[Vr
] ∈ Ak(X) whose image in Ak(U) is zero. This means that there are rational functions
ϕs on (k + 1)-dimensional subvarieties Ws of U such that ∑div(ϕs) = ∑ar
[Vr ∩U] on U.
Now the ϕs are also rational functions on the closures of Ws
in X, and as such their divisors
can only differ from the old ones by subvarieties V
0
r
that are contained in X\U = Y. We
conclude that ∑div(ϕs) = ∑ar
[Vr
]−∑br
[V
0
r
] on X for some br
. So ∑ar
[Vr
] = i∗ ∑br
[V
0
r
].
As an example that i∗ is in general not injective let Y be a smooth cubic curve in X = P
2
.
If P and Q are two distinct points on Y then [P]−[Q] 6= 0 ∈ A0(Y) = PicX by proposition
6.3.13, but [P]−[Q] = 0 ∈ A0(X) ∼= Z by example 9.1.9.
Proposition 9.1.14. Let X be a scheme, and let π : E → X be a vector bundle of rank r
on X (see remark 7.3.2). Then for all k ≥ 0 there is a well-defined surjective pull-back
homomorphism π
∗
: Ak(X) → Ak+r(E) given on cycles by π
∗
[V] = [π
−1
(V)].
Proof. It is clear that π
∗
is well-defined: it obviously maps k-dimensional cycles to (k+r)-
dimensional cycles, and π
∗ div(ϕ) = div(π
∗ϕ) for any rational function ϕ on a (k + 1)-
dimensional subvariety of X.
We will prove the surjectivity by induction on dimX. Let U ⊂ X be an affine open
subset over which E is of the form U ×A
r
, and let Y = X\U. By lemma 9.1.13 there is a
commutative diagram
Ak(Y) /

Ak(X) /
π
∗

Ak(U) /

0
Ak+r(E|Y ) /Ak+r(E) /Ak+r(U ×A
r
) /0
with exact rows. A diagram chase (similar to that of the proof of lemma 8.2.2) shows that
in order for π
∗
to be surjective it suffices to prove that the left and right vertical arrows
are surjective. But the left vertical arrow is surjective by the induction assumption since
dimY < dimX. So we only have to show that the right vertical arrow is surjective. In other
words, we have reduced to the case where X = SpecR is affine and E = X ×A
r
is the trivial
bundle. As π then factors as a sequence
E = X ×A
r → X ×A
r−1 → ··· → X ×A
1 → X
we can furthermore assume that r = 1, so that E = X ×A
1 = SpecR[t].
We have to show that π
∗
: Ak(X) → Ak(X × A
1
) is surjective. So let V ⊂ X × A
1 be a
(k +1)-dimensional subvariety, and let W = π(V). There are now two cases to consider:
• dimW = k. Then V = W ×A
1
, so [V] = π
∗
[W].
• dimW = k + 1. As it suffices to show that [V] is in the image of the pull-back
map Ak(W) → Ak+r(W × A
1
) we can assume that W = X. Consider the ideal
I(V) ⊗R K ⊂ K[t], where K = K(W) denotes the quotient field of R. It is not
the unit ideal as otherwise we would be in case (i). On the other hand K[t] is a
principal ideal domain, so I(V)⊗RK is generated by a single polynomial ϕ ∈ K[t].
170 Andreas Gathmann
Considering ϕ as a rational function on X × A
1 we see that the divisor of ϕ is
precisely [V] by construction, plus maybe terms of the form ∑aiπ
∗
[Wi
] for some
Wi ⊂ X corresponding to our tensoring with the field of rational functions K(X).
So [V] = π
∗
(∑ai
[Wi
]) (plus the divisor of a rational function), i. e. [V] is in the
image of π
∗
.

Remark 9.1.15. Note that the surjectivity part of proposition 9.1.14 is obviously false on
the cycle level, i. e. for the pull-back maps Zk(X) → Zk(E): not every subvariety of a
vector bundle E over X is the inverse image of a subvariety in X. So this proposition is
an example of the fact that working with Chow groups (instead of with the subvarieties
themselves) often makes life a little easier. In fact one can show (see [F] theorem 3.3 (a))
that the pull-back maps π
∗
: Ak(X) → Ak+r(E) are always isomorphisms.
Corollary 9.1.16. The Chow groups of affine spaces are given by
Ak(A
n
) = (
Z for k = n,
0 otherwise.
Proof. The statement for k ≥ n follows from example 9.1.5. For k < n note that the homomorphism A0(A
n−k
) → Ak(A
n
) is surjective by proposition 9.1.14, so the statement of the
corollary follows from example 9.1.8.
Corollary 9.1.17. The Chow groups of projective spaces are Ak(P
n
) ∼= Z for all 0 ≤ k ≤ n,
with an isomorphism given by [V] 7→ degV for all k-dimensional subvarieties V ⊂ P
n
.
Proof. The statement for k ≥ n follows again from example 9.1.5, so let us assume that
k < n. We prove the statement by induction on n. By lemma 9.1.13 there is an exact
sequence
Ak(P
n−1
) → Ak(P
n
) → Ak(A
n
) → 0.
We have Ak(A
n
) = 0 by corollary 9.1.16, so we conclude that Ak(P
n−1
) → Ak(P
n
) is surjective. By the induction hypothesis this means that Ak(P
n
) is generated by the class of
a k-dimensional linear subspace. As the morphism Zk(P
n−1
) → Zk(P
n
) trivially preserves
degrees it only remains to be shown that any cycle ∑ai
[Vi
] that is zero in Ak(P
n
) must
satisfy ∑ai degVi = 0. But this is clear from Bezouts theorem, as deg div ´ (ϕ) = 0 for all
rational functions on any subvariety of P
n
.
Remark 9.1.18. There is a generalization of corollary 9.1.17 as follows. Let X be a scheme
that has a stratification by affine spaces, i. e. X has a filtration by closed subschemes 0/ =
X−1 ⊂ X0 ⊂ ··· ⊂ Xn = X such that Xk\Xk−1 is a disjoint union of ak affine spaces A
k
for
all k. For example, X = P
n has such a stratification with ak = 1 for 0 ≤ k ≤ n, namely
0/ ⊂ P
0 ⊂ P
1 ⊂ ··· ⊂ P
n = X.
We claim that then Ak(X) is isomorphic to Z
ak modulo some (possibly trivial) subgroup,
where Z
ak
is generated by the classes of the closures of the ak copies of A
k mentioned
above. We will prove this by induction on dimX, the case of dimension 0 being obvious.
In fact, consider the exact sequence of lemma 9.1.13
Ak(Xn−1) → Ak(X) → ⊕an
i=1Ak(A
n
) → 0.
Note that Xn−1 itself is a scheme with a filtration 0/ = X−1 ⊂ X0 ⊂ ··· ⊂ Xn−1 as above. So
it follows that:
(i) For k < n we have Ak(A
n
) = 0, so Ak(X) is generated by Ak(Xn−1). Hence the
claim follows from the induction hypothesis.
(ii) For k ≥ n we have Ak(Xn−1) = 0, so An(X) ∼= ⊕
an
i=1Ak(A
n
) is generated by the
classes of the closures of the an copies of A
n
in X\Xn−1.
9. Intersection theory 171
This proves the claim. In fact, one can show that Ak(X) is always isomorphic to Z
ak
if X
has a stratification by affine spaces as above (see [F] example 1.9.1).
In particular, this construction can be applied to compute the Chow groups of products
of projective spaces and Grassmannian varieties (see exercise 3.5.4).
Remark 9.1.19. Using Chow groups, Bezout’s theorem can obviously be restated as fol- ´
lows: we have seen in corollary 9.1.17 that Ak(P
n
) ∼= Z for all k ≤ n, with the class of a
k-dimensional linear subspace as a generator. Using this isomorphism, define a product
map
An−k(P
n
)×An−l(P
n
) → An−k−l(P
n
), (a,b) 7→ ab
for k + l ≤ n. This “intersection pairing” has the following property: if X,Y ⊂ P
n
are
two subvarieties that intersect in the expected dimension (i. e. codim(X ∩Y) = codimX +
codimY) then [X ∩Y] = [X] · [Y]. So “intersections of subvarieties can be performed on
the level of cycle classes”. As we have mentioned in the introduction to this section, the
existence of such intersection pairing maps between the Chow groups will generalize to
arbitrary smooth varieties. It is one of the most important properties of the Chow groups.
9.2. Proper push-forward of cycles. We now want to generalize the push-forward maps
of example 9.1.10 to more general morphisms, i. e. given a morphism f : X →Y of schemes
we will study the question under which conditions there are induced push-forward maps
f∗ : Ak(X) → Ak(Y) for all k that are (roughly) given by f∗[V] = [ f(V)] for a k-dimensional
subvariety V of X.
Remark 9.2.1. We have seen already in remark 9.1.12 (ii) that there are no such pushforward maps for the open inclusion A
1 → P
1
. The reason for this is precisely that the
point P = P
1\A
1
is “missing” in the domain of the morphism: a rational function on A
1
(which is then also a rational function on P
1
) may have a zero and / or pole at the point P
which is then present on P
1 but not on A
1
. As the class of P is not trivial in the Chow group
of P
1
, this will change the rational equivalence class. Therefore there is no well-defined
push-forward map between the Chow groups.
Another example of a morphism for which there is no push-forward for Chow groups
is the trivial morphism f : A
1 → pt: again the class of a point is trivial in A0(A
1
) but not
in A0(pt). In contrast, the morphism f : P
1 → pt admits a well-defined push-forward map
f∗ : A0(P
1
) ∼= Z → A0(pt) ∼= Z sending the class of a point in P
1
to the class of a point in
pt.
These counterexamples can be generalized by saying that in general there should be no
points “missing” in the domain of the morphism f : X → Y for which we are looking for
a push-forward f∗. For example, if Y is the one-pointed space, by “no points missing”
we mean exactly that X should be compact (in the classical topology), i. e. complete in the
sense of remark 3.4.5. For general Y we need a “relative version” of this compactness (resp.
completeness) condition. Morphisms satisfying this condition are called proper. We will
give both the topological definition (corresponding to “compactness”) and the algebraic
definition (corresponding to “completeness”).
Definition 9.2.2. (Topological definition:) A continuous map f : X → Y of topological
spaces is called proper if f
−1
(Z) is compact for every compact set Z ⊂ Y.
(Algebraic definition:) Let f : X → Y be a morphism of “nice” schemes (separated, of
finite type over a field). For every morphism g : Z → Y from a third scheme Z form the
fiber diagram
X ×Y Z /
f
0

X
f

Z
g
/Y.
172 Andreas Gathmann
The morphism f is said to be proper if the induced morphism f
0
is closed for every such
g : Z → Y, i. e. if f
0 maps closed subsets of X ×Y Z to closed subsets of Z. This condition
is sometimes expressed by saying that f is required to be “universally closed”.
Remark 9.2.3. Note that the two definitions look quite different: whereas the topological
definition places a condition on inverse images of (compact) subsets by some morphism,
the algebraic definition places a condition on images of (closed) subsets by some morphism. Yet one can show that for varieties over the complex numbers the two definitions
agree if we apply the topological definition to the classical (not the Zariski) topology. We
will only illustrate this by some examples below. Note however that both definitions are
“obvious” generalizations of their absolute versions, i. e. properness of a map in topology is
a straightforward generalization of compactness of a space, whereas properness of a morphism in algebraic geometry is the expected generalization of completeness of a variety
(see remark 3.4.5). In particular, if Y = pt is a point then the (trivial) morphism f : X → pt
is proper if and only if X is complete (resp. compact).
Example 9.2.4. If X is complete (resp. compact) then any morphism f : X → Y is proper.
We will prove this both in the topological and the algebraic setting:
(i) In topology, let Z ⊂ Y be a compact subset of Y. In particular Z is closed, hence
so is the inverse image f
−1
(Z) as f is continuous. It follows that f
−1
(Z) is a
closed subset of a compact space X, hence compact.
(ii) In algebra, the fiber product X ×Y Z in definition 9.2.2 is isomorphic to the closed
subscheme p
−1
(∆Y ) of X ×Z, where p = (f,g) : X ×Z →Y ×Y and ∆Y ⊂ Y ×Y
is the diagonal. So if V ⊂ X ×Y Z is any closed subset, then V is also closed in
X ×Z, and hence its image in Z is closed as X is complete.
This is the easiest criterion to determine that a morphism is proper. Some more can be
found in exercise 9.5.5.
Example 9.2.5. Let U ⊂ X be a non-empty open subset of a (connected) scheme X. Then
the inclusion morphism i :U → X is not proper. This is obvious for the algebraic definition,
as i is not even closed itself (it maps the closed subset U ⊂ U to the non-closed subset
U ⊂ X). In the topological definition, let Z ⊂ X be a small closed disc around a point
P ∈ X\U. Its inverse image i
−1
(Z) = Z ∩U is Z minus a closed non-empty subset, so it is
not compact.
Example 9.2.6. If f : X →Y is proper then every fiber f
−1
(P) is complete (resp. compact).
Again this is obvious for the topological definition, as {P} ⊂Y is compact. In the algebraic
definition let P ∈ Y be a point, let Z be any scheme, and form the fiber diagram
Z × f
−1
(P) /
f
0

f
−1
(P) /

X
f

Z /P /Y.
If f is proper then by definition the morphism f
0
is closed for all choices of P and Z. By
definition this means exactly that all fibers f
−1
(P) of f are complete.
The converse is not true however: every fiber of the morphism A
1 → P
1
is complete
(resp. compact), but the morphism is not proper.
Remark 9.2.7. It turns out that the condition of properness of a morphism f : X → Y is
enough to guarantee the existence of well-defined push-forward maps f∗ : Ak(X) → Ak(Y).
To construct them rigorously however we have to elaborate further on our idea that f∗
should map any k-dimensional cycle [V] to [ f(V)], as the following two complications can
occur:
9. Intersection theory 173
(i) The image f(V) of V may have dimension smaller than k, so that f(V) does not
define a k-dimensional cycle. It turns out that we can consistently define f∗[V] to
be zero in this case.
(ii) It may happen that dim f(V) = dimV and the morphism f is a multiple covering
map, i. e. that a general point in f(V) has d > 1 inverse image points. In this case
the image f(V) is “covered d times by V”, so we would expect that we have to
set f∗[V] = d · [ f(V)]. Let us define this “order of the covering” d rigorously:
Proposition 9.2.8. Let f : X → Y be a morphism of varieties of the same dimension such
that f(X) is dense in Y . Then:
(i) K(X) is a finite-dimensional vector space over K(Y). Its dimension is called the
degree of the morphism f , denoted deg f . (One also says that K(X) : K(Y) is a
field extension of dimension [K(X) : K(Y)] = deg f .)
(ii) The degree of f is equal to the number of points in a general fiber of f . (This
means: there is a non-empty open set U ⊂ Y such that the fibers of f over U
consist of exactly deg f points.)
(iii) If moreover f is proper then every zero-dimensional fiber of f consists of exactly
deg f points if the points are counted with their scheme-theoretic multiplicities.
Proof. (i): We begin with a few reduction steps. As the fields of rational functions do
not change when we pass to an open subset, we can assume that X ⊂ A
n
and Y ⊂ A
m are
affine. Next, we factor the morphism f : X → Y as f = π ◦ γ with γ : X → Γ ⊂ X ×Y the
graph morphism and π : X ×Y → Y the projection. As γ is an isomorphism it is sufficient
to show the statement of the proposition for the projection map π. Finally, we can factor
the projection π (which is the restriction of the obvious projection map A
n+m → A
m to
X ×Y) into n projections that are given by dropping one coordinate at a time. Hence we
can assume that X ⊂ A
n+1
and Y ⊂ A
n
, and prove the statement for the map π : X →Y that
is the restriction of the projection map (x0,..., xn) 7→ (x1,..., xn) to X.
In this case the field K(X) is generated over K(Y) by the single element x0. Assume
that x0 ∈ K(X) is transcendental over K(Y), i. e. there is no polynomial relation of the form
Fd x
d
0 +Fd−1 x
d−1
0
···+F0 = 0, (∗)
for Fi ∈ K(Y) and Fd 6= 0. Then for every choice of (x1,..., xn) ∈ Y the value of x0 in
X is not restricted, i. e. the general fiber of f is not finite. But then dimX > dimY in
contradiction to our assumption. So x0 ∈ K(X) is algebraic over K(Y), i. e. there is a
relation (∗). It follows that K(X) is a vector space over K(Y) with basis {1, x0,..., x
d−1
0
}.
(ii): Continuing the proof of (i), note that on the non-empty open subset of Y where
all Fi are regular and Fd is non-zero every point in the target has exactly d inverse image
points (counted with multiplicity). Restricting the open subset further to the open subset
where the discriminant of the polynomial (∗) is non-zero, we can in fact show that there is
an open subset of Y on which the inverse images of f consist set-theoretically of exactly d
points that all count with multiplicity 1.
(iii): We will only sketch this part, using the topological definition of properness. By
(ii) there is an open subset U ⊂ Y on which all fibers of f consist of exactly n points. Let
P ∈ Y be any point, and choose a small closed disc ∆ ⊂ U ∪ {P} around P. If ∆ is small
enough then the inverse image f
−1
(∆\{P}) will be a union of d copies of ∆\{P}. As f
is proper, the inverse image f
−1
(∆) has to be compact, i. e. all the holes in the d copies of
∆\{P} have to be filled in by inverse image points of P. So the fiber f
−1
(P) must contain
at least d points (counted with multiplicities). But we see from (∗) above that every fiber
contains at most d points unless it is infinite (i. e. all Fi are zero at P). This shows part
(iii). 
174 Andreas Gathmann
We are now ready to construct the push-forward maps f∗ : Ak(X) → Ak(Y) for proper
morphisms f : X → Y.
Construction 9.2.9. Let f : X → Y be a proper morphism of schemes. Then for every
subvariety Z ⊂ X the image f(Z) is a closed subvariety of dimension at most dimZ. On
the cycle level we define homomorphisms f∗ : Zk(X) → Zk(Y) by
f∗[Z] = (
[K(Z) : K(f(Z))] · [ f(Z)] if dim f(Z) = dimZ,
0 if dim f(Z) < dimZ.
By proposition 9.2.8 this is well-defined and corresponds to the ideas mentioned in remark
9.2.7.
Remark 9.2.10. By the multiplicativity of degrees of field extensions it follows that the
push-forwards are functorial, i. e. (g ◦ f)∗ = g∗ f∗ for any two morphisms f : X → Y and
g : Y → Z.
Of course we want to show that these homomorphisms pass to the Chow groups, i. e.
give rise to well-defined homomorphisms f∗ : Ak(X) → Ak(Y). For this we have to show
by definition that divisors of rational functions are pushed forward to divisors of rational
functions.
Theorem 9.2.11. Let f : X → Y be a proper surjective morphism of varieties, and let
ϕ ∈ K(X)
∗ be a non-zero rational function on X. Then
f∗ div(ϕ) = (
0 if dimY < dimX
div(N(ϕ)) if dimY = dimX
in Z∗(Y), where N(ϕ) ∈ K(Y) denotes the determinant of the endomorphism of the K(Y)-
vector space K(X) given by multiplication by ϕ (this is usually called the norm of ϕ).
Proof. The complete proof of the theorem with all algebraic details is beyond the scope
of these notes; it can be found in [F] proposition 1.4. We will only sketch the idea of the
proof here.
Case 1: dimY < dimX (see the picture below). We can assume that dimY = dimX −1,
as otherwise the statement is trivial for dimensional reasons. Note that we must have
f∗ div(ϕ) = n · [Y] for some n ∈ Z by example 9.1.5. So it only remains to determine the
number n. By our interpretation of remark 9.2.7 (ii) we can compute this number on a general fiber of f by counting all points in this fiber with the multiplicity with which they occur
in the restriction of ϕ to this fiber. In other words, we have n = ∑P: f(P)=Q ordP(ϕ|
f −1(Q)
)
for any point Q ∈ Y over which the fiber of f is finite. But this number is precisely the
degree of ϕ|
f −1(Q)
on the complete curve f
−1
(Q), which must be zero. (Strictly speaking
we have only shown this for smooth projective curves in remark 6.3.5, but it is true in the
general case as well. The important ingredient is here that the fiber is complete.)
Case 2: dimY = dimX (see the picture below). We will restrict ourselves here to showing the stated equation set-theoretically, i. e. we will assume that ϕ is (locally around a
fiber) a regular function and show that f(Z(ϕ)) = Z(N(ϕ)), where Z(·) denotes as usual
the zero locus of a function.
Note first that we can neglect the fibers of f that are not finite: these fibers can only
lie over a subset of Y of codimension at least 2 (otherwise the non-zero-dimensional fibers
would form a component of X for dimensional reasons, in contrast to X being irreducible).
So as f∗ div(ϕ) is a cycle of codimension 1 in Y these higher-dimensional fibers cannot
contribute to the push-forward.
9. Intersection theory 175
ord φ =−1
ord φ =2
X
Y
Q
2
−1
−1
n=2−1−1=0
Case 1
f
f
X
Y
Q
P1
P2
P3
Case 2
Now let Q ∈ Y be any point such that the fiber f
−1
(Q) is finite. Then f
−1
(Q) consists of
exactly d = [K(X): K(Y)] points by proposition 9.2.8 (iii). Let us assume for simplicity that
all these points are distinct (although this is not essential), so f
−1
(Q) = {P1,...,Pd}. The
space of functions on this fiber is then just k
d
, corresponding to the value at the d points.
In this basis, the restriction of the function ϕ to this fiber is then obviously given by the
diagonal matrix with entries ϕ(P1),...,ϕ(Pd), so its determinant is N(ϕ)(Q) = ∏
d
i=1 ϕ(Pi).
Now it is clear that
Q ∈ f(Z(ϕ)) ⇐⇒ there is a Pi over Q with ϕ(Pi) = 0
⇐⇒ Q ∈ Z(N(ϕ)).
We can actually see the multiplicities arising as well: if there are k points among the Pi
where ϕ vanishes, then the diagonal matrix ϕ|
f
1(Q)
contains k zeros on the diagonal, hence
its determinant is a product that contains k zeros, so it should give rise to a zero of order k,
in accordance with our interpretation of remark 9.2.7 (ii).
Corollary 9.2.12. Let f : X → Y be a proper morphism of schemes. Then there are welldefined push-forward maps f∗ : Ak(X) → Ak(Y) for all k ≥ 0 given by the definition of
construction 9.2.9.
Proof. This follows immediately from theorem 9.2.11 applied to the morphism from a
(k +1)-dimensional subvariety of X to its image in Y.
Example 9.2.13. Let X be a complete scheme, and let f : X → pt be the natural (proper)
map. For any 0-dimensional cycle class α ∈ A0(X) we define the degree of α to be the
integer f∗α ∈ A0(pt) ∼= Z. This is well-defined by corollary 9.2.12. More explicitly, if
α = ∑i ni
[Pi
] for some points Pi ∈ X then degα = ∑i ni
.
Example 9.2.14. Let X = P˜ 2 be the blow-up of P
2 with coordinates (x0 : x1 : x2) in the
point P = (1 : 0 : 0), and denote by E ⊂ X the exceptional hypersurface. In this example
we will compute the Chow groups of X using remark 9.1.18.
Note that P
2 has a stratification by affine spaces as A
2 ∪ A
1 ∪ A
0
. Identifying A
0 with
P and recalling that the blow-up P˜ 2
is obtained from P
2 by “replacing the point P with a
line P
1
” we see that X has a stratification A
2 ∪ A
1 ∪ A
1 ∪ A
0
. By remark 9.1.18 it follows
that the closures of these four strata generate A∗(X). More precisely, these four classes
are [X] ∈ A2(X), [L] ∈ A1(X) where L is the strict transform of a line in P
2
through P,
the exceptional hypersurface [E] ∈ A1(X), and the class of a point in A0(X). It follows
immediately that A2(X) ∼= Z and A0(X) ∼= Z. Moreover we see that A1(X) is generated by
[L] and [E].
We have already stated without proof in remark 9.1.18 that [L] and [E] form in fact a
basis of A1(X). Let us now prove this in our special case at hand. So assume that there is
a relation n[L] +m[E] = 0 in A1(X). Consider the following two morphisms:
176 Andreas Gathmann
(i) Let π : X → P
2 be the projection to the base of the blow-up. This is a proper map,
and we have π∗[L] = [H] and π∗[E] = 0 where [H] ∈ A1(P
2
) is the class of a line.
So we see that
0 = π∗(0) = π∗(n[L] +m[E]) = n[H] ∈ A1(P
2
),
from which we conclude that n = 0.
(ii) Now let p : X → P
1 be the morphism that is the identity on E, and sends every
point Q ∈ X\E to the unique intersection point of E with the strict transform of
the line through P and Q. Again this is a proper map, and we have p∗[L] = 0 and
p∗[E] = [P
1
]. So again we see that
0 = p∗(0) = p∗(n[L] +m[E]) = m[P
1
] ∈ A1(P
1
),
from which we conclude that m = 0 as well.
Combining both parts we see that there is no non-trivial relation of the form n[L]+m[E] = 0
in A1(X).
Now let [H] be the class of a line in X that does not intersect the exceptional hypersurface. We have just shown that [H] must be a linear combination of [L] and [E]. To compute
which one it is, consider the rational function x1
x0
on X. It has simple zeros along L and E,
and a simple pole along H (with coordinates for L and H chosen appropriately). So we
conclude that [H] = [L] +[E] in A1(X).
9.3. Weil and Cartier divisors. Our next goal is to describe intersections on the level of
Chow groups as motivated in the beginning of section 9.1. We will start with the easiest
case, namely with the intersection of a variety with a subset of codimension 1. To put
it more precisely, given a subvariety V ⊂ X of dimension k and another one D ⊂ X of
codimension 1, we want to construct an intersection cycle [V] · [D] ∈ Ak−1(X) with the
property that [V] · [D] = [V ∩ D] if this intersection V ∩ D actually has dimension k − 1.
Of course these intersection cycles should be well-defined on the Chow groups, i. e. the
product cycle [V] · [D] ∈ Ak−1(X) should only depend on the classes of V and D in A∗(X).
Example 9.3.1. Here is an example showing that this is too much to hope for in the generality as we stated it. Let X = P
2∪P1 P
2 be the union of two projective planes glued together
along a common line. Let L1,L2,L3 ⊂ X be the lines as in the following picture.
L1
L2
L3
P
Q
Their classes in A1(X) are all the same since A1(X) ∼= Z by remark 9.1.18. But note that
L1 ∩L2 is empty, whereas L1 ∩L3 is a single point P. But 0 6= [P] ∈ A0(X), so there can be
no well-defined product map A1(X)×A1(X) → A0(X) that describes intersections on this
space X.
The reason why this construction failed is quite a subtle one: we have to distinguish
between codimension-1 subspaces and spaces that can locally be written as the zero locus
of a single function. In general the intersection product exists only for intersections with
spaces that are locally the zero locus of a single function. For most spaces this is the
same thing as codimension-1 subspaces, but notably not in example 9.3.1 above: neither
of the three lines Li can be written as the zero locus of a single function on X: there is a
9. Intersection theory 177
(linear) function on the vertical P
2
that vanishes precisely on L1, but we cannot extend it
to a function on all of X that vanishes at the point Q but nowhere else on the horizontal P
2
.
(We can write the Li as the zero locus of a single function on a component of X, but this is
not what we need.)
So for intersection-theoretic purposes we have to make a clear distinction between
codimension-1 subspaces and spaces that are locally the zero locus of a single function.
Let us make the corresponding definitions.
Definition 9.3.2. Let X be a scheme.
(i) If X has pure dimension n a Weil divisor on X is an element of Zn−1(X). Obviously, the Weil divisors form an Abelian group. Two Weil divisors are called
linearly equivalent if they define the same class in An−1(X). The quotient group
An−1(X) is called the group of Weil divisor classes.
(ii) Let KX be the sheaf of rational functions on X, and denote by K ∗
X
the subsheaf
of invertible elements (i. e. of those functions that are not identically zero on any
component of X). Note that K ∗
X
is a sheaf of Abelian groups, with the group
structure given by multiplication of rational functions. Similarly, let O
∗
X
be the
sheaf of invertible elements of OX (i. e. of the regular functions that are nowhere
zero). Note that O
∗
X
is a sheaf of Abelian groups under multiplication as well. In
fact, O
∗
X
is a subsheaf of K ∗
X
.
A Cartier divisor on X is a global section of the sheaf K ∗
X
/O
∗
X
. Obviously, the
Cartier divisors form an Abelian group under multiplication, denoted DivX. In
analogy to Weil divisors the group structure on DivX is usually written additively
however. A Cartier divisor is called linearly equivalent to zero if it is induced
by a global section of K ∗
X
. Two Cartier divisors are linearly equivalent if their
difference (i. e. quotient, see above) is linearly equivalent to zero. The quotient
group PicX := Γ(K ∗
X
/O
∗
X
)/Γ(K ∗
X
) is called the group of Cartier divisor classes.
Remark 9.3.3. Let us analyze the definition of Cartier divisors. There is an obvious exact
sequence of sheaves on X
0 → O
∗
X → K
∗
X → K
∗
X /O
∗
X → 0.
Note that these are not sheaves of OX -modules, so their flavor is slightly different from the
ones we have considered so far. But it is still true that we get an exact sequence of global
sections
0 → Γ(O
∗
X
) → Γ(K
∗
X
) → Γ(K
∗
X /O
∗
X
)
that is in general not exact on the right. More precisely, recall that the quotient sheaf
K ∗
X
/O
∗
X
is not just the sheaf that is K ∗
X
(U)/O
∗
X
(U) for all open subsets U ⊂ X, but rather the
sheaf associated to this presheaf. Therefore Γ(K ∗
X
/O
∗
X
) is in general not just the quotient
Γ(K ∗
X
)/Γ(O
∗
X
).
To unwind the definition of sheafification, an element of DivX = Γ(K ∗
X
/O
∗
X
) can be
given by a (sufficiently fine) open covering {Ui} and elements of K ∗
X
(Ui)/O
∗
X
(Ui) represented by rational functions ϕi for all i such that their quotients ϕi
ϕj
are in O
∗
X
(Ui ∩Uj) for
all i, j. So a Cartier divisor is an object that is locally a (non-zero) rational function modulo a nowhere-zero regular function. Intuitively speaking, the only data left from a rational
function if we mod out locally by nowhere-zero regular functions is the locus of its zeros
and poles together with their multiplicities. So one can think of Cartier divisors as objects
that are (linear combinations of) zero loci of functions.
A Cartier divisor is linearly equivalent to zero if it is globally a rational function, just the
same as for Weil divisors. From cohomology one would expect that one can think of the
quotient group PicX as the cohomology group H
1
(X,O
∗
X
). We cannot say this rigorously
because we have only defined cohomology for quasi-coherent sheaves (which O
∗
X
is not).
178 Andreas Gathmann
But there is a more general theory of cohomology of arbitrary sheaves of Abelian groups
on schemes, and in this theory the statement that PicX = H
1
(X,O
∗
X
) is correct.
Lemma 9.3.4. Let X be a purely n-dimensional scheme. Then there is a natural homomorphism DivX → Zn−1(X) that passes to linear equivalence to give a homomorphism
PicX → An−1(X). In other words, every Cartier divisor (class) determines a Weil divisor
(class).
Proof. Let D ∈ DivX be a Cartier divisor on X, represented by an open covering {Ui} of
X and rational functions ϕi on Ui
. For any (n − 1)-dimensional subvariety V of X define
the order of D at V to be ordV D := ordV∩Ui ϕi
, where i is an index such that Ui ∩V 6=
0/. This does not depend on the choice of i as the quotients ϕi
ϕj
are nowhere-zero regular
functions, so the orders of ϕi and ϕj are the same where they are both defined. So we get
a well-defined map DivX → Zn−1(X) defined by D 7→ ∑V ordV D · [V]. It is obviously a
homomorphism as ordV (ϕi
·ϕ
0
i
) = ordV ϕi +ordV ϕ
0
i
.
It is clear from the definition that a Cartier divisor that is linearly equivalent to zero,
i. e. a global rational function, determines a Weil divisor in Bn−1(X). Hence the homomorphism passes to linear equivalence.
Lemma 9.3.5. Let X be a smooth projective curve. Then Cartier divisors (resp. Cartier
divisor classes) on X are the same as Weil divisors (resp. Weil divisor classes). In particular, our definition 9.3.2 (ii) of DivX and PicX agrees with our earlier one from section
6.3.
Proof. The idea of the proof is lemma 7.5.6 which tells us that every point of X is locally
the scheme-theoretic zero locus of a single function, hence a Cartier divisor.
To be more precise, let ∑
n
i=1
aiPi ∈ Z0(X) be a Weil divisor. We will construct a Cartier
divisor D ∈ DivX that maps to the given Weil divisor under the correspondence of lemma
9.3.4. To do so, pick an open neighborhood Ui of Pi for all i = 1,...,n such that
(i) Pj ∈/ Ui for j 6= i, and
(ii) there is a function ϕPi
on Ui such that divϕPi = 1 ·Pi on Ui (see lemma 7.5.6).
Moreover, set U = X\{P1,...,Pn}. Then we define a Cartier divisor D by the open cover
{U,U1,...,Un} and the rational functions
(i) 1 on U,
(ii) ϕ
ai
Pi
on Ui
.
Note that these data define a Cartier divisor: no intersection of two elements of the open
cover contains one of the points Pi
, and the functions given on the elements of the open
cover are regular and non-vanishing away from the Pi
. By construction, the Weil divisor
associated to D is precisely ∑
n
i=1
aiPi
, as desired.
Example 9.3.6. In general, the map from Cartier divisors (resp. Cartier divisor classes)
to Weil divisors (resp. Cartier divisor classes) is neither injective nor surjective. Here are
examples of this:
(i) not injective: This is essentially example 9.1.7. Let X = X1 ∪ X2 be the union
of two lines Xi
∼= P
1 glued together at a point P ∈ X1 ∩X2. Let Q be a point on
X1\X2. Consider the open cover X = U ∪V with U = X\Q and V = X1\P.
We define a Cartier divisor D on X by choosing the following rational functions
on U and V: the constant function 1 on U, and the linear function on V ∼= A
1
that
has a simple zero at Q. Note that the quotient of these two functions is regular
and nowhere zero on U ∩V, so D is well-defined. Its associated Weil divisor [D]
is [Q].
9. Intersection theory 179
By symmetry, we can construct a similar Cartier divisor D
0 whose associated
Weil divisor is the class of a point Q
0 ∈ X2\X1.
Now note that the Cartier divisor classes of D and D
0
are different (because
D−D
0
is not the divisor of a rational function), but their associated Weil divisors
[Q] and [Q
0
] are the same by example 9.1.7.
(ii) not surjective: This is essentially example 9.3.1. The classes [Li
] of this example
are Weil divisors but not Cartier divisors.
Another example on an irreducible space X is the cone
X = {x
2
3 = x
2
1 +x
2
2} ⊂ P
3
.
x 1
x 2
x 3
L L 1 2
Let L1 = Z(x2, x1 +x3) and L2 = Z(x2, x1 −x3) be the two lines as in the picture.
We claim that there is no Cartier divisor on X corresponding to the Weil divisor
[L1]. In fact, if there was such a Cartier divisor, defined locally around the origin
by a function ϕ, we must have an equality of ideals
(x
2
1 +x
2
2 −x
2
3
,ϕ) = (x2, x1 +x3)
in the local ring OP3,0
. This is impossible since the right ideal contains two linearly independent linear parts, whereas the left ideal contains only one. But note
that the section x2 of the line bundle OX (1) defines a Cartier divisor div(x2) on
X whose associated Weil divisor is [L1] + [L2], and the section x1 + x3 defines a
Cartier divisor whose associated Weil divisor is 2[L1]. So [L1] and [L2] are not
Cartier divisors, whereas [L1] +[L2], 2[L1], and 2[L2] are. In particular, there is in
general no “decomposition of a Cartier divisor into its irreducible components”
as we have it by definition for Weil divisors.
There is quite a deep theorem however that the two notions agree on smooth schemes:
Theorem 9.3.7. Let X be a smooth n-dimensional scheme. Then DivX ∼= Zn−1(X) and
PicX ∼= An−1(X).
Proof. We cannot prove this here and refer to [H] remark II.6.11.1.A for details. One has
to prove the analogue of lemma 7.5.6, i. e. that every codimension-1 subvariety of X is
locally the scheme-theoretic zero locus of a single function. This is a commutative algebra
statement as it can be shown on the local ring of X at the subvariety.
(To be a little more precise, the property of X that we need is that its local rings are
unique factorization domains: if this is the case and V ⊂ X is an subvariety of codimension
1, pick any non-zero (local) function f ∈ OX,V that vanishes on V. As OX,V is a unique
factorization domain we can decompose f into its irreducible factors f = f1 ··· fn. Of
course one of the fi has to vanish on V. But as fi
is irreducible, its ideal must be the ideal
of V, so V is locally the zero locus of a single function. The problem with this is that it
is almost impossible to check that a ring (that one does not know very well) is a unique
factorization domain. So one uses the result from commutative algebra that every regular
local ring (i. e. “the local ring of a scheme at a smooth point”) is a unique factorization
180 Andreas Gathmann
domain. Actually, we can see from the above argument that it is enough that X is “smooth
in codimension 1”, i. e. that its set of singular points has codimension at least 2 — or
to express it algebraically, that its local rings OX,V at codimension-1 subvarieties V are
regular.)
Example 9.3.8. Finally let us discuss the relation between divisors and line bundles as
observed for curves in section 7.5. Note that we have in fact used such a correspondence
already in example 9.3.6 where we defined a Cartier divisor by giving a section of a line
bundle. The precise relation between line bundles and Cartier divisors is as follows.
Lemma 9.3.9. For any scheme X there are one-to-one correspondences
{Cartier divisors on X} ↔ {(L,s) ; L a line bundle on X and s a rational section of L}
and
{Cartier divisor classes on X} ↔ {line bundles on X that admit a rational section}.
Proof. The proof of this is essentially the same as the correspondence between divisor
classes and line bundles on a smooth projective curve in proposition 7.5.9. Given a Cartier
divisor D = {(Ui
,ϕi)} on X, we get an associated line bundle O(D) by taking the subsheaf
of OX -modules of KX generated by the functions 1
ϕi
on Ui
. Conversely, given a line bundle
with a rational section, this section immediately defines a Cartier divisor. The proof that
the same correspondence holds for divisor classes is the same as in proposition 7.5.9.
Remark 9.3.10. We should note that almost any line bundle on any scheme X admits a
rational section. In fact, this is certainly true for irreducible X (as the line bundle is then
isomorphic to the structure sheaf on a dense open subset of X by definition), and one can
show that it is true in most other cases as well (see [H] remark 6.14.1 for more information).
Most books actually define the group PicX to be the group of line bundles on X.
Summarizing our above discussions we get the following commutative diagram:
line bundles together with a
rational section
t
Cartier divisors DivX /

Cartier divisor classes PicX

OO
Weil divisors Zn−1(X) /Weil divisor classes An−1(X)
where
(i) the bottom row (the Weil divisors) exists only if X is purely n-dimensional,
(ii) the upper right vertical arrow is an isomorphism in most cases, at least if X is
irreducible,
(iii) the lower vertical arrows are isomorphisms at least if X is smooth (in codimension
1).
Remark 9.3.11. Although line bundles, Cartier divisor classes, and Weil divisor classes are
very much related and even all the same thing on many schemes (e. g. smooth varieties),
note that their “functorial properties” are quite different: if f : X → Y is a morphism then
for line bundles and Cartier divisors the pull-back f
∗
is the natural operation, whereas for
Weil divisors (i. e. elements of the Chow groups) the push-forward f∗ as in section 9.2
is more natural. In algebraic topology this can be expressed by saying that Weil divisors
correspond to homology cycles, whereas Cartier divisors correspond to cohomology cycles.
On nice spaces this is the same by Poincare duality, but this is a non-trivial statement. The ´
9. Intersection theory 181
natural operation for homology (resp. cohomology) is the push-forward (resp. pull-back).
Intersection products are defined between a cohomology and a homology class, yielding a
homology class. This corresponds to our initial statement of this section that intersection
products of Chow cycles (“homology classes”) with divisors will usually only be welldefined with Cartier divisors (“cohomology classes”) and not with Weil divisors.
9.4. Intersections with Cartier divisors. We are now ready to define intersection products of Chow cycles with Cartier divisors, as motivated in the beginning of section 9.3. Let
us give the definition first, and then discuss some of its features.
Definition 9.4.1. Let X be a scheme, let V ⊂ X be a k-dimensional subvariety with inclusion morphism i : V → X, and let D be a Cartier divisor on X. We define the intersection
product D·V ∈ Ak−1(X) to be
D·V = i∗[i
∗OX (D)],
where OX (D) is the line bundle on X associated to the Cartier divisor D by lemma 9.3.9,
i
∗ denotes the pull-back of line bundles, [i
∗OX (D)] is the Weil divisor class associated to
the line bundle i
∗OX (D) by remark 9.3.10 (note that V is irreducible), and i∗ denotes the
proper push-forward of corollary 9.2.12.
Note that by definition the intersection product depends only on the divisor class of D,
not on D itself. So using our definition we can construct bilinear intersection products
PicX ×Zk(X) → Ak−1(X),

D,∑ai
[Vi
]

7→ ∑ai(D·Vi).
If X is smooth and pure-dimensional (so that Weil and Cartier divisors agree) and W is
a codimension-1 subvariety of X, we denote by W ·V ∈ Ak−1(X) the intersection product
D·V, where D is the Cartier divisor corresponding to the Weil divisor [W].
Example 9.4.2. Let X be a smooth n-dimensional scheme, and let V and W be subvarieties
of dimensions k and n − 1, respectively. If V 6⊂ W, i. e. if dim(W ∩V) = k − 1, then the
intersection product W ·V is just the cycle [W ∩V] with possibly some scheme-theoretic
multiplicities. In fact, in this case the Weil divisor [W] corresponds by remark 9.3.10
to a line bundle OX (W) together with a section f whose zero locus is precisely W. By
definition of the intersection product we have to pull back this line bundle to V, i. e. restrict
the section f to V. The cycle W ·V is then the zero locus of f |V , with possibly schemetheoretic multiplicities if f vanishes along V with higher order.
As a concrete example, let C1 and C2 be two curves in P
2 of degrees d1 and d2, respectively, that intersect in finitely many points P1,...,Pn. Then the intersection product
C1 ·C2 ∈ A0(P
2
) is just ∑i ai
[Pi
], where ai
is the scheme-theoretic multiplicity of the point
Pi
in the intersection scheme C1 ∩C2. Using that all points in P
2
are rationally equivalent,
i. e. that A0(P
2
) ∼= Z is generated by the class of any point, we see that C1 ·C2 is just the
Bezout number ´ d1 · d2.
Example 9.4.3. Again let X be a smooth n-dimensional scheme, and let V and W be
subvarieties of dimensions k and n−1, respectively. This time let us assume that V ⊂ W,
so that the intersection W ∩V = V has dimension k and thus does not define a (k − 1)-
dimensional cycle. There are two ways to interpret the intersection product W ·V in this
case:
(i) Recall that the intersection product W ·V depends only on the divisor class of
W, not on W itself. So if we can replace W by a linearly equivalent divisor W0
such that V 6⊂ W0
then the intersection product W ·V is just W0
·V which can
now be constructed as in example 9.4.2. For example, let H ⊂ P
2 be a line and
assume that we want to compute the intersection product H · H ∈ A0(P
2
) ∼= Z.
The intersection H ∩H has dimension 1, but we can move the first H to a different
line H
0 which is linearly equivalent to H. So we see that H · H = H
0
· H = 1, a
182 Andreas Gathmann
H
0 ∩H is just one point. Note however that it may not always be possible to find
such a linearly equivalent divisor that makes the intersection have the expected
dimension.
(ii) If the strategy of (i) does not work or one does not want to apply it, there is also
a different description of the intersection product for which no moving of W is
necessary. Let us assume for simplicity that W is smooth. By the analogue of
remark 7.4.17 for general hypersurfaces the bundle i
∗OX (W) (where i : V → X
is the inclusion morphism) is precisely the restriction to V of the normal bundle
NW/X of W in X. By definition 9.4.1 the intersection product W ·V is then the
Weil divisor associated to this bundle, i. e. the locus of zeros minus poles of a
rational section of the normal bundle NW/X restricted to V.
X
P1
P2
V=W
W V.
[ P1
] +[ P2
= ]
Note that we can consider this procedure as an infinitesimal version of (i): the
section of the normal bundle describes an “infinitesimal deformation” of W in X,
and the deformed W meets V precisely in the locus where the section vanishes.
Proposition 9.4.4. (Commutativity of the intersection product) Let X be an n-dimensional
variety, and let D1,D2 be Cartier divisors on X with associated Weil divisors [D1],[D2].
Then D1 · [D2] = D2 · [D1] ∈ An−2(X).
Proof. We will only sketch the proof in two easy cases (that cover most applications however). For the general proof we refer to [F] theorem 2.4.
Case 1: D1 and D2 intersect in the expected dimension, i. e. the locus where the defining
equations of both D1 and D2 have a zero or pole has codimension 2 in X. Then one
can show that both D1 · [D2] and D2 · [D1] is simply the sum of the components of the
geometric intersection D1∩D2, counted with their scheme-theoretic multiplicities. In other
words, if V ⊂ X is a codimension-2 subvariety and if we assume for simplicity that the
local defining equations f1, f2 for D1,D2 around V are regular, then [V] occurs in both
intersection products with the coefficient lA(A/(f1, f2)), where A = OX,V is the local ring
of X at V.
Case 2: X is a smooth scheme, so that Weil and Cartier divisors agree on X. Then it suffices to compare the intersection products W ·V and V ·W for any two (n−1)-dimensional
subvarieties V,W of X. But the two products are obviously equal if V = W, and they are
equal by case 1 if V 6= W.
Corollary 9.4.5. The intersection product passes to rational equivalence, i. e. there are
well-defined bilinear intersection maps PicX ×Ak(X) → Ak−1(X) determined by D·[V] =
[D·V] for all D ∈ PicX and all k-dimensional subvarieties V of X.
Proof. All that remains to be shown is that D·α = 0 for any Cartier divisor D if the cycle
α is zero in the Chow group Ak(X). But this follows from proposition 9.4.4, as for any
rational function ϕ on a (k +1)-dimensional subvariety W of X we have
D· [div(ϕ)] = div(ϕ)· [D] = 0
(note that div(ϕ) is a Cartier divisor on W that is linearly equivalent to zero). 
9. Intersection theory 183
Remark 9.4.6. Obviously we can now iterate the process of taking intersection products
with Cartier divisors: if X is a scheme and D1,...,Dm are Cartier divisors (or divisor
classes) on X then there are well-defined commutative intersection products
D1 ·D2 ···Dm ·α ∈ Ak−m(X)
for any k-cycle α ∈ Ak(X). If X is an n-dimensional variety and α = [X] is the class of
X we usually omit [X] from the notation and write the intersection product simply as D1 ·
D2 ···Dm ∈ An−m(X). If m = n and X is complete, the notation D1 · D2 ···Dm is moreover
often used to denote the degree of the 0-cycle D1 ·D2 ···Dm ∈ A0(X) (see example 9.2.13)
instead of the cycle itself. If a divisor D occurs m times in the intersection product we will
also write this as D
m.
Example 9.4.7. Let X = P
2
. Then PicX = A1(X) = Z·[H], and the intersection product is
determined by H
2 = 1 (“two lines intersect in one point”). In the same way, H
n = 1 on P
n
.
Example 9.4.8. Let X = P˜ 2 be the blow-up of P
2
in a point P. By example 9.2.14 we
have PicX = Z[H] ⊕ Z[E], where E is the exceptional divisor, and H is a line in P
2 not
intersecting E. The strict transform L of a line in P
2
through P has class [L] = [H]−[E] ∈
PicX.
The intersection products on X are therefore determined by computing the three products H
2
, H · E, and E
2
. Of course, H
2 = 1 and H · E = 0 (as H ∩ E = 0/). To compute
E
2 we use the relation [E] = [H] − [L] and the fact that E and L meet in one point (with
multiplicity 1):
E
2 = E ·(H −L) = E ·H −E ·L = 0−1 = −1.
By our interpretation of example 9.4.3 (ii) this means that the normal bundle of E ∼= P
1
in
X is OP1 (−1). In particular, this normal bundle has no global sections. This means that E
cannot be deformed in X as in the picture of example 9.4.3 (ii): one says that the curve E
is rigid in X.
We can consider the formulas H
2 = 1, H ·E = 0, E
2 = −1, together with the existence
of the intersection product PicX × PicX → Z as a Bezout style theorem for the blow-up ´
X = P˜ 2
. In the same way, we get Bezout style theorems for other (smooth) surfaces and ´
even higher-dimensional varieties.
Example 9.4.9. As a more complicated example, let us reconsider the question of exercise
4.6.6: how many lines are there in P
3
that intersect four general given lines L1,...,L4 ⊂ P
3
?
Recall from exercise 3.5.4 that the space of lines in P
3
is the smooth four-dimensional
Grassmannian variety X = G(1,3) that can be described as the set of all rank-2 matrices

a0 a1 a2 a3
b0 b1 b2 b3

modulo row transformations. By the Gaussian algorithm it follows that G(1,3) has a stratification by affine spaces X4,X3,X2,X
0
2
,X1,X0 (where the subscript denotes the dimension
and the stars denote arbitrary complex numbers)

1 0 ∗ ∗
0 1 ∗ ∗   1 ∗ 0 ∗
0 0 1 ∗
  1 ∗ ∗ 0
0 0 0 1 
X4 X3 X2

0 1 0 ∗
0 0 1 ∗
  0 1 ∗ 0
0 0 0 1   0 0 1 0
0 0 0 1 
X
0
2 X1 X0
184 Andreas Gathmann
If we denote by σ4,...,σ0 the classes in A∗(X) of the closures of X4,...,X0, we have seen
in remark 9.1.18 that A∗(X) is generated by the classes σ4,...,σ0. These classes actually
all have a geometric interpretation:
(i) σ4 = [X].
(ii) σ3 is the class of all lines that intersect the line {x0 = x1 = 0} ⊂ P
3
. Note that
this is precisely the zero locus of a0b1 −a1b0. In particular, if L ⊂ P
3
is any other
line then the class σ
L
3
of all lines in P
3 meeting L is also a quadratic function q
in the entries of the matrix that is invariant under row transformations (in fact a
2×2 minor in a suitable choice of coordinates of P
3
). The quotient a0b1−a1b0
q
is
then a rational function on X whose divisor is σ3 − σ
L
3
. It follows that the class
σ
L
3
does not depend on L. So we can view σ3 as the class that describes all lines
intersecting any given line in P
3
.
(iii) σ2 is the class of all lines passing through the point (0 : 0 : 0 : 1). By an argument
similar to that in (ii) above, we can view σ2 as the class of all lines passing through
any given point in P
3
.
(iv) σ
0
2
is the class of all lines that are contained in a plane (namely in the plane x0 = 0
for the cycle X
0
2
given above).
(v) σ1 is the class of all lines that are contained in a plane and pass through a given
point in this plane.
(vi) σ0 is the class of all lines passing through two given points in P
3
.
Hence we see that the intersection number we are looking for is just σ
4
3 ∈ A0(X) ∼= Z —
the number of lines intersecting any four given lines in P
3
. So let us compute this number.
Step 1. Let us compute σ
2
3 ∈ A2(X), i. e. class of all lines intersecting two given lines
L1,L2 in P
3
. We have seen above that it does not matter which lines we take, so let us
choose L1 and L2 such that they intersect in a point P ∈ P
3
. A line that intersects both L1
and L2 has then two possibilities:
(i) it is any line in the plane spanned by L1 and L2,
(ii) it is any line in P
3 passing through P.
As (i) corresponds to σ
0
2
and (ii) to σ2 we see that σ
2
3 = σ2 + σ
0
2
. To be more precise,
we still have to show that σ
2
3
contains both X2 and X
0
2 with multiplicity 1 (and not with a
higher multiplicity). As an example, we will show that σ
2
3
contains σ2 with multiplicity
1; the proof for σ
0
2
is similar. Consider the open subset X4 ⊂ G(1,3); it is isomorphic to
an affine space A
4 with coordinates a2,a3,b2,b3. On this open subset, the space of lines
intersecting the line {x0 = x2 = 0} is given scheme-theoretically by the equation b2 = 0,
whereas the space of lines intersecting the line {x0 = x3 = 0} is given scheme-theoretically
by the equation b3 = 0. The scheme-theoretic intersection of these two spaces (i. e. the
product σ
2
3
) is then given by b2 = b3 = 0, which is precisely the locus of lines through the
point (0 : 1 : 0 : 0) (with multiplicity 1), i. e. the cycle σ2.
Step 2. In the same way we compute that
(i) σ3 ·σ2 = σ1 (lines meeting a line L and a point P are precisely lines in the plane
spanned by L and P passing through P),
(ii) σ3 ·σ
0
2 = σ1 (lines meeting a line L and contained in a plane H are precisely lines
in the plane H passing through the point H ∩L),
(iii) σ3 ·σ1 = σ0.
So we conclude that
σ
4
3 = σ
2
3
(σ2 +σ
0
2
) = 2σ3σ1 = 2,
i. e. there are exactly two lines in P
3 meeting four other general given lines.
9. Intersection theory 185
We should note that similar decompositions into affine spaces exist for all Grassmannian
varieties, as well as rules how to intersect the corresponding Chow cycles. These rules are
usually called Schubert calculus. They can be used to answer almost any question of the
form: how many lines in P
n
satisfy some given conditions?
Finally, let us prove a statement about intersection products that we will need in the next
section. It is based on the following set-theoretic idea: let f : X → Y be any map of sets,
and let V ⊂ X and W ⊂ Y be arbitrary subsets. Then it is checked immediately that
f(f
−1
(W)∩V) = W ∩ f(V).
This relation is called a projection formula. There are projection formulas for many other
morphisms and objects that can be pushed forward and pulled back along a morphism. We
will prove an intersection-theoretic version here.
Lemma 9.4.10. Let f : X →Y be a proper surjective morphism of schemes. Let α ∈ Ak(X)
be a k-cycle on X, and let D ∈ PicY be a Cartier divisor (class) on Y . Then
f∗(f
∗D·α) = D· f∗α ∈ Ak−1(Y).
Proof. (Note that this is precisely the set-theoretic intersection formula from above, together with the statement that the scheme-theoretic multiplicities match up in the right
way.)
By linearity we may assume that α = [V] for a k-dimensional subvariety V ⊂ X. Let
W = f(V), and denote by g : V → W the restriction of f to V. Then the left hand side of
the equation of the lemma is g∗[g
∗D
0
], where D
0
is the Cartier divisor on W associated to
the line bundle OY (D)|W . The right hand side is [K(V) : K(W)]·[D
0
] by construction 9.2.9,
with the convention that [K(V) : K(W)] = 0 if dimW < dimV. We will prove that these
expressions actually agree in Zk−1(W) for any given Cartier divisor D
0
. This is a local
statement (as we just have to check that every codimension-1 subvariety of W occurs on
both sides with the same coefficient), so passing to an open subset we can assume that D
0
is the divisor of a rational function ϕ on W. But then by theorem 9.2.11 the left hand side
is equal to
g∗ div(g
∗ϕ) = divN(g
∗ϕ) = div(ϕ
[K(V):K(W)]) = [K(V) : K(W)] · div(ϕ),
which equals the right hand side.
9.5. Exercises.
Exercise 9.5.1. Let X ⊂ P
n be a hypersurface of degree d. Compute the Chow group
An−1(P
n\X).
Exercise 9.5.2. Compute the Chow groups of X = P
n ×P
m for all n,m ≥ 1. Assuming that
there are “intersection pairing homomorphisms”
An+m−k(X)×An+m−l(X) → An+m−k−l(X), (α,α
0
) 7→ α·α
0
such that [V ∩W] = [V]·[W] for all subvarieties V,W ⊂ X that intersect in the expected dimension, compute these homomorphisms explicitly. Use this to state a version of Bezout’s ´
theorem for products of projective spaces.
Exercise 9.5.3. (This is a generalization of example 9.1.7.) If X1 and X2 are closed subschemes of a scheme X show that there are exact sequences
Ak(X1 ∩X2) → Ak(X1)⊕Ak(X2) → Ak(X1 ∪X2) → 0
for all k ≥ 0.
186 Andreas Gathmann
Exercise 9.5.4. Show that for any schemes X and Y there are well-defined product homomorphisms
Ak(X)×Al(Y) → Ak+l(X ×Y), [V]×[W] 7→ [V ×W].
If X has a stratification by affine spaces as in remark 9.1.18 show that the induced homomorphisms
M
k+l=m
Ak(X)×Al(Y) → Am(X ×Y)
are surjective. (In general, they are neither injective nor surjective).
Exercise 9.5.5. Prove the following criteria to determine whether a morphism f : X → Y
is proper:
(i) The composition of two proper morphisms is proper.
(ii) Properness is “stable under base change”: if f : X →Y is proper and g : Z →Y is
any morphism, then the induced morphism f
0
: X ×Y Z → Z is proper as well.
(iii) Properness is “local on the base”: if {Ui} is any open cover of Y and the restrictions f |
f −1(Ui)
: f
−1
(Ui) → Ui are proper for all i then f is proper.
(iv) Closed immersions (see 7.2.10) are proper.
Exercise 9.5.6. Let f : P
1 → P
1 be the morphism given in homogeneous coordinates by
(x0 : x1) 7→ (x
2
0
: x
2
1
). Let P ∈ P
1 be the point (1 : 1), and consider the restriction ˜f :
P
1\{P} → P
1
. Show that ˜f is not proper, both with the topological and the algebraic
definition of properness.
Exercise 9.5.7. For any n > 0 compute the Chow groups of P
2 blown up in n points.
Exercise 9.5.8. Let k be an algebraically closed field. In this exercise we will construct an
example of a variety that is complete (i. e. compact if k = C) but not projective.
Consider X = P
3
and the curves C1 = {x3 = x2 −x1 = 0} and C2 = {x3 = x0x2 −x
2
1 = 0}
in X. Denote by P1 = (1 : 0 : 0 : 0) and P2 = (1 : 1 : 1 : 0) their two intersection points.
Let X˜0
1 → X be the blow-up at C1, and let X˜
1 → X˜0
1
be the blow-up at the strict transform of C2. Denote by π1 : X˜
1 → X the projection map. Similarly, let π2 : X˜
2 → X be
the composition of the two blow-ups in the opposite order; first blow up C2 and then the
strict transform of C1. Obviously, X˜
1 and X˜
2 are isomorphic away from the inverse image of {P1,P2}, so we can glue π
−1
1
(X\{P1}) and π
−1
2
(X\{P2}) along the isomorphism
π
−1
1
(X\{P1,P2}) ∼= π
−1
2
(X\{P1,P2}) to get a variety Y. This variety will be our example.
From the construction there is an obvious projection map π : Y → X.
(i) Show that Y is proper over k.
(ii) For i = 1,2 we know that Ci
is isomorphic to P
1
. Hence we can choose a rational
function ϕi onCi with divisor P1−P2. Compute the divisor of the rational function
ϕi ◦ π on the variety π
−1
(Ci), as an element in Z1(Y).
(iii) From (ii) you should have found two irreducible curves D1,D2 ⊂ Y such that
[D1] +[D2] = 0 ∈ A1(Y). Deduce that Y is not a projective variety.
Exercise 9.5.9. Let X be a smooth projective surface, and let C,D ⊂ X be two curves in X
that intersect in finitely many points.
(i) Prove that there is an exact sequence of sheaves on X
0 → OX (−C −D) → OX (−C)⊕OX (−D) → OX → OC∩D → 0.
(ii) Conclude that the intersection product C·D ∈ Z is given by the formula
C·D = χ(X,OX ) +χ(X,OX (−C −D))−χ(X,OX (−C))−χ(X,OX (D))
where χ(X,F ) = ∑i
(−1)
ih
i
(X,F ) denotes the Euler characteristic of the sheaf
F .
9. Intersection theory 187
(iii) Show how the idea of (ii) can be used to define an intersection product of divisors
on a smooth complete surface (even if the divisors do not intersect in dimension
zero).
188 Andreas Gathmann
10. CHERN CLASSES
For any vector bundle π : F → X of rank r on a scheme X we define an associated
projective bundle p : P(F) → X whose fibers p
−1
(P) are just the projectivizations of
the affine fibers π
−1
(P). We construct natural line bundles OP(F)
(d) on P(F) for all
d ∈ Z that correspond to the standard line bundles O(d) on projective spaces. As in
the case of vector bundles there are pull-back homomorphisms A∗(X) → A∗(P(F))
between the Chow groups.
For a bundle as above we define the i-th Segre class si(F) : A∗(X) → A∗−i(X) by
si(F)·α = p∗(D
r−1+i
F
· p
∗α), where DF denotes the Cartier divisor associated to the
line bundle OP(F)
(1). The Chern classes ci(F) are defined to be the inverse of the
Segre classes. Segre and Chern classes are commutative; they satisfy the projection
formula for proper push-forwards and are compatible with pull-backs. They are multiplicative on exact sequences. Moreover, ci(F) = 0 for i > r. The top Chern class
cr(F) has the additional geometric interpretation as the zero locus of a section of F.
Using the technique of Chern roots one can compute the Chern classes of almost any
bundle that is constructed from known bundles in some way (e. g. by means of direct
sums, tensor products, dualizing, exact sequences, symmetric and exterior products).
The Chern character ch(F) and Todd class td(F) are defined to be certain polynomial combinations of the Chern classes of F. The Hirzebruch-Riemann-Roch theorem states that ∑i h
i
(X,F) = deg(ch(F)·td(TX )) for any vector bundle F on a smooth
projective scheme X. We study some examples and applications of this theorem and
give a sketch of proof.
10.1. Projective bundles. Recall that for any line bundle L on a variety X there is a
Cartier divisor on X corresponding to L that in turn defines intersection homomorphisms
Ak(X) → Ak−1(X). These homomorphisms can be thought of as intersecting a k-cycle on
X with the divisor of any rational section of L. We now want to generalize this idea from
line bundles to vector bundles. To do so, we need some preliminaries on projective bundles
first.
Roughly speaking, the projective bundle P(E) associated to a vector bundle E of rank
r on a scheme X is simply obtained by replacing the fibers (that are all isomorphic to
A
r
) by the corresponding projective spaces P
r−1 = (A
r\{0})/k
∗
. Let us give the precise
definition.
Definition 10.1.1. Let π : F → X be a vector bundle of rank r on a scheme X (see remark
7.3.2). In other words, there is an open covering {Ui} of X such that
(i) there are isomorphisms ψi
: π
−1
(Ui) → Ui ×A
r over Ui
,
(ii) on the overlaps Ui ∩Uj
the compositions
ψi ◦ψ
−1
j
: (Ui ∩Uj)×A
r → (Ui ∩Uj)×A
r
are linear in the coordinates of A
r
, i. e. they are of the form
(P, x) 7→ (P,Ψi, jx)
where P ∈ U, x = (x1,..., xr) ∈ A
r
, and the Ψi, j are r ×r matrices with entries in
OX (Ui ∩Uj).
Then the projective bundle P(F) is defined by glueing the patches Ui × P
r−1
along the
same transition functions, i. e. by glueing Ui ×P
r−1
to Uj ×P
r−1
along the isomorphisms
(Ui ∩Uj)×P
r−1 → (Ui ∩Uj)×P
r−1
, (P, x) 7→ (P,Ψi, jx)
for all i, j, where P ∈ Ui ∩Uj and x = (x1 : ··· : xr) ∈ P
r−1
. We say that P(F) is a projective
bundle of rank r −1 on X.
10. Chern classes 189
Note that in the same way as for vector bundles there is a natural projection morphism
p : P(F) → X that sends a point (P, x) to P. In contrast to the vector bundle case however
the morphism p is proper (which follows easily from exercise 9.5.5).
Example 10.1.2. Let X = P
1
, and let F be the vector bundle (i. e. locally free sheaf)
OX ⊕OX (−1) on X. Then P(F) is a projective bundle of rank 1 on X, so it is a scheme of
dimension 2. We claim that P(F) is isomorphic to the blow-up P˜ 2 of the projective plane
in a point P. In fact, this can be checked directly: by definition 10.1.1 P(F) is obtained by
glueing two copies U1,U2 of A
1 ×P
1
along the isomorphism
(A
1
\{0})×P
1 → (A
1
\{0})×P
1
, (z,(x1 : x2)) 7→ (
1
z
,(x1 : zx2)).
On the other hand, P˜ 2
is given by
P˜ 2 = {((x0 : x1 : x2),(y1 : y2)) ; x1y2 = x2y1} ⊂ P
2 ×P
1
(see example 4.3.4). Now an isomorphism is given by
U1
∼= A
1 ×P
1 → P˜ 2
, (z,(x1 : x2)) 7→ ((x1 : zx2 : x2),(z : 1)),
U2
∼= A
1 ×P
1 → P˜ 2
, (z,(x1 : x2)) 7→ ((x1 : x2 : zx2),(1 : z))
(note that this is compatible with the glueing isomorphism above).
To see geometrically that P˜ 2
is a projective bundle of rank 1 over P
1
let p : P˜ 2 →
E ∼= P
1 be the projection morphism onto the exceptional divisor as of example 9.2.14
(ii). The fibers of this morphism are the strict transforms of lines through P, so they are all
isomorphic to P
1
.
Remark 10.1.3. If F is a vector bundle and L a line bundle on X then P(F) ∼= P(F ⊗L). In
fact, tensoring F with L just multiplies the transition matrices Ψi, j of definition 10.1.1 with
a scalar function, which does not affect the morphism as the xi are projective coordinates.
Example 10.1.4. Let p : P(F) → X be a projective bundle over a scheme X, given by an
open cover {Ui} of X and transition matrices Ψi, j as in definition 10.1.1. In this example
we want to construct line bundles OP(F)
(d) for all d ∈ Z on P(F) that are relative versions
of the ordinary bundles OPr−1 (d) on projective spaces.
The construction is simple: on the patches Ui ×P
r−1 of P(F) we take the line bundles
OPr−1 (d). On the overlapsUi∩Uj
these line bundles are glued by ϕ 7→ ϕ◦Ψi, j
, where ϕ =
f
g
is (locally) a quotient of homogeneous polynomials f,g ∈ k[x1,..., xr
] with deg f −degg =
d. Note that the ϕ◦Ψi, j satisfies the same degree conditions as the Ψi, j are linear functions.
Summarizing, we can say that sections of the line bundle OP(F)
(d) are locally given by
quotients of two polynomials which are homogeneous in the fiber coordinates and whose
degree difference is d.
Construction 10.1.5. Again let p : P(F) → X be a projective bundle over a scheme X,
given by an open cover {Ui} of X and transition matrices Ψi, j
. Consider the vector bundle
p
∗F on P(F). It is given by glueing the patches Ui ×P
r−1 ×A
r
along the isomorphisms
(Ui ∩Uj)×P
r−1 ×A
r → (Ui ∩Uj)×P
r−1 ×A
r
, (P, x, y) 7→ (P,Ψi, jx,Ψi, jy),
where x = (x1 : ··· : xr) are projective coordinates on P
r−1
, and y = (y1,..., yr) are affine
coordinates on A
r
. Now consider the subbundle S of p
∗F given locally by the equations
xiyj = xjyi for all i, j = 1,...,r, i. e. the subbundle of p
∗F consisting of those (y1,..., yr)
that are scalar multiples of (x1 : ··· : xr). Obviously, S is a line bundle on P(F) contained
in p
∗F. Geometrically, the fiber of S over a point (P, x) ∈ P(F) is precisely the line in
the fiber FP whose projectivization is the point x. The line bundle S ⊂ p
∗F is called the
tautological subbundle on P(F).
190 Andreas Gathmann
We can actually identify the subbundle S in the language of example 10.1.4: we claim
that S is isomorphic to OP(F)
(−1). In fact, an isomorphism is given by
OP(F)
(−1) → S, ϕ 7→ (yi = ϕ· xi),
where ϕ is (locally) the quotient of two polynomials homogeneous in the xi of degree difference −1. It is obvious that the ϕ·xi are then quotients of two polynomials homogeneous
in the xi of the same degree, so that the yi are well-defined.
Example 10.1.6. One place where projective bundles occur naturally is in blow-ups. Recall from construction 4.3.2 that the blow-up X˜ of an affine variety X ⊂ A
n
at a subvariety
Y ⊂ X with ideal I(Y) = (f1,..., fr) is defined to be the closure of the graph
Γ = {(P,(f1(P) : ··· : fr(P))) ; P ∈ X\Y} ⊂ X ×P
r−1
.
The exceptional hypersurface of the blow-up must be contained in Y × P
r−1
, which has
dimension dimY +r−1. So if Y has dimension dimX −r (which is the expected dimension
as its ideal has r generators) then the exceptional hypersurface must be all of Y ×P
r−1
for
dimensional reasons.
Let us now sketch how this construction can be generalized to blow-ups of arbitrary
(not necessarily affine) varieties X in a subvariety Y. For simplicity let us assume that
there are r line bundles L1,...,Lr on X together with global sections si ∈ H
0
(X,Li) such
that Y is scheme-theoretically the zero locus s1 = ··· = sr = 0. Then the straightforward
generalization of the above construction is to define the blow-up of X in Y to be the closure
of the graph
Γ = {(P,(s1(P) : ··· : sr(P)) ; P ∈ X\Y} ⊂ P(L1 ⊕··· ⊕Lr).
As above, if Y has codimension r in X then the exceptional hypersurface of the blow-up is
the projective bundle P((L1 ⊕··· ⊕Lr)|Y ) over Y.
Now recall from remark 7.4.17 and example 9.4.3 (ii) that the normal bundle of a smooth
codimension-1 hypersurface Y in a smooth variety X that is given as the zero locus of a
section of a line bundle L is just the restriction of this line bundle L to Y. If we iterate this
result r times we see that the normal bundle of a smooth codimension-r hypersurface Y in
a smooth variety X that is given as the zero locus of sections of r line bundles L1,...,Lr
is just (L1 ⊕ ··· ⊕Lr)|Y . Combining this with what we have said above we conclude that
the exceptional hypersurface of the blow-up of a smooth variety X in a smooth variety Y
is just the projectivized normal bundle P(NY/X ) over Y. This is a relative version of our
earlier statement that the exceptional hypersurface of the blow-up of a variety in a smooth
point is isomorphic to the projectivized tangent space at this point.
In the above argument we have used for simplicity that the codimension-r subvariety Y
is globally the zero locus of r sections of line bundles. Actually we do not need this. We
only need that Y is locally around every point the zero locus of r regular functions, as we
can then make the above construction locally and finally glue the local patches together.
Using techniques similar to those in theorem 9.3.7 one can show that every smooth subvariety Y of codimension r in a smooth variety X is locally around every point the zero locus
of r regular functions. So it is actually true in general that the exceptional hypersurface of
the blow-up of X in Y is P(NY/X ) if X and Y are smooth.
Finally, in analogy to the case of vector bundles in proposition 9.1.14 let us discuss
pull-back homomorphisms for Chow groups induced by projective bundles.
Lemma 10.1.7. Let F be a vector bundle on a scheme X of rank r+1, and let p : P(F) → X
be the associated projective bundle of rank r. Then there are pull-back homomorphisms
p
∗
: Ak(X) → Ak+r(P(F)), [V] 7→ [p
−1
(V)]
for all k, satisfying the following compatibilities with our earlier constructions:
10. Chern classes 191
(i) (Compatibility with proper push-forward) Let f : X → Y be a proper morphism,
and let F be a vector bundle of rank r +1 on Y . Form the fiber diagram
P(f
∗F)
f
0
/
p
0

P(F)
p

X
f
/Y.
Then p∗
f∗ = f
0
∗ p
0∗ as homomorphisms Ak(X) → Ak+r(P(F)).
(ii) (Compatibility with intersection products) Let F be a vector bundle of rank r +1
on X, and let D ∈ PicX be a Cartier divisor (class). Then
p
∗
(D·α) = (p
∗D)·(p
∗α)
in Ak+r−1(P(F)) for every k-cycle α ∈ Ak(X).
Proof. (i): Let V ⊂ X be a k-dimensional subvariety. Then p
−1
(f(V)) = f
0
(p
0−1
(V)) =:
W, and both p
∗
f∗[V] and f
0
∗ p
0∗[V] are equal to d · [W], where d is the generic number of
inverse image points of f (resp. f
0
) on f(V) (resp. p
−1
(f(V)).
(ii): Let α = [V] for a k-dimensional subvariety V ⊂ X. On V the Cartier divisor D is
given by a line bundle L. If ϕ is any rational section of L then the statement follows from
the obvious identity p
∗ div(ϕ) = div(p
∗ϕ).
Remark 10.1.8. We have now constructed pull-back morphisms for Chow groups in three
cases:
(i) inclusions of open subsets (example 9.1.11),
(ii) projections from vector bundles (proposition 9.1.14),
(iii) projections from projective bundles (lemma 10.1.7).
These are in fact special cases of a general class of morphisms, called flat morphisms, for
which pull-back maps exist. See [F] section 1.7 for more details.
10.2. Segre and Chern classes of vector bundles. Let X be a scheme, and let F be a
vector bundle of rank r on X. Let p : P(F) → X be the projection from the corresponding
projective bundle. Note that we have the following constructions associated to p:
(i) push-forward homomorphisms p∗ : Ak(P(F)) → Ak(X) since p is proper (see
corollary 9.2.12),
(ii) pull-back homomorphisms p
∗
: Ak(X) → Ak+r−1(P(F)) by lemma 10.1.7,
(iii) a line bundle OP(F)
(1) on P(F) by example 10.1.4 (the dual of the tautological
subbundle).
We can now combine these three operations to get homomorphisms of the Chow groups of
X that depend on the vector bundle F:
Definition 10.2.1. Let X be a scheme, and let F be a vector bundle of rank r on X. Let
p : P(F) → X be the projection map from the associated projective bundle. Assume for simplicity that X (and hence P(F)) is irreducible (see below), so that the line bundle OP(F)
(1)
corresponds to a Cartier divisor DF on P(F). Now for all i ≥ −r+1 we define Segre class
homomorphisms by the formula
si(F) : Ak(X) → Ak−i(X), α 7→ si(F)·α := p∗(D
r−1+i
F
· p
∗α).
Remark 10.2.2. We will discuss some geometric interpretations of Segre classes (or rather
some combinations of them) later in proposition 10.2.3 (i) and (ii), proposition 10.3.12, and
remark 10.3.14. For the moment let us just note that every vector bundle F gives rise to
these homomorphisms si(F) that look like intersections (hence the notation si(F)·α) with
192 Andreas Gathmann
some object of codimension i as they decrease the dimension of cycles by i. (In algebraic
topology the Segre class si(F) is an object in the cohomology group H
2i
(X,Z).)
Note also that the condition that X be irreducible is not really necessary: even if OP(F)
(1)
does not determine a Cartier divisor on P(F) it does so on every subvariety of P(F), and
this is all we need for the construction of the intersection product (as we intersect with a
cycle in P(F) which is by definition a formal linear combination of subvarieties).
Proposition 10.2.3. Let X and Y be schemes.
(i) For any vector bundle F on X we have
• si(F) = 0 for i < 0,
• s0(F) = id.
(ii) For any line bundle L on X we have si(L)· α = (−1)
iD
i
· α for i ≥ 0 and all
α ∈ A∗(X), where D is the Cartier divisor class associated to the line bundle L.
(iii) (Commutativity) If F1 and F2 are vector bundles on X, then
si(F1)·sj(F2) = sj(F2)·si(F1)
as homomorphisms Ak(X) → Ak−i−j(X) for all i, j (where the dot denotes the
composition of the two homomorphisms).
(iv) (Projection formula) If f : X → Y is proper, F is a vector bundle on Y , and α ∈
A∗(X), then
f∗(si(f
∗F)·α) = si(F)· f∗α.
(v) (Compatibility with pull-back) If f : X → Y is a morphism for which a pull-back
f
∗
: A∗(Y) → A∗(X) exists (see remark 10.1.8), F is a vector bundle on Y , and
α ∈ A∗(Y), then
si(f
∗F)· f
∗α = f
∗
(si(F)·α).
Proof. (i): Let V ⊂ X be a k-dimensional subvariety. By construction we can represent
si(F)· [V] by a cycle of dimension k − i supported in V. As Zk−i(V) = 0 for i < 0 and
Zk(V) = [V] we conclude that si(F) = 0 for i < 0 and s0(F)· [V] = n · [V] for some n ∈ Z.
The computation of the multiplicity n is a local calculation, so we can replace X by an
open subset and thus assume that F is a trivial bundle. In this case P(F) = X ×P
r−1
and
DF is a hyperplane in P
r−1
. So D
r−1
F
is a point in P
r−1
, i. e. D
r−1
F
· p
∗
[V] = [V × {pt}] and
hence s0(F)· [V] = [V].
(ii): If L is a line bundle then P(L) = X and p is the identity. Hence the statement
follows from the identity OP(L)
(−1) = L.
The proofs of (iii), (iv), and (v) all follow from the various compatibilities between
push-forward, pull-back, and intersection products. As an example we give the proof of
(iv), see [F] proposition 3.1 for the other proofs.
For (iv) consider the fiber square
P(f
∗F)
f
0
/
p
0

P(F)
p

X
f
/Y
10. Chern classes 193
and denote the Cartier divisors associated to the line bundles OP(F)
(1) and OP(f
∗F)
(1) by
DF and D
0
F
, respectively. Then
f∗(si(f
∗F)·α) = f∗ p
0
∗
(D
0
F
r−1+i
· p
0∗α) by definition 10.2.1
= p∗ f
0
∗
(D
0
F
r−i+1
· p
0∗α) by remark 9.2.10
= p∗ f
0
∗
((f
0∗DF)
r−i+1
· p
0∗α) as D
0
F = f
0∗DF
= p∗(D
r−i+1
F
· f
0
∗ p
0∗α) by lemma 9.4.10
= p∗(D
r−i+1
F
· p
∗
f∗α) by lemma 10.1.7 (i)
= si(E)· f∗α by definition 10.2.1.

Corollary 10.2.4. Let F be a vector bundle on a scheme X, and let p : P(F) → X be
the projection. Then p∗ : A∗(P(F)) → A∗(X) is surjective and p∗
: A∗(X) → A∗(P(F)) is
injective.
Proof. By proposition 10.2.3 (i) we have
α = s0(F)·α = p∗(D
r−1
F
· p
∗α)
for all α ∈ A∗(X), so p∗ is surjective. The same formula shows that α = 0 if p
∗α = 0, so
p
∗
is injective.
By proposition 10.2.3 (iii) any polynomial expression in the Segre classes of some vector bundles acts on the Chow groups of X. Although the Segre classes are the characteristic
classes of vector bundles that are the easiest ones to define, some others that are polynomial combinations of them have nicer properties and better geometric interpretations. Let
us now define these combinations.
Definition 10.2.5. Let X be a scheme, and let F be a vector bundle of rank r on X. The
total Segre class of F is defined to be the formal sum
s(F) = ∑
i≥0
si(F) : A∗(X) → A∗(X).
Note that:
(i) All si(F) can be recovered from the homomorphism s(F) by considering the
graded parts.
(ii) Although the sum over i in s(F) is formally infinite, it has of course only finitely
many terms as Ak(X) is non-zero only for finitely many k.
(iii) The homomorphism s(F) is in fact an isomorphism of vector spaces: by proposition 10.2.3 (i) it is given by a triangular matrix with ones on the diagonal (in the
natural grading of A∗(X)).
By (iii) it makes sense to define the total Chern class of F
c(F) = ∑
i≥0
ci(F)
to be the inverse homomorphism of s(F). In other words, the Chern classes ci(F) are the
unique homomorphisms ci(F) : Ak(X) → Ak−i(X) such that
s(F)· c(F) = (1+s1(F) +s2(F) +···)·(c0(F) +c1(F) +c2(F) +···) = id.
194 Andreas Gathmann
Explicitly, the first few Chern classes are given by
c0(F) = 1,
c1(F) = −s1(F),
c2(F) = −s2(F) +s1(F)
2
,
c3(F) = −s3(F) +2s1(F)s2(F)−s1(F)
3
.
Proposition 10.2.3 translates directly into corresponding statements about Chern classes:
Proposition 10.2.6. Let X and Y be schemes.
(i) For any line bundle L on X with associated Cartier divisor class D we have
c(L) · α = (1 + D) · α. In other words, ci(L) = 0 for i > 1, and c1(L) is the
homomorphism of intersection with the Cartier divisor class associated to L. By
abuse of notation, the Cartier divisor class associated to L is often also denoted
c1(L).
(ii) (Commutativity) If F1 and F2 are vector bundles on X, then
ci(F1)· cj(F2) = c j(F2)· ci(F1)
for all i, j.
(iii) (Projection formula) If f : X → Y is proper, F is a vector bundle on Y , and α ∈
A∗(X), then
f∗(ci(f
∗F)·α) = ci(F)· f∗α.
(iv) (Pull-back) If f : X →Y is a morphism for which a pull-back f ∗
: A∗(Y) → A∗(X)
exists, F is a vector bundle on Y , and α ∈ A∗(Y), then
ci(f
∗F)· f
∗α = f
∗
(ci(F)·α).
Proof. (i): This follows from proposition 10.2.3, since
(1−D+D
2 −D
3 ±···)(1+D) = 1.
(ii), (iii), (iv): All these statements follow from the corresponding properties of Segre
classes in proposition 10.2.3, taking into account that the Chern classes are just polynomials in the Segre classes.
10.3. Properties of Chern classes. In this section we will show how to compute the
Chern classes of almost any bundle that is constructed from other known bundles in some
way (e. g. by means of direct sums, tensor products, dualizing, exact sequences, symmetric
and exterior products). We will also discuss the geometric meaning of Chern classes.
The most important property of Chern classes is that they are multiplicative in exact
sequences:
Proposition 10.3.1. Let 0 → F
0 → F → F
00 → 0 be an exact sequence of vector bundles
on a scheme X. Then c(F) = c(F
0
)· c(F
00).
Proof. We prove the statement by induction on the rank of F
00
.
Step 1: rankF
00 = 1. We have to show that s(F
0
)· [V] = c(F
00)·s(F)· [V] for all kdimensional subvarieties V ⊂ X. Consider the diagram
P
0 = P(F
0
|V )

 i /
p
0
'
P(F|V ) = P
p
x
V
10. Chern classes 195
Then
c(F
00)·s(F)· [V] = c(F
00)· p∗((1+DF +D
2
F +···)· [P]) by definition 10.2.1
= c(F
00)· p∗(s(OP(−1))· [P]) by proposition 10.2.3 (ii)
= (1+c1(F
00))· p∗(s(OP(−1))· [P]) by proposition 10.2.6 (i)
= p∗((1+c1(p
∗F
00))·s(OP(−1))· [P]) by proposition 10.2.6 (iii).
On the other hand, we have a bundle map OP(−1) ,→ p
∗F → p
∗F
00 on P, which by construction fails to be injective exactly at the points of P
0
. In other words, P
0
in P is the
(scheme-theoretic) zero locus of a section of the line bundle p
∗F
00 ⊗OP(−1)
∨. So we get
s(F
0
)· [V] = p
0
∗
(s(OP0(−1))· [P
0
])
= p∗i∗(s(i
∗OP(−1))· [P
0
])
= p∗(s(OP(−1))·i∗[P
0
])
= p∗(s(OP(−1))·(c1(p
∗F
00)−c1(OP(−1)))· [P]).
Subtracting these two equations from each other, we get
c(F
00)·s(F)· [V]−s(F
0
)· [V] = p∗(s(OP(−1)) c(OP(−1))[P]) = p∗[P] = 0
for dimensional reasons.
Step 2: rankF
00 > 1. Let Q = P(F
00∨) with projection map q : Q → X, and let L
∨ ⊂
q
∗F
00∨ be the universal line bundle. Then we get a commutative diagram of vector bundles
on Q with exact rows and columns
0

0

0 /q
∗F
0 /F˜ /

F˜00 /

0
0 /q
∗F
0 /q
∗F /

q
∗F
00 /

0
L

L

0 0
for some vector bundles F˜ and F˜00 on Q with rankF˜00 = rankF
00 −1. Recall that we want
to prove the statement that for any short exact sequence of vector bundles the Chern polynomial of the bundle in the middle is equal to the product of the Chern polynomials of the
other two bundles. In the above diagram we know that this is true for the columns by step
1 and for the top row by the inductive assumption; hence it must be true for the bottom row
as well. So we have shown that
c(q
∗F) = c(q
∗F
0
)· c(q
∗F
00).
It follows that
q
∗
c(F) = q
∗
(c(F
0
)· c(F
00))
by proposition 10.2.6 (iv), and finally that
c(F) = c(F
0
)· c(F
00)
as q
∗
is injective by corollary 10.2.4.
Remark 10.3.2. Of course proposition 10.3.1 can be split up into graded parts to obtain the
equations
ck(F) = ∑
i+j=k
ci(F
0
)· cj(F
00)
196 Andreas Gathmann
for all k ≥ 0 and any exact sequence 0 → F
0 → F → F
00 → 0 of vector bundles on a scheme
X.
Note moreover that by definition the same relation s(F) = s(F
0
)·s(F
00) then holds for
the Segre classes.
Example 10.3.3. In this example we will compute the Chern classes of the tangent bundle
TX of X = P
n
. By lemma 7.4.15 we have an exact sequence of vector bundles on X
0 → OX → OX (1)
⊕(n+1) → TX → 0.
Moreover proposition 10.2.6 (i) implies that c(OX ) = 1 and c(OX (1)) = 1+H, where H is
(the divisor class of) a hyperplane in X. So by proposition 10.3.1 it follows that
c(TX ) = c(OX (1))n+1
/c(OX ) = (1+H)
n+1
,
i. e. ck(TX ) =
n+1
k

·H
k
(where H
k
is the class of a linear subspace of X of codimension k).
Remark 10.3.4. Note that proposition 10.3.1 allows us to compute the Chern classes of any
bundle F of rank r on a scheme X that has a filtration
0 = F0 ⊂ F1 ⊂ ··· ⊂ Fr−1 ⊂ Fr = F
by vector bundles such that the quotients Li
:= Fi/Fi−1 are all line bundles (i. e. Fi has rank
i for all i). In fact, in this case a recursive application of proposition 10.3.1 to the exact
sequences
0 → Fi−1 → Fi → Li → 0
yields (together with proposition 10.2.6 (i))
c(F) =
r
∏
i=1
(1+Di)
where Di = c1(Li) is the divisor associated to the line bundle Li
.
Unfortunately, not every vector bundle admits such a filtration. We will see now however that for computations with Chern classes we can essentially pretend that such a filtration always exists.
Lemma 10.3.5. (Splitting construction) Let F be a vector bundle of rank r on a scheme X.
Then there is a scheme Y and a morphism f : Y → X such that
(i) f admits push-forwards and pull-backs for Chow groups (in fact it will be an
iterated projective bundle),
(ii) the push-forward f∗ is surjective,
(iii) the pull-back f ∗
is injective,
(iv) f
∗F has a filtration by vector bundles
0 = F0 ⊂ F1 ⊂ ··· ⊂ Fr−1 ⊂ Fr = f
∗F
such that the quotients Fi/Fi−1 are line bundles on Y .
In other words, “every vector bundle admits a filtration after pulling back to an iterated
projective bundle”.
Proof. We construct the morphism f by induction on rankF. There is nothing to do if
rankF = 1. Otherwise set Y
0 = P(F
∨) and let f
0
: Y
0 → X be the projection. Let L
∨ ⊂
f
0∗F
∨ be the tautological line bundle on Y
0
. Then we have an exact sequence of vector
bundles 0 → F˜ → f
0∗F → L → 0 on Y
0
, where rankF˜ = rankF −1. Hence by the inductive
assumption there is a morphism f
00 : Y → Y
0
such that f
00∗F˜ has a filtration (Fi) with line
bundle quotients. If we set f = f
0 ◦ f
00 it follows that we have an induced filtration of f
∗F
on Y
0 = F0 ⊂ F1 ⊂ ··· ⊂ Fr−1 = f
00∗F˜ ⊂ f
∗
10. Chern classes 197
with line bundle quotients. Moreover, f∗ is surjective and f
∗
is injective, as this is true for
f
00 by the inductive assumption and for f
0 by corollary 10.2.4.
Construction 10.3.6. (Splitting construction) Suppose one wants to prove a universal
identity among Chern classes of vector bundles on a scheme X, e. g. the statement that
ci(F) = 0 whenever i > rankF (see corollary 10.3.7 below). If the identity is invariant
under pull-backs (which it essentially always is because of proposition 10.2.6 (iv)) then one
can assume that the vector bundles in question have filtrations with line bundle quotients.
More precisely, pick a morphism f : Y → X as in lemma 10.3.5. We can then show the
identity for the pulled-back bundle f
∗F on Y, using the filtration. As the pull-back f
∗
is
injective and commutes with the identity we want to show, the identity then follows for F
on X as well. (This is the same argument that we used already at the end of the proof of
proposition 10.3.1.)
Corollary 10.3.7. Let F be a vector bundle of rank r on a scheme X. Then ci(F) = 0 for
all i > r.
Proof. By the splitting construction 10.3.6 we can assume that F has a filtration with line
bundle quotients Li
, i = 1,...,r. But then c(F) = ∏
r
i=1
(1+c1(Li)) by remark 10.3.4, which
obviously has no parts of degree bigger than r.
Remark 10.3.8. This vanishing of Chern classes beyond the rank of the bundle is a property
that is not shared by the Segre classes (see e. g. proposition 10.2.3 (ii)). This is one reason
why Chern classes are usually preferred over Segre classes in computations (although they
carry the same information).
Remark 10.3.9. The splitting construction is usually formalized as follows. Let F be a
vector bundle of rank r on a scheme X. We write formally
c(F) =
r
∏
i=1
(1+αi).
There are two ways to think of the α1,...,αr
:
• The αi are just formal “variables” such that the k-th elementary symmetric polynomial in the αi
is exactly ck(F). So any symmetric polynomial in the αi
is
expressible as a polynomial in the Chern classes of F in a unique way.
• After having applied the splitting construction, the vector bundle F has a filtration
with line bundle quotients Li
. Then we can set αi = c1(Li), and the decomposition
c(F) = ∏
r
i=1
(1+αi) becomes an actual equation (and not just a formal one).
The αi are usually called the Chern roots of F. Using the splitting construction and Chern
roots, one can compute the Chern classes of almost any bundle that is constructed from
other known bundles by standard operations:
Proposition 10.3.10. Let X be a scheme, and let F and F0 be vector bundles with Chern
roots (αi)i and (α
0
j
)j
, respectively. Then:
(i) F
∨ has Chern roots (−αi)i
.
(ii) F ⊗F
0 has Chern roots (αi +α
0
j
)i, j
.
(iii) S
kF has Chern roots (αi1 +···+αik
)i1≤···≤ik
.
(iv) Λ
kF has Chern roots (αi1 +···+αik
)i1<···<ik
.
Proof. (i): If F has a filtration 0 = F0 ⊂ F1 ⊂ ··· ⊂ Fr = F with line bundle quotients Li =
Fi/Fi−1, then F
∨ has an induced filtration 0 = (F/Fr)
∨ ⊂ (F/Fr−1)
∨ ⊂ ··· ⊂ (F/F0)
∨ = F
∨
with line bundle quotients L
∨
i
.
(ii): If F and F
0 have filtrations
0 = F0 ⊂ F1 ⊂ ··· ⊂ Fr = F and 0 = F
0
0 ⊂ F
0
1 ⊂ ··· ⊂ F
0
s = F
0
198 Andreas Gathmann
with line bundle quotients Li
:= Fi/Fi−1 and L
0
i
:= F
0
i
/F
0
i−1
, then F ⊗F
0 has a filtration
0 = F0 ⊗F
0 ⊂ F1 ⊗F
0 ⊂ ··· ⊂ Fr ⊗F
0 = F ⊗F
0
with quotients Li ⊗F
0
. But Li ⊗F
0
itself has a filtration
0 = Li ⊗F
0
0 ⊂ Li ⊗F
0
1 ⊂ ··· ⊂ Li ⊗F
0
s = Li ⊗F
0
with quotients Li ⊗L
0
j
, so the result follows.
(iii) and (iv) follow in the same way.
Example 10.3.11. The results of proposition 10.3.10 can be restated using Chern classes
instead of Chern roots. For example, (i) just says that ci(F
∨) = (−1)
i
ci(F). It is more
difficult to write down closed forms for the Chern classes in the cases (ii) to (iv). For
example, if F
0 = L is a line bundle, then
c(F ⊗L) = ∏
i
(1+ (αi +α
0
)) = ∑
i
(1+c1(L))r−i
ci(F)
where r = rankF. So for 0 ≤ p ≤ r we have
cp(F ⊗L) =
p
∑
i=0

r −i
p−i

ci(F) c1(L)
p−i
.
Also, from part (iv) it follows immediately that c1(F) = c1(Λ
rF).
As a more complicated example, assume that F is a rank-2 bundle on a scheme X
and let us compute the Chern classes of S
3F. Say F has Chern roots α1 and α2, so that
c1(F) = α1 + α2 and c2(F) = α1α2. Then by part (iii) a tedious but easy computation
shows that
c(S
3F) = (1+3α1)(1+2α1 +α2)(1+α1 +2α2)(1+3α2)
= 1+6c1(F) +10c2(F) +11c1(F)
2 +30c1(F)c2(F)
+6c1(F)
3 +9c2(F)
2 +18c1(F)
2
c2(F).
Splitting this up into graded pieces one obtains the individual Chern classes, e. g.
c4(S
3F) = 9c2(F)
2 +18c1(F)
2
c2(F).
Now that we have shown how to compute Chern classes let us discuss their geometric
meaning. By far the most important property of Chern classes is that the “top Chern class”
of a vector bundle (i. e. cr(F) if r = rankF) is the class of the zero locus of a section:
Proposition 10.3.12. Let F be a vector bundle of rank r on an n-dimensional scheme X.
Let s ∈ Γ(F) be a global section of F, and assume that its scheme-theoretic zero locus Z(s)
has dimension n−r (as expected). Then [Z(s)] = cr(F)· [X] ∈ An−r(X).
Proof. We will only sketch the proof; for details especially about multiplicities we refer to
[F] section 14.1.
We prove the statement by induction on r. Applying the splitting principle we may
assume that there is an exact sequence
0 → F
0 → F → L → 0 (∗)
of vector bundles on X, where L is a line bundle and rankF
0 = rankF − 1. Now let s ∈
Γ(X,F) be a global section of F as in the proposition. Then s induces
(i) a section l ∈ Γ(X,L), and
(ii) a section s
0 ∈ Γ(Z(l),F
0
) (i. e. “s is a section of F
0 on the locus where the induced
section on L vanishes”).
10. Chern classes 199
Let us assume that l is not identically zero, and denote by i : Z(l) ,→ X the inclusion
morphism. Note that then i∗[Z(s
0
)] = cr−1(F)· [Z(l)] by the induction hypothesis, and
[Z(l)] = c1(L)·[X] as the Weil divisor associated to a line bundle is just the zero locus of a
section. Combining these results we get
[Z(s)] = i∗[Z(s
0
)] = cr−1(F)· c1(L)· [X].
But applying proposition 10.3.1 to the exact sequence (∗) we get cr(F) = cr−1(F
0
)· c1(L),
so the result follows.
Remark 10.3.13. Proposition 10.3.12 is the generalization of our old statement that the first
Chern class of a line bundle (i. e. the divisor associated to a line bundle) is the zero locus
of a (maybe rational) section of that bundle. In contrast to the line bundle case however, it
is not clear that a section of the vector bundle exists that vanishes in the right codimension.
This is why proposition 10.3.12 cannot be used as a definition for the top Chern class.
Remark 10.3.14. There are analogous interpretations for the intermediate Chern classes
ck(F) that we state without proof: let F be a vector bundle of rank r on a scheme X. Let
s1,...,sr+1−k be global sections of X, and assume that the (scheme-theoretic) locus Z ⊂ X
where the sections s1,...,sr+1−k are linearly dependent has codimension k in X (which is
the expected codimension). Then [Z] = ck(F)· [X] ∈ A∗(X). (For a proof of this statement
see [F] example 14.4.1).
Two special cases of this property are easy to see however:
(i) In the case k = r we are reduced to proposition 10.3.12.
(ii) In the case k = 1 the locus Z is just the zero locus of a section of Λ
rF, so we have
[Z] = c1(Λ
rF) = c1(F) (the latter equality is easily checked using proposition
10.3.10 (iv)).
Example 10.3.15. As an example of proposition 10.3.12 let us recalculate that there are 27
lines on a cubic surface X in P
3
(see section 4.5). To be more precise, we will not reprove
here that the number of lines in X is finite; instead we will assume that it is finite and just
recalculate the number 27 under this assumption.
Let G(1,3) be the 4-dimensional Grassmannian variety of lines in P
3
. As in construction
10.1.5 there is a tautological rank-2 subbundle F of the trivial bundle C
4 whose fiber over
a point [L] ∈ G(1,3) (where L ⊂ P
3
is a line) is precisely the 2-dimensional subspace of
C
4 whose projectivization is L. Dualizing, we get a surjective morphism of vector bundles
(C
4
)
∨ → F
∨ that corresponds to restricting a linear function on C
4
(or P
3
) to the line L.
Taking the d-th symmetric power of this morphism we arrive at a surjective morphism
S
d
(C
4
)
∨ → S
dF
∨ that corresponds to restricting a homogeneous polynomial of degree d
on P
3
to L.
Now let X = { f = 0} be a cubic surface. By what we have just said the polynomial f
determines a section of S
3F
∨ whose set of zeros in G(1,3) is precisely the set of lines that
lie in X (i. e. the set of lines on which f vanishes). So assuming that this set is finite we see
by proposition 10.3.12 that the number of lines in the cubic surface X is the degree of the
cycle c4(S
3F
∨) on G(1,3).
To compute this number note that by example 10.3.11 we have
c4(S
3F
∨
) = 9c2(F
∨
)
2 +18c1(F
∨
)
2
c2(F
∨
),
so that it remains to compute the numbers c2(F
∨)
2
and c1(F
∨)
2
c2(F
∨). There are general
rules (called “Schubert calculus”) how to compute such intersection products on Grassmannian varieties, but in this case we can also compute the result directly in a way similar
to that in example 9.4.9:
(i) By exactly the same reasoning as above, c2(F
∨) = c2(S
1F
∨) is the locus of all
lines in P
3
that are contained in a given plane.
200 Andreas Gathmann
(ii) The class c1(F
∨) = c1(Λ
2F
∨) is (by definition of the exterior product, see also
remark 10.3.14) the locus of all lines L ⊂ P
3
such that two given linear equations
f1, f2 on P
4 become linearly dependent when restricted to the line. This means
that f1|L and f2|L must have their zero at the same point of L. In other words, L
intersects Z(f1, f2), which is a line. In summary, c1(F
∨) is just the class of lines
that meet a given line in P
3
.
Using these descriptions we can now easily compute the required intersection products:
c2(F
∨)
2
is the number of lines that are contained in two given planes in P
3
, so it is 1 (the
line must precisely be the intersection line of the two planes). Moreover, c1(F
∨)
2
c2(F
∨) is
the number of lines intersecting two given lines and lying in a given plane, i. e. the number
of lines through two points in a plane, which is 1.
Summarizing, we get that the number of lines on a cubic surface is
c4(S
3F
∨
) = 9c2(F
∨
)
2 +18c1(F
∨
)
2
c2(F
∨
) = 9 · 1+18 · 1 = 27.
Remark 10.3.16. The preceding example 10.3.15 shows very well how enumerative problems can be attacked in general. By an enumerative problem we mean that we want to
count the number of curves in some space with certain conditions (e. g. lines through two
points, lines in a cubic surface, plane conics through 5 points, and so on). Namely:
(i) Find a complete (resp. compact) “moduli space” M whose points correspond to
the curves one wants to study (in the above example: the Grassmannian G(1,3)
that parametrizes lines in P
3
).
(ii) Every condition that one imposes on the curves (passing through a point, lying in
a given subvariety, . . . ) corresponds to some intersection-theoretic cycle on M —
a divisor, a combination of Chern classes, or something else.
(iii) If the expected number of curves satisfying the given conditions is finite then the
intersection product of the cycles in (ii) will have dimension 0. As M is complete
the degree of this zero-cycle is a well-defined integer. It is called the virtual
solution to the enumerative problem. Note that this number is well-defined even
if the actual number of curves satisfying the given conditions is not finite.
(iv) It is now a different (and usually more difficult, in any case not an intersectiontheoretic) problem to figure out whether the actual number of curves satisfying
the given conditions is finite or not, and if so whether they are counted in the
intersection product of (iii) with the scheme-theoretic multiplicity 1. If this is the
case then the solution of (iii) is said to be enumerative (and not only virtual). For
example, we have shown in section 4.5 that the number 27 computed intersectiontheoretically in example 10.3.15 is actually enumerative for any smooth cubic
surface X.
10.4. Statement of the Hirzebruch-Riemann-Roch theorem. As a final application of
Chern classes we will now state and sketch a proof of the famous Hirzebruch-RiemannRoch theorem that is a vast and very useful generalization (yet still not the most general
version) of the Riemann-Roch theorem (see section 7.7, in particular remark 7.7.7).
As usual the goal of the Riemann-Roch type theorems is to compute the dimension
h
0
(X,F ) of the space of global sections of a sheaf F on a scheme X, in the case at hand
of a vector bundle on a smooth projective scheme X. As we have already seen in the case
where X is a curve and F a line bundle there is no easy general formula for this number
unless you add some “correction term” (that was −h
1
(X,F ) in the case of curves). The
same is true in higher dimensions. Here the Riemann-Roch theorem will compute the Euler
characteristic of F :
Definition 10.4.1. Let F be a coherent sheaf on a projective scheme X. Then the dimensions h
i
(X,F ) = dimH
i
(X,F ) are all finite by theorem 8.4.7 (i). We define the Euler
10. Chern classes 201
characteristic of F to be the integer
χ(X,F ) := ∑
i≥0
(−1)
i
h
i
(X,F ).
(Note that the sum is finite as h
i
(X,F ) = 0 for i > dimX.)
The “left hand side” of the Hirzebruch-Riemann-Roch theorem will just be χ(X,F );
this is the number that we want to compute. Recall that there were many “vanishing theorems”, e. g. h
i
(X,F ⊗ OX (d)) = 0 for i > 0 and d  0 by theorem 8.4.7 (ii). So in the
cases when such vanishing theorems apply the theorem will actually compute the desired
number h
0
(X,F ).
The “right hand side” of the Hirzebruch-Riemann-Roch theorem is an intersectiontheoretic expression that is usually easy to compute. It is a certain combination of the
Chern (resp. Segre) classes of the bundle F (corresponding to the locally free sheaf F )
and the tangent bundle TX of X. These combinations will have rational coefficients, so we
have to tensor the Chow groups with Q (i. e. we consider formal linear combinations of
subvarieties with rational coefficients instead of integer ones).
Definition 10.4.2. Let F be a vector bundle of rank r with Chern roots α1,...,αr on a
scheme X. Then we define the Chern character ch(F) : A∗(X)⊗Q → A∗(X)⊗Q to be
ch(F) =
r
∑
i=1
exp(αi)
and the Todd class td(F) : A∗(X)⊗Q → A∗(X)⊗Q to be
td(F) =
r
∏
i=1
αi
1−exp(−αi)
,
where the expressions in the αi are to be understood as formal power series, i. e.
exp(αi) = 1+αi +
1
2
α
2
i +
1
6
α
3
i +···
and
αi
1−exp(−αi)
= 1+
1
2
αi +
1
12
α
2
i +··· .
Remark 10.4.3. As usual we can expand the definition of ch(F) and td(F) to get symmetric
polynomials in the Chern roots which can then be written as polynomials (with rational
coefficients) in the Chern classes ci = ci(F) of F. Explicitly,
ch(F) = r +c1 +
1
2
(c
2
1 −2c2) + 1
6
(c
3
1 −3c1c2 +3c3) +···
and td(F) = 1+
1
2
c1 +
1
12
(c
2
1 +c2) + 1
24
c1c2 +··· .
Remark 10.4.4. If 0 → F
0 → F → F
00 → 0 is an exact sequence of vector bundles on X
then the Chern roots of F are just the union of the Chern roots of F
0
and F
00. So we see that
ch(F) = ch(F
0
) +ch(F
00)
and
td(F) = td(F
0
)·td(F
00).
We can now state the Hirzebruch-Riemann-Roch theorem:
Theorem 10.4.5. (Hirzebruch-Riemann-Roch theorem) Let F be a vector bundle on a
smooth projective variety X. Then
χ(X,F) = deg(ch(F)·td(TX ))
where deg(α) denotes the degree of the dimension-0 part of the (non-homogeneous) cycle
α.
202 Andreas Gathmann
Before we sketch a proof of this theorem in the next section let us consider some examples.
Example 10.4.6. Let F = L be a line bundle on a smooth projective curve X of genus
g. Then χ(X,L) = h
0
(X,L) − h
1
(X,L). On the right hand side, the dimension-0 part of
ch(L)·td(TX ), i. e. its codimension-1 part, is equal to
deg(ch(L)·td(TX )) = deg((1+c1(L))(1+
1
2
c1(TX ))) by remark 10.4.3
= deg(c1(L)−
1
2
c1(ΩX ))
= degL−
1
2
(2g−2) by corollary 7.6.6
= degL+1−g,
so we are recovering our earlier Riemann-Roch theorem of corollary 8.3.3.
Example 10.4.7. If F is a vector bundle of rank r on a smooth projective curve X then we
get in the same way
h
0
(X,F)−h
1
(X,F) = deg(ch(F)·td(TX ))
= deg((r +c1(F))(1+
1
2
c1(TX )))
= degc1(F) +r(1−g).
Example 10.4.8. Let L = OX (D) be a line bundle on a smooth projective surface X corresponding to a divisor D. Now the dimension-0 part of the right hand side has codimension
2, so the Hirzebruch-Riemann-Roch theorem states that
h
0
(X,L)−h
1
(X,L) +h
2
(X,L)
= deg(ch(F)·td(TX ))
= deg1+c1(L) + 1
2
c1(L)
2
1+
1
2
c1(TX ) + 1
12
(c1(TX )
2 +c2(TX ))
=
1
2
D·(D−KX ) + K
2
X +c2(TX )
12
.
Note that:
(i) The number χ(X,OX ) = K
2
X+c2(TX )
12 is an invariant of X that does not depend on
the line bundle. The Hirzebruch-Riemann-Roch theorem implies that it is always
an integer, i. e. that K
2
X + c2(TX ) is divisible by 12 (which is not at all obvious
from the definitions).
(ii) If X has degree d and L = OX (n) for n  0 then h
1
(X,L) = h
2
(X,L) = 0 by
theorem 8.4.7 (ii). Moreover we then have D
2 = dn2
, so we get
h
0
(X,OX (n)) = d
2
n
2 +
1
2
(H ·KX )· n+
K
2
X +c2(TX )
12
where H denotes the class of a hyperplane (restricted to X). In other words, we
have just recovered proposition 6.1.5 about the Hilbert function of X. Moreover,
we have identified the non-leading coefficients of the Hilbert polynomial in terms
of intersection-theoretic data.
Example 10.4.9. The computation of example 10.4.8 works for higher-dimensional varieties as well: let X be a smooth projective N-dimensional variety of degree d and consider
the line bundle L = OX (n) on X for n  0. We see immediately that the codimension-N
part of ch(OX (n))·td(TX ) is a polynomial in n of degree N with leading coefficient
1
N!
c1(L)
N =
d
N!
n
N
,
10. Chern classes 203
which reproves proposition 6.1.5 (for smooth X). Moreover, we can identify the other coefficients of the Hilbert polynomial in terms of intersection-theoretic expressions involving
the characteristic classes of the tangent bundle of X.
Example 10.4.10. Let F = OX (d) be a line bundle on X = P
n
. Then we can compute both
sides of the Hirzebruch-Riemann-Roch theorem explicitly and therefore prove the theorem
in this case:
As for the left hand side, proposition 8.4.1 implies that
χ(X,OX (d)) =



h
0
(X,OX (d)) =
n+d
n

if d ≥ 0,
(−1)
nh
n
(X,OX (d)) = (−1)
n
−d−1
n

if d ≤ −n−1,
0 otherwise.
Note that this means in fact in all cases that
χ(X,OX (d)) = 
n+d
n

.
As for the right hand side let us first compute the Todd class of TX . By the Euler sequence
0 → OX → OX (1)
⊕(n+1) → TX → 0
of lemma 7.4.15 together with the multiplicativity of Chern classes (see proposition 10.3.1)
we see that the Chern classes (and hence the Todd class) of TX are the same as those of
OX (1)
⊕(n+1)
. But the Chern roots of the latter bundle are just n+1 times the class H of a
hyperplane, so it follows that
td(TX ) = H
n+1
(1−exp(−H))n+1
.
As the Chern character of OX (d) is obviously exp(dH) we conclude that the right hand
side of the Hirzebruch-Riemann-Roch theorem is the H
n
-coefficient of
H
n+1
exp(dH)
(1−exp(−H))n+1
.
But this is equal to the residue
resH=0
exp(dH)
(1−exp(−H))n+1
dH,
which we can compute using the substitution x = 1 − exp(−H) (so exp(H) = 1
1−x
and
dH
dx =
1
1−x
):
resH=0
exp(dH)
(1−exp(−H))n+1
dH = resx=0
(1−x)
−d−1
x
n+1
dx.
This number is equal to the x
n
-coefficient of (1−x)
−d−1
, which is simply
(−1)
n

−d −1
n

=

n+d
n

in agreement with what we had found for the left hand side of the Hirzebruch-RiemannRoch theorem above. So we have just proven the theorem for line bundles on P
n
.
10.5. Proof of the Hirzebruch-Riemann-Roch theorem. Finally we now want to give
a very short sketch of proof of the Hirzebruch-Riemann-Roch theorem 10.4.5, skipping
several subtleties from commutative algebra. The purpose of this section is just to give an
idea of the proof, and in particular to show why the rather strange-looking Todd classes
come into play. For a more detailed discussion of the proof or more general versions see
[F] chapter 1
204 Andreas Gathmann
The proof of the theorem relies heavily on certain constructions being additive (or otherwise well-behaved) on exact sequences of vector bundles. Let us formalize this idea
first.
Definition 10.5.1. Let X be a scheme. The Grothendieck group of vector bundles K
◦
(X)
on X is defined to be the group of formal finite sums ∑i ai
[Fi
] where ai ∈ Z and the Fi
are vector bundles on X, modulo the relations [F] = [F
0
] + [F
00] for every exact sequence
0 → F
0 → F → F
00 → 0. (Of course we then also have ∑
r
i=1
(−1)
i
[Fi
] = 0 for every exact
sequence
0 → F1 → F2 → ··· → Fr → 0.)
Example 10.5.2. Definition 10.5.1 just says that every construction that is additive on
exact sequences passes to the Grothendieck group. For example:
(i) If X is projective then the Euler characteristic of a vector bundle (see definition
10.4.1) is additive on exact sequences by the long exact cohomology sequence of
proposition 8.2.1. Hence the Euler characteristic can be thought of as a homomorphism of Abelian groups
χ : K
◦
(X) → Z, χ([F]) = χ(X,F).
(ii) The Chern character of a vector bundle is additive on exact sequences remark
10.4.4. So we get a homomorphism
ch : K
◦
(X) → A∗(X)⊗Q, ch([F]) = ch(F).
(It can in fact be shown that this homomorphism gives rise to an isomorphism
K
◦
(X)⊗Q → A∗(X)⊗Q if X is smooth; see [F] example 15.2.16(b). We will not
need this however in our proof.)
(iii) Let X be a smooth projective variety. For the same reason as in (ii) the right hand
side of the Hirzebruch-Riemann-Roch theorem gives rise to a homomorphism
τ : K
◦
(X) → A∗(X)⊗Q, τ(F) = ch(F)·td(TX ).
In particular, by (i) and (iii) we have checked already that both sides of the HirzebruchRiemann-Roch theorem are additive on exact sequences (which is good). So to prove the
theorem we only have to check it on a set of generators for K
◦
(X). To use this to our
advantage however we first have to gather more information about the structure of the
Grothendieck groups. We will need the following lemma of which we can only sketch the
proof.
Lemma 10.5.3. Let X be a smooth projective scheme. Then for every coherent sheaf F on
X there is an exact sequence
0 → Fr → Fr−1 → ··· → F0 → F → 0
where the Fi are vector bundles (i. e. locally free sheaves). We say that “every coherent
sheaf has a finite locally free resolution”. Moreover, if X = P
n
then the Fi can all be
chosen to be direct sums of line bundles OX (d) for various d.
Proof. By a repeated application of lemma 8.4.6 we know already that there is a (possibly
infinite) exact sequence
··· → Fr → ··· → F1 → F0 → F → 0.
Now one can show that for an n-dimensional smooth scheme the kernel K of the morphism
Fr−1 → Fr−2 is always a vector bundle (see [F] B.8.3). So we get a locally free resolution
0 → K → Fr−1 → Fr−2 → ··· → F0 → F → 0
as required.
10. Chern classes 205
If X = P
n with homogeneous coordinate ring S = k[x0,..., xn] then one can show that a
coherent sheaf F on X is nothing but a graded S-module M (in the same way that a coherent
sheaf on an affine scheme SpecR is given by an R-module). By the famous Hilbert syzygy
theorem (see [EH] theorem III-57) there is a free resolution of M
0 →
M
i
Sn,i → ··· →M
i
S1,i →
M
i
S0,i → M → 0
where each Sj,i
is isomorphic to S, with the grading shifted by some constants aj,i
. This
means exactly that we have a locally free resolution
0 →
M
i
OX (an,i) → ··· →M
i
OX (a1,i) →
M
i
OX (a0,i) → F → 0
of F .
Corollary 10.5.4. The Hirzebruch-Riemann-Roch theorem 10.4.5 is true for any vector
bundle on P
n
.
Proof. By lemma 10.5.3 (applied to X = P
n
and a vector bundle F ) the Grothendieck
group K
◦
(P
n
) is generated by the classes of the line bundles OPn (d) for d ∈ Z. As we
have already checked the Hirzebruch-Riemann-Roch theorem for these bundles in example
10.4.10 the statement follows by the remark at the end of example 10.5.2.
Remark 10.5.5. To study the Hirzebruch-Riemann-Roch theorem for general smooth projective X let i : X → P
n be an embedding of X in projective space and consider the following
diagram:
K
◦
(X)
i∗ /
τ

K
◦
(P
n
)
χ
/
τ

Z
_

A(X)⊗Q
i∗ /A(P
n
)⊗Q
deg
/Q.
Let us first discuss the right square. The homomorphisms χ and τ are explained in example 10.5.2, and deg denotes the degree of the dimension-0 part of a cycle class. The
Hirzebruch-Riemann-Roch theorem for P
n of corollary 10.5.4 says precisely that this right
square is commutative.
Now consider the left square. The homomorphism τ is as above, and the i∗ in the bottom
row is the proper push-forward of cycles of corollary 9.2.12. We have to explain the pushforward i∗ in the top row. Of course we would like to define i∗[F] = [i∗F] for any vector
bundle F on X, but we cannot do this directly as i∗F is not a vector bundle but only a
coherent sheaf on P
n
. So instead we let
0 → Fr → Fr−1 → ··· → F0 → i∗F → 0 (∗)
be a locally free resolution of the coherent sheaf i∗F on P
n
and set
i∗ : K
◦
(X) → K
◦
(P
n
), i∗([F]) =
r
∑
k=0
(−1)
k
[Fk].
One can show that this is indeed a well-defined homomorphism of groups (i. e. that this
definition does not depend on the choice of locally free resolution), see [F] section B.8.3.
But in fact we do not really need to know this: we do know by the long exact cohomology
sequence applied to (∗) that
χ(X,F) =
r
∑
k=0
(−1)
k
χ(P
n
,Fk),
206 Andreas Gathmann
so it is clear that at least the composition χ◦i∗ does not depend on the choice of locally free
resolution. The Hirzebruch-Riemann-Roch theorem on X is now precisely the statement
that the outer rectangle in the above diagram is commutative.
As we know already that the right square is commutative, it suffices therefore to show
that the left square is commutative as well (for any choice of locally free resolution as
above), i. e. that
r
∑
k=0
(−1)
k
ch(Fk)·td(TPr) = i∗(ch(F)·td(TX )).
As the Todd class is multiplicative on exact sequences by remark 10.4.4 we can rewrite
this using the projection formula as
r
∑
k=0
(−1)
k
ch(Fk) = i∗
ch(F)
td(NX/Pn )
.
Summarizing our ideas we see that to prove the general Hirzebruch-Riemann-Roch theorem it suffices to prove the following proposition (for Y = P
n
):
Proposition 10.5.6. Let i : X → Y be a closed immersion of smooth projective schemes,
and let F be a vector bundle on X. Then there is a locally free resolution
0 → Fr → Fr−1 → ··· → F0 → i∗F → 0
of the coherent sheaf i∗F on Y such that
r
∑
k=0
(−1)
k
ch(Fk) = i∗
ch(F)
td(NX/Y )
in A∗(Y)⊗Q.
Example 10.5.7. Before we give the general proof let us consider an example where both
sides of the equation can be computed explicitly: let X be a smooth scheme, E a vector
bundle of rank r on X, and Y = P(E ⊕ OX ). The embedding i : X → Y is given by X =
P(0⊕OX ),→ P(E ⊕OX ). In other words, X is just “the zero section of a projective bundle”.
The special features of this particular case that we will need are:
(i) There is a projection morphism p : Y → X such that p ◦ i = id.
(ii) X is the zero locus of a section of a vector bundle on Y: consider the exact sequence
0 → S → p
∗
(E ⊕OX ) → Q → 0 (∗)
on Y, where S is the tautological subbundle of construction 10.1.5. The vector
bundle Q (which has rank r) is usually called the universal quotient bundle. Note
that we have a global section of p
∗
(E ⊕ OX ) by taking the point (0,1) in every
fiber (i. e. 0 in the fiber of E and 1 in the fiber of OX ). By definition of S the
induced section s ∈ Γ(Q) vanishes precisely on P(0⊕OX ) = X.
(iii) Restricting (∗) to X (i. e. pulling the sequence back by i) we get the exact sequence
0 → i
∗
S → E ⊕OX → i
∗Q → 0 (∗)
on X. Note that the first morphism is given by λ 7→ (0,λ) by construction, so we
conclude that i
∗Q = E.
(iv) As X is given in Y as the zero locus of a section of Q, we see from example 10.1.6
that the normal bundle of X in Y is just NX/Y = i
∗Q = E.
Let us now check proposition 10.5.6 in this case. Note that away from the zero locus of s
there is an exact sequence
0 → OY
·s → Q
∧s → Λ
2Q
∧s → Λ
3Q → ··· → Λ
r−1Q
∧s → Λ
rQ → 0
10. Chern classes 207
of vector bundles (which follows from the corresponding statement for vector spaces).
Dualizing and tensoring this sequence with p
∗F we get the exact sequence
0 → p
∗F ⊗Λ
rQ
∨ → p
∗F ⊗Λ
r−1Q
∨ → ··· → p
∗F ⊗Q
∨ → p
∗F → 0
again on Y\Z(s) = Y\X. Let us try to extend this exact sequence to all of Y. Note that the
last morphism p
∗F ⊗Q
∨ → p
∗F is just induced by the evaluation morphism s : Q
∨ → OY ,
so its cokernel is precisely the sheaf (p
∗F)|Z(s) = i∗F. One can show that the other stages
of the sequence remain indeed exact (see [F] B.3.4), so we get a locally free resolution
0 → p
∗F ⊗Λ
rQ
∨ → p
∗F ⊗Λ
r−1Q
∨ → ··· → p
∗F ⊗Q
∨ → p
∗F → i∗F → 0
on Y. (This resolution is called the Koszul complex.) So what we have to check is that
r
∑
k=0
(−1)
k
ch(p
∗F ⊗Λ
kQ
∨
) = i∗
ch(F)
td(i
∗Q)
.
But note that
i∗
ch(F)
td(i
∗Q)
=
ch(p
∗F)
td(Q)
·i∗[X] = ch(p
∗F)cr(Q)
td(Q)
by the projection formula and proposition 10.3.12. So by the additivity of Chern characters
it suffices to prove that
r
∑
k=0
(−1)
k
ch(Λ
kQ
∨
) = cr(Q)
td(Q)
.
But this is easily done: if α1,...,αr are the Chern roots of Q then the left hand side is
r
∑
k=0
(−1)
k ∑
i1<···<ik
exp(−αi1 −···−αik
) =
r
∏
i=1
(1−exp(−αi)) = α1 ···αr
·
r
∏
i=1
1−exp(−αi)
αi
,
which equals the right hand side. It is in fact this formal identity that explains the appearance of Todd classes in the Hirzebruch-Riemann-Roch theorem.
Using the computation of this special example we can now give the general proof of the
Hirzebruch-Riemann-Roch theorem.
Proof. (of proposition 10.5.6) We want to reduce the proof to the special case considered
in example 10.5.7.
Let i : X → Y be any inclusion morphism of smooth projective varieties. We denote by
M be the blow-up of Y ×P
1
in X × {0}. The smooth projective scheme M comes together
with a projection morphism q : M → P
1
. Its fibers q
−1
(P) for P 6= 0 are all isomorphic to
Y. The fiber q
−1
(0) however is reducible with two smooth components: one of them (the
exceptional hypersurface of the blow-up) is the projectivized normal bundle of X × {0} in
Y × P
1 by example 10.1.6, and the other one is simply the blow-up Y˜ of Y in X. We are
particularly interested in the first component. As the normal bundle of X × {0} in Y ×P
1
is
NX/Y ⊕OX this component is just the projective bundle P := P(NX/Y ⊕OX ) on X. Note that
there is an inclusion of the space X ×P
1
in M that corresponds to the given inclusion X ⊂Y
in the fibers q
−1
(P) for P 6= 0, and to the “zero section inclusion” X ⊂ P(NX/Y ⊕OX ) = P
as in example 10.5.7 in the fiber q
−1
(0). The following picture illustrates the geometric
situation.
208 Andreas Gathmann
IP 1
IP X/Y +OX
(N )
8
0
Y
X
X X
Y
Y
~
M
q
P=
The idea of the proof is now simply the following: we have to prove an equality in the Chow
groups, i. e. modulo rational equivalence. The fibers q
−1
(0) and q
−1
(∞) are rationally
equivalent as they are the zero resp. pole locus of a rational function on the base P
1
, so they
are effectively “the same” for intersection-theoretic purposes. But example 10.5.7 shows
that the proposition is true in the fiber q
−1
(0), so it should be true in the fiber q
−1
(∞) as
well.
To be more precise, let F be a sheaf on X as in the proposition. Denote by pX : X ×P
1 →
X the projection, and by iX : X ×P
1 → M the inclusion discussed above. Then iX ∗ p
∗
X F is
a coherent sheaf on M that can be thought of as “the sheaf F on X in every fiber of q”. By
lemma 10.5.3 we can choose a locally free resolution
0 → Fr → Fr−1 → ··· → F0 → iX ∗ p
∗
X F → 0 (1)
on M.
Note that the divisor [0]−[∞] on P
1
is equivalent to zero by example 9.1.9. So it follows
that
r
∑
k=0
(−1)
k
ch(Fi)· q
∗
([0]−[∞]) = 0
in A∗(M)⊗Q. Now by definition of the pull-back we have q
∗
[0] = [Y˜]+[P] and q
∗
[∞] = [Y],
so we get the equality
r
∑
k=0
(−1)
k
ch(Fi
|Y˜)· [Y˜] +
r
∑
k=0
(−1)
k
ch(Fi
|P)· [P] =
r
∑
k=0
(−1)
k
ch(Fi
|Y )· [Y] (2)
in A∗(M)⊗Q. But note that the restriction to Y˜ of the sheaf iX ∗ p
∗
X F in (1) is the zero sheaf
as X ×P
1 ∩Y˜ = 0/ in M. So the sequence
0 → Fr
|Y˜ → ··· → F1|Y˜ → F0|Y˜ → 0
is exact, which means that the first sum in (2) vanishes. The second sum in (2) is precisely
ch(F)
td(NX/Y
)
· [X] by example 10.5.7. So we conclude that
r
∑
k=0
(−1)
k
ch(Fi
|Y )· [Y] = ch(F)
td(NX/Y )
· [X]
in A∗(M)⊗Q. Pushing this relation forward by the (proper) projection morphism from M
to Y then gives the desired equation.
This completes the proof of the Hirzebruch-Riemann-Roch theorem 10.4.5.
10. Chern classes 209
Remark 10.5.8. Combining proposition 10.5.6 with remark 10.5.5 we see that we have just
proven the following statement: let f : X → Y be a closed immersion of smooth projective
schemes, and let F be a coherent sheaf on X. Then there is a locally free resolution
0 → Fr → Fr−1 → ··· → F0 → f∗F → 0
of the coherent sheaf f∗F on Y such that
r
∑
k=0
(−1)
k
ch(Fk)·td(TY ) = f∗(ch(F)·td(TX )) ∈ A∗(Y)⊗Q.
This is often written as
ch(f∗F)·td(TY ) = f∗(ch(F)·td(TX )).
In other words, “the push-forward f∗ commutes with the operator τ of example 10.5.2
(iii)”.
It is the statement of the Grothendieck-Riemann-Roch theorem that this relation is
actually true for any proper morphism f of smooth projective schemes (and not just for
closed immersions). See [F] section 15 for details on how to prove this.
The Grothendieck-Riemann-Roch theorem is probably one of the most general Riemann-Roch type theorems that one can prove. The only further generalization one could
think of is to singular schemes. There are some such generalizations to mildly singular
schemes; see [F] section 18 for details.
10.6. Exercises.
Exercise 10.6.1. Let X = P
1
, and for n ∈ Z let Fn be the projective bundle Fn = P(OX ⊕
OX (n)). Let p : Fn → X be the projection morphism. The surfaces Fn are called Hirzebruch
surfaces.
(i) Show that F0
∼= P
1 ×P
1
, and Fn
∼= F−n for all n.
(ii) Show that all fibers p
−1
(P) ⊂ Fn for P ∈ X are rationally equivalent as 1-cycles
on Fn. Denote this cycle by D ∈ A1(Fn).
(iii) Now let n ≥ 0. Show that the global section (1, x
n
0
) of OX ⊕ OX (n) (where x0,
x1 are the homogeneous coordinates of X) determines a morphism s : X → Fn.
Denote by C ∈ A1(Fn) the class of the image curve s(X).
(iv) Again for n ≥ 0, show that A0(Fn) ∼= Z and A1(Fn) = Z· [C]⊕Z· [D]. Compute
the intersection products C
2
, D
2
, and C·D, arriving at a Bezout style theorem for ´
the surfaces Fn.
Exercise 10.6.2. Let F and F
0 be two rank-2 vector bundles on a scheme X. Compute the
Chern classes of F ⊗F
0
in terms of the Chern classes of F and F
0
.
Exercise 10.6.3. Let F be a vector bundle of rank r on a scheme X, and let p : P(F) → X
be the projection. Prove that
D
r
F +D
r−1
F
· p
∗
c1(F) +···+ p
∗
cr(F) = 0,
where DF is the Cartier divisor associated to the line bundle OP(F)
(1).
Exercise 10.6.4. Let X ⊂ P
4 be the intersection of two general quadric hypersurfaces.
(i) Show that one expects a finite number of lines in X.
(ii) If there is a finite number of lines in X, show that this number is 16 (as usual
counted with multiplicities (which one expects to be 1 for general X)).
Exercise 10.6.5. A circle in the plane P
2
C
is defined to be a conic passing through the two
points (1 : ±i : 0).
Why is this called a circle?
How many circles are there in the plane that are tangent to
210 Andreas Gathmann
(i) three circles
(ii) two circles and a line
(iii) one circle and two lines
(iv) three lines
in general position? (Watch out for possible non-enumerative contributions in the intersection products you consider.)
If you are interested, try to find out the answer to the above questions over R (and the
“usual” definition of a circle).
Exercise 10.6.6. Let X ⊂ P
4 be a smooth quintic hypersurface, i. e. the zero locus of a
homogeneous polynomial of degree 5.
(i) Show that one expects a finite number of lines in X, and that this expected number
is then 2875.
(ii) Show that the number of lines on the special quintic X = {x
5
0 + ··· + x
5
4 = 0} is
not finite. This illustrates the fact that the intersection-theoretic computations will
only yield virtual numbers in general. (In fact one can show that the number of
lines on a general quintic hypersurface in P
4
is finite and that the computation of
(i) then yields the correct answer.)
Exercise 10.6.7. Let X = P
1 ×P
1
. Compute the number K
2
X +c2(TX ) directly and check
that it is divisible by 12 (see example 10.4.8).
Exercise 10.6.8. Let X and Y be isomorphic smooth projective varieties. Use the Hirzebruch-Riemann-Roch theorem 10.4.5 to prove that the constant coefficients of the Hilbert
polynomials of X and Y agree, whereas the non-constant coefficients will in general be
different.
References 211
REFERENCES
[AM] M. Atiyah, I. Macdonald, Introduction to commutative algebra, Addison-Wesley (1969).
[D] O. Debarre, Introduction a la g ` eom ´ etrie alg ´ ebrique ´ , notes for a class taught at the University Louis
Pasteur in Strasbourg, available at http://www-irma.u-strasbg.fr/˜debarre/.
[Do] I. Dolgachev, Introduction to algebraic geometry, notes for a class taught at the University of Michigan,
available at http://www.math.lsa.umich.edu/˜idolga/lecturenotes.html.
[EGA] A. Grothendieck, J. Dieudonne,´ El´ ements de g ´ eom ´ etrie alg ´ ebrique ´ , Publications Mathematiques IHES ´
(various volumes).
[EH] D. Eisenbud, J. Harris, The geometry of schemes, Springer Graduate Texts in Mathematics 197 (2000).
[F] W. Fulton, Intersection theory, Springer-Verlag (1984).
[G] A. Gathmann, Algebraic geometry, notes for a class taught at Harvard University (1999-2000), available
at http://www.math.ias.edu/˜andreas/pub/.
[Gr] G.-M. Greuel, Introduction to algebraic geometry, notes for a class taught at the University of Kaiserslautern, Mathematics International Lecture Notes, University of Kaiserslautern (1997–1998).
[GP] G.-M. Greuel, G. Pfister, A Singular introduction to commutative algebra, Springer-Verlag (2002).
[H] R. Hartshorne, Algebraic geometry, Springer Graduate Texts in Mathematics 52 (1977).
[Ha] J. Harris, Algebraic geometry, Springer Graduate Texts in Mathematics 133 (1992).
[K] F. Kirwan, Complex algebraic curves, London Mathematical Society Student Texts 23, Cambridge
University Press (1992).
[M1] D. Mumford, The red book of varieties and schemes, Springer Lecture Notes in Mathematics 1358
(1988).
[M2] D. Mumford, Algebraic geometry I — complex projective varieties, Springer Classics in Mathematics
(1976).
[Ma] H. Matsumura, Commutative algebra, W. A. Benjamin Publishers (1970).
[R] M. Reid, Undergraduate algebraic geometry, London Mathematical Society Student Texts 12, Cambridge University Press (1988).
[S1] I. Shafarevich, Basic algebraic geometry, Springer Study Edition (1977).
[S2] I. Shafarevich, Basic algebraic geometry I — Varieties in projective space, Springer-Verlag, Berlin
(1994).
[S3] I. Shafarevich, Basic algebraic geometry II — Schemes and complex manifolds, Springer-Verlag, Berlin
(1994).
[V] R. Vakil, Introduction to algebraic geometry, notes for a class taught at MIT (1999), available at
http://math.stanford.edu/˜vakil/725/course.html.
Note: This is a very extensive list of literature of varying usefulness. Here is a short
recommendation which of the references you might want to use for what:
• For a general reference on the commutative algebra background, see [AM].
• For commutative algebra problems involving computational aspects, see [GP].
• For motivational aspects, examples, and a generally “fairy-tale” style introduction to the classical theory of algebraic geometry (no schemes) without much
theoretical background, see [Ha], or maybe [S1] and [S2].
• For motivations and examples concerning scheme theory, see [EH], or maybe
[S1] and [S3].
• For a good book that develops the theory, but largely lacks motivations and examples (especially in chapters II and III), see [H]. You should not try to read the
“hard-core” parts of this book without some motivational background.
• For intersection theory and Chern classes the best reference is [F].
• For the ultimate reference (“if it is not proven there, it must be wrong”), see
[EGA]. Warning: this is unreadable if you do not have a decent background in
algebraic geometry yet, and it is close to being unreadable even if you do.